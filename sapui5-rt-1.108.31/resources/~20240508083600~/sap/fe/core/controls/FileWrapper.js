/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/CommonUtils","sap/fe/core/helpers/ClassSupport","sap/fe/macros/ResourceModel","sap/m/BusyDialog","./FieldWrapper"],function(e,t,i,r,n){"use strict";var l,a,o,s,u,p,f,c,d,y,h,b,g,v,m,w,_,E,C,P,z,B,x,U,S,T,A;var L=t.property;var I=t.defineUI5Class;var O=t.aggregation;function k(e,t,i,r){if(!i)return;Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function D(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function j(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;R(e,t)}function R(e,t){R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,i){t.__proto__=i;return t};return R(e,t)}function F(e,t,i,r,n){var l={};Object.keys(r).forEach(function(e){l[e]=r[e]});l.enumerable=!!l.enumerable;l.configurable=!!l.configurable;if("value"in l||l.initializer){l.writable=true}l=i.slice().reverse().reduce(function(i,r){return r(e,t,i)||i},l);if(n&&l.initializer!==void 0){l.value=l.initializer?l.initializer.call(n):void 0;l.initializer=undefined}if(l.initializer===void 0){Object.defineProperty(e,t,l);l=null}return l}function N(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}var V=(l=I("sap.fe.core.controls.FileWrapper"),a=L({type:"sap.ui.core.URI"}),o=L({type:"sap.ui.model.Context"}),s=L({type:"sap.ui.model.Context"}),u=L({type:"string"}),p=L({type:"string"}),f=L({type:"string"}),c=O({type:"sap.m.Avatar",multiple:false}),d=O({type:"sap.ui.core.Icon",multiple:false}),y=O({type:"sap.m.Link",multiple:false}),h=O({type:"sap.m.Text",multiple:false}),b=O({type:"sap.ui.unified.FileUploader",multiple:false}),g=O({type:"sap.m.Button",multiple:false}),l(v=(m=function(t){j(l,t);function l(){var e;for(var i=arguments.length,r=new Array(i),n=0;n<i;n++){r[n]=arguments[n]}e=t.call.apply(t,[this].concat(r))||this;k(e,"uploadUrl",w,D(e));k(e,"parentEntitySet",_,D(e));k(e,"parentEntityType",E,D(e));k(e,"propertyPath",C,D(e));k(e,"filename",P,D(e));k(e,"mediaType",z,D(e));k(e,"avatar",B,D(e));k(e,"icon",x,D(e));k(e,"link",U,D(e));k(e,"text",S,D(e));k(e,"fileUploader",T,D(e));k(e,"deleteButton",A,D(e));e._busy=false;return e}var a=l.prototype;a.getAccessibilityInfo=function e(){var t=[];if(this.avatar){t.push(this.avatar)}if(this.icon){t.push(this.icon)}if(this.link){t.push(this.link)}if(this.text){t.push(this.text)}if(this.fileUploader){t.push(this.fileUploader)}if(this.deleteButton){t.push(this.deleteButton)}return{children:t}};a.onBeforeRendering=function e(){this._setAriaLabels();this._addSideEffects()};a._setAriaLabels=function e(){this._setAriaLabelledBy(this.avatar);this._setAriaLabelledBy(this.icon);this._setAriaLabelledBy(this.link);this._setAriaLabelledBy(this.text);this._setAriaLabelledBy(this.fileUploader);this._setAriaLabelledBy(this.deleteButton)};a._addSideEffects=function e(){var t="",i="",r="",n="";var l=[];this.getCustomData().forEach(function(e){if(e.getProperty("key")==="sourcePath"){i=e.getProperty("value")}});n="/".concat(this.parentEntitySet,"/");t=i.substring(i.indexOf(n)+n.length,i.length);r=t.replace(this.propertyPath,"");l.push({$NavigationPropertyPath:t});if(this.filename){l.push({$NavigationPropertyPath:r+this.filename})}if(this.mediaType){l.push({$NavigationPropertyPath:r+this.mediaType})}this._getSideEffectController().addControlSideEffects(this.parentEntityType,{SourceProperties:t,TargetEntities:l,sourceControlId:this.getId()})};a._getSideEffectController=function e(){var t=this._getViewController();return t?t._sideEffects:undefined};a._getViewController=function t(){var i=e.getTargetView(this);return i&&i.getController()};a.getUploadUrl=function e(){var t=this.getBindingContext();return t&&this.uploadUrl?this.uploadUrl.replace(t.getPath(),t.getCanonicalPath()):""};a.setUIBusy=function e(t){var n=this;this._busy=t;if(t){if(!this.busyDialog){this.busyDialog=new r({text:i.getText("M_FILEWRAPPER_BUSY_DIALOG_TITLE"),showCancelButton:false})}setTimeout(function(){if(n._busy){var e;(e=n.busyDialog)===null||e===void 0?void 0:e.open()}},1e3)}else{var l;(l=this.busyDialog)===null||l===void 0?void 0:l.close(false)}};a.getUIBusy=function e(){return this._busy};l.render=function e(t,i){t.openStart("div",i);t.style("width",i.width);t.openEnd();t.openStart("div");t.style("display","flex");t.style("box-sizing","border-box");t.style("justify-content","space-between");t.style("align-items","center");t.style("flex-wrap","wrap");t.style("align-content","stretch");t.style("width","100%");t.openEnd();t.openStart("div");t.style("display","flex");t.style("align-items","center");t.openEnd();if(i.avatar){t.renderControl(i.avatar)}else{t.renderControl(i.icon);t.renderControl(i.link);t.renderControl(i.text)}t.close("div");t.openStart("div");t.style("display","flex");t.style("align-items","center");t.openEnd();t.renderControl(i.fileUploader);t.renderControl(i.deleteButton);t.close("div");t.close("div");t.close("div")};a.destroy=function e(t){var i=this._getSideEffectController();if(i){i.removeControlSideEffects(this)}delete this.busyDialog;n.prototype.destroy.apply(this,[t])};return l}(n),w=F(m.prototype,"uploadUrl",[a],{configurable:true,enumerable:true,writable:true,initializer:null}),_=F(m.prototype,"parentEntitySet",[o],{configurable:true,enumerable:true,writable:true,initializer:null}),E=F(m.prototype,"parentEntityType",[s],{configurable:true,enumerable:true,writable:true,initializer:null}),C=F(m.prototype,"propertyPath",[u],{configurable:true,enumerable:true,writable:true,initializer:null}),P=F(m.prototype,"filename",[p],{configurable:true,enumerable:true,writable:true,initializer:null}),z=F(m.prototype,"mediaType",[f],{configurable:true,enumerable:true,writable:true,initializer:null}),B=F(m.prototype,"avatar",[c],{configurable:true,enumerable:true,writable:true,initializer:null}),x=F(m.prototype,"icon",[d],{configurable:true,enumerable:true,writable:true,initializer:null}),U=F(m.prototype,"link",[y],{configurable:true,enumerable:true,writable:true,initializer:null}),S=F(m.prototype,"text",[h],{configurable:true,enumerable:true,writable:true,initializer:null}),T=F(m.prototype,"fileUploader",[b],{configurable:true,enumerable:true,writable:true,initializer:null}),A=F(m.prototype,"deleteButton",[g],{configurable:true,enumerable:true,writable:true,initializer:null}),m))||v);return V},false);
//# sourceMappingURL=FileWrapper.js.map