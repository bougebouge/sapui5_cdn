/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/controls/DataLossOrDraftDiscard/DataLossOrDraftDiscardHandler","sap/fe/core/helpers/EditState","sap/fe/core/controllerextensions/collaboration/ActivitySync","sap/base/Log"],function(e,t,r,n){"use strict";function i(e,t){try{var r=e()}catch(e){return t(e)}if(r&&r.then){return r.then(void 0,t)}return r}var o=function(e,t,r,o,c,s){try{if(s===undefined)s=v.BackNavigation;var f=r.getModel();var u=f.bindContext("".concat(r.getPath(),"/DraftAdministrativeData")).getBoundContext();var l=function(){if(r&&r.getObject()&&(!r.getObject().DraftAdministrativeData||r.getObject().IsActiveEntity===true)){e()}else{var f=i(function(){return Promise.resolve(u.requestObject()).then(function(n){return Promise.resolve(a(n,e,t,r,o,c,s)).then(function(){})})},function(e){n.error("Cannot retrieve draftDataContext information",e)});if(f&&f.then)return f.then(function(){})}}();return Promise.resolve(l&&l.then?l.then(function(){}):void 0)}catch(e){return Promise.reject(e)}};var a=function(e,n,i,o,a,d,h){try{if(h===undefined)h=v.BackNavigation;var g=r.isConnected(a.getView());var m=!g?n:function(){r.disconnect(a.getView());for(var e=arguments.length,t=new Array(e),i=0;i<e;i++){t[i]=arguments[i]}n.apply.apply(n,[null].concat(t))};var p=l(a);var D=function(){if(e){var r=function(){if(a.getAppComponent().getRootViewController().isFclEnabled()){return Promise.resolve(u(e,i,a,m,d)).then(function(){})}else if(!o.getObject().HasActiveEntity){f(e,i,a,m,h,p,d)}else if(e.CreationDateTime===e.LastChangeDateTime){s(a,o,m,h)}else if(t.isEditStateDirty()){c(a,i,m,h,p,d)}else{m()}}();if(r&&r.then)return r.then(function(){})}else{n()}}();return Promise.resolve(D&&D.then?D.then(function(){}):void 0)}catch(e){return Promise.reject(e)}};var c=function(t,r,n,i,o,a){try{if(i===v.ForwardNavigation&&o){n()}else{e.performAfterDiscardorKeepDraft(n,r,t,a)}return Promise.resolve()}catch(e){return Promise.reject(e)}};var s=function(e,t,r,o){try{var a=function(){if(o===v.BackNavigation){var a={skipDiscardPopover:true};var c=i(function(){return Promise.resolve(e.editFlow.cancelDocument(t,a)).then(function(){r()})},function(e){n.error("Error while canceling the document",e)});if(c&&c.then)return c.then(function(){})}else{r()}}();return Promise.resolve(a&&a.then?a.then(function(){}):void 0)}catch(e){return Promise.reject(e)}};var f=function(r,o,a,c,s,f,u){try{var l=function(){if(t.isEditStateDirty()){var l=function(){if(r.CreationDateTime===r.LastChangeDateTime&&s===v.BackNavigation){var t=i(function(){return Promise.resolve(e.discardDraft(a,u)).then(function(){c()})},function(e){n.error("Error while canceling the document",e)});if(t&&t.then)return t.then(function(){})}else if(s===v.ForwardNavigation&&f){c()}else{e.performAfterDiscardorKeepDraft(c,o,a,u)}}();if(l&&l.then)return l.then(function(){})}else{c()}}();return Promise.resolve(l&&l.then?l.then(function(){}):void 0)}catch(e){return Promise.reject(e)}};var u=function(t,r,n,i,o){try{if(t.CreationDateTime!==t.LastChangeDateTime){e.performAfterDiscardorKeepDraft(i,r,n,o)}else{i()}return Promise.resolve()}catch(e){return Promise.reject(e)}};var v;(function(e){e["BackNavigation"]="BackNavigation";e["ForwardNavigation"]="ForwardNavigation"})(v||(v={}));function l(e){var t,r;var n=false;var i=e.getAppComponent().getManifest();n=(i===null||i===void 0?void 0:(t=i["sap.fe"])===null||t===void 0?void 0:(r=t.app)===null||r===void 0?void 0:r.silentlyKeepDraftOnForwardNavigation)||false;return n}var d={processDataLossOrDraftDiscardConfirmation:o,silentlyKeepDraftOnForwardNavigation:l,NavigationType:v,processFclMode:u,processNoActiveEntityMode:f,processEditingDraftForExistingEntity:s,processEditStateDirty:c};return d},false);
//# sourceMappingURL=draftDataLossPopup.js.map