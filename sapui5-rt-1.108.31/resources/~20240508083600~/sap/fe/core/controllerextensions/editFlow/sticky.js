/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/library","sap/m/MessageBox","sap/ui/core/Core","../../operationsHelper"],function(e,t,n,r,o,i){"use strict";var a=function(e,n){try{function s(n){var o=t.getTranslatedText("C_OP_OBJECT_PAGE_SAVE",n);var a=r.bindContext("".concat(c,"(...)"),e,{$$inheritExpandSelect:true});var s="direct";var u=a.execute(s,undefined,i.fnOnStrictHandlingFailed.bind(l,s,{label:o,model:r},n,null,null,null,undefined));r.submitBatch(s);return u}var r=e.getModel(),o=r.getMetaModel(),a=o.getMetaPath(e.getPath()),c=o.getObject("".concat(a,"@com.sap.vocabularies.Session.v1.StickySessionSupported/SaveAction"));if(!c){throw new Error("Save Action for Sticky Session not found for ".concat(a))}return Promise.resolve(n?Promise.resolve(n.getModel("sap.fe.i18n").getResourceBundle()).then(s):s(n))}catch(u){return Promise.reject(u)}};var c=function(e,n){try{var r=e.getModel(),o=r.getMetaModel(),a=o.getMetaPath(e.getPath()),c=o.getObject("".concat(a,"@com.sap.vocabularies.Session.v1.StickySessionSupported/EditAction"));if(!c){throw new Error("Edit Action for Sticky Session not found for ".concat(a))}return Promise.resolve(n.getModel("sap.fe.i18n").getResourceBundle()).then(function(o){var a=t.getTranslatedText("C_COMMON_OBJECT_PAGE_EDIT",o);var s=r.bindContext("".concat(c,"(...)"),e,{$$inheritExpandSelect:true});var u="direct";var d=s.execute(u,undefined,i.fnOnStrictHandlingFailed.bind(l,u,{label:a,model:r},o,null,null,null,undefined));r.submitBatch(u);return Promise.resolve(d).then(function(e){var t=n.getSideEffectsService().getODataActionSideEffects(c,e);var r=function(){var r;if(t!==null&&t!==void 0&&(r=t.triggerActions)!==null&&r!==void 0&&r.length){return Promise.resolve(n.getSideEffectsService().requestSideEffectsForODataAction(t,e)).then(function(){})}}();return r&&r.then?r.then(function(){return e}):e})})}catch(e){return Promise.reject(e)}};var s=n.ProgrammingModel;function u(e){var t=e.getModel(),n=t.getMetaModel(),r=n.getMetaPath(e.getPath()),o=n.getObject("".concat(r,"@com.sap.vocabularies.Session.v1.StickySessionSupported/DiscardAction"));if(!o){throw new Error("Discard Action for Sticky Session not found for ".concat(r))}var i=t.bindContext("/".concat(o,"(...)"));var a=i.execute("direct").then(function(){return e});t.submitBatch("direct");return a}function d(t,n,i){var a=n.getModel("ui").getProperty("/isEditable"),c=o.getLibraryResourceBundle("sap.fe.templates"),u=c&&c.getText("T_COMMON_UTILS_NAVIGATION_AWAY_MSG"),d=c&&c.getText("T_COMMON_UTILS_NAVIGATION_AWAY_CONFIRM_BUTTON"),l=c&&c.getText("T_COMMON_UTILS_NAVIGATION_AWAY_CANCEL_BUTTON");if(i===s.Sticky&&a){return r.warning(u,{actions:[d,l],emphasizedAction:d,onClose:function(r){if(r===d){var o=n&&n.getModel("internal");e.info("Navigation confirmed.");if(o){o.setProperty("/sessionOn",false);o.setProperty("/stickySessionToken",undefined)}else{e.warning("Local UIModel couldn't be found.")}t()}else{e.info("Navigation rejected.")}}})}return t()}var l={editDocumentInStickySession:c,activateDocument:a,discardDocument:u,processDataLossConfirmation:d};return l},false);
//# sourceMappingURL=sticky.js.map