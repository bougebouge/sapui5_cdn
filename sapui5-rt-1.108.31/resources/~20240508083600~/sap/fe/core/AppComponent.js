/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/AppStateHandler","sap/fe/core/controllerextensions/routing/RouterProxy","sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/ModelHelper","sap/fe/core/library","sap/fe/core/support/Diagnostics","sap/fe/macros/internal/valuehelp/ValueListHelper","sap/ui/core/Core","sap/ui/core/UIComponent","sap/ui/model/json/JSONModel","./converters/MetaModelConverter","./helpers/SemanticDateOperators"],function(e,t,o,r,i,n,a,s,c,u,l,p,f){"use strict";var d,v,g;var C=p.deleteModelCacheData;var N=r.defineUI5Class;function R(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;A(e,t)}function A(e,t){A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,o){t.__proto__=o;return t};return A(e,t)}var S=n.StartupMode;var E={FCL:{VIEWNAME:"sap.fe.core.rootView.Fcl",VIEWNAME_COMPATIBILITY:"sap.fe.templates.RootContainer.view.Fcl",ROUTERCLASS:"sap.f.routing.Router"},NAVCONTAINER:{VIEWNAME:"sap.fe.core.rootView.NavContainer",VIEWNAME_COMPATIBILITY:"sap.fe.templates.RootContainer.view.NavContainer",ROUTERCLASS:"sap.m.routing.Router"}};var h=(d=N("sap.fe.core.AppComponent",{interfaces:["sap.ui.core.IAsyncContentCreation"],config:{fullWidth:true},manifest:{"sap.ui5":{services:{resourceModel:{factoryName:"sap.fe.core.services.ResourceModelService",startup:"waitFor",settings:{bundles:["sap.fe.core.messagebundle"],modelName:"sap.fe.i18n"}},routingService:{factoryName:"sap.fe.core.services.RoutingService",startup:"waitFor"},shellServices:{factoryName:"sap.fe.core.services.ShellServices",startup:"waitFor"},ShellUIService:{factoryName:"sap.ushell.ui5service.ShellUIService"},navigationService:{factoryName:"sap.fe.core.services.NavigationService",startup:"waitFor"},environmentCapabilities:{factoryName:"sap.fe.core.services.EnvironmentService",startup:"waitFor"},sideEffectsService:{factoryName:"sap.fe.core.services.SideEffectsService",startup:"waitFor"},asyncComponentService:{factoryName:"sap.fe.core.services.AsyncComponentService",startup:"waitFor"}},rootView:{viewName:E.NAVCONTAINER.VIEWNAME,type:"XML",async:true,id:"appRootView"},routing:{config:{controlId:"appContent",routerClass:E.NAVCONTAINER.ROUTERCLASS,viewType:"XML",controlAggregation:"pages",async:true,containerOptions:{propagateModel:true}}}}},designtime:"sap/fe/core/designtime/AppComponent.designtime",library:"sap.fe.core"}),d(v=(g=function(r){R(u,r);function u(){var e;for(var t=arguments.length,o=new Array(t),i=0;i<t;i++){o[i]=arguments[i]}e=r.call.apply(r,[this].concat(o))||this;e.startupMode=S.Normal;return e}var p=u.prototype;p._isFclEnabled=function e(){var t,o;var r=this.getManifestEntry("/sap.ui5");return(r===null||r===void 0?void 0:(t=r.rootView)===null||t===void 0?void 0:t.viewName)===E.FCL.VIEWNAME||(r===null||r===void 0?void 0:(o=r.rootView)===null||o===void 0?void 0:o.viewName)===E.FCL.VIEWNAME_COMPATIBILITY};p.getRouterProxy=function e(){return this._oRouterProxy};p.getAppStateHandler=function e(){return this._oAppStateHandler};p.getRootViewController=function e(){return this.getRootControl().getController()};p.getRootContainer=function e(){return this.getRootControl().getContent()[0]};p.getStartupMode=function e(){return this.startupMode};p.setStartupModeCreate=function e(){this.startupMode=S.Create};p.setStartupModeAutoCreate=function e(){this.startupMode=S.AutoCreate};p.setStartupModeDeeplink=function e(){this.startupMode=S.Deeplink};p.init=function s(){var c,p;var d=new l({editMode:n.EditMode.Display,isEditable:false,draftStatus:n.DraftStatus.Clear,busy:false,busyLocal:{},pages:{}});var v=new l({pages:{}});d.setDefaultBindingMode("OneWay");i.enhanceUiJSONModel(d,n);i.enhanceInternalJSONModel(v);this.setModel(d,"ui");this.setModel(v,"internal");this.bInitializeRouting=this.bInitializeRouting!==undefined?this.bInitializeRouting:true;this._oRouterProxy=new o;this._oAppStateHandler=new t(this);this._oDiagnostics=new a;var g=this.getModel();if(g!==null&&g!==void 0&&(c=g.isA)!==null&&c!==void 0&&c.call(g,"sap.ui.model.odata.v4.ODataModel")){this.entityContainer=g.getMetaModel().requestObject("/$EntityContainer/")}else{this.entityContainer=Promise.resolve()}var C=this.getManifest()["sap.ui5"];if(C!==null&&C!==void 0&&(p=C.rootView)!==null&&p!==void 0&&p.viewName){if(C.rootView.viewName===E.FCL.VIEWNAME_COMPATIBILITY){C.rootView.viewName=E.FCL.VIEWNAME}else if((C===null||C===void 0?void 0:C.rootView.viewName)===E.NAVCONTAINER.VIEWNAME_COMPATIBILITY){C.rootView.viewName=E.NAVCONTAINER.VIEWNAME}if(C.rootView.viewName===E.FCL.VIEWNAME&&C.routing.config.routerClass===E.FCL.ROUTERCLASS){e.info('Rootcontainer: "'.concat(E.FCL.VIEWNAME,'" - Routerclass: "').concat(E.FCL.ROUTERCLASS,'"'))}else if(C.rootView.viewName===E.NAVCONTAINER.VIEWNAME&&C.routing.config.routerClass===E.NAVCONTAINER.ROUTERCLASS){e.info('Rootcontainer: "'.concat(E.NAVCONTAINER.VIEWNAME,'" - Routerclass: "').concat(E.NAVCONTAINER.ROUTERCLASS,'"'))}else if(C.rootView.viewName.indexOf("sap.fe.core.rootView")!==-1){throw Error("\nWrong configuration for the couple (rootView/routerClass) in manifest file.\n"+"Current values are :(".concat(C.rootView.viewName,"/").concat(C.routing.config.routerClass,")\n")+"Expected values are \n"+"\t - (".concat(E.NAVCONTAINER.VIEWNAME,"/").concat(E.NAVCONTAINER.ROUTERCLASS,")\n")+"\t - (".concat(E.FCL.VIEWNAME,"/").concat(E.FCL.ROUTERCLASS,")"))}else{e.info('Rootcontainer: "'.concat(C.rootView.viewName,'" - Routerclass: "').concat(E.NAVCONTAINER.ROUTERCLASS,'"'))}}f.addSemanticDateOperators();r.prototype.init.call(this);u.instanceMap[this.getId()]=this};p.onServicesStarted=function t(){var o=this;var r=function(){o.entityContainer.then(function(){if(o.getRootViewController().attachRouteMatchers){o.getRootViewController().attachRouteMatchers()}o.getRouter().initialize();o.getRouterProxy().init(o,o._isFclEnabled())}).catch(function(e){var t=c.getLibraryResourceBundle("sap.fe.core");o.getRootViewController().displayMessagePage(t.getText("C_APP_COMPONENT_SAPFE_APPSTART_TECHNICAL_ISSUES"),{title:t.getText("C_COMMON_SAPFE_ERROR"),description:e.message,FCLLevel:0})})};if(this.bInitializeRouting){return this.getRoutingService().initializeRouting().then(function(){if(o.getRootViewController()){return r()}else{o.getRootControl().attachAfterInit(function(){r()})}}).catch(function(t){e.error("cannot cannot initialize routing: ".concat(t))})}};p.exit=function e(){this._oAppStateHandler.destroy();this._oRouterProxy.destroy();delete this._oAppStateHandler;delete this._oRouterProxy;C(this.getMetaModel());this.getModel("ui").destroy()};p.getMetaModel=function e(){return this.getModel().getMetaModel()};p.getDiagnostics=function e(){return this._oDiagnostics};p.destroy=function t(){var o,i;try{s.initializeCachedValueHelp();delete u.instanceMap[this.getId()];delete window._routing}catch(t){e.info(t)}var n=this.oModels[undefined];var a;if(n.oRequestor){a=jQuery.extend({},n.oRequestor.mHeaders)}(o=this.getRoutingService())===null||o===void 0?void 0:o.beforeExit();for(var c=arguments.length,l=new Array(c),p=0;p<c;p++){l[p]=arguments[p]}(i=r.prototype.destroy).call.apply(i,[this].concat(l));if(a&&n.oRequestor){n.oRequestor.mHeaders=a}};p.getComponentData=function e(){return r.prototype.getComponentData.call(this)};p.getRoutingService=function e(){return{}};p.getShellServices=function e(){return{}};p.getNavigationService=function e(){return{}};p.getSideEffectsService=function e(){return{}};p.getEnvironmentCapabilities=function e(){return{}};p.getStartupParameters=function e(){var t=this.getComponentData();var o=t&&t.startupParameters||{};return Promise.resolve(o)};p.restore=function e(){this.getRootViewController().viewState.onRestore()};p.suspend=function e(){this.getRootViewController().viewState.onSuspend()};return u}(u),g.instanceMap={},g))||v);return h},false);
//# sourceMappingURL=AppComponent.js.map