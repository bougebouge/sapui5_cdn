/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/helpers/IssueManager","sap/fe/macros/CommonHelper","../../ManifestSettings","./Chart","./Table"],function(t,a,e,n,i){"use strict";var o={};var r=n.createChartVisualization;var s=e.TemplateType;var l=t.IssueType;var u=t.IssueSeverity;var v=t.IssueCategory;var c=function(t,a,e){var n=[];var i=e.getManifestWrapper().hasMultipleVisualizations()||e.getTemplateType()===s.AnalyticalListPage;var o=a.split("@")[0];if(!m(t,i)){var r=e.getEntityType();var l=p(r);if(l){n.push({visualization:l,annotationPath:"".concat(o).concat(e.getRelativeAnnotationPath(l.fullyQualifiedName,r)),converterContext:e})}}else{var u=t.Visualizations;var v=function(t){var a=u.find(function(a){return t.indexOf(a.$target.term)>=0});if(a){n.push({visualization:a.$target,annotationPath:"".concat(o).concat(a.value),converterContext:e})}};if(i){v(["com.sap.vocabularies.UI.v1.LineItem"]);v(["com.sap.vocabularies.UI.v1.Chart"])}else{v(["com.sap.vocabularies.UI.v1.LineItem","com.sap.vocabularies.UI.v1.Chart"])}}return n};o.getVisualizationsFromPresentationVariant=c;function f(t,a,e){if(a){var n=e.getEntityTypeAnnotation(a);var i=n.annotation;if(i){if(i.term==="com.sap.vocabularies.UI.v1.SelectionPresentationVariant"){return i}}else{throw new Error("Annotation Path for the SPV mentioned in the manifest is not found, Please add the SPV in the annotation")}}else{var o,r;return(o=t.annotations)===null||o===void 0?void 0:(r=o.UI)===null||r===void 0?void 0:r.SelectionPresentationVariant}}o.getSelectionPresentationVariant=f;function d(t,a){var e=t&&t.PresentationVariant;if(e){return m(e,a)}else{throw new Error("Presentation Variant is not present in the SPV annotation")}}o.isSelectionPresentationCompliant=d;function m(t){var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var e=false,n=false;if(a){if(t!==null&&t!==void 0&&t.Visualizations){var i=t.Visualizations;i.forEach(function(t){if(t.$target.term==="com.sap.vocabularies.UI.v1.LineItem"){e=true}if(t.$target.term==="com.sap.vocabularies.UI.v1.Chart"){n=true}})}return n&&e}else{return(t===null||t===void 0?void 0:t.Visualizations)&&!!t.Visualizations.find(function(t){return t.$target.term==="com.sap.vocabularies.UI.v1.LineItem"||t.$target.term==="com.sap.vocabularies.UI.v1.Chart"})}}o.isPresentationCompliant=m;function p(t){var a;return(a=t.annotations.UI)===null||a===void 0?void 0:a.LineItem}o.getDefaultLineItem=p;function h(t){var a;return(a=t.annotations.UI)===null||a===void 0?void 0:a.Chart}o.getDefaultChart=h;function g(t){var a,e;return(a=t.annotations)===null||a===void 0?void 0:(e=a.UI)===null||e===void 0?void 0:e.PresentationVariant}o.getDefaultPresentationVariant=g;function I(t){var a,e;return(a=t.annotations)===null||a===void 0?void 0:(e=a.UI)===null||e===void 0?void 0:e.SelectionVariant}o.getDefaultSelectionVariant=I;function P(t,a){var e=a.getManifestWrapper().getDefaultTemplateAnnotationPath();var n=f(t,e,a);var i;if(n){i=n.SelectionVariant;if(i){return i}}else{i=I(t);return i}}o.getSelectionVariant=P;function V(t,a,e,n,o,s){var f=t!==""?e.getEntityTypeAnnotation(t):{annotation:undefined,converterContext:e};var d=s?e.getEntityTypeAnnotation(s):null;var m=f.annotation;e=f.converterContext;var p=[];var h;var g="";var I,P;var V=m===null||m===void 0?void 0:m.term;if(V){switch(V){case"com.sap.vocabularies.UI.v1.LineItem":case"com.sap.vocabularies.UI.v1.Chart":h=d===null||d===void 0?void 0:d.annotation;p.push({visualization:m,annotationPath:t,converterContext:e});break;case"com.sap.vocabularies.UI.v1.PresentationVariant":h=m;p=p.concat(c(m,t,e));break;case"com.sap.vocabularies.UI.v1.SelectionPresentationVariant":h=m.PresentationVariant;g=h.fullyQualifiedName;p=p.concat(c(h,t,e));break;default:break}p.forEach(function(t){var e=t.visualization,s=t.annotationPath,l=t.converterContext;switch(e.term){case"com.sap.vocabularies.UI.v1.Chart":I=r(e,s,l,o);break;case"com.sap.vocabularies.UI.v1.LineItem":default:P=i.createTableVisualization(e,s,l,h,a,n);break}})}else{P=i.createDefaultTableVisualization(e);e.getDiagnostics().addIssue(v.Annotation,u.Medium,l.MISSING_LINEITEM)}var b=[];var C=V==="com.sap.vocabularies.UI.v1.SelectionPresentationVariant"?g:m&&m.fullyQualifiedName;if(C===undefined){C="/"}if(I){b.push(I)}if(P){b.push(P)}return{visualizations:b,annotationPath:e.getEntitySetBasedAnnotationPath(C)}}o.getDataVisualizationConfiguration=V;function b(t,e){var n=t.getObject(t.getPath()),i=a.createPresentationPathContext(t),o=t.getModel();if(a._isPresentationVariantAnnotation(i.getPath())){var r=n.Visualizations;if(Array.isArray(r)){for(var s=0;s<r.length;s++){if(r[s].$AnnotationPath.indexOf(e)!==-1){e=r[s].$AnnotationPath;break}}}return o.getMetaContext(t.getPath().split("@")[0]+e)}return t}o.getUiControl=b;return o},false);
//# sourceMappingURL=DataVisualization.js.map