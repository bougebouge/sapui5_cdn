/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/annotations/DataField","sap/fe/core/converters/controls/Common/Action","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/Key","sap/fe/core/templating/DataModelPathHelper","sap/ui/core/Core","../../helpers/Aggregation","../../helpers/ID","../../ManifestSettings"],function(e,t,r,n,a,o,i,l,u){"use strict";var v={};var s=u.VisualizationType;var d=u.TemplateType;var f=u.ActionType;var g=l.getFilterBarID;var c=l.getChartID;var p=i.AggregationHelper;var y=a.getTargetObjectPath;var m=n.KeyHelper;var h=r.insertCustomElements;var b=t.getActionsFromManifest;var A=e.isDataFieldForActionAbstract;function P(e,t){return C(e)||S(e,t)||O(e,t)||T()}function T(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function S(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,l=[],u=!0,v=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0){}}catch(e){v=!0,a=e}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(v)throw a}}return l}}function C(e){if(Array.isArray(e))return e}function I(e,t){var r=typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=O(e))||t&&e&&typeof e.length==="number"){if(r)e=r;var n=0;var a=function(){};return{s:a,n:function(){if(n>=e.length)return{done:true};return{done:false,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o=true,i=false,l;return{s:function(){r=r.call(e)},n:function(){var e=r.next();o=e.done;return e},e:function(e){i=true;l=e},f:function(){try{if(!o&&r.return!=null)r.return()}finally{if(i)throw l}}}}function O(e,t){if(!e)return;if(typeof e==="string")return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w(e,t)}function w(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,n=new Array(t);r<t;r++){n[r]=e[r]}return n}function D(e,t,r){var n=[];if(e){var a=e.Actions||[];a.forEach(function(e){var t,a,o,i;var l;if(A(e)&&!(((t=e.annotations)===null||t===void 0?void 0:(a=t.UI)===null||a===void 0?void 0:(o=a.Hidden)===null||o===void 0?void 0:o.valueOf())===true)&&!e.Inline&&!e.Determining&&!(e!==null&&e!==void 0&&(i=e.ActionTarget)!==null&&i!==void 0&&i.isBound)){var u=m.generateKeyFromDataField(e);switch(e.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForAction":l={type:f.DataFieldForAction,annotationPath:r.getEntitySetBasedAnnotationPath(e.fullyQualifiedName),key:u};break;case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":l={type:f.DataFieldForIntentBasedNavigation,annotationPath:r.getEntitySetBasedAnnotationPath(e.fullyQualifiedName),key:u};break}}if(l){n.push(l)}})}return n}function E(e,t,r){var n=D(e,t,r);var a=b(r.getManifestControlConfiguration(t).actions,r,n);var o=h(n,a.actions,{enableOnSelect:"overwrite",enabled:"overwrite",visible:"overwrite",command:"overwrite"});return{actions:o,commandActions:a.commandActions}}v.getChartActions=E;function F(e,t){var r;var n=t.getManifestWrapper();var a=t.getManifestControlConfiguration(e);var o=["Page","Control"].indexOf(n.getVariantManagement())>-1;var i=true;var l=[];if((a===null||a===void 0?void 0:(r=a.chartSettings)===null||r===void 0?void 0:r.personalization)!==undefined){i=a.chartSettings.personalization}if(o&&i){if(i===true){return"Sort,Type,Item"}else if(typeof i==="object"){if(i.type){l.push("Type")}if(i.item){l.push("Item")}if(i.sort){l.push("Sort")}return l.join(",")}}return undefined}v.getP13nMode=F;function M(e,t,r,n){var a,i,l;var u=new p(r.getEntityType(),r);if(!n&&!u.isAnalyticsSupported()){throw new Error("ApplySupported is not added to the annotations")}var v=u.getTransAggregations();var f=u.getCustomAggregateDefinitions();var m={};if(f){var h=u.getEntityType();var b=I(f),A;try{var T=function(){var e,t,r,n,a;var o=A.value;var i=o===null||o===void 0?void 0:(e=o.annotations)===null||e===void 0?void 0:(t=e.Aggregation)===null||t===void 0?void 0:t.ContextDefiningProperties;var l=o===null||o===void 0?void 0:o.qualifier;var u=l&&h.entityProperties.find(function(e){return e.name===l});var v=u&&(u===null||u===void 0?void 0:(r=u.annotations)===null||r===void 0?void 0:(n=r.Common)===null||n===void 0?void 0:(a=n.Label)===null||a===void 0?void 0:a.toString());m[l]={name:l,label:v||"Custom Aggregate (".concat(l,")"),sortable:true,sortOrder:"both",contextDefiningProperty:i?i.map(function(e){return e.value}):[]}};for(b.s();!(A=b.n()).done;){T()}}catch(e){b.e(e)}finally{b.f()}}var S={};var C=o.getLibraryResourceBundle("sap.fe.core");if(v){for(var O=0;O<v.length;O++){var w,D,M,j,N,B;S[v[O].Name]={name:v[O].Name,propertyPath:v[O].AggregatableProperty.valueOf().value,aggregationMethod:v[O].AggregationMethod,label:(w=v[O])!==null&&w!==void 0&&(D=w.annotations)!==null&&D!==void 0&&(M=D.Common)!==null&&M!==void 0&&M.Label?(j=v[O])===null||j===void 0?void 0:(N=j.annotations)===null||N===void 0?void 0:(B=N.Common)===null||B===void 0?void 0:B.Label.toString():"".concat(C.getText("AGGREGATABLE_PROPERTY")," (").concat(v[O].Name,")"),sortable:true,sortOrder:"both",custom:false}}}var x=u.getAggregatableProperties();var L=u.getGroupableProperties();var $={};$.$Type="Org.OData.Aggregation.V1.ApplySupportedType";$.AggregatableProperties=[];$.GroupableProperties=[];for(var z=0;x&&z<x.length;z++){var G,V,H;var R={$Type:(G=x[z])===null||G===void 0?void 0:G.$Type,Property:{$PropertyPath:(V=x[z])===null||V===void 0?void 0:(H=V.Property)===null||H===void 0?void 0:H.value}};$.AggregatableProperties.push(R)}for(var U=0;L&&U<L.length;U++){var k;var Q={$PropertyPath:(k=L[U])===null||k===void 0?void 0:k.value};$.GroupableProperties.push(Q)}var K=E(e,t,r);var W=t.split("@"),q=P(W,1),J=q[0];if(J.lastIndexOf("/")===J.length-1){J=J.substr(0,J.length-1)}var Y=(a=r.getEntityType().annotations)===null||a===void 0?void 0:(i=a.UI)===null||i===void 0?void 0:(l=i.HeaderInfo)===null||l===void 0?void 0:l.TypeNamePlural;var _=r.getDataModelObjectPath();var X=J.length===0;var Z=_.targetEntitySet?_.targetEntitySet.name:_.startingEntitySet.name;var ee=X?g(r.getContextPath()):undefined;var te={legendGroup:{layout:{position:"bottom"}}};var re;if(r.getTemplateType()===d.ObjectPage){re=true}else if(r.getTemplateType()===d.ListReport||r.getTemplateType()===d.AnalyticalListPage){re=false}var ne=r.getManifestWrapper().hasMultipleVisualizations()||r.getTemplateType()==="AnalyticalListPage";var ae=ne?".handlers.onSegmentedButtonPressed":"";var oe=ne?"{= ${pageInternal>alpContentView} !== 'Table'}":"true";var ie=u.getAllowedTransformations();$.enableSearch=ie?ie.indexOf("search")>=0:true;var le="";if(e.fullyQualifiedName.split("#").length>1){le=e.fullyQualifiedName.split("#")[1]}return{type:s.Chart,id:le?c(X?Z:J,le,s.Chart):c(X?Z:J,s.Chart),collection:y(r.getDataModelObjectPath()),entityName:Z,personalization:F(t,r),navigationPath:J,annotationPath:r.getAbsoluteAnnotationPath(t),filterId:ee,vizProperties:JSON.stringify(te),actions:K.actions,commandActions:K.commandActions,title:Y,autoBindOnInit:re,onSegmentedButtonPressed:ae,visible:oe,customAgg:m,transAgg:S,applySupported:$}}v.createChartVisualization=M;return v},false);
//# sourceMappingURL=Chart.js.map