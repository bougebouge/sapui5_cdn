/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/annotations/DataField","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/ID","sap/fe/core/converters/helpers/Key","sap/fe/core/helpers/BindingToolkit","../../../helpers/StableIdHelper","../../helpers/DataFieldHelper","../Common/Form"],function(e,t,a,i,n,o,r,l){"use strict";var v={};var d=l.getFormElementsFromManifest;var u=l.FormElementType;var c=r.isReferencePropertyStaticallyHidden;var s=r.isAnnotationFieldStaticallyHidden;var f=o.generate;var p=n.not;var b=n.getExpressionFromAnnotation;var g=n.equal;var m=n.compileExpression;var y=i.KeyHelper;var F=a.getHeaderFacetID;var I=a.getHeaderFacetFormID;var h=a.getHeaderFacetContainerID;var T=a.getCustomHeaderFacetID;var P=t.Placement;var U=t.insertCustomElements;var D=e.getSemanticObjectPath;function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,i)}return a}function $(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach(function(t){C(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function C(e,t,a){t=A(t);if(t in e){Object.defineProperty(e,t,{value:a,enumerable:true,configurable:true,writable:true})}else{e[t]=a}return e}function A(e){var t=S(e,"string");return typeof t==="symbol"?t:String(t)}function S(e,t){if(typeof e!=="object"||e===null)return e;var a=e[Symbol.toPrimitive];if(a!==undefined){var i=a.call(e,t||"default");if(typeof i!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var H;(function(e){e["Annotation"]="Annotation";e["XMLFragment"]="XMLFragment"})(H||(H={}));v.HeaderFacetType=H;var j;(function(e){e["Reference"]="Reference";e["Collection"]="Collection"})(j||(j={}));v.FacetType=j;var E;(function(e){e["Default"]="Default";e["NotAdaptable"]="not-adaptable";e["NotAdaptableTree"]="not-adaptable-tree";e["NotAdaptableVisibility"]="not-adaptable-visibility"})(E||(E={}));v.FlexDesignTimeType=E;var N;(function(e){e["ProgressIndicator"]="ProgressIndicator";e["RatingIndicator"]="RatingIndicator";e["Content"]="Content"})(N||(N={}));var R;(function(e){e["None"]="None";e["DataPoint"]="DataPoint";e["Chart"]="Chart";e["Identification"]="Identification";e["Contact"]="Contact";e["Address"]="Address";e["FieldGroup"]="FieldGroup"})(R||(R={}));function k(e){var t,a,i;var n=[];(t=e.getEntityType().annotations)===null||t===void 0?void 0:(a=t.UI)===null||a===void 0?void 0:(i=a.HeaderFacets)===null||i===void 0?void 0:i.forEach(function(t){var a=z(t,e);if(a){n.push(a)}});return n}v.getHeaderFacetsFromAnnotations=k;function w(e){var t={};Object.keys(e).forEach(function(a){var i=e[a];t[a]=q(i,a)});return t}v.getHeaderFacetsFromManifest=w;function x(e,t,a){var i;if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&t.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){return false}var n=f([{Facet:e}]);var o=a.getManifestWrapper().getHeaderFacets();var r=(i=o[n])===null||i===void 0?void 0:i.stashed;return r===true}v.getStashedSettingsForHeaderFacet=x;function L(e,t,a){var i=E.Default;var n=f([{Facet:e}]);if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&t.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){i=E.NotAdaptableTree}else{var o=a.getManifestWrapper().getHeaderFacets();if(n){var r,l;var v=(r=o[n])===null||r===void 0?void 0:(l=r.flexSettings)===null||l===void 0?void 0:l.designtime;switch(v){case E.NotAdaptable:case E.NotAdaptableTree:case E.NotAdaptableVisibility:i=v;break;default:break}}}return i}v.getDesignTimeMetadataSettingsForHeaderFacet=L;function V(e,t,a){var i,n,o;if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&!(((i=e.annotations)===null||i===void 0?void 0:(n=i.UI)===null||n===void 0?void 0:(o=n.Hidden)===null||o===void 0?void 0:o.valueOf())===true)){var r,l;var v=F({Facet:e}),d=function(e,t){var a,i;return((a=e.ID)===null||a===void 0?void 0:a.toString())||((i=e.Label)===null||i===void 0?void 0:i.toString())||t},u=e.Target.value,c=B(e);var f;var y;switch(c){case R.FieldGroup:f=G(e,a);break;case R.DataPoint:y=Q(e,a);break;default:break}var I=e.annotations;if(((r=e.Target)===null||r===void 0?void 0:(l=r.$target)===null||l===void 0?void 0:l.term)==="com.sap.vocabularies.UI.v1.Chart"&&s(e)){return undefined}else{var T,P;return{type:H.Annotation,facetType:j.Reference,id:v,containerId:h({Facet:e}),key:d(e,v),flexSettings:{designtime:L(e,t,a)},stashed:x(e,t,a),visible:m(p(g(b(I===null||I===void 0?void 0:(T=I.UI)===null||T===void 0?void 0:(P=T.Hidden)===null||P===void 0?void 0:P.valueOf()),true))),annotationPath:"".concat(a.getEntitySetBasedAnnotationPath(e.fullyQualifiedName),"/"),targetAnnotationValue:u,targetAnnotationType:c,headerFormData:f,headerDataPointData:y}}}return undefined}function M(e,t){if(e.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){var a,i,n;var o=[],r=F({Facet:e}),l=function(e,t){var a,i;return((a=e.ID)===null||a===void 0?void 0:a.toString())||((i=e.Label)===null||i===void 0?void 0:i.toString())||t};e.Facets.forEach(function(a){var i=V(a,e,t);if(i){o.push(i)}});return{type:H.Annotation,facetType:j.Collection,id:r,containerId:h({Facet:e}),key:l(e,r),flexSettings:{designtime:L(e,e,t)},stashed:x(e,e,t),visible:m(p(g(b((a=e.annotations)===null||a===void 0?void 0:(i=a.UI)===null||i===void 0?void 0:(n=i.Hidden)===null||n===void 0?void 0:n.valueOf()),true))),annotationPath:"".concat(t.getEntitySetBasedAnnotationPath(e.fullyQualifiedName),"/"),facets:o}}return undefined}function B(e){var t=R.None;var a={"com.sap.vocabularies.UI.v1.DataPoint":R.DataPoint,"com.sap.vocabularies.UI.v1.Chart":R.Chart,"com.sap.vocabularies.UI.v1.Identification":R.Identification,"com.sap.vocabularies.Communication.v1.Contact":R.Contact,"com.sap.vocabularies.Communication.v1.Address":R.Address,"com.sap.vocabularies.UI.v1.FieldGroup":R.FieldGroup};if(e.$Type!=="com.sap.vocabularies.UI.v1.ReferenceURLFacet"&&e.$Type!=="com.sap.vocabularies.UI.v1.CollectionFacet"){var i,n;t=a[(i=e.Target)===null||i===void 0?void 0:(n=i.$target)===null||n===void 0?void 0:n.term]||R.None}return t}function G(e,t){var a;if(!e){throw new Error("Cannot get FieldGroup form data without facet definition")}var i=U(W(e,t),d(e,t));return{id:I({Facet:e}),label:(a=e.Label)===null||a===void 0?void 0:a.toString(),formElements:i}}function W(e,t){var a=[];if(e.$Type!=="com.sap.vocabularies.UI.v1.ReferenceURLFacet"&&e.$Type!=="com.sap.vocabularies.UI.v1.CollectionFacet"){var i,n;(i=e.Target)===null||i===void 0?void 0:(n=i.$target)===null||n===void 0?void 0:n.Data.forEach(function(i){var n,o,r;if(!(((n=i.annotations)===null||n===void 0?void 0:(o=n.UI)===null||o===void 0?void 0:(r=o.Hidden)===null||r===void 0?void 0:r.valueOf())===true)){var l=D(t,i);if((i.$Type==="com.sap.vocabularies.UI.v1.DataField"||i.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"||i.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath"||i.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation"||i.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithAction")&&!c(i)){var v,d,s,f,F,h,T,P,U,O,$;var C=i.annotations;a.push({isValueMultilineText:((v=i.Value)===null||v===void 0?void 0:(d=v.$target)===null||d===void 0?void 0:(s=d.annotations)===null||s===void 0?void 0:(f=s.UI)===null||f===void 0?void 0:(F=f.MultiLineText)===null||F===void 0?void 0:F.valueOf())===true,type:u.Annotation,key:y.generateKeyFromDataField(i),visible:m(p(g(b(C===null||C===void 0?void 0:(h=C.UI)===null||h===void 0?void 0:(T=h.Hidden)===null||T===void 0?void 0:T.valueOf()),true))),label:((P=i.Value)===null||P===void 0?void 0:(U=P.$target)===null||U===void 0?void 0:(O=U.annotations)===null||O===void 0?void 0:($=O.Common)===null||$===void 0?void 0:$.Label)||i.Label,idPrefix:I({Facet:e},i),annotationPath:"".concat(t.getEntitySetBasedAnnotationPath(i.fullyQualifiedName),"/"),semanticObjectPath:l})}else if(i.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&!c(i)){var A,S,H,j,E,N,R,k,w,x,L,V,M;var B=i.annotations;a.push({isValueMultilineText:((A=i.Target)===null||A===void 0?void 0:(S=A.$target)===null||S===void 0?void 0:(H=S.annotations)===null||H===void 0?void 0:(j=H.UI)===null||j===void 0?void 0:(E=j.MultiLineText)===null||E===void 0?void 0:E.valueOf())===true,type:u.Annotation,key:y.generateKeyFromDataField(i),visible:m(p(g(b(B===null||B===void 0?void 0:(N=B.UI)===null||N===void 0?void 0:(R=N.Hidden)===null||R===void 0?void 0:R.valueOf()),true))),label:((k=i.Target)===null||k===void 0?void 0:(w=k.$target)===null||w===void 0?void 0:(x=w.annotations)===null||x===void 0?void 0:(L=x.Common)===null||L===void 0?void 0:(V=L.Label)===null||V===void 0?void 0:V.toString())||((M=i.Label)===null||M===void 0?void 0:M.toString()),idPrefix:I({Facet:e},i),annotationPath:"".concat(t.getEntitySetBasedAnnotationPath(i.fullyQualifiedName),"/"),semanticObjectPath:l})}}})}return a}function Q(e,t){var a=N.Content;var i;if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&!s(e)){var n,o,r,l,v;if(((n=e.Target)===null||n===void 0?void 0:(o=n.$target)===null||o===void 0?void 0:o.Visualization)==="UI.VisualizationType/Progress"){a=N.ProgressIndicator}else if(((r=e.Target)===null||r===void 0?void 0:(l=r.$target)===null||l===void 0?void 0:l.Visualization)==="UI.VisualizationType/Rating"){a=N.RatingIndicator}var d=(v=e.Target)===null||v===void 0?void 0:v.$target;if(typeof d==="object"){var u;if(d!==null&&d!==void 0&&(u=d.Value)!==null&&u!==void 0&&u.$target){var c,f;var p=d.Value.$target;if((p===null||p===void 0?void 0:(c=p.annotations)===null||c===void 0?void 0:(f=c.Common)===null||f===void 0?void 0:f.SemanticObject)!==undefined){i=t.getEntitySetBasedAnnotationPath(p===null||p===void 0?void 0:p.fullyQualifiedName)}}}}return{type:a,semanticObjectPath:i}}function z(e,t){var a;switch(e.$Type){case"com.sap.vocabularies.UI.v1.ReferenceFacet":a=V(e,e,t);break;case"com.sap.vocabularies.UI.v1.CollectionFacet":a=M(e,t);break;default:break}return a}function K(e){if(!e){return undefined}var t=["Heroes","Decoration","Workers","LongRunners"].indexOf(e)!==-1?"$auto.".concat(e):e;return"{ path : '', parameters : { $$groupId : '".concat(t,"' } }")}function q(e,t){var a=T(t);var i=e.position;if(!i){i={placement:P.After}}return{facetType:j.Reference,facets:[],type:e.type,id:a,containerId:a,key:t,position:i,visible:e.visible,fragmentName:e.template||e.name,title:e.title,subTitle:e.subTitle,stashed:e.stashed||false,flexSettings:$($({},{designtime:E.Default}),e.flexSettings),binding:K(e.requestGroupId),templateEdit:e.templateEdit}}return v},false);
//# sourceMappingURL=HeaderFacet.js.map