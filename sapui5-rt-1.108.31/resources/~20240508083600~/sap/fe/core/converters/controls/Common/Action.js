/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/ID","sap/fe/core/converters/ManifestSettings","sap/fe/core/formatters/FPMFormatter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/StableIdHelper"],function(e,n,t,r,i,o,a){"use strict";var l={};var u=a.replaceSpecialChars;var c=o.resolveBindingString;var f=o.pathInModel;var v=o.or;var d=o.isConstant;var s=o.ifElse;var p=o.greaterOrEqual;var b=o.getExpressionFromAnnotation;var y=o.formatResult;var m=o.equal;var g=o.compileExpression;var h=o.and;var A=r.ActionType;var S=t.getCustomActionID;var O=n.Placement;var j=e.bindingContextPathVisitor;function E(e){return k(e)||w(e)||I(e)||P()}function P(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function w(e){if(typeof Symbol!=="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function k(e){if(Array.isArray(e))return B(e)}function x(e,n){var t=typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=I(e))||n&&e&&typeof e.length==="number"){if(t)e=t;var r=0;var i=function(){};return{s:i,n:function(){if(r>=e.length)return{done:true};return{done:false,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o=true,a=false,l;return{s:function(){t=t.call(e)},n:function(){var e=t.next();o=e.done;return e},e:function(e){a=true;l=e},f:function(){try{if(!o&&t.return!=null)t.return()}finally{if(a)throw l}}}}function I(e,n){if(!e)return;if(typeof e==="string")return B(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor)t=e.constructor.name;if(t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return B(e,n)}function B(e,n){if(n==null||n>e.length)n=e.length;for(var t=0,r=new Array(n);t<n;t++){r[t]=e[t]}return r}function M(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function C(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?M(Object(t),!0).forEach(function(n){D(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):M(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function D(e,n,t){n=N(n);if(n in e){Object.defineProperty(e,n,{value:t,enumerable:true,configurable:true,writable:true})}else{e[n]=t}return e}function N(e){var n=F(e,"string");return typeof n==="symbol"?n:String(n)}function F(e,n){if(typeof e!=="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==undefined){var r=t.call(e,n||"default");if(typeof r!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var T;(function(e){e["Accept"]="Accept";e["Attention"]="Attention";e["Back"]="Back";e["Critical"]="Critical";e["Default"]="Default";e["Emphasized"]="Emphasized";e["Ghost"]="Ghost";e["Negative"]="Negative";e["Neutral"]="Neutral";e["Reject"]="Reject";e["Success"]="Success";e["Transparent"]="Transparent";e["Unstyled"]="Unstyled";e["Up"]="Up"})(T||(T={}));l.ButtonType=T;function q(e,n,t,r){var i=n.find(function(e){return e.key===r});var o=e[r];var a=C({},i!==null&&i!==void 0?i:o);if(i){var l,u;a.enabled=(l=o===null||o===void 0?void 0:o.enabled)!==null&&l!==void 0?l:i.enabled;a.visible=(u=o===null||o===void 0?void 0:o.visible)!==null&&u!==void 0?u:i.visible;for(var c in o||{}){if(!i[c]&&c!=="menu"){a[c]=o[c]}}}var f=((a===null||a===void 0?void 0:a.visible)||(a===null||a===void 0?void 0:a.type)===A.DataFieldForAction||(a===null||a===void 0?void 0:a.type)===A.DataFieldForIntentBasedNavigation)&&!t.find(function(e){return e.key===(a===null||a===void 0?void 0:a.key)});return{action:a,canBeMenuItem:f}}function U(e,n,t,r,i){var o=q(n,t,i,e.defaultAction),a=o.action,l=o.canBeMenuItem;if(l){e.defaultAction=a}if(a.command){r[a.key]=a}}function _(e,n,t,r,i){var o;var a=[];var l=x((o=e.menu)!==null&&o!==void 0?o:[]),u;try{for(l.s();!(u=l.n()).done;){var f=u.value;var d=q(n,t,i,f),s=d.action,p=d.canBeMenuItem;if(p){a.push(s)}if(s.command){r[f]=s}}}catch(e){l.e(e)}finally{l.f()}e.menu=a;var b=a.map(function(e){return c(e.visible,"boolean")});e.visible=g(h(c(e.visible,"boolean"),v.apply(void 0,E(b))))}function L(e,n,t){var r={};var i=[];var o={};for(var a in e){var l=e[a];if(l.defaultAction!==undefined){U(l,e,n,o,t)}if(l.type===A.Menu){var u;i.push.apply(i,E(l.menu));_(l,e,n,o,t);if(!((u=l.menu)!==null&&u!==void 0&&u.length)){i.push(l.key)}}if(l.command){o[a]=l}r[a]=l}i.forEach(function(e){return delete r[e]});return{actions:r,commandActions:o}}var R=function(e,n,t){if(n&&e.enabled===undefined){return undefined}var r=H(e.enabled,t);return g(s(e.requiresSelection===true,h(p(f("numberOfSelectedContexts","internal"),1),r),r))};var V=function(e,n,t){if(n&&e.visible===undefined){return undefined}var r=H(e.visible,t);return g(r)};function $(e,n){var t,r;if(!n){return}e.type=n.type;e.annotationPath=n.annotationPath;e.press=n.press;e.enabled=(t=e.enabled)!==null&&t!==void 0?t:n.enabled;e.visible=(r=e.visible)!==null&&r!==void 0?r:n.visible}function z(e,n){if(n!==null&&n!==void 0&&n.find(function(n){return n.key===e.key})){e.visible="false"}}function G(e,n,t,r,i,o,a){var l={};var c=function(c){var f,v,d;var s=e[c];var p=((f=s.press)===null||f===void 0?void 0:f.lastIndexOf("."))||-1;var b=t===null||t===void 0?void 0:t.find(function(e){return e.key===c});var y=!!b;if(s.facetName){a=s.facetName}l[c]={id:b?c:S(c),type:s.menu?A.Menu:A.Default,visible:V(s,y,n),enabled:R(s,y,n),handlerModule:s.press&&s.press.substring(0,p).replace(/\./gi,"/"),handlerMethod:s.press&&s.press.substring(p+1),press:s.press,text:s.text,noWrap:s.__noWrap,key:u(c),enableOnSelect:s.enableOnSelect,defaultValuesExtensionFunction:s.defaultValuesFunction,position:{anchor:(v=s.position)===null||v===void 0?void 0:v.anchor,placement:s.position===undefined?O.After:s.position.placement},isNavigable:K(s,r,i),command:s.command,requiresSelection:s.requiresSelection===undefined?false:s.requiresSelection,enableAutoScroll:X(s),menu:(d=s.menu)!==null&&d!==void 0?d:[],facetName:s.inline?a:undefined,defaultAction:s.defaultAction};$(l[c],b);z(l[c],o)};for(var f in e){c(f)}return L(l,t!==null&&t!==void 0?t:[],o!==null&&o!==void 0?o:[])}l.getActionsFromManifest=G;function H(e,n){var t=c(e,"boolean");var r;if(d(t)&&t.value===undefined){r=true}else if(d(t)&&typeof t.value==="boolean"){r=t.value}else if(t._type!=="EmbeddedBinding"&&t._type!=="EmbeddedExpressionBinding"){var o;var a=t.value;r=y([f("/","$view"),a,f("selectedContexts","internal")],i.customBooleanPropertyCheck,((o=n.getDataModelObjectPath().contextLocation)===null||o===void 0?void 0:o.targetEntityType)||n.getEntityType())}else{r=t}return r}var W=function(e){var n={};e.forEach(function(e){var t;if(e!==null&&e!==void 0&&(t=e.menu)!==null&&t!==void 0&&t.length){n=e.menu.reduce(function(e,n){var t=n.key;if(t&&!e[t]){e[t]=true}return e},n)}});return e.filter(function(e){return!n[e.key]})};l.removeDuplicateActions=W;function Q(e,n){var t;if((n===null||n===void 0?void 0:n.isBound)!==true){return"true"}if(n!==null&&n!==void 0&&(t=n.parameters)!==null&&t!==void 0&&t.length){var r,i;var o=n===null||n===void 0?void 0:n.parameters[0].fullyQualifiedName,a=b(n===null||n===void 0?void 0:(r=n.annotations.Core)===null||r===void 0?void 0:r.OperationAvailable,[],undefined,function(n){return j(n,e,o)});if((n===null||n===void 0?void 0:(i=n.annotations.Core)===null||i===void 0?void 0:i.OperationAvailable)!==undefined){return g(m(a,true))}}return"true"}l.getEnabledForAnnotationAction=Q;function J(e){var n=[];e.forEach(function(e){var t={LocalProperty:{$PropertyPath:e.LocalProperty.value},SemanticObjectProperty:e.SemanticObjectProperty};n.push(t)});return n}l.getSemanticObjectMapping=J;function K(e,n,t){var r,i;var o=true;if(t){var a=n&&(n.detail||n.display);o=a!==null&&a!==void 0&&a.route?true:false}if(e&&e.afterExecution&&(((r=e.afterExecution)===null||r===void 0?void 0:r.navigateToInstance)===false||((i=e.afterExecution)===null||i===void 0?void 0:i.enableAutoScroll)===true)||!o){return false}return true}l.isActionNavigable=K;function X(e){var n;return(e===null||e===void 0?void 0:(n=e.afterExecution)===null||n===void 0?void 0:n.enableAutoScroll)===true}l.enableAutoScroll=X;return l},false);
//# sourceMappingURL=Action.js.map