/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/annotations/DataField","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ModelHelper","sap/fe/core/templating/DataModelPathHelper","../../../helpers/StableIdHelper","../../helpers/ConfigurableObject","../../helpers/DataFieldHelper","../../helpers/ID","../../helpers/Key","../../ManifestSettings"],function(e,t,n,a,i,o,r,l,v,u){"use strict";var s={};var c=u.ActionType;var f=v.KeyHelper;var d=l.getFormStandardActionButtonID;var p=l.getFormID;var m=r.isReferencePropertyStaticallyHidden;var y=o.Placement;var O=o.insertCustomElements;var b=i.generate;var g=a.getTargetObjectPath;var P=a.getTargetEntitySetPath;var h=t.pathInModel;var E=t.not;var F=t.ifElse;var C=t.getExpressionFromAnnotation;var D=t.equal;var S=t.compileExpression;var I=e.getSemanticObjectPath;function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach(function(t){j(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function j(e,t,n){t=A(t);if(t in e){Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true})}else{e[t]=n}return e}function A(e){var t=U(e,"string");return typeof t==="symbol"?t:String(t)}function U(e,t){if(typeof e!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==undefined){var a=n.call(e,t||"default");if(typeof a!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var N;(function(e){e["Default"]="Default";e["Slot"]="Slot";e["Annotation"]="Annotation"})(N||(N={}));s.FormElementType=N;function M(){return{textLinesEdit:4}}function _(e,t){var n,a,i,o;return(t===null||t===void 0?void 0:t.valueOf())===false||((n=e.annotations)===null||n===void 0?void 0:(a=n.UI)===null||a===void 0?void 0:a.PartOfPreview)===undefined||((i=e.annotations)===null||i===void 0?void 0:(o=i.UI)===null||o===void 0?void 0:o.PartOfPreview.valueOf())===true}function k(e,t){var n=[];var a=t.getEntityTypeAnnotation(e.Target.value);var i=a.annotation;t=a.converterContext;function o(e,a){var i,o,r;var l=I(t,e);if(e.$Type!=="com.sap.vocabularies.UI.v1.DataFieldForAction"&&e.$Type!=="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"&&!m(e)&&((i=e.annotations)===null||i===void 0?void 0:(o=i.UI)===null||o===void 0?void 0:(r=o.Hidden)===null||r===void 0?void 0:r.valueOf())!==true){n.push({key:f.generateKeyFromDataField(e),type:N.Annotation,annotationPath:"".concat(t.getEntitySetBasedAnnotationPath(e.fullyQualifiedName),"/"),semanticObjectPath:l,formatOptions:M(),isPartOfPreview:_(e,a)})}}switch(i===null||i===void 0?void 0:i.term){case"com.sap.vocabularies.UI.v1.FieldGroup":i.Data.forEach(function(t){var n,a;return o(t,(n=e.annotations)===null||n===void 0?void 0:(a=n.UI)===null||a===void 0?void 0:a.PartOfPreview)});break;case"com.sap.vocabularies.UI.v1.Identification":i.forEach(function(t){var n,a;return o(t,(n=e.annotations)===null||n===void 0?void 0:(a=n.UI)===null||a===void 0?void 0:a.PartOfPreview)});break;case"com.sap.vocabularies.UI.v1.DataPoint":n.push({key:"DataPoint::".concat(i.qualifier?i.qualifier:""),type:N.Annotation,annotationPath:"".concat(t.getEntitySetBasedAnnotationPath(i.fullyQualifiedName),"/")});break;case"com.sap.vocabularies.Communication.v1.Contact":n.push({key:"Contact::".concat(i.qualifier?i.qualifier:""),type:N.Annotation,annotationPath:"".concat(t.getEntitySetBasedAnnotationPath(i.fullyQualifiedName),"/")});break;default:break}return n}function x(e,t){var n=t.getManifestWrapper();var a=n.getFormContainer(e.Target.value);var i={};if(a!==null&&a!==void 0&&a.fields){Object.keys(a===null||a===void 0?void 0:a.fields).forEach(function(e){i[e]={key:e,id:"CustomFormElement::".concat(e),type:a.fields[e].type||N.Default,template:a.fields[e].template,label:a.fields[e].label,position:a.fields[e].position||{placement:y.After},formatOptions:T(T({},M()),a.fields[e].formatOptions)}})}return i}s.getFormElementsFromManifest=x;function H(e,t,a){var i,o,r,l,v,u;var s=b([{Facet:e}]);var f="/".concat(e.fullyQualifiedName);var p=t.getEntityTypeAnnotation(e.Target.value);var m=S(E(D(true,C((i=e.annotations)===null||i===void 0?void 0:(o=i.UI)===null||o===void 0?void 0:o.Hidden))));var y;if(p.converterContext.getEntitySet()&&p.converterContext.getEntitySet()!==t.getEntitySet()){y=P(p.converterContext.getDataModelObjectPath())}else if(((r=p.converterContext.getDataModelObjectPath().targetObject)===null||r===void 0?void 0:r.containsTarget)===true){y=g(p.converterContext.getDataModelObjectPath(),false)}else if(p.converterContext.getEntitySet()&&!y&&n.isSingleton(p.converterContext.getEntitySet())){var I;y=(I=p.converterContext.getEntitySet())===null||I===void 0?void 0:I.fullyQualifiedName}var w=O(k(e,t),x(e,t),{formatOptions:"overwrite"});a=a!==undefined?a.filter(function(t){return t.facetName==e.fullyQualifiedName}):[];if(a.length===0){a=undefined}var T={id:d(s,"ShowHideDetails"),key:"StandardAction::ShowHideDetails",text:S(F(D(h("showDetails","internal"),true),h("T_COMMON_OBJECT_PAGE_HIDE_FORM_CONTAINER_DETAILS","sap.fe.i18n"),h("T_COMMON_OBJECT_PAGE_SHOW_FORM_CONTAINER_DETAILS","sap.fe.i18n"))),type:c.ShowFormDetails,press:"FormContainerRuntime.toggleDetails"};if(((l=e.annotations)===null||l===void 0?void 0:(v=l.UI)===null||v===void 0?void 0:(u=v.PartOfPreview)===null||u===void 0?void 0:u.valueOf())!==false&&w.some(function(e){return e.isPartOfPreview===false})){if(a!==undefined){a.push(T)}else{a=[T]}}return{id:s,formElements:w,annotationPath:f,isVisible:m,entitySet:y,actions:a}}s.getFormContainer=H;function R(e,t,n){var a;var i=[];(a=e.Facets)===null||a===void 0?void 0:a.forEach(function(e){if(e.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){return}i.push(H(e,t,n))});return i}function B(e){return e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"}s.isReferenceFacet=B;function L(e,t,n,a){var i,o,r;switch(e.$Type){case"com.sap.vocabularies.UI.v1.CollectionFacet":return{id:p({Facet:e}),useFormContainerLabels:true,hasFacetsNotPartOfPreview:e.Facets.some(function(e){var t,n,a;return((t=e.annotations)===null||t===void 0?void 0:(n=t.UI)===null||n===void 0?void 0:(a=n.PartOfPreview)===null||a===void 0?void 0:a.valueOf())===false}),formContainers:R(e,n,a),isVisible:t};case"com.sap.vocabularies.UI.v1.ReferenceFacet":return{id:p({Facet:e}),useFormContainerLabels:false,hasFacetsNotPartOfPreview:((i=e.annotations)===null||i===void 0?void 0:(o=i.UI)===null||o===void 0?void 0:(r=o.PartOfPreview)===null||r===void 0?void 0:r.valueOf())===false,formContainers:[H(e,n,a)],isVisible:t};default:throw new Error("Cannot create form based on ReferenceURLFacet")}}s.createFormDefinition=L;return s},false);
//# sourceMappingURL=Form.js.map