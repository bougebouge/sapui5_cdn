/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/converters/MetaModelConverter","sap/fe/core/formatters/ValueFormatter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/DisplayModeFormatter","sap/fe/core/templating/FieldControlHelper","sap/fe/core/templating/PropertyHelper"],function(e,t,n,a,i,r,o,l){"use strict";var s={};var u=l.isProperty;var d=l.isPathExpression;var v=l.isKey;var f=l.isImmutable;var c=l.isComputed;var p=l.hasValueHelp;var g=l.getAssociatedUnitProperty;var m=l.getAssociatedCurrencyProperty;var y=o.isRequiredExpression;var b=o.isReadOnlyExpression;var h=o.isNonEditableExpression;var O=o.isDisabledExpression;var x=i.isPathUpdatable;var D=i.getTargetObjectPath;var E=i.getRelativePaths;var I=i.getContextRelativeTargetObjectPath;var M=a.pathInModel;var $=a.or;var T=a.notEqual;var C=a.not;var V=a.isTruthy;var P=a.isConstant;var S=a.ifElse;var U=a.getExpressionFromAnnotation;var j=a.formatResult;var A=a.equal;var F=a.constant;var q=a.compileExpression;var N=a.and;var R=a.addTypeInformation;var B=t.getInvolvedDataModelObjects;var L=t.convertMetaModelContext;var W=e.UI;var w=e.singletonPathVisitor;function k(e){return K(e)||z(e)||_(e)||H()}function H(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _(e,t){if(!e)return;if(typeof e==="string")return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor)n=e.constructor.name;if(n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(e,t)}function z(e){if(typeof Symbol!=="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function K(e){if(Array.isArray(e))return G(e)}function G(e,t){if(t==null||t>e.length)t=e.length;for(var n=0,a=new Array(t);n<t;n++){a[n]=e[n]}return a}var Y=r.EDM_TYPE_MAPPING;s.EDM_TYPE_MAPPING=Y;var J=function(e){return r.getDisplayMode(e.targetObject,e)};s.getDisplayMode=J;var Q=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var n=arguments.length>2?arguments[2]:undefined;var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:W.IsEditable;return X(e,t,n,true,a)};s.getEditableExpressionAsObject=Q;var X=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var n=arguments.length>2?arguments[2]:undefined;var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:W.IsEditable;if(!e||typeof e==="string"){return q(false)}var r=F(true);if(t!==null){r=S(h(t),false,i)}var o=d(e)&&e.$target||e;var l=E(n);var s=x(n,{propertyPath:e,pathVisitor:function(e,t){return w(e,n.convertedTypes,t)}});var u=S($(C(s),c(o),v(o),f(o),h(o,l)),S($(c(o),h(o,l)),false,W.IsTransientBinding),i);if(a){return N(u,r)}return q(N(u,r))};s.getEditableExpression=X;var Z=function(e,t){var n;var a=D(e);var i=M("/collaboration/activities".concat(a),"internal");var r=e===null||e===void 0?void 0:(n=e.targetEntityType)===null||n===void 0?void 0:n.keys;var o=[];r===null||r===void 0?void 0:r.forEach(function(e){var t=M(e.name);o.push(t)});return j([i].concat(o),t)};s.getCollaborationExpression=Z;var ee=function(e,t,n){return te(e,t,true,n)};s.getEnabledExpressionAsObject=ee;var te=function(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var a=arguments.length>3?arguments[3]:undefined;if(!e||typeof e==="string"){return q(true)}var i;if(a){i=E(a)}var r=F(true);if(t!==null){r=S(O(t),false,true)}var o=d(e)&&e.$target||e;var l=S(O(o,i),false,true);if(n){return N(l,r)}return q(N(l,r))};s.getEnabledExpression=te;var ne=function(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:null;var r=arguments.length>5&&arguments[5]!==undefined?arguments[5]:W.IsEditable;if(!e||typeof e==="string"){return"Display"}var o=d(e)&&e.$target||e;var l=E(t);var s=Q(e,i,t,r);var u=ee(e,i,t);var v=m(o);var f=v||g(o);var p=F("Editable");if(f){var y=b(f,l);p=S($(y,c(f),n),S(!P(y)&&y,"EditableReadOnly","EditableDisplay"),"Editable")}var h=$(b(o,l),b(i));var O=S(u,S(s,p,S(N(!P(h)&&h,r),"ReadOnly","Display")),S(r,"Disabled","Display"));if(a){return O}return q(O)};s.getEditMode=ne;var ae=function(e){var t,n,a,i;var r=e.targetObject;var o=(t=r.annotations)===null||t===void 0?void 0:(n=t.Measures)===null||n===void 0?void 0:n.ISOCurrency;var l=o?o:(a=r.annotations)===null||a===void 0?void 0:(i=a.Measures)===null||i===void 0?void 0:i.Unit;if(l){return q($(V(U(l)),C(W.IsTotal)))}else{return q(F(true))}};s.hasValidAnalyticalCurrencyOrUnit=ae;var ie=function(e,t,n){var a=d(e)&&e.$target||e;var i=m(a)||g(a);if(!i){return q(n)}var r=b(i);var o=N($(!P(r),C(r)),C(c(i)));return q(S(o,t,n))};s.ifUnitEditable=ie;var re=function(e,t,n){var a=d(e)&&e.$target||e;return p(a)?q(t):q(S(A(n,"Editable"),"Value",t))};s.getFieldDisplay=re;var oe=function(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var a=t;if(e._type==="Property"){var i=Y[e.type];if(i){var r,o,l;a.type=i.type;if(i.constraints&&!n){var s,u,d,v;a.constraints={};if(i.constraints.$Scale&&e.scale!==undefined){a.constraints.scale=e.scale}if(i.constraints.$Precision&&e.precision!==undefined){a.constraints.precision=e.precision}if(i.constraints.$MaxLength&&e.maxLength!==undefined){a.constraints.maxLength=e.maxLength}if(e.nullable===false){a.constraints.nullable=e.nullable}if(i.constraints["@Org.OData.Validation.V1.Minimum/$Decimal"]&&((s=e.annotations)===null||s===void 0?void 0:(u=s.Validation)===null||u===void 0?void 0:u.Minimum)!==undefined&&!isNaN(e.annotations.Validation.Minimum)){a.constraints.minimum="".concat(e.annotations.Validation.Minimum)}if(i.constraints["@Org.OData.Validation.V1.Maximum/$Decimal"]&&((d=e.annotations)===null||d===void 0?void 0:(v=d.Validation)===null||v===void 0?void 0:v.Maximum)!==undefined&&!isNaN(e.annotations.Validation.Maximum)){a.constraints.maximum="".concat(e.annotations.Validation.Maximum)}}else if(e.nullable===false){a.constraints={};a.constraints.nullable=e.nullable}if((a===null||a===void 0?void 0:(r=a.type)===null||r===void 0?void 0:r.indexOf("sap.ui.model.odata.type.Int"))===0){if(!a.formatOptions){a.formatOptions={}}a.formatOptions=Object.assign(a.formatOptions,{parseAsString:false,emptyString:""})}if(a.type==="sap.ui.model.odata.type.String"){var f,c,p;if(!a.formatOptions){a.formatOptions={}}a.formatOptions.parseKeepsEmptyString=true;if((f=i.constraints)!==null&&f!==void 0&&f["@com.sap.vocabularies.Common.v1.IsDigitSequence"]&&(c=e.annotations)!==null&&c!==void 0&&(p=c.Common)!==null&&p!==void 0&&p.IsDigitSequence){a.constraints.isDigitSequence=true}}if((a===null||a===void 0?void 0:(o=a.type)===null||o===void 0?void 0:o.indexOf("sap.ui.model.odata.type.Double"))===0){if(!a.formatOptions){a.formatOptions={}}a.formatOptions=Object.assign(a.formatOptions,{parseAsString:false,emptyString:""})}if((a===null||a===void 0?void 0:(l=a.type)===null||l===void 0?void 0:l.indexOf("sap.ui.model.odata.type.DateTimeOffset"))===0){a.constraints.V4=true}}}return a};s.formatWithTypeInformation=oe;var le=function(e,t){var n,a,i,r;var o=Y[e===null||e===void 0?void 0:e.type]||(t?Y[t]:undefined);var l={type:o.type,constraints:{},formatOptions:{}};if(u(e)){var s,d,v,f,c,p,g,m,y,b,h,O,x,D,E,I,M,$;l.constraints={scale:(s=o.constraints)!==null&&s!==void 0&&s.$Scale?e.scale:undefined,precision:(d=o.constraints)!==null&&d!==void 0&&d.$Precision?e.precision:undefined,maxLength:(v=o.constraints)!==null&&v!==void 0&&v.$MaxLength?e.maxLength:undefined,nullable:(f=o.constraints)!==null&&f!==void 0&&f.$Nullable?e.nullable:undefined,minimum:(c=o.constraints)!==null&&c!==void 0&&c["@Org.OData.Validation.V1.Minimum/$Decimal"]&&!isNaN((p=e.annotations)===null||p===void 0?void 0:(g=p.Validation)===null||g===void 0?void 0:g.Minimum)?"".concat((m=e.annotations)===null||m===void 0?void 0:(y=m.Validation)===null||y===void 0?void 0:y.Minimum):undefined,maximum:(b=o.constraints)!==null&&b!==void 0&&b["@Org.OData.Validation.V1.Maximum/$Decimal"]&&!isNaN((h=e.annotations)===null||h===void 0?void 0:(O=h.Validation)===null||O===void 0?void 0:O.Maximum)?"".concat((x=e.annotations)===null||x===void 0?void 0:(D=x.Validation)===null||D===void 0?void 0:D.Maximum):undefined,isDigitSequence:l.type==="sap.ui.model.odata.type.String"&&(E=o.constraints)!==null&&E!==void 0&&E["@com.sap.vocabularies.Common.v1.IsDigitSequence"]&&(I=e.annotations)!==null&&I!==void 0&&(M=I.Common)!==null&&M!==void 0&&M.IsDigitSequence?true:undefined,V4:($=o.constraints)!==null&&$!==void 0&&$.$V4?true:undefined}}l.formatOptions={parseAsString:(l===null||l===void 0?void 0:(n=l.type)===null||n===void 0?void 0:n.indexOf("sap.ui.model.odata.type.Int"))===0||(l===null||l===void 0?void 0:(a=l.type)===null||a===void 0?void 0:a.indexOf("sap.ui.model.odata.type.Double"))===0?false:undefined,emptyString:(l===null||l===void 0?void 0:(i=l.type)===null||i===void 0?void 0:i.indexOf("sap.ui.model.odata.type.Int"))===0||(l===null||l===void 0?void 0:(r=l.type)===null||r===void 0?void 0:r.indexOf("sap.ui.model.odata.type.Double"))===0?"":undefined,parseKeepsEmptyString:l.type==="sap.ui.model.odata.type.String"?true:undefined};return l};s.getTypeConfig=le;var se=function(e,t,a,i){var r,o,l,s,u;var d=e.targetObject;var v=(r=d.annotations)===null||r===void 0?void 0:(o=r.Measures)===null||o===void 0?void 0:o.Unit;var f=E(e);t=oe(d,t);if(((l=v)===null||l===void 0?void 0:l.toString())==="%"){if((i===null||i===void 0?void 0:i.showMeasure)===false){return t}return j([t],n.formatWithPercentage)}var c=v?"sap.ui.model.odata.type.Unit":"sap.ui.model.odata.type.Currency";v=v?v:(s=d.annotations)===null||s===void 0?void 0:(u=s.Measures)===null||u===void 0?void 0:u.ISOCurrency;var p=v.$target?oe(v.$target,U(v,f),a):U(v,f);return R([t,p],c,undefined,i)};s.getBindingWithUnitOrCurrency=se;var ue=function(e){var t,n,a,i,r;var o=e.targetObject;var l=(t=o.annotations)===null||t===void 0?void 0:(n=t.Measures)===null||n===void 0?void 0:n.Unit;if(((a=l)===null||a===void 0?void 0:a.toString())==="%"){return F("%")}var s=E(e);var u=l?"sap.ui.model.odata.type.Unit":"sap.ui.model.odata.type.Currency";l=l?l:(i=o.annotations)===null||i===void 0?void 0:(r=i.Measures)===null||r===void 0?void 0:r.ISOCurrency;var d=l.$target?oe(l.$target,U(l,s)):U(l,s);var v=M(I(e));v=oe(o,v,true);return R([v,d],u,undefined,{parseKeepsEmptyString:true,emptyString:"",showNumber:false})};s.getBindingForUnitOrCurrency=ue;var de=function(e,t){var n,a;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var o=e.targetObject;var l=(n=o.annotations)===null||n===void 0?void 0:(a=n.Common)===null||a===void 0?void 0:a.Timezone;var s=E(e);t=oe(o,t);var u="sap.fe.core.type.DateTimeWithTimezone";var d=l.$target?oe(l.$target,U(l,s),i):U(l,s);var v;if(r){v={showTimezoneForEmptyValues:false}}return R([t,d],u,undefined,v)};s.getBindingWithTimezone=de;var ve=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"Begin";var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"Begin";return q(S(A(e,"Display"),t,n))};s.getAlignmentExpression=ve;var fe=function(e,t){if(t&&t.context){return L(t.context)}return null};fe.requiresIContext=true;s.getConverterContext=fe;var ce=function(e,t){if(t&&t.context){return B(t.context)}return null};ce.requiresIContext=true;s.getDataModelObjectPath=ce;var pe=function(e){var t;if((t=e.navigationProperties)!==null&&t!==void 0&&t.length){var n=(e===null||e===void 0?void 0:e.navigationProperties.findIndex(function(t){if(t.isCollection){var n,a;if((n=e.contextLocation)!==null&&n!==void 0&&(a=n.navigationProperties)!==null&&a!==void 0&&a.length){var i;return((i=e.contextLocation)===null||i===void 0?void 0:i.navigationProperties.findIndex(function(e){return e.name===t.name}))===-1}return true}return false}))>-1;if(n){return true}}return false};s.isCollectionField=pe;var ge=function(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;return me(e,t,n,true)};s.getRequiredExpressionAsObject=ge;var me=function(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:{};var r=arguments.length>5?arguments[5]:undefined;var o;var l=i.requiredPropertiesFromInsertRestrictions||[];var s=i.requiredPropertiesFromUpdateRestrictions||[];if(!e||typeof e==="string"){o=F(false)}else{var u;if(r){u=E(r)}var v=F(true);if(t!==null){v=y(t)}var f=F(false);var c=F(false);var p=d(e)&&e.$target||e;var g=y(p,u);var m=n||W.IsEditable;if(l.length&&l.includes(e.name)){f=N(F(true),W.IsCreateMode)}if(s.length&&s.includes(e.name)){c=N(F(true),T(W.IsCreateMode,true))}o=$(N($(g,v),m),f,c)}if(a){return o}return q(o)};s.getRequiredExpression=me;var ye=function(e){var t,n;var a=e===null||e===void 0?void 0:(t=e.targetObject)===null||t===void 0?void 0:(n=t.$target)===null||n===void 0?void 0:n.Data;var i=Object.keys(a);var r=[];var o;var l=[];for(var s=0,u=i;s<u.length;s++){var d=u[s];if(a[d]["$Type"]&&a[d]["$Type"].indexOf("DataField")>-1){r.push(a[d])}}for(var v=0,f=r;v<f.length;v++){var c=f[v];switch(c.$Type){case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":if(typeof c.Value==="object"){o=c.Value.$target}break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":if(c.Target.$target){if(c.Target.$target.$Type==="com.sap.vocabularies.UI.v1.DataField"||c.Target.$target.$Type==="com.sap.vocabularies.UI.v1.DataPointType"){if(typeof c.Target.$target.Value==="object"){o=c.Target.$target.Value.$target}}else{if(typeof c.Target==="object"){o=c.Target.$target}break}}break}l.push(ge(o,c,false))}return q($.apply(void 0,k(l)))};s.getRequiredExpressionForConnectedDataField=ye;return s},false);
//# sourceMappingURL=UIFormatters.js.map