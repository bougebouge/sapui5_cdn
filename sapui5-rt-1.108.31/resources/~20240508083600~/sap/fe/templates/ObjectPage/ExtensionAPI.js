/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/converters/helpers/ID","sap/fe/core/ExtensionAPI","sap/fe/core/helpers/ClassSupport","sap/ui/core/library","sap/ui/core/message/Message"],function(e,t,r,n,i,o,s){"use strict";var a,u;var c=o.MessageType;var g=i.defineUI5Class;var p=r.getSideContentLayoutID;function f(e,t){try{var r=e()}catch(e){return t(e)}if(r&&r.then){return r.then(void 0,t)}return r}function l(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;d(e,t)}function d(e,t){d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,r){t.__proto__=r;return t};return d(e,t)}var v=(a=g("sap.fe.templates.ObjectPage.ExtensionAPI"),a(u=function(r){l(n,r);function n(){return r.apply(this,arguments)||this}var i=n.prototype;i.refresh=function e(r){var n=this._view.getBindingContext();if(!n){return Promise.resolve()}var i=t.getAppComponent(this._view),o=i.getSideEffectsService(),s=n.getModel().getMetaModel(),a={TargetProperties:[],TargetEntities:[]};var u,c,g,p;if(r===undefined||r===null){a.TargetEntities.push({$NavigationPropertyPath:""})}else{u=Array.isArray(r)?r:[r];g=this._controller.getOwnerComponent().getEntitySet();for(var f=0;f<u.length;f++){c=u[f];if(c===""){a.TargetProperties.push({$PropertyPath:"*"})}else{p=s.getObject("/".concat(g,"/").concat(c,"/$kind"));if(p==="NavigationProperty"){a.TargetEntities.push({$NavigationPropertyPath:c})}else if(p){a.TargetProperties.push({$PropertyPath:c})}else{return Promise.reject("".concat(c," is not a valid path to be refreshed"))}}}}return o.requestSideEffects(a.TargetEntities.concat(a.TargetProperties),n)};i.getSelectedContexts=function e(t){var r=this._view.byId(t);if(r&&r.isA("sap.fe.macros.table.TableAPI")){r=r.getContent()}return r&&r.isA("sap.ui.mdc.Table")&&r.getSelectedContexts()||[]};i.showSideContent=function e(t,r){var n=p(t),i=this._view.byId(n),o=r===undefined?!i.getShowSideContent():r;i.setShowSideContent(o,false)};i.getBindingContext=function e(){return this._view.getBindingContext()};i._buildOPMessage=function e(t){try{var r=this;var n=r._view;return Promise.resolve(n.getModel("sap.fe.i18n").getResourceBundle()).then(function(e){var r=null;switch(t.length){case 0:break;case 1:r=t[0];break;default:var n={Error:{id:2,count:0},Warning:{id:1,count:0},Information:{id:0,count:0}};r=t.reduce(function(e,t){var r=t.getType();e.setType(n[r].id>n[e.getType()].id?r:e.getType());n[r].count++;return e},new s({type:c.Information}));if(n.Error.count===0&&n.Warning.count===0&&n.Information.count>0){r.setMessage(e.getText("OBJECTPAGESTATE_INFORMATION"))}else if(n.Error.count>0&&n.Warning.count>0||n.Information.count>0){r.setMessage(e.getText("OBJECTPAGESTATE_ISSUE"))}else{r.setMessage(e.getText(r.getType()===c.Error?"OBJECTPAGESTATE_ERROR":"OBJECTPAGESTATE_WARNING"))}}return r})}catch(e){return Promise.reject(e)}};i.showMessages=function t(r){try{var n=this;var i=n._view;var o=i.getBindingContext("internal");var s=f(function(){return Promise.resolve(n._buildOPMessage(r)).then(function(e){if(e){o===null||o===void 0?void 0:o.setProperty("OPMessageStripVisibility",true);o===null||o===void 0?void 0:o.setProperty("OPMessageStripText",e.getMessage());o===null||o===void 0?void 0:o.setProperty("OPMessageStripType",e.getType())}else{n.hideMessage()}})},function(){e.error("Cannot display ObjectPage message")});return Promise.resolve(s&&s.then?s.then(function(){}):void 0)}catch(e){return Promise.reject(e)}};i.hideMessage=function e(){var t=this._view;var r=t.getBindingContext("internal");r===null||r===void 0?void 0:r.setProperty("OPMessageStripVisibility",false)};return n}(n))||u);return v},false);
//# sourceMappingURL=ExtensionAPI.js.map