/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/converters/controls/Common/DataVisualization","sap/fe/core/converters/controls/ListReport/FilterBar","sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/ModelHelper","sap/fe/core/TemplateModel","sap/fe/core/templating/FilterHelper","sap/fe/macros/MacroMetadata","sap/fe/macros/ResourceModel"],function(e,t,a,r,i,o,l,n,s,p){"use strict";var c=n.getFilterConditions;var u=i.getInvolvedDataModelObjects;var f=r.getSelectionFields;var d=a.getSelectionVariant;var g=s.extend("sap.fe.macros.FilterBar",{name:"FilterBar",namespace:"sap.fe.macros.internal",publicNamespace:"sap.fe.macros",fragment:"sap.fe.macros.filterBar.FilterBar",metadata:{stereotype:"xmlmacro",designtime:"sap/fe/macros/filterBar/FilterBar.designtime",properties:{selectionFields:{type:"sap.ui.model.Context"},metaPath:{type:"sap.ui.model.Context",isPublic:true},contextPath:{type:"sap.ui.model.Context",isPublic:true},id:{type:"string",isPublic:true},visible:{type:"boolean",isPublic:true},showMessages:{type:"boolean",defaultValue:false,isPublic:true},_applyIdToContent:{type:"boolean",defaultValue:false},variantBackreference:{type:"string"},hideBasicSearch:{type:"boolean"},enableFallback:{type:"boolean",defaultValue:false},showAdaptFiltersButton:{type:"boolean",defaultValue:true},p13nMode:{type:"sap.ui.mdc.FilterBarP13nMode[]",defaultValue:"Item,Value"},propertyInfo:{type:"string"},useSemanticDateRange:{type:"boolean",defaultValue:true},liveMode:{type:"boolean",defaultValue:false,isPublic:true},_valueList:{type:"sap.ui.model.Context",required:false},_internalContextPath:{type:"sap.ui.model.Context",required:false},filterConditions:{type:"string",required:false},suspendSelection:{type:"boolean",defaultValue:false},showDraftEditState:{type:"boolean",defaultValue:false},isDraftCollaborative:{type:"boolean",defaultValue:false},toggleControlId:{type:"string"},initialLayout:{type:"string",defaultValue:"compact"}},events:{search:{type:"function",isPublic:true},filterChanged:{type:"function",isPublic:true},stateChange:{type:"function"},internalFilterChanged:{type:"function"},internalSearch:{type:"function"}},aggregations:{filterFields:{type:"sap.fe.macros.FilterField",isPublic:true}}},_processPropertyInfos:function(e){var t=[];if(e.propertyInfo){var a=e.propertyInfo.replace(/\\{/g,"{").replace(/\\}/g,"}");var r=JSON.parse(a);r.forEach(function(e){if(e.isParameter){t.push(e.name)}if(e.path==="$editState"){e.label=p.getText("FILTERBAR_EDITING_STATUS")}});e.propertyInfo=JSON.stringify(r).replace(/\{/g,"\\{").replace(/\}/g,"\\}")}e.parameters=JSON.stringify(t)},create:function(a,r,i,n){var s=a.contextPath;if(!s){e.error("Context Path not available for FilterBar Macro.");return}var p=a.metaPath;var g=p&&p.getPath();var v=g.split("/@com.sap.vocabularies.UI.v1.SelectionFields");var y=v[0].endsWith("/")?v[0]:v[0]+"/";var m="@com.sap.vocabularies.UI.v1.SelectionFields"+(v[1]||"");var b=o.getEntitySetPath(y);var h=s.getModel();var C=this.parseAggregation(n.filterFields,function(e){var t=e.getAttribute("key");n[t]=e;return{key:t,label:e.getAttribute("label"),position:{placement:e.getAttribute("placement"),anchor:e.getAttribute("anchor")},required:e.getAttribute("required")==="true",type:"Slot"}});a._internalContextPath=h.createBindingContext(y);var F=u(a._internalContextPath);var I="@com.sap.vocabularies.UI.v1.SelectionFields";var P={};P[I]={filterFields:C};var S=this.getConverterContext(F,undefined,i,P);if(!a.propertyInfo){a.propertyInfo=f(S,[],m).sPropertyInfo}this._processPropertyInfos(a);if(!a.selectionFields){var B=f(S,[],m).selectionFields;a.selectionFields=new l(B,h).createBindingContext("/");var x=S.getEntityType(),M=d(x,S),V=s.getModel().getContext(b),_=c(V,{selectionVariant:M});a.filterConditions=_}if(h.getObject(b+"@com.sap.vocabularies.Common.v1.DraftRoot")||h.getObject(b+"@com.sap.vocabularies.Common.v1.DraftNode")){a.showDraftEditState=true;if(o.isCollaborationDraftSupported(h)){a.isDraftCollaborative=true}}if(a._applyIdToContent){a._apiId=a.id+"::FilterBar";a._contentId=a.id}else{a._apiId=a.id;a._contentId=this.getContentId(a.id)}if(a.hideBasicSearch!=="true"){var D=t.getSearchRestrictions(b,h);a.hideBasicSearch=Boolean(D&&!D.Searchable)}return a}});return g},false);
//# sourceMappingURL=FilterBar.metadata.js.map