/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/CommonUtils","sap/fe/core/helpers/ModelHelper","sap/fe/core/templating/DisplayModeFormatter","sap/fe/macros/CommonHelper","sap/ui/model/odata/v4/AnnotationHelper","sap/base/util/JSTokenizer"],function(e,t,n,r,i,a){"use strict";var o=n.EDM_TYPE_MAPPING;var s={isRequiredInFilter:function(n,i){var a=i.context.getModel(),o=i.context.getPath(),s=r.getLocationForPropertyPath(a,o);var l=t.getEntitySetPath(s,a);var c,f,p=a.getObject(l+"/@com.sap.vocabularies.Common.v1.ResultContext");if(!p){if(typeof n==="string"){c=n}else{c=a.getObject("".concat(o,"@sapui.name"))}f=e.getFilterRestrictionsByPath(l,a);p=f&&f.RequiredProperties&&f.RequiredProperties.indexOf(c)>-1}return p},maxConditions:function(t,n){var i,a=-1;var o=n.context.getModel(),s=n.context.getPath();var l=r.getLocationForPropertyPath(o,s);if(o.getObject("".concat(l,"/@com.sap.vocabularies.Common.v1.ResultContext"))===true){return 1}if(typeof t==="string"){i=t}else{i=o.getObject("".concat(s,"@sapui.name"))}var c=e.getFilterRestrictionsByPath(l,o);var f=o.getObject("".concat(l,"/").concat(i));if(!f){f=o.getObject(s)}if(f.$Type==="Edm.Boolean"){a=1}else if(c&&c.FilterAllowedExpressions&&c.FilterAllowedExpressions[i]){var p=e.getSpecificAllowedExpression(c.FilterAllowedExpressions[i]);if(p==="SingleValue"||p==="SingleRange"){a=1}}return a},getConditionsBinding:function(e,t,n){var r=e.getInterface(0),i=r.getModel(),a=r.getPath();var o="",s=e.getInterface(1).getPath(),l,c;if(n&&n["$kind"]==="EntityType"&&a.startsWith(s)){s=e.getInterface(1).getPath();var f=a.replace(s,"");l=f.split("/")}else{l=a.substring(1).split("/");s="/".concat(l.shift(),"/")}for(c=0;c<l.length;++c){t=i.getProperty(s+l.slice(0,c+1).join("/"));if(t.$kind==="NavigationProperty"&&t.$isCollection){o+="".concat(l[c],"*/")}else if(typeof t!=="string"){o+="".concat(l[c],"/")}}return"{$filters>/conditions/".concat(o.substring(0,o.length-1),"}")},constraints:function(e,t){var n=i.format(e,t),r=n&&n.match(/constraints:.*?({.*?})/);var o=r?a.parseJS(r[1]):{};if(n.includes("sap.ui.model.odata.type.DateTimeOffset")){o.V4=true}if(o.nullable===false){delete o.nullable}return Object.keys(o).length===0?undefined:JSON.stringify(o).replaceAll('"',"'")},formatOptions:function(e,t){if(e.$Type==="Edm.String"&&(!e.hasOwnProperty("$Nullable")||e.$Nullable===true)){t.arguments=[null,{parseKeepsEmptyString:false}]}var n=i.format(e,t),r=n&&n.match(/formatOptions:.*?({.*?})/);return r&&r[1]||undefined},getDataType:function(e){var t=o[e];return t?t.type:e}};s.getConditionsBinding.requiresIContext=true;return s},false);
//# sourceMappingURL=FilterFieldHelper.js.map