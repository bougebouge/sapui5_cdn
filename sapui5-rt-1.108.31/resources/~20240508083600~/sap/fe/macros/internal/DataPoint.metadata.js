/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/templating/CriticalityFormatters","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/PropertyHelper","sap/fe/core/templating/UIFormatters","sap/fe/macros/field/FieldHelper","sap/fe/macros/field/FieldTemplating","sap/fe/macros/internal/helpers/DataPointTemplating","sap/fe/macros/MacroMetadata"],function(e,t,i,a,n,o,r,s,l,c){"use strict";var p=c.extend("sap.fe.macros.internal.DataPoint",{name:"DataPoint",namespace:"sap.fe.macros.internal",fragment:"sap.fe.macros.internal.DataPoint",metadata:{stereotype:"xmlmacro",properties:{idPrefix:{type:"string"},metaPath:{type:"sap.ui.model.Context",required:true,$kind:["Property"]},ariaLabelledBy:{type:"string"},semanticObjects:{type:"sap.ui.model.Context",required:false,computed:true},formatOptions:{type:"object",properties:{dataPointStyle:{type:"string",allowedValues:["","large"]},displayMode:{type:"string",allowedValues:["Value","Description","ValueDescription","DescriptionValue"]},iconSize:{type:"string",allowedValues:["1rem","1.375rem","2rem"]},isAnalytics:{type:"boolean",defaultValue:false},measureDisplayMode:{type:"string",allowedValues:["Hidden","ReadOnly"]},showEmptyIndicator:{type:"boolean",defaultValue:false},showLabels:{type:"boolean",defaultValue:false}}},contextPath:{type:"sap.ui.model.Context",required:true,$kind:["EntitySet","NavigationProperty","EntityType","Singleton"]}}},create:function(t){var i,o,r,l;var c=e.getInvolvedDataModelObjects(t.metaPath,t.contextPath);var p;t.visible=s.getVisibleExpression(c);if(c!==null&&c!==void 0&&(i=c.targetObject)!==null&&i!==void 0&&(o=i.Value)!==null&&o!==void 0&&o.path){p=a.enhanceDataModelPath(c,c.targetObject.Value.path)}var u=e.convertMetaModelContext(t.metaPath);if(!t.formatOptions){t.formatOptions={}}t.semanticObjects=s.getSemanticObjects([]);t.hasQuickViewFacets=false;t.hasSemanticObjectOnNavigation=false;if((u===null||u===void 0?void 0:u.Visualization)==="UI.VisualizationType/Rating"){return this.setUpRatingIndicator(t,u)}if((u===null||u===void 0?void 0:u.Visualization)==="UI.VisualizationType/Progress"){return this.setUpProgressBar(t,u,c)}var d=p&&p.targetObject;if(s.isUsedInNavigationWithQuickViewFacets(c,d)||d!==null&&d!==void 0&&(r=d.annotations)!==null&&r!==void 0&&(l=r.Common)!==null&&l!==void 0&&l.SemanticObject){this.setUpSemanticObjectsAndQuickView(t,u,c,p)}else if(n.isProperty(d)&&(n.hasUnit(d)||n.hasCurrency(d))){return this.setUpObjectNumber(t,u,c,p)}return this.setUpObjectStatus(t,u,c)},setUpRatingIndicator:function(e,i){e.targetLabel=t.compileExpression(t.formatResult([t.pathInModel("T_HEADER_RATING_INDICATOR_FOOTER","sap.fe.i18n"),t.getExpressionFromAnnotation(i.Value),i.TargetValue?t.getExpressionFromAnnotation(i.TargetValue):"5"],"MESSAGE"));e.visualization="Rating";return e},setUpProgressBar:function(e,t,a){e.criticalityColorExpression=i.buildExpressionForCriticalityColor(t,a);e.displayValue=l.buildExpressionForProgressIndicatorDisplayValue(a);e.percentValue=l.buildExpressionForProgressIndicatorPercentValue(a);e.visualization="Progress";return e},setUpObjectNumber:function(e,a,n,r){e.criticalityColorExpression=i.buildExpressionForCriticalityColor(a,n);e.emptyIndicatorMode=e.formatOptions.showEmptyIndicator?"On":undefined;e.objectStatusNumber=l.buildFieldBindingExpression(n,e.formatOptions,true);e.unit=e.formatOptions.measureDisplayMode==="Hidden"?undefined:t.compileExpression(o.getBindingForUnitOrCurrency(r));e.visualization="ObjectNumber";return e},setUpObjectStatus:function(e,t,a){e.criticalityColorExpression=e.criticalityColorExpression?e.criticalityColorExpression:i.buildExpressionForCriticalityColor(t,a);e.emptyIndicatorMode=e.formatOptions.showEmptyIndicator?"On":undefined;e.objectStatusText=l.buildFieldBindingExpression(a,e.formatOptions,false);e.iconExpression=i.buildExpressionForCriticalityIcon(t,a);e.visualization="ObjectStatus";return e},setUpSemanticObjectsAndQuickView:function(e,t,a,n){var o;var l=n&&n.targetObject;e.hasQuickViewFacets=l?s.isUsedInNavigationWithQuickViewFacets(a,l):false;e.semanticObject="";var c,p=[];if(typeof t.Value==="object"){var u,d;c=(u=t.Value.$target)===null||u===void 0?void 0:(d=u.annotations)===null||d===void 0?void 0:d.Common;p=s.getSemanticObjectExpressionToResolve(c)}if(!!e.semanticObject&&e.semanticObject[0]==="{"){p.push({key:e.semanticObject.substr(1,e.semanticObject.length-2),value:e.semanticObject})}e.semanticObjects=s.getSemanticObjects(p);if(!e.semanticObject&&(n===null||n===void 0?void 0:(o=n.navigationProperties)===null||o===void 0?void 0:o.length)>0){n.navigationProperties.forEach(function(t){var i,a;if(t!==null&&t!==void 0&&(i=t.annotations)!==null&&i!==void 0&&(a=i.Common)!==null&&a!==void 0&&a.SemanticObject){e.semanticObject=t.annotations.Common.SemanticObject;e.hasSemanticObjectOnNavigation=true}})}e.criticalityColorExpression=i.buildExpressionForCriticalityColor(t,a);if(e.criticalityColorExpression==="None"&&n){e.criticalityColorExpression=e.hasQuickViewFacets?"Information":r.getStateDependingOnSemanticObjectTargets(n)}}});return p},false);
//# sourceMappingURL=DataPoint.metadata.js.map