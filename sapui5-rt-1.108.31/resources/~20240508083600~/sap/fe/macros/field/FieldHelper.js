/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/converters/helpers/Key","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ModelHelper","sap/fe/core/helpers/SideEffectsHelper","sap/fe/core/helpers/StableIdHelper","sap/fe/core/templating/FieldControlHelper","sap/fe/core/templating/PropertyHelper","sap/fe/core/templating/UIFormatters","sap/fe/macros/CommonHelper","sap/fe/macros/internal/valuehelp/ValueListHelper","sap/fe/macros/ResourceModel","sap/ui/base/ManagedObject","sap/ui/core/format/DateFormat","sap/ui/model/json/JSONModel","sap/ui/model/odata/v4/AnnotationHelper"],function(e,t,a,n,r,i,o,c,s,l,u,m,v,f,p,g,d,b){"use strict";var O=u.getAlignmentExpression;var y=l.isProperty;var h=s.isRequiredExpression;var P=c.generate;var T=r.pathInModel;var x=r.or;var j=r.ifElse;var $=r.equal;var F=r.constant;var C=r.compileExpression;var I=n.KeyHelper;var A=a.UI;var S=function(e){try{var t=e.getModel();var a=e.getSetting("sap.fe.macros.internal.Field");var n=a.sideEffects;if(n){return Promise.resolve(n)}return Promise.resolve(o.generateSideEffectsMapFromMetaModel(t))}catch(e){return Promise.reject(e)}};var D="@Org.OData.Measures.V1.ISOCurrency",E="@Org.OData.Measures.V1.Unit";var M={displayMode:function(e,t){var a=e["@com.sap.vocabularies.Common.v1.Text"],n=a&&(e&&e["@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement"]||t&&t["@com.sap.vocabularies.UI.v1.TextArrangement"]);if(n){if(n.$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"){return"Description"}else if(n.$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast"){return"ValueDescription"}return"DescriptionValue"}return a?"DescriptionValue":"Value"},buildExpressionForTextValue:function(e,t){var a=t.context.getModel();var n=t.context.getPath();var r=a.createBindingContext("".concat(n,"@com.sap.vocabularies.Common.v1.Text"));var i=r.getProperty();var o=i?b.value(i,{context:r}):undefined;var c="";e=b.getNavigationPath(e);if(e.indexOf("/")>-1&&o){c=e.replace(/[^\/]*$/,o.substr(1,o.length-2))}else{c=o}if(c){c="{ path : '"+c.replace(/^\{+/g,"").replace(/\}+$/g,"")+"', parameters: {'$$noPatch': true}}"}return c},buildTargetPathFromDataModelObjectPath:function(e){var t=e.startingEntitySet.name;var a="/".concat(t);var n=e.navigationProperties;for(var r=0;r<n.length;r++){a+="/".concat(n[r].name)}return a},hasSemanticObjectTargets:function(e){var t,a,n,r,i;var o=y(e.targetObject)?e.targetObject:e.targetObject.$target;var c=(t=o.annotations)===null||t===void 0?void 0:(a=t.Common)===null||a===void 0?void 0:a.SemanticObject;var s=(n=o.annotations)===null||n===void 0?void 0:(r=n.Common)===null||r===void 0?void 0:r.SemanticObjectUnavailableActions;var l=M.buildTargetPathFromDataModelObjectPath(e);var u="".concat(l,"/").concat(o.name);var m;if(c!==null&&c!==void 0&&c.path){m=C(T(c.path))}if(u&&(m||(c===null||c===void 0?void 0:(i=c.valueOf())===null||i===void 0?void 0:i.length)>0)){var v=u.replace(/\//g,"_");if(!m){var f="pageInternal>semanticsTargets/"+(c===null||c===void 0?void 0:c.valueOf())+"/"+v+(!s?"/HasTargetsNotFiltered":"/HasTargets");return"{parts:[{path:'"+f+"'}], formatter:'FieldRuntime.hasTargets'}"}else{return undefined}}else{return false}},getStateDependingOnSemanticObjectTargets:function(e){var t,a,n,r,i;var o=y(e.targetObject)?e.targetObject:e.targetObject.$target;var c=(t=o.annotations)===null||t===void 0?void 0:(a=t.Common)===null||a===void 0?void 0:a.SemanticObject;var s=(n=o.annotations)===null||n===void 0?void 0:(r=n.Common)===null||r===void 0?void 0:r.SemanticObjectUnavailableActions;var l=M.buildTargetPathFromDataModelObjectPath(e);var u="".concat(l,"/").concat(o.name);var m;if(c!==null&&c!==void 0&&c.path){m=C(T(c.path))}if(u&&(m||(c===null||c===void 0?void 0:(i=c.valueOf())===null||i===void 0?void 0:i.length)>0)){var v=u.replace(/\//g,"_");if(!m){var f="pageInternal>semanticsTargets/".concat(c===null||c===void 0?void 0:c.valueOf(),"/").concat(v).concat(!s?"/HasTargetsNotFiltered":"/HasTargets");return"{parts:[{path:'".concat(f,"'}], formatter:'FieldRuntime.getStateDependingOnSemanticObjectTargets'}")}else{return"Information"}}else{return"None"}},isNotAlwaysHidden:function(e,t){var a=t.context;var n=false;if(e.Value&&e.Value.$Path){n=a.getObject("Value/$Path@com.sap.vocabularies.UI.v1.Hidden")}if(!n||n.$Path){n=a.getObject("@com.sap.vocabularies.UI.v1.Hidden");if(!n||n.$Path){n=false}}return!n},isDraftIndicatorVisibleInFieldGroup:function(e){if(e&&e.formatOptions&&e.formatOptions.fieldGroupDraftIndicatorPropertyPath&&e.formatOptions.fieldGroupName){return"{parts: ["+"{value: '"+e.formatOptions.fieldGroupName+"'},"+"{path: 'internal>semanticKeyHasDraftIndicator'} , "+"{path: 'HasDraftEntity', targetType: 'any'}, "+"{path: 'IsActiveEntity', targetType: 'any'}, "+"{path: 'pageInternal>hideDraftInfo', targetType: 'any'}], "+"formatter: 'sap.fe.macros.field.FieldRuntime.isDraftIndicatorVisible'}"}else{return false}},isRequired:function(e,t){if(t==="Display"||t==="ReadOnly"||t==="Disabled"){return false}if(e){if(p.bindingParser(e)){return"{= %"+e+" === 7}"}else{return e=="com.sap.vocabularies.Common.v1.FieldControlType/Mandatory"}}return false},getActionParameterVisibility:function(e,t){if(typeof e==="object"){if(e&&e.$If&&e.$If.length===3){var a={$If:[]};a.$If[0]=e.$If[0];a.$If[1]=e.$If[2];a.$If[2]=e.$If[1];return b.value(a,t)}else{return"{= !%{"+e.$Path+"} }"}}else if(typeof e==="boolean"){return b.value(!e,t)}else{return undefined}},propertyName:function(e,t){var a;if(typeof e==="string"){if(t.context.getPath().indexOf("$Path")>-1||t.context.getPath().indexOf("$PropertyPath")>-1){a=e}}else if(e.$Path||e.$PropertyPath){var n=e.$Path?"/$Path":"/$PropertyPath";var r=t.context.getPath();a=t.context.getObject("".concat(r+n,"/$@sapui.name"))}else if(e.Value&&e.Value.$Path){a=e.Value.$Path}else{a=t.context.getObject("@sapui.name")}return a},getFieldGroupIds:function(e,t){if(!t){return undefined}var a=e.getInterface(0);return S(a).then(function(n){var r=a.getSetting("sap.fe.macros.internal.Field");r.sideEffects=n;var i=e.getPath(1).substr(1);var o=M.getSideEffectsOnEntityAndProperty(t,i,n);var c;if(o.length){c=o.reduce(function(e,t){return e&&"".concat(e,",").concat(t)||t})}return c})},getSideEffectsOnEntityAndProperty:function(e,t,a){var n=e.indexOf("/")>0;e=n?e.substr(e.lastIndexOf("/")+1):e;return a[t]&&a[t][0].concat(a[t][1][e]||[])||[]},fieldControl:function(e,t){var a=t&&t.context.getModel();var n=t&&t.context.getPath();var r=a&&a.createBindingContext("".concat(n,"@com.sap.vocabularies.Common.v1.FieldControl"));var i=r&&r.getProperty();if(i){if(i.hasOwnProperty("$EnumMember")){return i.$EnumMember}else if(i.hasOwnProperty("$Path")){return b.value(i,{context:r})}}else{return undefined}},getNavigationEntity:function(e,t){var a=t&&t.context||e;var n="";var r="".concat(b.getNavigationPath(a.getPath()),"/");var i=a.getObject().$Path;var o=i.split("/").pop();if(r.indexOf(i)>-1){r=r.split(i)[0]}if(i.indexOf("/")>-1){n="".concat(i.substring(0,i.lastIndexOf("/")),"/");r+=n}var c=a.getObject(r),s=Object.keys(c),l=s.length;for(var u=0;u<l;u++){if(c[s[u]].$kind==="NavigationProperty"&&c[s[u]].$ReferentialConstraint&&c[s[u]].$ReferentialConstraint.hasOwnProperty(o)){return t?b.getNavigationBinding(n+s[u]):r+s[u]}}if(c["$Key"].includes(o)){return t?b.getNavigationBinding(n):r}var m=a.getObject(r+"@");for(var v in m){if(v.includes("SemanticKey")){if(m[v][0].$PropertyPath===o){return t?b.getNavigationBinding(n):r}}}return undefined},valueHelpProperty:function(e,t){var a=e.getPath();var n=e.getObject()||{};var r=n.$Path?"".concat(a,"/$Path"):a;var i="".concat(r,"@");var o=e.getObject(i);var c;if(o){c=o.hasOwnProperty(D)&&D||o.hasOwnProperty(E)&&E;if(c&&!t){var s="".concat(r+c,"/$Path");if(e.getObject(s)){r=s}}}return r},valueHelpPropertyForFilterField:function(e){return M.valueHelpProperty(e,true)},getIDForFieldValueHelp:function(e,t,a,n){if(e){return e}var r=n;if(a!==n){r="".concat(a,"::").concat(n)}return P([t,r])},getFieldHelpPropertyForFilterField:function(e,a,n,r,i,o,c,s){var l=e.getInterface(0).getModel(1).createBindingContext(e.getInterface(0).getPath(1));var u=M.propertyName(a,{context:l}),v=s==="true"||s===true;var f=l.getModel(),p=l.getPath(),g=m.getLocationForPropertyPath(f,p),d=t.getFilterRestrictionsByPath(g,l);if((n==="Edm.DateTimeOffset"||n==="Edm.Date")&&v&&d&&d.FilterAllowedExpressions&&d.FilterAllowedExpressions[u]&&(d.FilterAllowedExpressions[u].indexOf("SingleRange")!==-1||d.FilterAllowedExpressions[u].indexOf("SingleValue")!==-1)||n==="Edm.Boolean"&&!c){return undefined}return M.getIDForFieldValueHelp(null,r||"FilterFieldValueHelp",i,o)},getSemanticKeyTitle:function(e,t,a,n,r,i){var o=f.getText("T_NEW_OBJECT");var c=f.getText("T_ANNOTATION_HELPER_DEFAULT_OBJECT_PAGE_HEADER_TITLE_NO_HEADER_INFO");var s,l;var u;var m=function(e){s="($"+e+" === '' || $"+e+" === undefined || $"+e+" === null ? '"+o+"': $"+e+")";l="($"+e+" === '' || $"+e+" === undefined || $"+e+" === null ? '"+c+"': $"+e+")";return"(!%{IsActiveEntity} ? !%{HasActiveEntity} ? "+s+" : "+l+" : "+l+")"};var v=function(e,t){var a;if(i){a=m(e);return t?"{= "+a+"}":a}else{return t?e:"$"+e}};if(e){if(n&&r!=="ObjectIdentifier"){var p=n.$EnumMember;if(p==="com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst"){u=v(e,false);return"{= "+u+" +' (' + "+"($"+t+(a?" || ${"+a+"}":"")+") +')' }"}else if(p==="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast"){u=v(e,false);return"{= ($"+t+(a?" || ${"+a+"}":"")+")"+" + ' (' + "+u+" +')' }"}else{return v(e,true)}}else{return v(e,true)}}else{return v(t,true)}},getObjectIdentifierText:function(e,t,a,n){if(e){if(t&&(t.$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"||t.$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate"||t.$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst")){return undefined}else{return a||"{".concat(n,"}")}}return undefined},getSemanticObjectsList:function(e){var t=e;var a=[];for(var n in t.getObject()){if(n.indexOf("com.sap.vocabularies.Common.v1.SemanticObject")>-1&&n.indexOf("com.sap.vocabularies.Common.v1.SemanticObjectMapping")===-1&&n.indexOf("com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions")===-1){var r=t.getObject()[n];if(typeof r==="object"){r=b.value(r,{context:e})}if(a.indexOf(r)===-1){a.push(r)}}}var i=new d(a);i.$$valueAsPromise=true;return i.createBindingContext("/")},getSemanticObjectsQualifiers:function(e){var t=e;var a=[];var n=function(e){return a.find(function(t){return t.qualifier===e})};for(var r in t.getObject()){if(r.indexOf("com.sap.vocabularies.Common.v1.SemanticObject#")>-1||r.indexOf("com.sap.vocabularies.Common.v1.SemanticObjectMapping#")>-1||r.indexOf("com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions#")>-1){var i=t.getObject()[r],o=r.split("#")[0],c=r.split("#")[1];var s=n(c);if(!s){s={qualifier:c};s[o]=i;a.push(s)}else{s[o]=i}}}a=a.filter(function(e){return!!e["@com.sap.vocabularies.Common.v1.SemanticObject"]});var l=new d(a);l.$$valueAsPromise=true;return l.createBindingContext("/")},getSemanticObjectsWithAnnotations:function(e){var t;var a;var n=e;var r=[];var i=function(e){return r.find(function(t){return t.qualifier===e})};for(var o in n.getObject()){if(o.indexOf("com.sap.vocabularies.Common.v1.SemanticObject")>-1||o.indexOf("com.sap.vocabularies.Common.v1.SemanticObjectMapping")>-1||o.indexOf("com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions")>-1){if(o.indexOf("#")>-1){t=n.getObject()[o];var c=o.split("#")[0],s=o.split("#")[1];a=i(s);if(o==="@com.sap.vocabularies.Common.v1.SemanticObject"&&typeof t==="object"){t=b.value(t[0],{context:e})}if(!a){a={qualifier:s};a[c]=t;r.push(a)}else{a[c]=t}}else{t=n.getObject()[o];var l=void 0;if(o.indexOf("com.sap.vocabularies.Common.v1.SemanticObjectMapping")>-1){l="@com.sap.vocabularies.Common.v1.SemanticObjectMapping"}else if(o.indexOf("com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions")>-1){l="@com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"}else if(o.indexOf("com.sap.vocabularies.Common.v1.SemanticObject")>-1){l="@com.sap.vocabularies.Common.v1.SemanticObject"}a=i("main");if(o==="@com.sap.vocabularies.Common.v1.SemanticObject"&&typeof t==="object"){t=b.value(t,{context:e})}if(!a){a={qualifier:"main"};a[l]=t;r.push(a)}else{a[l]=t}}}}r=r.filter(function(e){return!!e["@com.sap.vocabularies.Common.v1.SemanticObject"]});var u=new d(r);u.$$valueAsPromise=true;return u.createBindingContext("/")},computeSemanticLinkModelContextChange:function(e,t){if(M.hasSemanticObjectsWithPath(e)){var a=M.buildTargetPathFromDataModelObjectPath(t);return"FieldRuntime.LinkModelContextChange($event, '".concat(t.targetObject.name,"', '").concat(a,"')")}else{return undefined}},hasSemanticObjectsWithPath:function(e){var t=false;if(e&&e.length){for(var a=0;a<e.length;a++){if(e[a]&&e[a].value&&e[a].value.indexOf("{")===0){t=true;break}}}return t},isSemanticKeyHasFieldGroupColumn:function(e){return e},_checkCustomSemanticObjectHasAnnotations:function(e){if(e&&e.length==0){e=undefined}return e},_manageCustomSemanticObjects:function(e,t,a){if(e){if(!(e[0]==="[")){if(t&&t.indexOf(e)===-1){t.push(e)}}else{JSON.parse(e).forEach(function(e){if(t&&t.indexOf(e)===-1){t.push(e)}})}a=this._checkCustomSemanticObjectHasAnnotations(a)}return{semanticObjectsList:t,semanticObjectsWithAnnotations:a}},computeLinkParameters:function(e,t,a,n,r,i,o,c,s,l,u){var m=this._manageCustomSemanticObjects(l,a,n);a=m.semanticObjectsList;n=m.semanticObjectsWithAnnotations;return Promise.resolve().then(function(){var o;var l=[],m=[];var v=(o=n)===null||o===void 0?void 0:o.filter(function(e){return e.qualifier==="main"});var f=v&&v[0]?v[0]["@com.sap.vocabularies.Common.v1.SemanticObject"]:undefined;if(n){n.forEach(function(e){var t=e["@com.sap.vocabularies.Common.v1.SemanticObject"];if(typeof t==="object"){t=C(T(t.$Path))}if(e["@com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"]){var a={semanticObject:t,actions:e["@com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"]};m.push(a)}if(e["@com.sap.vocabularies.Common.v1.SemanticObjectMapping"]){var n=[];e["@com.sap.vocabularies.Common.v1.SemanticObjectMapping"].forEach(function(e){n.push({key:e.LocalProperty.$PropertyPath,value:e.SemanticObjectProperty})});var r={semanticObject:t,items:n};l.push(r)}});return JSON.stringify({name:e,payload:{semanticObjects:a,entityType:t,semanticObjectUnavailableActions:m,semanticObjectMappings:l,semanticPrimaryActions:[],mainSemanticObject:f,propertyPathLabel:s,dataField:r,contact:i,navigationPath:c,hasQuickViewFacets:u!==null?u:false}})}else{return JSON.stringify({name:e,payload:{semanticObjects:a,entityType:t,semanticObjectUnavailableActions:m,semanticObjectMappings:l,semanticPrimaryActions:[],mainSemanticObject:f,propertyPathLabel:s,dataField:r,contact:i,navigationPath:c,hasQuickViewFacets:u!==null?u:false}})}})},computeFieldBaseDelegate:function(e,t){if(t){return JSON.stringify({name:e,payload:{retrieveTextFromValueList:t}})}return"{name: '".concat(e,"'}")},_getPrimaryIntents:function(t){var a=[];if(t){var n=sap.ushell&&sap.ushell.Container;var r=n&&n.getService("CrossApplicationNavigation");t.forEach(function(e){if(typeof e==="string"){a.push(r.getPrimaryIntent(e,{}))}})}return Promise.all(a).then(function(e){return e}).catch(function(t){e.error("Error fetching primary intents",t);return[]})},_SemanticObjectsHasPrimaryAction:function(e,a){var n=function(e,t,a){for(var n in e.semanticObjectUnavailableActions[a].actions){if(t.intent.split("-")[1].indexOf(e.semanticObjectUnavailableActions[a].actions[n])===0){return false}}return true};e.semanticPrimaryActions=a;var r=e.semanticObjects&&e.mainSemanticObject&&e.semanticPrimaryActions[e.semanticObjects.indexOf(e.mainSemanticObject)];var i=t.getHash();if(e.mainSemanticObject&&r!==null&&r.intent!==i){for(var o in e.semanticObjectUnavailableActions){if(e.mainSemanticObject.indexOf(e.semanticObjectUnavailableActions[o].semanticObject)===0){return n(e,r,o)}}return true}else{return false}},checkPrimaryActions:function(t,a){var n=this;return this._getPrimaryIntents(t&&t.semanticObjects).then(function(e){return a?{titleLink:e,hasTitleLink:n._SemanticObjectsHasPrimaryAction(t,e)}:n._SemanticObjectsHasPrimaryAction(t,e)}).catch(function(t){e.error("Error in checkPrimaryActions",t)})},_getTitleLinkWithParameters:function(e,t){if(e&&e.titlelink){return e.titlelink}else{return t}},getPrimaryAction:function(e){return e.semanticPrimaryActions[e.semanticObjects.indexOf(e.mainSemanticObject)].intent?M._getTitleLinkWithParameters(e,e.semanticPrimaryActions[e.semanticObjects.indexOf(e.mainSemanticObject)].intent):e.primaryIntentAction},operators:function(e,a,n,r,o){if(!a||!o){return undefined}var c;var s=e.getInterface(0).getModel(1).createBindingContext(e.getInterface(0).getPath(1));var l=M.propertyName(a,{context:s});var u=s.getModel(),v=s.getPath(),f=m.getLocationForPropertyPath(u,v),p=a.$Type;if(p==="Edm.Guid"){return t.getOperatorsForGuidProperty()}o=o.slice(0,-1);var g=o.lastIndexOf("/")>0;var d=g&&o!==f||!g&&f.lastIndexOf("/")>0;var b=d&&f.substr(f.indexOf(o)+o.length+1)||"";var O=d&&b+"/"+l||l;if(!g){if(!d){c=t.getOperatorsForProperty(l,f,s,p,n,r)}else{c=t.getOperatorsForProperty(O,o,s,p,n,r)||t.getOperatorsForProperty(l,f,s,p,n,r)}}else if(!d){c=t.getOperatorsForProperty(O,o,s,p,n,r)||t.getOperatorsForProperty(l,i.getEntitySetPath(o),s,p,n,r);return c}else{c=t.getOperatorsForProperty(O,o,s,p,n,r)||t.getOperatorsForProperty(O,i.getEntitySetPath(o),s,p,n,r)}if(!c&&(p==="Edm.Date"||p==="Edm.DateTimeOffset")){c=t.getOperatorsForDateProperty(p)}return c},getPropertyContextForQuickViewForm:function(e){if(e.getObject("Value")!==undefined){var t=e.getInterface(),a=t.getModel();var n=t.getPath();n=n+(n.endsWith("/")?"Value":"/Value");return a.createBindingContext(n)}else{return e}},getPropertyPathForQuickViewForm:function(e){if(e&&e.getObject("$Path")){var t=e.getInterface(),a=t.getModel();var n=t.getPath();n=n+(n.endsWith("/")?"$Path":"/$Path");return a.createBindingContext(n)}return e},getDataFieldDefault:function(e){var t=e.getModel().getObject("".concat(e.getPath(),"@com.sap.vocabularies.UI.v1.DataFieldDefault"));return t?"".concat(e.getPath(),"@com.sap.vocabularies.UI.v1.DataFieldDefault"):e.getPath()},isDataFieldActionButtonVisible:function(e,t,a,n){return t["@com.sap.vocabularies.UI.v1.Hidden"]!==true&&(a!==true||n!==false)},getPressEventForDataFieldActionButton:function(e,t){var a;var n="Isolated";if(t.InvocationGrouping&&t.InvocationGrouping.$EnumMember==="com.sap.vocabularies.UI.v1.OperationGroupingType/ChangeSet"){n="ChangeSet"}var r=e.navigateAfterAction;r=r==="false"?false:true;var i=e===null||e===void 0?void 0:(a=e.entitySet)===null||a===void 0?void 0:a.getPath().split("/");var o=i[i.length-1];var c={contexts:"${$source>/}.getBindingContext()",invocationGrouping:m.addSingleQuotes(n),model:"${$source>/}.getModel()",label:m.addSingleQuotes(t.Label,true),isNavigable:r,entitySetName:m.addSingleQuotes(o)};return m.generateFunction(".editFlow.invokeAction",m.addSingleQuotes(t.Action),m.objectToString(c))},isNumericDataType:function(e){var t=e;if(t!==undefined){var a=["Edm.Int16","Edm.Int32","Edm.Int64","Edm.Byte","Edm.SByte","Edm.Single","Edm.Decimal","Edm.Double"];return a.indexOf(t)===-1?false:true}else{return false}},isDateOrTimeDataType:function(e){if(e!==undefined){var t=["Edm.DateTimeOffset","Edm.DateTime","Edm.Date","Edm.TimeOfDay","Edm.Time"];return t.indexOf(e)>-1}else{return false}},isDateTimeDataType:function(e){if(e!==undefined){var t=["Edm.DateTimeOffset","Edm.DateTime"];return t.indexOf(e)>-1}else{return false}},isDateDataType:function(e){return e==="Edm.Date"},isTimeDataType:function(e){if(e!==undefined){var t=["Edm.TimeOfDay","Edm.Time"];return t.indexOf(e)>-1}else{return false}},getUnderlyingPropertyDataType:function(e,t,a,n){var r="@com.sap.vocabularies.Common.v1.Text",i="@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement";if(!!e&&!!e[i]&&e[i].$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"&&!!e[r]&&!!e[r].$Path){return t.getObject("".concat(a,"/").concat(e[r].$Path,"/$Type"))}return n},getColumnAlignment:function(e,t){var a=t.collection.sPath,n=t.collection.oModel;if((e["$Type"]==="com.sap.vocabularies.UI.v1.DataFieldForAction"||e["$Type"]==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation")&&e.Inline&&e.IconUrl){return"Center"}var r=n.getObject("".concat(a,"/@com.sap.vocabularies.Common.v1.SemanticKey"));if(e["$Type"]==="com.sap.vocabularies.UI.v1.DataField"){var i=e.Value.$Path;var o=r&&!r.every(function(e){return e.$PropertyPath!==i});if(o){return"Begin"}}return M.getDataFieldAlignment(e,n,a)},getPropertyAlignment:function(e,t,a){var n="Begin";var r=t?t.textAlignMode:"";switch(r){case"Form":if(this.isNumericDataType(e)){n="Begin";if(a){n=O(a,"Begin","End")}}break;default:if(this.isNumericDataType(e)||this.isDateOrTimeDataType(e)){n="Right"}break}return n},getDataFieldAlignment:function(e,t,a,n,r){var i,o="Begin",c,s;if(e["$Type"]==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){i=e.Target.$AnnotationPath;if(e.Target["$AnnotationPath"]&&e.Target["$AnnotationPath"].indexOf("com.sap.vocabularies.UI.v1.FieldGroup")>=0){var l=t.getObject("".concat(a,"/").concat(i));for(var u=0;u<l.Data.length;u++){c=t.getObject("".concat(a,"/").concat(i,"/Data/").concat(u.toString(),"/Value/$Path/$Type"));s=t.getObject("".concat(a,"/").concat(i,"/Data/").concat(u.toString(),"/Value/$Path@"));c=this.getUnderlyingPropertyDataType(s,t,a,c);o=this.getPropertyAlignment(c,n,r);if(o==="Begin"){break}}return o}else if(e.Target["$AnnotationPath"]&&e.Target["$AnnotationPath"].indexOf("com.sap.vocabularies.UI.v1.DataPoint")>=0&&t.getObject("".concat(a,"/").concat(i,"/Visualization/$EnumMember"))==="com.sap.vocabularies.UI.v1.VisualizationType/Rating"){return o}else{c=t.getObject("".concat(a,"/").concat(i,"/$Type"));if(c==="com.sap.vocabularies.UI.v1.DataPointType"){c=t.getObject("".concat(a,"/").concat(i,"/Value/$Path/$Type"));s=t.getObject("".concat(a,"/").concat(i,"/Value/$Path@"));c=this.getUnderlyingPropertyDataType(s,t,a,c)}o=this.getPropertyAlignment(c,n,r)}}else{i=e.Value.$Path;c=t.getObject("".concat(a,"/").concat(i,"/$Type"));s=t.getObject("".concat(a,"/").concat(i,"@"));c=this.getUnderlyingPropertyDataType(s,t,a,c);if(!(t.getObject("".concat(a,"/"))["$Key"].indexOf(i)===0)){o=this.getPropertyAlignment(c,n,r)}}return o},getTypeAlignment:function(e,t,a,n,r,i){var o=e.getInterface(0);var c=o.getModel();if(n==="/undefined"&&i&&i.$target){n="/".concat(i.$target.fullyQualifiedName.split("/")[0])}return M.getDataFieldAlignment(t,c,n,a,r)},isDataFieldActionButtonEnabled:function(e,t,a,n){if(t!==true){return"true"}return(a===null?"{= !${#"+e.Action+"} ? false : true }":a)?n:"true"},getLabelTextForDataField:function(e,t,a,n,r,i){var o=e["@com.sap.vocabularies.Common.v1.DraftRoot"];return M.getSemanticKeyTitle(t["@com.sap.vocabularies.Common.v1.Text"]&&a,n,r,t["@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement"],i,o)},retrieveTextFromValueList:function(e,t,a){var n="".concat(e.sPath,"/").concat(t);var r=a.displayMode;m.setMetaModel(e.getModel());return"{= FieldRuntime.retrieveTextFromValueList(%{"+t+"},'"+n+"','"+r+"')}"},computeLabelText:function(e,t){var a=t.context.getModel();var n=t.context.getPath();if(n.endsWith("/")){n=n.slice(0,n.lastIndexOf("/"))}var r=a.getObject("".concat(n,"/Label"));if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){return undefined}if(r){return r}else if(r===""){return""}var i;if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){if(e.Target.$AnnotationPath.indexOf("@com.sap.vocabularies.UI.v1.DataPoint")>-1||e.Target.$AnnotationPath.indexOf("@com.sap.vocabularies.UI.v1.Chart")>-1){i=a.getObject("".concat(n,"/Target/$AnnotationPath@/Title"))}if(e.Target.$AnnotationPath.indexOf("@com.sap.vocabularies.Communication.v1.Contact")>-1){i=a.getObject("".concat(n,"/Target/$AnnotationPath@/fn/$Path@com.sap.vocabularies.Common.v1.Label"))}}if(i){return i}var o;if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){o=a.getObject("".concat(n,"/Target/$AnnotationPath@/Label"))}if(o){return o}var c=a.getObject("".concat(n,"/Value/$Path@com.sap.vocabularies.Common.v1.Label"));if(c){return c}var s;if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){s=a.getObject("".concat(n,"/Target/$AnnotationPath/Value/$Path@com.sap.vocabularies.Common.v1.Label"))}if(s){return s}return""},buildExpressionForAlignItems:function(e){var t=F(e);var a=F("com.sap.vocabularies.UI.v1.VisualizationType/Progress");var n=F("com.sap.vocabularies.UI.v1.VisualizationType/Rating");return C(j(x($(t,a),$(t,n)),F("Center"),j(A.IsEditable,F("Center"),F("Stretch"))))},hasValueHelpAnnotation:function(e){if(e){return e["@com.sap.vocabularies.Common.v1.ValueListReferences"]||e["@com.sap.vocabularies.Common.v1.ValueListMapping"]||e["@com.sap.vocabularies.Common.v1.ValueList"]}},getAPDialogDisplayFormat:function(e,a){var n;var r=a.context.getModel();var i=a.context.getPath();var o=e.$Name||a.context.getProperty("".concat(i,"@sapui.name"));var c=r.getObject("".concat(i,"@"));var s=c["@com.sap.vocabularies.Common.v1.ValueList"]||c["@com.sap.vocabularies.Common.v1.ValueListMapping"]||c["@com.sap.vocabularies.Common.v1.ValueListReferences"];var l=function(e){var t=e.Parameters.find(function(e){return e.LocalDataProperty&&e.LocalDataProperty.$PropertyPath===o});return t&&t.ValueListProperty};var u;if(c["@com.sap.vocabularies.Common.v1.TextArrangement"]||c["@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement"]){return t.computeDisplayMode(c,undefined)}else if(s){if(s.CollectionPath){u=l(s);if(!u){return"Value"}n=r.getObject("/".concat(s.CollectionPath,"/").concat(u,"@"));return n&&n["@com.sap.vocabularies.Common.v1.Text"]?t.computeDisplayMode(n,undefined):"Value"}else{return r.requestValueListInfo(i,true).then(function(e){u=l(e[""]);if(!u){return"Value"}n=e[""].$model.getMetaModel().getObject("/".concat(e[""]["CollectionPath"],"/").concat(u,"@"));return n&&n["@com.sap.vocabularies.Common.v1.Text"]?t.computeDisplayMode(n,undefined):"Value"})}}else{return"Value"}},getActionParameterDialogFieldHelp:function(e,t,a){return this.hasValueHelpAnnotation(e)?P([t,a]):undefined},getFieldValueHelpDelegate:function(e,t,a,n){return m.objectToString({name:m.addSingleQuotes("sap/fe/macros/field/FieldValueHelpDelegate"),payload:{propertyPath:m.addSingleQuotes(v.getPropertyPath({UnboundAction:!e,EntityTypePath:t,Action:a,Property:n}))}})},getValueHelpDelegate:function(e,t,a,n){var r={name:m.addSingleQuotes("sap/fe/macros/valuehelp/ValueHelpDelegate"),payload:{propertyPath:m.addSingleQuotes(v.getPropertyPath({UnboundAction:!e,EntityTypePath:t,Action:a,Property:n})),qualifiers:{},valueHelpQualifier:m.addSingleQuotes(""),isActionParameterDialog:true}};return m.objectToString(r)},getValueHelpDelegateForNonComputedVisibleKeyField:function(e){var t={name:m.addSingleQuotes("sap/fe/macros/valuehelp/ValueHelpDelegate"),payload:{propertyPath:m.addSingleQuotes(e),qualifiers:{},valueHelpQualifier:m.addSingleQuotes("")}};return m.objectToString(t)},_getEntitySetFromMultiLevel:function(e,t,a,n,r){var i=t.split("/").filter(Boolean);i=i.filter(function(e){return e!=="$NavigationPropertyBinding"});if(i.length>0){for(var o=n;o<i.length-r;o++){a="/".concat(e.getObject("".concat(a,"/$NavigationPropertyBinding/").concat(i[o])))}}return a},getPropertyCollection:function(e,t){var a=t&&t.context||e;var n=a.getPath();var r=n.split("/").filter(Boolean);var i=r[0];var o=a.getObject("$Path");var c="/".concat(i);if(n.indexOf("/@com.sap.vocabularies.")>-1){var s=n.indexOf("/@com.sap.vocabularies.");var l=n.substring(0,s);c=M._getEntitySetFromMultiLevel(a,l,c,1,0)}if(o&&o.indexOf("/")>-1){c=M._getEntitySetFromMultiLevel(a,o,c,0,1)}return c},getUnitOrCurrency:function(e){var t=e.getObject();var a=e.sPath;if(t["@Org.OData.Measures.V1.ISOCurrency"]){a="".concat(a,"Org.OData.Measures.V1.ISOCurrency")}else{a="".concat(a,"Org.OData.Measures.V1.Unit")}return a},hasStaticUnitOrCurrency:function(e){return e["@Org.OData.Measures.V1.ISOCurrency"]?!e["@Org.OData.Measures.V1.ISOCurrency"].$Path:!e["@Org.OData.Measures.V1.Unit"].$Path},getStaticUnitOrCurrency:function(e,t){if(t&&t.measureDisplayMode!=="Hidden"){var a=e["@Org.OData.Measures.V1.ISOCurrency"]||e["@Org.OData.Measures.V1.Unit"];var n=g.getDateInstance();var r=n.oLocaleData.mData;if(r&&r.units&&r.units.short&&r.units.short[a]&&r.units.short[a].displayName){return r.units.short[a].displayName}return a}},getEmptyIndicatorTrigger:function(e,t,a){if(a){return e?a:"inactive"}return e?t:"inactive"},getBindingInfoForTextArrangement:function(e,t,a){if(t&&t.$EnumMember&&t.$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"&&a){return"{".concat(a.Value.$Path,"}")}},semanticKeyFormat:function(e,t){t.arguments=[{},{groupingEnabled:false}];return b.format(e,t)},getIsMediaContentTypeNullExpr:function(e,t){t=t||"===";return"{= %{"+e+"@odata.mediaContentType} "+t+" null }"},getPathForIconSource:function(e){return"{= FIELDRUNTIME.getIconForMimeType(%{"+e+"@odata.mediaContentType})}"},getFilenameExpr:function(e,t){if(e){if(e.indexOf("{")===0){return"{= $"+e+" ? $"+e+" : $"+t+"}"}return e}return t},calculateMBfromByte:function(e){return e?(e/(1024*1024)).toFixed(6):undefined},getDownloadUrl:function(e){return e+"{= ${internal>/stickySessionToken} ? ('?SAP-ContextId=' + ${internal>/stickySessionToken}) : '' }"},getMarginClass:function(e){return e==="true"||e===true?"sapMTableContentMargin":undefined},getRequired:function(e,t,a){var n=F(false);if(t!==null){n=h(t===null||t===void 0?void 0:t.targetObject)}return C(x(n,a.indexOf(e)>-1))},isFieldPartOfForm:function(e,t){var a=I.generateKeyFromDataField(t);var n=e.find(function(e){return e.key===a});return n?true:false}};M.buildExpressionForTextValue.requiresIContext=true;M.getFieldGroupIds.requiresIContext=true;M.fieldControl.requiresIContext=true;M.getTypeAlignment.requiresIContext=true;M.getPropertyCollection.requiresIContext=true;M.getAPDialogDisplayFormat.requiresIContext=true;M.operators.requiresIContext=true;M.semanticKeyFormat.requiresIContext=true;M.computeLabelText.requiresIContext=true;M.getFieldHelpPropertyForFilterField.requiresIContext=true;M.retrieveTextFromValueList.requiresIContext=true;M.getActionParameterVisibility.requiresIContext=true;M.computeLinkParameters.requiresIContext=true;return M},false);
//# sourceMappingURL=FieldHelper.js.map