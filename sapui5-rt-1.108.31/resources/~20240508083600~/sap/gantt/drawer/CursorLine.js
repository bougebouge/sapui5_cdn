/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/core/Core","sap/ui/Device","sap/gantt/misc/Format","sap/gantt/drawer/Drawer","sap/gantt/misc/Utility","../simple/GanttUtils","sap/ui/core/theming/Parameters","sap/ui/thirdparty/d3"],function(e,t,r,a,n,i,o){"use strict";var s=a.extend("sap.gantt.drawer.CursorLine");s.prototype.drawSvg=function(e,t,r,a){this._oLocale=r;var i=jQuery(n.attributeEqualSelector("id",a.svgId)).offset().left;var o=[];e.each(function(e,t){var r=jQuery(this),n=r.offset();o.push({x:a.x+i-n.left,y:a.y,svgId:r.attr("id"),svgHeight:r.height()})});var s=this;t.each(function(e,t){var r=s._createHeaderTopG(d3.select(this));var a=null;a=r[0]["parentNode"].getElementById("inner-header-svg");var n=null,i=null;var u=r[0]["parentNode"].getElementById("inner-header-g");if(u!==null){n=r[0]["parentNode"].getElementById("inner-header-g").style.height}if(n!==null){i=n.split("px")}if(i!==null){s._drawHeaderLabel(r,o[t],a,parseInt(i[0],10))}else{s._drawHeaderLabel(r,o[t],null,0)}});e.each(function(e,t){var r=s._createBodyTopG(d3.select(this));s._drawCursorLine(r,o[t])})};s.prototype._createBodyTopG=function(e){var t=e.selectAll(".cursorline-top").data(function(){return[{svgHeight:jQuery(this.parentNode).height()}]});t.enter().append("g").classed("cursorline-top",true);t.exit().remove();return t};s.prototype._drawCursorLine=function(e,t){var r=e.selectAll("path").data(function(e){return[{svgHeight:e.svgHeight,x:t.x,y:t.y}]});r.enter().append("path").classed("sapGanttCursorLineBody",true);r.attr("d",function(e){return"M"+e.x+",0v"+e.svgHeight+"h1h-1"});r.exit().remove()};s.prototype._createHeaderTopG=function(e){var t=e.selectAll(".cursorline-header-top").data(function(){return[{svgHeight:jQuery(this.parentNode).height()}]});t.enter().append("g").classed("cursorline-header-top",true);t.exit().remove();return t};s.prototype._drawHeaderLabel=function(e,t,a,n){var s=this;var u=this._getAxisTime(t.svgId);var l=t.x;var p=t.y;var d;var c=function(e){return s._getTimeLabel(r.dateToAbapTimestamp(u.viewToTime(e)),s._oLocale,u)};var g=e.selectAll("rect").data(function(e){if(a!==null){d=e.svgHeight-n}else{d=e.svgHeight}return[{svgHeight:d,svgId:e.svgId,x:l,y:p}]});g.enter().append("rect").classed("sapGanttCursorLineHeader",true);g.attr("width",function(e){var t=c(e.x),r=i.getShapeTextWidth(t,parseInt(o.get("sapUiFontSmallSize"),10),"Arial","normal");return r<64?64:r+10}).attr("height",function(e){return e.svgHeight>80?30:25}).attr("x",function(e){return e.x-parseFloat(g.attr("width"))/2}).attr("y",function(e){return e.svgHeight-parseFloat(g.attr("height"))-5});g.exit().remove();if(a!==null){var v=e.selectAll("path").data(function(e){return[{svgHeight:n,x:l,y:p}]});v.enter().append("path").classed("sapGanttCursorLineBody",true);v.attr("d",function(e){var t=l;return"M"+t+","+d+"v"+n+"h1h-1"});v.exit().remove()}var h=e.selectAll("text").data(function(e){return[{x:parseFloat(g.attr("x"))+parseFloat(g.attr("width")/2),y:parseFloat(g.attr("y"))+parseFloat(g.attr("height")/2)}]});h.enter().append("text").classed("sapGanttCursorLineLabel",true);h.attr("x",function(e){return e.x}).attr("y",function(e){return e.y}).text(function(e){return c(e.x)});h.exit().remove()};s.prototype.destroySvg=function(e,t){e.selectAll(".cursorline-top").remove();t.selectAll(".cursorline-header-top").remove()};s.prototype._getAxisTime=function(e){var t=n.attributeEqualSelector("id",e);var r=jQuery(t);var a=null;if(r){a=r.control(0,true).getAxisTime()}return a};s.prototype._getTimeLabel=function(e,t,a){var i=r._convertUTCToLocalTime(e,t),o=a.getZoomStrategy();var s=n.getFormattedDate(o.getLowerRowFormatter(),i);return n.getLowerCaseLabel(s)};return s},true);
//# sourceMappingURL=CursorLine.js.map