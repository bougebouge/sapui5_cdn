/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/gantt/drawer/Drawer","sap/ui/core/Core","sap/ui/core/IconPool","sap/ui/Device","sap/ui/thirdparty/d3"],function(t,e,n,a){"use strict";var r=t.extend("sap.gantt.drawer.SelectionPanel");r.prototype.drawSvg=function(t,e,n,a){if(!e){return}this._oGanttChartWithTable=a;var r=[];for(var i=0;i<e.length;i++){if(e[i].index&&e[i].index!==0){r.push(e[i])}}var o=t.selectAll(".sapGanttSelectionPanel");if(o.empty()){o=t.append("g").classed("sapGanttSelectionPanel",true)}if(!o.empty()){var d=jQuery(t.node()).width();var u=a._oGanttChart._composeChartSchemeBackgroundConfig();this._drawExpandedBackground(o,d,n,r,u);this._drawExpandedContent(o,d,n,r)}};r.prototype._drawExpandedBackground=function(t,n,a,r,i){var o=t.selectAll(".sapGanttExpandChartHeader").data(r);o.enter().append("rect").classed("sapGanttExpandChartHeader",true);o.attr("x",function(){return e.getConfiguration().getRTL()?n-a+1:2}).attr("y",function(t){return t.y}).attr("height",function(t){return t.rowHeight-1}).attr("width",a-2).attr("class",function(t){var e=i?i[t.chartScheme]:undefined;if(e&&e!==""){return"sapGanttExpandChartHeader "+e}else{return"sapGanttExpandChartHeader sapGanttExpandChartHeaderBG"}});o.exit().remove();var d=t.selectAll(".sapGanttExpandChartCnt").data(r);d.enter().append("rect").classed("sapGanttExpandChartCnt",true);d.attr("x",function(){return e.getConfiguration().getRTL()?2:a+1}).attr("y",function(t){return t.y}).attr("height",function(t){return t.rowHeight-1}).attr("width",n-a-3).attr("class",function(t){var e=i?i[t.chartScheme]:undefined;if(e&&e!==""){return"sapGanttExpandChartCnt "+e}else{return"sapGanttExpandChartCnt sapGanttExpandChartCntBG"}});d.exit().remove();var u=t.selectAll("path.sapGanttExpandChartLine").data(r);u.enter().append("path").classed("sapGanttExpandChartLine",true);u.attr("d",function(t){return"M0 "+(t.y-1)+" H"+(n-1)});u.exit().remove()};r.prototype._drawExpandedContent=function(t,r,i,o){var d=this._getLevelIndentByShape;var u=[];for(var c=0;c<o.length;c++){if(o[c].index===1){var s=[];s.push(o[c]);u.push(s)}}t.selectAll("g").remove();var p=t.selectAll("g").data(u);p.enter().append("g").classed("sapGanttExpandChartContent",true);p.exit().remove();var l=p.selectAll(".sapGanttExpandChartIcon").data(function(t){return t});l.enter().append(function(t){if(n.isIconURI(t.icon)){return document.createElementNS(d3.ns.prefix.svg,"text")}return document.createElementNS(d3.ns.prefix.svg,"image")}).classed("sapGanttExpandChartIcon",true).classed("iconFont",function(t){return n.isIconURI(t.icon)}).classed("iconImage",function(t){return!n.isIconURI(t.icon)});p.selectAll(".iconImage").attr("xlink:href",function(t){return t.icon}).attr("x",function(t){return e.getConfiguration().getRTL()?r-i-d(t)-17:d(t)+i}).attr("y",function(t){return t.y+4.25}).attr("width",16).attr("height",16);p.selectAll(".iconFont").attr("x",function(t){return e.getConfiguration().getRTL()?r-i-d(t):d(t)+i}).attr("y",function(t){return t.y+19}).text(function(t){var e=n.getIconInfo(t.icon);if(e){return e.content}}).attr("font-family",function(t){var e=n.getIconInfo(t.icon);if(e){return e.fontFamily}}).attr("font-size","16px");l.exit().remove();var f=p.selectAll("sapGanttExpandChartText").data(function(t){return t});f.enter().append("text").classed("sapGanttExpandChartText",true);f.attr("x",function(t){return e.getConfiguration().getRTL()?r-i-d(t)-26:d(t)+i+27}).attr("y",function(t){return t.y+16.5}).attr("font-size",function(t){return"0.75em"}).text(function(t){return t.name}).attr("text-anchor",a.browser.edge&&e.getConfiguration().getRTL()?"end":"start");f.exit().remove();var h=this;var g=p.selectAll(".sapGanttExpandChartCloseButton").data(function(t){return t});g.enter().append("text").classed("sapGanttExpandChartCloseButton",true);g.attr("x",function(t){var n,a=jQuery(this).prev("text");if(a&&a.length>0){var o=a[0].getBoundingClientRect();if(o&&o.width>0){n=o.width}else{n=a[0].clientWidth}}if(isNaN(n)||n==null||n==0){n=60}var u=e.getConfiguration().getRTL()?r-i-d(t)-n-37:d(t)+i+n+35;return u}).attr("y",function(t){return t.y+19}).text(function(t){var e=n.getIconInfo("decline",undefined);if(e){return e.content}}).attr("font-family",function(t){var e=n.getIconInfo("decline",undefined);if(e){return e.fontFamily}}).attr("font-size","14px").attr("font-weight","bolder").on("click",function(t){var e=h._oGanttChartWithTable._oTT.getBinding("rows");var n=e.getContexts(0,e.getLength());var a=h._oGanttChartWithTable.getRowIdName();for(var r=0;r<n.length;r++){var i=n[r].getProperty();if(i&&t.id&&i[a]===t.id){h._oGanttChartWithTable.handleExpandChartChange(false,[t.chartScheme],[r])}}});g.select("title").remove();g.insert("title",":first-child").text(function(t){return sap.ui.getCore().getLibraryResourceBundle("sap.gantt").getText("TLTP_CLOSE")});g.exit().remove()};r.prototype._getLevelIndentByShape=function(t){var e=13;var n=17;var a=25;var r=0;if(t&&t.bindingObj&&t.bindingObj._aRowIndexMap&&t.rowIndex&&t.rowIndex<t.bindingObj._aRowIndexMap.length){r=t.bindingObj._aRowIndexMap[t.rowIndex].level}if(isNaN(r)||r==null){r=0}return n*r+a+e};return r},true);
//# sourceMappingURL=SelectionPanel.js.map