/*!
 * OpenUI5
 * (c) Copyright 2009-2024 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["../library","sap/base/util/restricted/_omit","sap/ui/core/Control","sap/ui/model/json/JSONModel","./getContainerUserInfo","sap/base/util/extend","sap/base/util/restricted/_CancelablePromise","sap/base/security/URLListValidator","sap/base/Log","./IFrameRenderer","sap/ui/core/library"],function(e,t,i,r,s,o,a,n,l,u){"use strict";function p(e){if(e.parts&&e.formatter){return e.formatter.apply(null,e.parts.map(function(e){if(e.model){return"{"+e.model+">"+e.path+"}"}return"{"+e.path+"}"}))}return e}var c=i.extend("sap.ui.fl.util.IFrame",{metadata:{library:"sap.ui.fl",properties:{url:{type:"sap.ui.core.URI",group:"Misc",defaultValue:""},width:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"100%"},title:{type:"string",group:"Misc",defaultValue:undefined},asContainer:{type:"boolean",group:"Misc",defaultValue:undefined},renameInfo:{type:"object",group:"Data",defaultValue:null},useLegacyNavigation:{type:"boolean",defaultValue:false},_settings:{type:"object",group:"Data",defaultValue:null}},designtime:"sap/ui/fl/designtime/util/IFrame.designtime"},init:function(){if(i.prototype.init){i.prototype.init.apply(this,arguments)}this._oInitializePromise=s().then(function(e){this._oUserModel=new r(e);this.setModel(this._oUserModel,"$user")}.bind(this))},waitForInit:function(){return this._oInitializePromise?this._oInitializePromise:Promise.reject()},_setUrlLegacy:function(e){if(this._oSetUrlPromise){this._oSetUrlPromise.cancel();delete this._oSetUrlPromise}this.setProperty("url","");this._oSetUrlPromise=new a(function(e,t,i){i.shouldReject=false;setTimeout(e,0)});this._oSetUrlPromise.then(function(){delete this._oSetUrlPromise;this.setProperty("url",e)}.bind(this))},setUrl:function(e){var t=decodeURI(e)===e?encodeURI(e):e;if(c.isValidUrl(t)){if(this.getUseLegacyNavigation()){this._setUrlLegacy(t)}else{this.setProperty("url",t)}}else{l.error("Provided URL is not valid as an IFrame src")}return this},_replaceIframeLocation:function(e){this.getDomRef().contentWindow.location.replace(e)},onAfterRendering:function(){if(!this.getUseLegacyNavigation()){this._replaceIframeLocation("about:blank");this._replaceIframeLocation(this.getUrl())}},applySettings:function(e){if(e){var r=t(e,["url"]);var s=Array.from(arguments).slice(1);s.unshift(r);i.prototype.applySettings.apply(this,s);if(e.url){i.prototype.applySettings.apply(this,[{url:e.url}])}var a=this.getProperty("_settings")||{};if(e._settings){o(a,e._settings)}else{Object.keys(e).filter(function(t){return!!e[t]}).forEach(function(t){a[t]=p(e[t])})}this.setProperty("_settings",a)}else{i.prototype.applySettings.apply(this,arguments)}},exit:function(){if(this._oUserModel){this._oUserModel.destroy();delete this._oUserModel}},renderer:u});c.isValidUrl=function(e){return!n.entries().some(function(e){return/javascript/i.test(e.protocol)})&&n.validate(e)};return c});
//# sourceMappingURL=IFrame.js.map