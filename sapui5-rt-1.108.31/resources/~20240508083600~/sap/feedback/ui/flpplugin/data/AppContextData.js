/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/base/Object","sap/base/Log","sap/ushell/services/AppConfiguration","../utils/Constants","../utils/Utils","../utils/UI5Utils"],function(t,a,e,p,n,i){"use strict";return t.extend("sap.feedback.ui.flpplugin.data.AppContextData",{_dataV1:null,_dataV2:null,constructor:function(){},getData:function(t){return this._updateData().then(function(){if(t===p.E_DATA_FORMAT.version1){return this._dataV1}else if(t===p.E_DATA_FORMAT.version2){return this._dataV2}return null}.bind(this))},_updateData:function(){this._resetData();return this._collectData().then(function(t){this._setData(t)}.bind(this),function(){this._resetData()}.bind(this))},_resetData:function(){this._dataV1={ui5Version:p.S_DEFAULT_VALUE,ui5Theme:p.S_DEFAULT_VALUE,fioriId:p.S_DEFAULT_VALUE,appTitle:p.S_DEFAULT_VALUE,language:p.S_DEFAULT_VALUE,componentId:p.S_DEFAULT_VALUE,appVersion:p.S_DEFAULT_VALUE,ach:p.S_DEFAULT_VALUE};this._dataV2={appFrameworkId:p.S_DEFAULT_VALUE,appFrameworkVersion:p.S_DEFAULT_VALUE,theme:p.S_DEFAULT_VALUE,appId:p.S_DEFAULT_VALUE,appTitle:p.S_DEFAULT_VALUE,languageTag:p.S_DEFAULT_VALUE,technicalAppComponentId:p.S_DEFAULT_VALUE,appVersion:p.S_DEFAULT_VALUE,appSupportInfo:p.S_DEFAULT_VALUE}},_setData:function(t){this._dataV1={ui5Version:t.appFrameworkVersion,ui5Theme:t.theme,fioriId:t.appId,appTitle:t.appTitle,language:t.languageTag,componentId:t.technicalAppComponentId,appVersion:t.appVersion,ach:t.appSupportInfo};this._dataV2=t},_getLanguage:function(t){if(t){var a=t.getLanguage();if(a&&a.length===2){return a.toUpperCase()}}return i.getLanguage().toUpperCase()},_collectData:function(){return new Promise(function(t,e){var o=i.getCurrentApp();if(n.isSupportedAppType(o)){this._collectionAppInfoData(o).then(function(a){var e=this._assignAppInfoData(a);t(e)}.bind(this))}else{a.warning("App not of a supported app type.",null,p.S_PLUGIN_APPCONTEXTDATA_NAME);e()}}.bind(this))},_collectionAppInfoData:function(t){return new Promise(function(a,i){var o=["appId","appVersion","appSupportInfo","technicalAppComponentId","appFrameworkId","appFrameworkVersion"];t.getInfo(o).then(function(t){var i=e.getMetadata();if(i&&i.title){t.appTitle=i.title}if(t.appId&&t.appId===p.S_LAUNCHPAD_VALUE){t.appTitle=n.stringToTitleCase(t.appId)}a(t)}).catch(function(t){i(t)})})},_assignAppInfoData:function(t){var a={};var e=i.getUserInfo();if(e){var o=e.getUser();if(o){a.languageTag=this._getLanguage(o)}}a.theme=i.getTheme();if(t){a.appFrameworkId=n.convertAppFrameworkTypeToId(t["appFrameworkId"])||p.S_DEFAULT_VALUE;a.appFrameworkVersion=t["appFrameworkVersion"]||p.S_DEFAULT_VALUE;a.appId=t["appId"]||p.S_DEFAULT_VALUE;a.appTitle=t["appTitle"]||p.S_DEFAULT_VALUE;a.technicalAppComponentId=t["technicalAppComponentId"]||p.S_DEFAULT_VALUE;a.appVersion=t["appVersion"]||p.S_DEFAULT_VALUE;a.appSupportInfo=t["appSupportInfo"]||p.S_DEFAULT_VALUE}return a}})});
//# sourceMappingURL=AppContextData.js.map