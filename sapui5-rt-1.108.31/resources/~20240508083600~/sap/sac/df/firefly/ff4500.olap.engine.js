/*!
 * SAPUI5
    (c) Copyright 2009-2021 SAP SE. All rights reserved
  
 */
sap.ui.define(["sap/sac/df/firefly/ff2100.runtime","sap/sac/df/firefly/ff4050.processor","sap/sac/df/firefly/ff4200.olap.api","sap/sac/df/firefly/ff3500.sql"],function(e){"use strict";e.Aggregation=function(){};e.Aggregation.prototype=new e.XObject;e.Aggregation.prototype._ff_c="Aggregation";e.Aggregation.create=function(t,r){var i=new e.Aggregation;i.m_name=t;i.m_def=r;return i};e.Aggregation.prototype.m_name=null;e.Aggregation.prototype.m_def=0;e.Aggregation.prototype.getName=function(){return this.m_name};e.Aggregation.prototype.getDefaultValue=function(){return this.m_def};e.OlapDimension=function(){};e.OlapDimension.prototype=new e.XObject;e.OlapDimension.prototype._ff_c="OlapDimension";e.OlapDimension.prototype.m_name=null;e.OlapDimension.prototype.m_type=null;e.OlapDimension.prototype.m_member=null;e.OlapDimension.prototype.getMembers=function(){return this.m_member};e.OlapDimension.prototype.setMembers=function(e){this.m_member=e};e.OlapDimension.prototype.getName=function(){return this.m_name};e.OlapDimension.prototype.setName=function(e){this.m_name=e};e.OlapDimension.prototype.getType=function(){return this.m_type};e.OlapDimension.prototype.setType=function(e){this.m_type=e};e.OlapDimensionMember=function(){};e.OlapDimensionMember.prototype=new e.XObject;e.OlapDimensionMember.prototype._ff_c="OlapDimensionMember";e.OlapDimensionMember.create=function(t){var r=new e.OlapDimensionMember;r.setName(t);r.setAggregation(e.Aggregation.create("avg",0));return r};e.OlapDimensionMember.prototype.name=null;e.OlapDimensionMember.prototype.aggregation=null;e.OlapDimensionMember.prototype.m_displayName=null;e.OlapDimensionMember.prototype.m_rawvalue=null;e.OlapDimensionMember.prototype.getAggregation=function(){return this.aggregation};e.OlapDimensionMember.prototype.setAggregation=function(e){this.aggregation=e};e.OlapDimensionMember.prototype.getName=function(){return this.name};e.OlapDimensionMember.prototype.setName=function(t){if(e.XStringUtils.containsString(t," ",true)){throw e.XException.createIllegalArgumentException("name contains a space")}this.name=t};e.OlapDimensionMember.prototype.getDisplayName=function(){return e.isNull(this.m_displayName)?this.name:this.m_displayName};e.OlapDimensionMember.prototype.setDisplayName=function(e){this.m_displayName=e};e.OlapDimensionMember.prototype.getRawValue=function(){return this.m_rawvalue};e.OlapDimensionMember.prototype.setRawValue=function(e){this.m_rawvalue=e};e.OlapFilterToSqlConverter=function(){};e.OlapFilterToSqlConverter.prototype=new e.XObject;e.OlapFilterToSqlConverter.prototype._ff_c="OlapFilterToSqlConverter";e.OlapFilterToSqlConverter.prototype.evaluateSelection=function(t){var r=t.getStructureByKey("SetOperand");if(e.notNull(r)){return this.convertSetOperand(r)}var i=t.getStructureByKey("Operator");if(e.notNull(i)){return this.convertOperator(i)}var a=t.getStructureByKey("TuplesOperand");if(e.notNull(a)){return this.convertTuplesOperand(a)}return null};e.OlapFilterToSqlConverter.prototype.convertTuplesOperand=function(t){var r=null;var i=t.getListByKey("FieldNames");var a=t.getListByKey("Tuples");for(var n=0;n<a.size();n++){var l=null;var s=a.getListAt(n);if(i.size()!==s.size()){throw e.XException.createIllegalArgumentException(e.SqlOperation.format("Invalid TuplesOperand structure '{0}': expected '{1}' and '{2}' to have the same length",e.StringListBuilder.create().add(t.toString()).add(i.toString()).add(s.toString()).build()))}for(var o=0;o<i.size();o++){var u=this.convertOlapFieldNameToSql(i.getStringAt(o));var c=e.SqlOperation.equals(e.SqlReference.create(u),e.SqlStringConstant.create(s.getStringAt(o)));if(e.notNull(l)){l=e.SqlOperation.and(l,c)}else{l=c}}if(e.notNull(r)){r=e.SqlOperation.or(r,l)}else{r=l}}return r};e.OlapFilterToSqlConverter.prototype.convertOperator=function(t){var r=null;var i=t.getStringByKey("Code");var a=t.getListByKey("SubSelections");for(var n=0;n<a.size();n++){var l=this.evaluateSelection(a.getStructureAt(n));if(n===0){if(e.XString.isEqual(i,"Not")){r=e.SqlOperation.not(l)}else{r=l}}else if(e.XString.isEqual(i,"And")){r=e.SqlOperation.and(r,l)}else if(e.XString.isEqual(i,"Or")){r=e.SqlOperation.or(r,l)}else{throw e.XException.createIllegalArgumentException(e.SqlOperation.format("Invalid Operator {0} for multiple arguments",e.StringListBuilder.create().add(i).build()))}}if(e.isNull(r)){throw e.XException.createIllegalArgumentException(e.SqlOperation.format("Invalid Operator {0} for zero arguments",e.StringListBuilder.create().add(i).build()))}return r};e.OlapFilterToSqlConverter.prototype.convertSetOperand=function(t){var r=null;var i=null;var a=t.getListByKey("Elements");var n=this.convertOlapFieldNameToSql(t.getStringByKey("FieldName"));for(var l=0;l<a.size();l++){var s=a.getStructureAt(l).getStringByKey("Comparison");var o=a.getStructureAt(l).getBooleanByKey("IsExcluding");var u=null;var c=null;var p=a.getStructureAt(l).getStringByKey("Low");if(e.notNull(p)){c=e.SqlStringConstant.create(p)}if(e.isNull(c)){throw e.XException.createIllegalArgumentException("Low of setoperand is empty")}if(e.XString.isEqual(s,"=")){u=e.SqlOperation.equals(e.SqlReference.create(n),c)}else if(e.XString.isEqual(s,"<>")){u=e.SqlOperation.not(e.SqlOperation.equals(e.SqlReference.create(n),c))}else if(e.XString.isEqual(s,"<")){u=e.SqlOperation.less(e.SqlReference.create(n),c)}else if(e.XString.isEqual(s,"<=")){u=e.SqlOperation.lessEqual(e.SqlReference.create(n),c)}else if(e.XString.isEqual(s,">")){u=e.SqlOperation.greater(e.SqlReference.create(n),c)}else if(e.XString.isEqual(s,">=")){u=e.SqlOperation.greaterEqual(e.SqlReference.create(n),c)}else if(e.XString.isEqual(s,"LIKE")||e.XString.isEqual(s,"MATCH")){if(e.notNull(p)){c=e.SqlStringConstant.create(e.XString.replace(e.XString.replace(p,"*","%"),"?","_"))}u=e.SqlOperation.like(e.SqlReference.create(n),c)}else if(e.XString.isEqual(s,"NOT_MATCH")){if(e.notNull(p)){c=e.SqlStringConstant.create(e.XString.replace(e.XString.replace(p,"*","%"),"?","_"))}u=e.SqlOperation.not(e.SqlOperation.like(e.SqlReference.create(n),c))}if(e.notNull(u)){if(o){if(e.isNull(i)){i=e.SqlOperation.not(u)}else{i=e.SqlOperation.and(i,e.SqlOperation.not(u))}}else{if(e.isNull(r)){r=u}else{r=e.SqlOperation.or(r,u)}}}}if(e.notNull(i)){if(e.isNull(r)){return i}else{return e.SqlOperation.and(r,i)}}return r};e.OlapFilterToSqlConverter.prototype.convertOlapFieldNameToSql=function(t){return e.XString.substring(t,0,e.XString.lastIndexOf(t,"."))};e.OlapFormulaToSql={convert:function(t){var r=t.getStructureByKey("Function");if(e.notNull(r)){return e.OlapFormulaToSql.convertFunction(r)}var i=t.getStructureByKey("Constant");if(e.notNull(i)){return e.OlapFormulaToSql.convertConstant(i)}var a=t.getStructureByKey("Member");if(e.notNull(a)){return e.OlapFormulaToSql.convertMember(a)}return null},convertMember:function(t){var r=t.getStringByKey("Name");return e.SqlAggregateFunction.create("sum",e.SqlReference.create(r)).toSqlString(new e.SqlCodeGenOptions)},convertConstant:function(t){var r=t.getStringByKey("ValueType");if(e.XString.isEqual(r,"Number")){var i=t.getDoubleByKey("Value");return e.SqlDoubleConstant.create(i).toSqlString(new e.SqlCodeGenOptions)}if(e.XString.isEqual(r,"String")){var a=t.getStringByKey("Value");return e.SqlStringConstant.create(a).toSqlString(new e.SqlCodeGenOptions)}return null},convertFunction:function(t){var r=e.XString.toUpperCase(t.getStringByKey("Name"));var i=t.getListByKey("Parameters");var a=e.StringListBuilder.create().add("+").add("-").add("*").add("/").add("<").add(">").add("<=").add(">=").add("!=").build();var n;for(n=0;n<a.size();n++){if(e.XString.isEqual(r,a.get(n))){return e.SqlOperation.format("({0}) {1} ({2})",e.StringListBuilder.create().add(e.OlapFormulaToSql.convert(i.getStructureAt(0))).add(r).add(e.OlapFormulaToSql.convert(i.getStructureAt(1))).build())}}var l=(new e.StringMapBuilder).init().put("==",e.XStringValue.create("=")).put("AND",e.XStringValue.create("&")).put("OR",e.XStringValue.create("|")).put("XOR",e.XStringValue.create("^")).build();for(n=0;n<l.size();n++){if(e.XString.isEqual(r,l.getKeysAsReadOnlyListOfString().get(n))){return e.SqlOperation.format("({0}) {1} ({2})",e.StringListBuilder.create().add(e.OlapFormulaToSql.convert(i.getStructureAt(0))).add(l.getValuesAsReadOnlyList().get(n).getString()).add(e.OlapFormulaToSql.convert(i.getStructureAt(1))).build())}}var s=(new e.StringMapBuilder).init().put("**",e.SqlFunctionDescription.create("POWER",2)).put("LOG",e.SqlFunctionDescription.create("LOG",1)).put("EXP",e.SqlFunctionDescription.create("EXP",1)).put("ROUND",e.SqlFunctionDescription.create("ROUND",1)).put("FLOOR",e.SqlFunctionDescription.create("FLOOR",1)).put("CEIL",e.SqlFunctionDescription.create("CEIL",1)).put("SQRT",e.SqlFunctionDescription.create("SQRT",1)).put("LOG10",e.SqlFunctionDescription.create("LOG10",1)).put("ABS",e.SqlFunctionDescription.create("ABS",1)).put("TRUNCATE",e.SqlFunctionDescription.create("TRUNC",1)).put("SIN",e.SqlFunctionDescription.create("SIN",1)).put("COS",e.SqlFunctionDescription.create("COS",1)).put("TAN",e.SqlFunctionDescription.create("TAN",1)).put("ASIN",e.SqlFunctionDescription.create("ASIN",1)).put("ACOS",e.SqlFunctionDescription.create("ACOS",1)).put("ATAN",e.SqlFunctionDescription.create("ATAN",1)).put("SINH",e.SqlFunctionDescription.create("SINH",1)).put("COSH",e.SqlFunctionDescription.create("COSH",1)).put("TANH",e.SqlFunctionDescription.create("TANH",1)).put("DIV",e.SqlFunctionDescription.create("DIV",1)).put("NOT",e.SqlFunctionDescription.create("~",1)).put("SIGN",e.SqlFunctionDescription.create("SIGN",1)).put("MOD",e.SqlFunctionDescription.create("MOD",2)).build();for(n=0;n<s.size();n++){if(e.XString.isEqual(r,s.getKeysAsReadOnlyListOfString().get(n))){var o=e.XStringBuffer.create();var u=s.getValuesAsReadOnlyList().get(n);o.append(u.getName());o.append("(");for(var c=0;c<u.getArgs();c++){if(c!==0){o.append(",")}o.append(e.OlapFormulaToSql.convert(i.getStructureAt(0)))}o.append(")")}}if(e.XString.isEqual(r,"IF")){return e.SqlOperation.format("CASE WHEN ({0}) THEN ({1}) ELSE ({2}) END",e.StringListBuilder.create().add(e.OlapFormulaToSql.convert(i.getStructureAt(0))).add(e.OlapFormulaToSql.convert(i.getStructureAt(1))).add(e.OlapFormulaToSql.convert(i.getStructureAt(2))).build())}if(e.XString.isEqual(r,"MAX")){return e.SqlOperation.format("CASE WHEN ({0}) > ({1}) THEN ({0}) ELSE ({1}) END",e.StringListBuilder.create().add(e.OlapFormulaToSql.convert(i.getStructureAt(0))).add(e.OlapFormulaToSql.convert(i.getStructureAt(1))).build())}if(e.XString.isEqual(r,"MIN")){return e.SqlOperation.format("CASE WHEN ({0}) < ({1}) THEN ({0}) ELSE ({1}) END",e.StringListBuilder.create().add(e.OlapFormulaToSql.convert(i.getStructureAt(0))).add(e.OlapFormulaToSql.convert(i.getStructureAt(1))).build())}if(e.XString.isEqual(r,"MAX0")){return e.SqlOperation.format("CASE WHEN ({0}) > ({1}) THEN ({0}) ELSE ({1}) END",e.StringListBuilder.create().add(e.OlapFormulaToSql.convert(i.getStructureAt(0))).add("0").build())}if(e.XString.isEqual(r,"MIN0")){return e.SqlOperation.format("CASE WHEN ({0}) < ({1}) THEN ({0}) ELSE ({1}) END",e.StringListBuilder.create().add(e.OlapFormulaToSql.convert(i.getStructureAt(0))).add("0").build())}return null},main:function(){e.OlapEngineModule.getInstance();var t=e.OlapFormulaToSql.convert(e.JsonParserFactory.createFromString('{"Formula":{"Function":{"Name":"*","Parameters":[{"Member":{"Name":"area"}},{"Constant":{"Value":2,"ValueType":"Number"}}]}},"Name":"Doubler","Visibility":"Visible"}').asStructure().getStructureByKey("Formula"));e.XString.asString(t)}};e.OlapRequest=function(){};e.OlapRequest.prototype=new e.XObject;e.OlapRequest.prototype._ff_c="OlapRequest";e.OlapRequest.create=function(t,r){var i=new e.OlapRequest;i.m_request=t;i.m_where=r;i.m_mode=4;i.m_source=e.SqlReference.create("test");i.m_tablealias="test";return i};e.OlapRequest.prototype.m_request=null;e.OlapRequest.prototype.m_where=null;e.OlapRequest.prototype.m_mode=0;e.OlapRequest.prototype.m_source=null;e.OlapRequest.prototype.m_tablealias=null;e.OlapRequest.prototype.setDataSource=function(e,t){this.m_source=e;this.m_tablealias=t;return this};e.OlapRequest.prototype.ToSql=function(){if(this.m_mode===4){return this.ToSqlWithBooked3()}return null};e.OlapRequest.prototype.ToSqlWithBooked3=function(){var t=e.SqlQuery.create().from(this.m_source);if(e.notNull(this.m_where)&&e.XString.size(this.m_where)>0){t.where(this.m_where)}var r=e.XList.create();var i=e.SqlQuery.create();r.add(i);var a;for(a=0;a<this.getRequest().size();++a){if(this.getRequest().get(a).getDim().getType()===e.OlapDimensionType.NORMAL){var n=e.SqlSelectAlias.create(e.SqlCast.create(e.SqlReference.create2(this.m_tablealias,this.getRequest().get(a).getDim().getName()),"varchar"),this.getRequest().get(a).getDim().getName());for(var l=0,s=r.size();l<s;++l){if(this.getRequest().get(a).getHasTotal()){var o=r.get(l).cloneQuery();o.select(e.SqlSelectAlias.create(e.SqlStringConstant.create("___INA_SQL_TOTAL"),this.getRequest().get(a).getDim().getName()));r.add(o)}r.get(l).select(e.SqlSelectAlias.create(e.SqlReference.create(this.getRequest().get(a).getDim().getName()),this.getRequest().get(a).getDim().getName()));r.get(l).groupBy(e.SqlReference.create(this.getRequest().get(a).getDim().getName()))}t.select(n);t.groupBy(e.SqlReference.create(this.getRequest().get(a).getDim().getName()))}else{var u;for(u=0;u<this.getRequest().get(a).getDim().getMembers().size();++u){var c=this.getRequest().get(a).getDim().getMembers().get(u);var p=e.SqlSelectAlias.create(c.getRawValue()!==null?c.getRawValue():e.SqlAggregateFunction.create(c.getAggregation().getName(),e.SqlReference.create(c.getName())),c.getName());for(var g=0,d=r.size();g<d;++g){r.get(g).select(p)}t.select(p)}}}r.set(0,e.SqlQuery.create().selectAll().from(e.SqlReference.create("test_with")));var y=e.SqlWith.create();y.addDependency("test_with",t);var S=2;var m=1;for(var f=1,b=r.size();f<b;++f){var h=e.XStringUtils.concatenate2("total_",e.XInteger.convertToString(f));if(f===S){m=S;S=m*2}var D=e.XMath.binaryAnd(f,m-1);var v=D===0?"test_with":e.XStringUtils.concatenate2("total_",e.XInteger.convertToString(D));y.addDependency(h,r.get(f).from(e.SqlReference.create(v)));r.set(f,e.SqlQuery.create().selectAll().from(e.SqlReference.create(h)))}if(r.size()>1){var T=e.SqlUnion.create(r.get(0),r.get(1));for(var _=2,A=r.size();_<A;++_){T=T.unionWith(r.get(_))}y.setBody(T)}else{y.setBody(r.get(0))}return y.toSqlString(new e.SqlCodeGenOptions)};e.OlapRequest.prototype.getRequest=function(){return this.m_request};e.OlapRequestEntry=function(){};e.OlapRequestEntry.prototype=new e.XObject;e.OlapRequestEntry.prototype._ff_c="OlapRequestEntry";e.OlapRequestEntry.prototype.m_dim=null;e.OlapRequestEntry.prototype.m_type=null;e.OlapRequestEntry.prototype.m_followedByTotal=false;e.OlapRequestEntry.prototype.m_hasTotal=false;e.OlapRequestEntry.prototype.m_hasConditionalTotal=false;e.OlapRequestEntry.prototype.getType=function(){return this.m_type};e.OlapRequestEntry.prototype.setType=function(e){this.m_type=e};e.OlapRequestEntry.prototype.getDim=function(){return this.m_dim};e.OlapRequestEntry.prototype.setDim=function(e){this.m_dim=e};e.OlapRequestEntry.prototype.setFollowedByTotal=function(e){this.m_followedByTotal=e};e.OlapRequestEntry.prototype.getFollowedByTotal=function(){return this.m_followedByTotal};e.OlapRequestEntry.prototype.setHasTotal=function(e){this.m_hasTotal=e};e.OlapRequestEntry.prototype.getHasTotal=function(){return this.m_hasTotal};e.OlapRequestEntry.prototype.setHasConditionalTotal=function(e){this.m_hasConditionalTotal=e};e.OlapRequestEntry.prototype.getHasConditionalTotal=function(){return this.m_hasConditionalTotal};e.OlapResultValue=function(){};e.OlapResultValue.prototype=new e.XObject;e.OlapResultValue.prototype._ff_c="OlapResultValue";e.OlapResultValue.create=function(t,r,i){var a=new e.OlapResultValue;a.m_row=t;a.m_col=r;a.m_value=i;return a};e.OlapResultValue.prototype.m_row=null;e.OlapResultValue.prototype.m_col=null;e.OlapResultValue.prototype.m_value=null;e.OlapResultValue.prototype.getValue=function(){return this.m_value};e.OlapResultValue.prototype.getCol=function(){return this.m_col};e.OlapResultValue.prototype.getRow=function(){return this.m_row};e.SqlFunctionDescription=function(){};e.SqlFunctionDescription.prototype=new e.XObject;e.SqlFunctionDescription.prototype._ff_c="SqlFunctionDescription";e.SqlFunctionDescription.create=function(t,r){var i=new e.SqlFunctionDescription;i.setName(t);i.setArgs(r);return i};e.SqlFunctionDescription.prototype.m_name=null;e.SqlFunctionDescription.prototype.m_args=0;e.SqlFunctionDescription.prototype.getName=function(){return this.m_name};e.SqlFunctionDescription.prototype.setName=function(e){this.m_name=e};e.SqlFunctionDescription.prototype.getArgs=function(){return this.m_args};e.SqlFunctionDescription.prototype.setArgs=function(e){this.m_args=e};e.GenericAttributeBuilder=function(){};e.GenericAttributeBuilder.prototype=new e.XObject;e.GenericAttributeBuilder.prototype._ff_c="GenericAttributeBuilder";e.GenericAttributeBuilder.create=function(){return(new e.GenericAttributeBuilder).init()};e.GenericAttributeBuilder.prototype.init=function(){this.m_values=e.XList.create();return this.setObtainability(e.ObtainabilityType.ALWAYS).setIsKey(false).setIsFilterable(true)};e.GenericAttributeBuilder.prototype.m_name=null;e.GenericAttributeBuilder.prototype.m_description=null;e.GenericAttributeBuilder.prototype.m_values=null;e.GenericAttributeBuilder.prototype.m_isKey=false;e.GenericAttributeBuilder.prototype.m_obtainibility=null;e.GenericAttributeBuilder.prototype.m_dataType=null;e.GenericAttributeBuilder.prototype.m_decimals=0;e.GenericAttributeBuilder.prototype.m_initialValue=null;e.GenericAttributeBuilder.prototype.m_isFilerable=false;e.GenericAttributeBuilder.prototype.m_length=0;e.GenericAttributeBuilder.prototype.m_presentationType=null;e.GenericAttributeBuilder.prototype.setName=function(e){this.m_name=e;return this};e.GenericAttributeBuilder.prototype.getName=function(){return this.m_name};e.GenericAttributeBuilder.prototype.setDescription=function(e){this.m_description=e;return this};e.GenericAttributeBuilder.prototype.getDescription=function(){return this.m_description};e.GenericAttributeBuilder.prototype.setIsKey=function(e){this.m_isKey=e;return this};e.GenericAttributeBuilder.prototype.isKey=function(){return this.m_isKey};e.GenericAttributeBuilder.prototype.setObtainability=function(e){this.m_obtainibility=e;return this};e.GenericAttributeBuilder.prototype.appendValue=function(e){this.m_values.add(e);return this};e.GenericAttributeBuilder.prototype.getValues=function(){return this.m_values};e.GenericAttributeBuilder.prototype.setDataType=function(e){this.m_dataType=e;return this};e.GenericAttributeBuilder.prototype.setDecimals=function(e){this.m_decimals=e;return this};e.GenericAttributeBuilder.prototype.setInitialValue=function(e){this.m_initialValue=e;return this};e.GenericAttributeBuilder.prototype.setIsFilterable=function(e){this.m_isFilerable=e;return this};e.GenericAttributeBuilder.prototype.setLength=function(e){this.m_length=e;return this};e.GenericAttributeBuilder.prototype.setPresentationType=function(e){this.m_presentationType=e;return this};e.GenericAttributeBuilder.prototype.toStructure=function(t){var r=e.PrFactory.createStructure();r.putString("Name",e.XStringUtils.concatenate3(t,".",this.m_name));r.putString("Description",this.m_description);r.putBoolean("IsKey",this.m_isKey);r.putString("Obtainability",this.m_obtainibility.getName());var i=r.putNewList("Values");for(var a=0;a<this.m_values.size();a++){i.add(this.m_values.get(a))}r.putString("DataType",this.m_dataType);r.putInteger("Decimals",this.m_decimals);r.put("InitialValue",this.m_initialValue);r.putBoolean("IsFilterable",this.m_isFilerable);r.putInteger("Length",this.m_length);r.putString("PresentationType",this.m_presentationType);r.put("FilterCapability",e.JsonParserFactory.createFromString('{"Comparison":{"Excluding":["=",">","<",">=","<=","<>","BETWEEN","NOT_BETWEEN","FUZZY","LIKE","MATCH","NOT_MATCH","IS_NULL"],"Including":["=",">","<",">=","<=","<>","BETWEEN","NOT_BETWEEN","FUZZY","LIKE","MATCH","NOT_MATCH","IS_NULL"]}}\r\n'));return r};e.GenericAxisBuilder=function(){};e.GenericAxisBuilder.prototype=new e.XObject;e.GenericAxisBuilder.prototype._ff_c="GenericAxisBuilder";e.GenericAxisBuilder.create=function(){var t=new e.GenericAxisBuilder;t.m_dimensions=e.XList.create();t.m_tuples=e.XList.create();return t};e.GenericAxisBuilder.create2=function(t,r){var i=new e.GenericAxisBuilder;i.m_dimensions=t;i.m_tuples=r;return i};e.GenericAxisBuilder.prototype.m_dimensions=null;e.GenericAxisBuilder.prototype.m_name=null;e.GenericAxisBuilder.prototype.m_type=null;e.GenericAxisBuilder.prototype.m_tuples=null;e.GenericAxisBuilder.prototype.m_totalTuples=0;e.GenericAxisBuilder.prototype.appendDimension=function(){var t=e.GenericDimensionBuilder.create();this.m_dimensions.add(t);return t};e.GenericAxisBuilder.prototype.getDimensions=function(){return this.m_dimensions};e.GenericAxisBuilder.prototype.appendTuple=function(t){while(t.size()>this.getDimensions().size()){var r=this.appendDimension().setName(e.XStringUtils.concatenate2("UnknownDimension",e.XInteger.convertToString(this.getDimensions().size()))).setDescription("UnknownDimension").getAttributes();r.add(e.GenericAttributeBuilder.create().setName("KEY").setIsKey(true).setDescription("Primary Key"));r.add(e.GenericAttributeBuilder.create().setName("LONG_TEXT").setDescription("My Description"))}while(t.size()>this.m_tuples.size()){this.m_tuples.add(e.GenericTupleBuilder.create())}for(var i=0;i<t.size();i++){var a=this.getDimensions().get(i).getAttributes().get(1).getValues().size();var n=false;for(var l=0;l<a;l++){if(this.getDimensions().get(i).getAttributes().get(1).getValues().get(l)===null?t.get(i)===null:this.getDimensions().get(i).getAttributes().get(1).getValues().get(l).isEqualTo(t.get(i))){n=true;a=l;break}}if(!n){this.getDimensions().get(i).getAttributes().get(1).appendValue(t.get(i));this.getDimensions().get(i).getAttributes().get(0).appendValue(t.get(i))}this.m_tuples.get(i).getEntries().add(e.GenericTupleEntryBuilder.create().setMemberIndex(a))}return this};e.GenericAxisBuilder.prototype.appendTuple2=function(t){if(t.size()>this.getDimensions().size()){throw e.XException.createIllegalStateException("You don't have enough Dimensions available")}while(t.size()>this.m_tuples.size()){this.m_tuples.add(e.GenericTupleBuilder.create())}for(var r=0;r<t.size();r++){var i=this.getDimensions().get(r).getAttributes();var a=i.get(0).getValues().size();var n=false;for(var l=0;l<a;l++){var s=true;for(var o=0;o<i.size();o++){var u=t.get(r).getByKey(i.get(o).getName());if(!(i.get(o).getValues().get(l)===null?e.isNull(u):i.get(1).getValues().get(l).isEqualTo(u))){s=false}}if(s){n=true;a=l;break}}if(!n){for(var c=0;c<i.size();c++){i.get(c).appendValue(t.get(r).getByKey(i.get(c).getName()))}}this.m_tuples.get(r).getEntries().add(e.GenericTupleEntryBuilder.create().setMemberIndex(a))}return this};e.GenericAxisBuilder.prototype.getOrAppendTupleIndex2=function(e){return this.getOrAppendTupleIndex3(e,true,false,false)};e.GenericAxisBuilder.prototype.getOrAppendTupleIndex3=function(t,r,i,a){if(t.size()===0){return-1}if(t.size()>this.getDimensions().size()){throw e.XException.createIllegalStateException("You don't have enough Dimensions available")}while(t.size()>this.m_tuples.size()){this.m_tuples.add(e.GenericTupleBuilder.create())}var n=this.m_tuples.get(0).getEntries().size();var l=e.XList.create();for(var s=0;s<t.size();s++){var o=this.getDimensions().get(s).getAttributes();var u=o.get(0).getValues().size();var c=false;for(var p=0;p<u;p++){var g=true;for(var d=0;d<o.size();d++){var y=t.get(s).getByKey(o.get(d).getName());if(!(o.get(d).getValues().get(p)===null?e.isNull(y):o.get(d).getValues().get(p).isEqualTo(y))){g=false}}if(g){c=true;u=p;break}}if(!c){if(!r){return-1}for(var S=0;S<o.size();S++){o.get(S).appendValue(t.get(s).getByKey(o.get(S).getName()))}}l.add(e.XIntegerValue.create(u))}var m=0;var f=-1;for(var b=0,h=this.m_tuples.get(0).getEntries().size();b<h;b++){var D=true;for(var v=0;v<t.size();v++){if(h!==this.m_tuples.get(v).getEntries().size()){throw e.XException.createRuntimeException("Inconsistent Tuple builder!")}if(this.m_tuples.get(v).getEntries().get(i?h-1-b:b).getMemberIndex()!==l.get(v).getInteger()){D=false;if(m<v){m=v;f=i?h-1-b:b}break}}if(D){return i?h-1-b:b}}if(a){return f}if(r){for(var T=0;T<t.size();T++){this.m_tuples.get(T).getEntries().add(e.GenericTupleEntryBuilder.create().setMemberIndex(l.get(T).getInteger()))}}return n};e.GenericAxisBuilder.prototype.getOrAppendTupleIndex=function(t){var r=e.XList.create();for(var i=0;i<t.size();i++){r.add((new e.StringMapBuilder).init().put("ID",t.get(i)).put("LONG_TEXT",t.get(i)).build())}return this.getOrAppendTupleIndex2(r)};e.GenericAxisBuilder.prototype.getOrAppendTupleIndex4=function(t,r,i,a){var n=e.XList.create();for(var l=0;l<t.size();l++){n.add((new e.StringMapBuilder).init().put("ID",t.get(l)).put("LONG_TEXT",t.get(l)).build())}return this.getOrAppendTupleIndex3(n,r,i,a)};e.GenericAxisBuilder.prototype.insertTuple=function(t,r){var i=e.XList.create();for(var a=0;a<r.size();a++){var n=this.getDimensions().get(a).getAttributes();var l=n.get(0).getValues().size();var s=false;for(var o=0;o<l;o++){var u=true;for(var c=0;c<n.size();c++){var p=r.get(a).getByKey(n.get(c).getName());if(!(n.get(c).getValues().get(o)===null?e.isNull(p):n.get(1).getValues().get(o).isEqualTo(p))){u=false}}if(u){s=true;l=o;break}}if(!s){for(var g=0;g<n.size();g++){n.get(g).appendValue(r.get(a).getByKey(n.get(g).getName()))}}i.add(e.XIntegerValue.create(l))}for(var d=0;d<r.size();d++){this.m_tuples.get(d).getEntries().insert(t,e.GenericTupleEntryBuilder.create().setMemberIndex(i.get(d).getInteger()))}};e.GenericAxisBuilder.prototype.insertTuple2=function(t,r){var i=e.XList.create();for(var a=0;a<r.size();a++){i.add((new e.StringMapBuilder).init().put("ID",r.get(a)).put("LONG_TEXT",r.get(a)).build())}this.insertTuple(t,i)};e.GenericAxisBuilder.prototype.getTuple=function(t){var r=e.XList.create();for(var i=0;i<this.m_tuples.size();i++){var a=this.m_tuples.get(i).getEntries().get(t).getMemberIndex();var n=this.getDimensions().get(i).getAttributes();var l=e.XHashMapByString.create();for(var s=0;s<n.size();s++){l.put(n.get(s).getName(),n.get(s).getValues().get(e.XDouble.convertToInt(a)))}r.add(l)}return r};e.GenericAxisBuilder.prototype.toStructure=function(){var t=e.PrFactory.createStructure();t.putString("Name",this.getName());t.putString("Type",this.getType());var r=t.putNewList("Dimensions");for(var i=0;i<this.m_dimensions.size();i++){r.add(this.m_dimensions.get(i).toStructure())}var a=t.putNewList("ExceptionAlertLevel");var n=t.putNewList("ExceptionName");while(this.m_tuples.size()<this.m_dimensions.size()){this.m_tuples.add(e.GenericTupleBuilder.create())}for(var l=0;l<(this.m_tuples.size()>=1?this.m_tuples.get(0).getEntries().size():1);l++){a.add(e.PrFactory.createDouble(0));n.add(e.PrFactory.createString(""))}var s=this.m_tuples.size()>=1?this.m_tuples.get(0).getEntries().size():1;t.putInteger("TupleCount",s);t.putInteger("TupleCountTotal",this.m_totalTuples>s?this.m_totalTuples:s);var o=t.putNewList("Tuples");for(var u=0;u<this.m_tuples.size();u++){o.add(this.m_tuples.get(u).toStructure())}return t};e.GenericAxisBuilder.prototype.toStructurelimit=function(t,r){var i=e.PrFactory.createStructure();i.putString("Name",this.getName());i.putString("Type",this.getType());var a=i.putNewList("Dimensions");for(var n=0;n<this.m_dimensions.size();n++){a.add(this.m_dimensions.get(n).toStructure())}var l=i.putNewList("ExceptionAlertLevel");var s=i.putNewList("ExceptionName");while(this.m_tuples.size()<this.m_dimensions.size()){this.m_tuples.add(e.GenericTupleBuilder.create())}for(var o=0;o<(this.m_tuples.size()>=1?this.m_tuples.get(0).getEntries().size():1);o++){l.add(e.PrFactory.createDouble(0));s.add(e.PrFactory.createString(""))}var u=r-t;i.putInteger("TupleCount",r-t);i.putInteger("TupleCountTotal",this.m_totalTuples>u?this.m_totalTuples:u);var c=i.putNewList("Tuples");for(var p=0;p<this.m_tuples.size();p++){c.add(this.m_tuples.get(p).toStructureLimit(t,r))}return i};e.GenericAxisBuilder.prototype.getName=function(){return this.m_name};e.GenericAxisBuilder.prototype.setName=function(e){this.m_name=e;return this};e.GenericAxisBuilder.prototype.getType=function(){return this.m_type};e.GenericAxisBuilder.prototype.setType=function(e){this.m_type=e;return this};e.GenericAxisBuilder.prototype.setTotalTuples=function(e){this.m_totalTuples=e;return this};e.GenericCellBuilder=function(){};e.GenericCellBuilder.prototype=new e.XObject;e.GenericCellBuilder.prototype._ff_c="GenericCellBuilder";e.GenericCellBuilder.create=function(){return(new e.GenericCellBuilder).init()};e.GenericCellBuilder.prototype.m_exception=0;e.GenericCellBuilder.prototype.m_lockedvalue=0;e.GenericCellBuilder.prototype.m_inputenabled=0;e.GenericCellBuilder.prototype.m_exceptionalertlevel=0;e.GenericCellBuilder.prototype.m_exceptionname=null;e.GenericCellBuilder.prototype.m_value=null;e.GenericCellBuilder.prototype.m_queryDataCellReference=null;e.GenericCellBuilder.prototype.init=function(){this.setException(0);this.setLockedvalue(0);this.setInputenabled(0);this.setExceptionalertlevel(0);this.setExceptionname("");this.setValue(null);return this};e.GenericCellBuilder.prototype.getException=function(){return this.m_exception};e.GenericCellBuilder.prototype.setException=function(e){this.m_exception=e;return this};e.GenericCellBuilder.prototype.getLockedvalue=function(){return this.m_lockedvalue};e.GenericCellBuilder.prototype.setLockedvalue=function(e){this.m_lockedvalue=e;return this};e.GenericCellBuilder.prototype.getInputenabled=function(){return this.m_inputenabled};e.GenericCellBuilder.prototype.setInputenabled=function(e){this.m_inputenabled=e;return this};e.GenericCellBuilder.prototype.getExceptionalertlevel=function(){return this.m_exceptionalertlevel};e.GenericCellBuilder.prototype.setExceptionalertlevel=function(e){this.m_exceptionalertlevel=e;return this};e.GenericCellBuilder.prototype.getExceptionname=function(){return this.m_exceptionname};e.GenericCellBuilder.prototype.setExceptionname=function(e){this.m_exceptionname=e;return this};e.GenericCellBuilder.prototype.getValue=function(){return this.m_value};e.GenericCellBuilder.prototype.setValue=function(e){this.m_value=e;return this};e.GenericCellBuilder.prototype.getQueryDataCellReference=function(){return this.m_queryDataCellReference};e.GenericCellBuilder.prototype.setQueryDataCellReference=function(e){this.m_queryDataCellReference=e;return this};e.GenericCellsBuilder=function(){};e.GenericCellsBuilder.prototype=new e.XObject;e.GenericCellsBuilder.prototype._ff_c="GenericCellsBuilder";e.GenericCellsBuilder.create=function(){return(new e.GenericCellsBuilder).init().setColumns(1)};e.GenericCellsBuilder.prototype.m_cells=null;e.GenericCellsBuilder.prototype.init=function(){this.m_cells=e.XList.create();return this};e.GenericCellsBuilder.prototype.setColumns=function(e){return this};e.GenericCellsBuilder.prototype.toStructure=function(){var t=e.PrFactory.createStructure();var r=e.PrFactory.createList();var i=e.PrFactory.createList();var a=e.PrFactory.createList();var n=e.PrFactory.createList();var l=e.PrFactory.createList();var s=e.PrFactory.createList();var o=e.PrFactory.createList();var u=e.PrFactory.createList();var c=e.PrFactory.createList();var p=e.PrFactory.createList();var g=e.PrFactory.createList();var d=e.PrFactory.createList();for(var y=0;y<this.m_cells.size();y++){r.add(e.PrFactory.createDouble(this.m_cells.get(y).getException()));i.add(e.PrFactory.createDouble(this.m_cells.get(y).getExceptionalertlevel()));a.add(e.PrFactory.createString(this.m_cells.get(y).getExceptionname()));if(this.m_cells.get(y).getValue()!==null){n.add(this.m_cells.get(y).getValue());l.add(e.PrFactory.createString(this.m_cells.get(y).getValue().getStringRepresentation()));s.add(e.PrFactory.createString(this.m_cells.get(y).getValue().getStringRepresentation()))}else{n.add(null);l.add(e.PrFactory.createString("null"));s.add(e.PrFactory.createString("null"))}o.add(e.PrFactory.createDouble(this.m_cells.get(y).getInputenabled()));u.add(e.PrFactory.createInteger(-1));c.add(e.PrFactory.createInteger(0));p.add(e.PrFactory.createString(""));g.add(e.PrFactory.createString("#.##0"));d.add(e.PrFactory.createString(this.m_cells.get(y).getQueryDataCellReference()))}t.put("Exceptions",e.GenericEncodedList.encodeNone2(r));t.put("ExceptionAlertLevel",e.GenericEncodedList.encodeNone2(i));t.put("ExceptionName",e.GenericEncodedList.encodeNone2(a));t.put("Values",e.GenericEncodedList.encodeNone2(n));t.put("ValuesFormatted",e.GenericEncodedList.encodeNone2(l));t.put("ValuesRounded",e.GenericEncodedList.encodeNone2(s));t.put("InputEnabled",e.GenericEncodedList.encodeNone2(o));t.put("UnitIndex",e.GenericEncodedList.encodeNone2(u));t.put("LockedValue",e.GenericEncodedList.encodeNone2(c));t.put("CellValueTypes",e.GenericEncodedList.encodeNone2(c));t.put("Units",e.GenericEncodedList.encodeNone2(p));t.put("UnitDescriptions",e.GenericEncodedList.encodeNone2(p));t.put("UnitTypes",e.GenericEncodedList.encodeNone2(c));t.put("UnitPositions",e.GenericEncodedList.encodeNone2(c));t.put("NumericRounding",e.GenericEncodedList.encodeNone2(c));t.put("NumericShift",e.GenericEncodedList.encodeNone2(c));t.put("CellFormat",e.GenericEncodedList.encodeNone2(g));t.put("QueryDataCellReferences",e.GenericEncodedList.encodeNone2(d));return t};e.GenericCellsBuilder.prototype.toStructureLimit=function(t,r,i,a,n){var l=e.PrFactory.createStructure();var s=e.PrFactory.createList();var o=e.PrFactory.createList();var u=e.PrFactory.createList();var c=e.PrFactory.createList();var p=e.PrFactory.createList();var g=e.PrFactory.createList();var d=e.PrFactory.createList();var y=e.PrFactory.createList();var S=e.PrFactory.createList();var m=e.PrFactory.createList();var f=e.PrFactory.createList();var b=e.PrFactory.createList();for(var h=t*n+i;h<this.m_cells.size()&&h<r*n;h++){var D=e.XMath.mod(h,n);if(D>=a){h=h+n-D+i-1;continue}s.add(e.PrFactory.createDouble(this.m_cells.get(h).getException()));o.add(e.PrFactory.createDouble(this.m_cells.get(h).getExceptionalertlevel()));u.add(e.PrFactory.createString(this.m_cells.get(h).getExceptionname()));if(this.m_cells.get(h).getValue()!==null){c.add(this.m_cells.get(h).getValue());p.add(e.PrFactory.createString(this.m_cells.get(h).getValue().getStringRepresentation()));g.add(e.PrFactory.createString(this.m_cells.get(h).getValue().getStringRepresentation()))}else{c.add(null);p.add(e.PrFactory.createString("null"));g.add(e.PrFactory.createString("null"))}d.add(e.PrFactory.createDouble(this.m_cells.get(h).getInputenabled()));y.add(e.PrFactory.createInteger(-1));S.add(e.PrFactory.createInteger(0));m.add(e.PrFactory.createString(""));f.add(e.PrFactory.createString("#.##0"));b.add(e.PrFactory.createString(this.m_cells.get(h).getQueryDataCellReference()))}l.put("Exceptions",e.GenericEncodedList.encodeNone2(s));l.put("ExceptionAlertLevel",e.GenericEncodedList.encodeNone2(o));l.put("ExceptionName",e.GenericEncodedList.encodeNone2(u));l.put("Values",e.GenericEncodedList.encodeNone2(c));l.put("ValuesFormatted",e.GenericEncodedList.encodeNone2(p));l.put("ValuesRounded",e.GenericEncodedList.encodeNone2(g));l.put("InputEnabled",e.GenericEncodedList.encodeNone2(d));l.put("UnitIndex",e.GenericEncodedList.encodeNone2(y));l.put("LockedValue",e.GenericEncodedList.encodeNone2(S));l.put("CellValueTypes",e.GenericEncodedList.encodeNone2(S));l.put("Units",e.GenericEncodedList.encodeNone2(m));l.put("UnitDescriptions",e.GenericEncodedList.encodeNone2(m));l.put("UnitTypes",e.GenericEncodedList.encodeNone2(S));l.put("UnitPositions",e.GenericEncodedList.encodeNone2(S));l.put("NumericRounding",e.GenericEncodedList.encodeNone2(S));l.put("NumericShift",e.GenericEncodedList.encodeNone2(S));l.put("CellFormat",e.GenericEncodedList.encodeNone2(f));l.put("QueryDataCellReferences",e.GenericEncodedList.encodeNone2(b));return l};e.GenericCellsBuilder.prototype.getCells=function(){return this.m_cells};e.GenericCubeBuilder=function(){};e.GenericCubeBuilder.prototype=new e.XObject;e.GenericCubeBuilder.prototype._ff_c="GenericCubeBuilder";e.GenericCubeBuilder.create=function(){return(new e.GenericCubeBuilder).init().setAnnotations("")};e.GenericCubeBuilder.demoContent=function(){e.OlapEngineModule.getInstance();e.OlapApiModule.getInstance();var t=e.GenericCubeBuilder.create().setBaseDataSource(e.GenericDataSourceBuilder.create().setObjectName("Root").setDescription("Root").setType("InfoCube")).setDataSource(e.GenericDataSourceBuilder.create().setObjectName("Basic").setType("Query").setDescription("Basic"));var r=e.GenericDimensionBuilder.create().setName("Country").setDescription("Origin Country").setDimensionType(3).setAxisDefault("Rows").setAxisConstraints(e.StringListBuilder.create().add("Columns").add("Rows").add("Free").build()).setDataType(null).setKeyAttribute("Country.ID");r.getAttributes().add(e.GenericAttributeBuilder.create().setIsKey(true).setName("ID").setDataType("String"));r.getAttributes().add(e.GenericAttributeBuilder.create().setName("LONG_TEXT").setDataType("String"));t.getDimensions().add(r);r=e.GenericDimensionBuilder.create().setName("Product").setDescription("Origin Product").setDimensionType(3).setAxisDefault("Rows").setAxisConstraints(e.StringListBuilder.create().add("Columns").add("Rows").add("Free").build()).setDataType(null).setKeyAttribute("Product.ID");r.getAttributes().add(e.GenericAttributeBuilder.create().setIsKey(true).setName("ID").setDataType("String"));r.getAttributes().add(e.GenericAttributeBuilder.create().setName("LONG_TEXT").setDataType("String"));t.getDimensions().add(r);var i=e.GenericDimensionBuilder.create().setName("Measure").setDescription("Data").setDimensionType(2).setAxisDefault("Columns").setAxisConstraints(e.StringListBuilder.create().add("Columns").add("Rows").add("Free").build()).setDataType(null).setKeyAttribute("Measure.ID");i.getAttributes().add(e.GenericAttributeBuilder.create().setIsKey(true).setName("ID").setDataType("String"));i.getAttributes().add(e.GenericAttributeBuilder.create().setName("LONG_TEXT").setDataType("String"));i.putMember((new e.StringMapBuilder).init().put("ID",e.PrFactory.createString("0")).put("LONG_TEXT",e.PrFactory.createString("Hello World 1")).build());i.putMember((new e.StringMapBuilder).init().put("ID",e.PrFactory.createString("1")).put("LONG_TEXT",e.PrFactory.createString("Hello World 2")).build());i.putMember((new e.StringMapBuilder).init().put("ID",e.PrFactory.createString("2")).put("LONG_TEXT",e.PrFactory.createString("Hello World 3")).build());i.putMember((new e.StringMapBuilder).init().put("ID",e.PrFactory.createString("3")).put("LONG_TEXT",e.PrFactory.createString("Hello World 4")).build());i.putMember((new e.StringMapBuilder).init().put("ID",e.PrFactory.createString("4")).put("LONG_TEXT",e.PrFactory.createString("Test Member")).build());t.getDimensions().add(i);return t.toStructure()};e.GenericCubeBuilder.main=function(){};e.GenericCubeBuilder.prototype.m_annotations=null;e.GenericCubeBuilder.prototype.m_baseDataSource=null;e.GenericCubeBuilder.prototype.m_dataSource=null;e.GenericCubeBuilder.prototype.m_catalogPackage=null;e.GenericCubeBuilder.prototype.m_catalogSchema=null;e.GenericCubeBuilder.prototype.m_catalogType=null;e.GenericCubeBuilder.prototype.m_createdBy=null;e.GenericCubeBuilder.prototype.m_createdOn=null;e.GenericCubeBuilder.prototype.m_dueDate=null;e.GenericCubeBuilder.prototype.m_dimensions=null;e.GenericCubeBuilder.prototype.getDimensions=function(){return this.m_dimensions};e.GenericCubeBuilder.prototype.init=function(){this.m_dimensions=e.XList.create();return this};e.GenericCubeBuilder.prototype.getAnnotations=function(){return this.m_annotations};e.GenericCubeBuilder.prototype.setAnnotations=function(e){this.m_annotations=e;return this};e.GenericCubeBuilder.prototype.setDataSource=function(e){this.m_dataSource=e;return this};e.GenericCubeBuilder.prototype.setBaseDataSource=function(e){this.m_baseDataSource=e;return this};e.GenericCubeBuilder.prototype.toStructure=function(){var t=e.PrFactory.createStructure();t.putString("Annotations",this.m_annotations);t.putString("CatalogPackage",this.m_catalogPackage);t.putString("CatalogSchema",this.m_catalogSchema);t.putString("CatalogType",this.m_catalogType);t.putString("CreatedBy",this.m_createdBy);t.putString("CreatedOn",this.m_createdOn);t.putString("DueDate",this.m_dueDate);t.putNewStructure("DynamicFilter");t.put("ExtendedSortTypes",e.PrListBuilder.create().add(e.PrFactory.createString("MemberText")).build());t.put("Sort",e.JsonParserFactory.createFromString('[{ "Dimension": "code", "SortType": "MemberText", "MeasureName": "", "Direction": "Asc" }]'));var r=t.putNewStructure("CurrencyTranslation");r.putString("Name","");r.putString("Operation","Original");r.putString("Target","");t.put("BaseDataSource",this.m_baseDataSource.toStructure());t.put("DataSource",this.m_dataSource.toStructure());t.put("Query",e.JsonParserFactory.createFromString('{"Axes":[{"DimensionOrderFixed":false,"Axis":"Rows","ZeroSuppressionType":0,"ResultAlignment":"Bottom"},{"DimensionOrderFixed":false,"Axis":"Columns","ZeroSuppressionType":0,"ResultAlignment":"Bottom"},{"DimensionOrderFixed":false,"Axis":"Free","ZeroSuppressionType":0,"ResultAlignment":"Bottom"}],"CurrencyTranslationEnabled":"Possible","ResultStructureFeature":{"Enabled":true,"Reordering":"None","ResultAlignment":{"ConfigLevel":"Axis","ResultAlignmentList":["Top","Bottom"]},"ConditionalVisibility":true,"ConditionalTotals":false,"ConditionalTotalsList":[]}}'));var i=t.putNewList("Dimensions");for(var a=0;a<this.m_dimensions.size();a++){i.add(this.m_dimensions.get(a).toStructure())}var n=e.PrFactory.createStructure();n.put("Cube",t);return n};e.GenericDataSourceBuilder=function(){};e.GenericDataSourceBuilder.prototype=new e.XObject;e.GenericDataSourceBuilder.prototype._ff_c="GenericDataSourceBuilder";e.GenericDataSourceBuilder.create=function(){return(new e.GenericDataSourceBuilder).init()};e.GenericDataSourceBuilder.prototype.m_objectName=null;e.GenericDataSourceBuilder.prototype.m_type=null;e.GenericDataSourceBuilder.prototype.m_dataArea=null;e.GenericDataSourceBuilder.prototype.m_description=null;e.GenericDataSourceBuilder.prototype.m_instanceId=null;e.GenericDataSourceBuilder.prototype.init=function(){return this};e.GenericDataSourceBuilder.prototype.getObjectName=function(){return this.m_objectName};e.GenericDataSourceBuilder.prototype.setObjectName=function(e){this.m_objectName=e;return this};e.GenericDataSourceBuilder.prototype.getType=function(){return this.m_type};e.GenericDataSourceBuilder.prototype.setType=function(e){this.m_type=e;return this};e.GenericDataSourceBuilder.prototype.getDataArea=function(){return this.m_dataArea};e.GenericDataSourceBuilder.prototype.setDataArea=function(e){this.m_dataArea=e;return this};e.GenericDataSourceBuilder.prototype.setDescription=function(e){this.m_description=e;return this};e.GenericDataSourceBuilder.prototype.setInstanceId=function(e){this.m_instanceId=e;return this};e.GenericDataSourceBuilder.prototype.toStructure=function(){var t=e.PrFactory.createStructure();t.putString("ObjectName",this.m_objectName);t.putString("Type",this.m_type);t.putString("DataArea",this.m_dataArea);t.putString("Description",this.m_description);t.putString("InstanceId",this.m_instanceId);return t};e.GenericDimensionBuilder=function(){};e.GenericDimensionBuilder.prototype=new e.XObject;e.GenericDimensionBuilder.prototype._ff_c="GenericDimensionBuilder";e.GenericDimensionBuilder.create=function(){return(new e.GenericDimensionBuilder).init()};e.GenericDimensionBuilder.convertList=function(t){var r=e.PrFactory.createList();for(var i=0;e.notNull(t)&&i<t.size();i++){r.add(e.PrFactory.createString(t.get(i)))}return r};e.GenericDimensionBuilder.prototype.init=function(){this.m_attributes=e.XList.create();this.m_axisConstraints=e.XListOfString.create();this.setMembers(e.PrList.create());return this};e.GenericDimensionBuilder.prototype.m_name=null;e.GenericDimensionBuilder.prototype.m_description=null;e.GenericDimensionBuilder.prototype.m_attributes=null;e.GenericDimensionBuilder.prototype.m_axisConstraints=null;e.GenericDimensionBuilder.prototype.m_axisDefault=null;e.GenericDimensionBuilder.prototype.m_dataType=null;e.GenericDimensionBuilder.prototype.m_defaultResultSetAttributeNodes=null;e.GenericDimensionBuilder.prototype.m_defaultResultSetAttributes=null;e.GenericDimensionBuilder.prototype.m_defaultResultSetReadMode=null;e.GenericDimensionBuilder.prototype.m_dimensionType=0;e.GenericDimensionBuilder.prototype.m_keyAttribute=null;e.GenericDimensionBuilder.prototype.m_members=null;e.GenericDimensionBuilder.prototype.m_hirachy=null;e.GenericDimensionBuilder.prototype.setName=function(e){this.m_name=e;return this};e.GenericDimensionBuilder.prototype.getName=function(){return this.m_name};e.GenericDimensionBuilder.prototype.setDescription=function(e){this.m_description=e;return this};e.GenericDimensionBuilder.prototype.getAttributes=function(){return this.m_attributes};e.GenericDimensionBuilder.prototype.getAxisConstraints=function(){return this.m_axisConstraints};e.GenericDimensionBuilder.prototype.toStructure=function(){var t=e.PrFactory.createStructure();t.putString("Name",this.m_name);t.putString("Description",this.m_description);t.putString("AxisDefault",this.m_axisDefault);t.putString("DataType",this.m_dataType);t.putString("DefaultResultSetReadMode",this.m_defaultResultSetReadMode);t.putInteger("DimensionType",this.m_dimensionType);t.put("DefaultResultSetAttributes",e.GenericDimensionBuilder.convertList(this.m_defaultResultSetAttributes));t.put("DefaultResultSetAttributeNodes",e.GenericDimensionBuilder.convertList(this.m_defaultResultSetAttributeNodes));t.put("AxisConstraints",e.GenericDimensionBuilder.convertList(this.m_axisConstraints));t.put("DefaultResultStructure",e.JsonParserFactory.createFromString('{"ResultAlignment":"","ResultStructure":[{"Result":"Total","Visibility":"Visible"},{"Result":"Members","Visibility":"Visible"}]}'));var r=t.putNewList("Attributes");var i=e.PrFactory.createList();if(this.m_attributes.size()>0){for(var a=0;a<this.m_attributes.get(0).getValues().size();a++){i.add(e.PrFactory.createInteger(this.m_attributes.get(0).getValues().get(a)!==null&&this.m_attributes.get(0).getValues().get(a).isString()&&e.XString.isEqual(this.m_attributes.get(0).getValues().get(a).asString().getString(),"___INA_SQL_TOTAL")?1:0))}}var n=e.PrList.create();var l=e.PrList.create();for(var s=0;s<this.m_attributes.size();s++){r.add(this.m_attributes.get(s).toStructure(this.m_name));var o=e.PrFactory.createString(e.XStringUtils.concatenate3(this.m_name,".",this.m_attributes.get(s).getName()));n.add(o);if(!this.m_attributes.get(s).isKey()){l.add(o)}else if(e.isNull(this.m_keyAttribute)){this.m_keyAttribute=o.getString()}}t.put("MemberTypes",e.GenericEncodedList.encodeNone2(i));t.putString("KeyAttribute",this.m_keyAttribute);var u=t.putNewList("AxisConstraints");for(var c=0;c<this.m_axisConstraints.size();c++){u.add(e.PrFactory.createString(this.m_axisConstraints.get(c)))}if(this.getMembers()!==null&&this.getMembers().size()>0){t.put("Members",this.m_members)}t.putNewList("DefaultResultSetAttributeNodes").addString(this.m_name);t.putNewList("Hierarchies");t.putBoolean("HierarchiesPossible",false);t.putInteger("Length",0);t.putNewList("LevelHierarchies");t.putBoolean("MultipleValues",true);if(e.notNull(this.m_hirachy)){t.put("AttributeHierarchy",this.m_hirachy)}else{var p=t.putNewStructure("AttributeHierarchy");p.putString("DefaultDisplayKeyAttribute",this.m_keyAttribute);p.putString("DefaultKeyAttribute",this.m_keyAttribute);p.put("DefaultTextAttribute",l.get(0));p.putNewList("Children");p.put("AttributeNames",n);p.put("DefaultResultSetAttributes",l);p.putString("Name",this.m_name);p.putString("Description",this.m_description)}return t};e.GenericDimensionBuilder.prototype.getAxisDefault=function(){return this.m_axisDefault};e.GenericDimensionBuilder.prototype.setAxisDefault=function(e){this.m_axisDefault=e;return this};e.GenericDimensionBuilder.prototype.getDataType=function(){return this.m_dataType};e.GenericDimensionBuilder.prototype.setDataType=function(e){this.m_dataType=e;return this};e.GenericDimensionBuilder.prototype.getDefaultResultSetAttributeNodes=function(){return this.m_defaultResultSetAttributeNodes};e.GenericDimensionBuilder.prototype.setDefaultResultSetAttributeNodes=function(e){this.m_defaultResultSetAttributeNodes=e;return this};e.GenericDimensionBuilder.prototype.getDefaultResultSetReadMode=function(){return this.m_defaultResultSetReadMode};e.GenericDimensionBuilder.prototype.setDefaultResultSetReadMode=function(e){this.m_defaultResultSetReadMode=e;return this};e.GenericDimensionBuilder.prototype.getKeyAttribute=function(){return this.m_keyAttribute};e.GenericDimensionBuilder.prototype.setKeyAttribute=function(e){this.m_keyAttribute=e;return this};e.GenericDimensionBuilder.prototype.getDimensionType=function(){return this.m_dimensionType};e.GenericDimensionBuilder.prototype.setDimensionType=function(e){this.m_dimensionType=e;return this};e.GenericDimensionBuilder.prototype.getDefaultResultSetAttributes=function(){return this.m_defaultResultSetAttributes};e.GenericDimensionBuilder.prototype.setDefaultResultSetAttributes=function(e){this.m_defaultResultSetAttributes=e;return this};e.GenericDimensionBuilder.prototype.setAxisConstraints=function(e){this.m_axisConstraints=e;return this};e.GenericDimensionBuilder.prototype.putMember=function(t){var r=e.PrFactory.createStructure();var i=t.getKeysAsReadOnlyListOfString();for(var a=0;a<i.size();a++){r.put(e.XStringUtils.concatenate3(this.m_name,".",i.get(a)),t.getByKey(i.get(a)))}var n=r.putNewStructure("MemberOperand");n.putString("Value",t.getByKey("ID").asString().getString());n.putString("Description",t.getByKey("LONG_TEXT").asString().getString());r.putString("Visibility","Visible");r.putNewList("DefaultSelectedDimensions");r.putBoolean("IsSelectionCandidate",false);r.putString("ResultCalculation","");r.putString("SingleValueCalculation","");this.m_members.add(r);return this};e.GenericDimensionBuilder.prototype.getMembers=function(){return this.m_members};e.GenericDimensionBuilder.prototype.setMembers=function(e){this.m_members=e};e.GenericDimensionBuilder.prototype.getHirachy=function(){return this.m_hirachy};e.GenericDimensionBuilder.prototype.setHirachy=function(e){this.m_hirachy=e};e.GenericEncodedList={appendToPrList:function(e,t){for(var r=0;r<t.size();r++){e.add(t.get(r))}return e},encodeNone:function(t){var r=e.PrFactory.createStructure();r.putString("Encoding","None");r.putInteger("Size",t.size());e.GenericEncodedList.appendToPrList(r.putNewList("Values"),t);return r},encodeNone2:function(t){var r=e.PrFactory.createStructure();r.putString("Encoding","None");r.putInteger("Size",t.size());r.put("Values",t);return r}};e.GenericResultSetBuilder=function(){};e.GenericResultSetBuilder.prototype=new e.XObject;e.GenericResultSetBuilder.prototype._ff_c="GenericResultSetBuilder";e.GenericResultSetBuilder.create=function(){var t=new e.GenericResultSetBuilder;t.m_cells=e.GenericCellsBuilder.create();t.m_axes=e.XList.create();return t};e.GenericResultSetBuilder.demoResultSet=function(){e.OlapEngineModule.getInstance();e.OlapApiModule.getInstance();e.OlapEngineModule.getInstance();var t=e.GenericResultSetBuilder.create();var r=e.GenericAxisBuilder.create().setName("Rows").setType("Rows");var i=e.GenericAxisBuilder.create().setName("Columns").setType("Columns");t.getAxes().add(r);t.getAxes().add(i);var a=e.GenericDimensionBuilder.create().setName("Country").setDescription("Origin Country").setDimensionType(3).setAxisDefault("Rows").setAxisConstraints(e.StringListBuilder.create().add("Columns").add("Rows").build()).setDataType(null).setKeyAttribute("Country.ID");a.getAttributes().add(e.GenericAttributeBuilder.create().setIsKey(true).setName("ID").setDataType("String"));a.getAttributes().add(e.GenericAttributeBuilder.create().setName("LONG_TEXT").setDataType("String"));r.getDimensions().add(a);a=e.GenericDimensionBuilder.create().setName("Product").setDescription("Origin Product").setDimensionType(3).setAxisDefault("Columns").setAxisConstraints(e.StringListBuilder.create().add("Columns").add("Rows").build()).setDataType(null).setKeyAttribute("Product.ID");a.getAttributes().add(e.GenericAttributeBuilder.create().setIsKey(true).setName("ID").setDataType("String"));a.getAttributes().add(e.GenericAttributeBuilder.create().setName("LONG_TEXT").setDataType("String"));r.getDimensions().add(a);var n=e.GenericDimensionBuilder.create().setName("Measure").setDescription("Data").setDimensionType(2).setAxisDefault("Columns").setAxisConstraints(e.StringListBuilder.create().add("Columns").add("Rows").build()).setDataType(null).setKeyAttribute("Measure.ID");n.getAttributes().add(e.GenericAttributeBuilder.create().setIsKey(true).setName("ID").setDataType("String"));n.getAttributes().add(e.GenericAttributeBuilder.create().setName("LONG_TEXT").setDataType("String"));var l=e.PrFactory.createList();var s=l.addNewStructure();s.putString("Measure.ID","0");s.putString("Measure.LONG_TEXT","Hello World");s.putString("Visibility","Visible");s.putNewList("DefaultSelectedDimensions");s.putBoolean("IsSelectionCandidate",false);s.putString("ResultCalculation","");s.putString("SingleValueCalculation","");s=l.addNewStructure();s.putString("Measure.ID","1");s.putString("Measure.LONG_TEXT","Hello World 2");s.putString("Visibility","Visible");s.putNewList("DefaultSelectedDimensions");s.putBoolean("IsSelectionCandidate",false);s.putString("ResultCalculation","");s.putString("SingleValueCalculation","");s=l.addNewStructure();s.putString("Measure.ID","3");s.putString("Measure.LONG_TEXT","Hello World 3");s.putString("Visibility","Visible");s.putNewList("DefaultSelectedDimensions");s.putBoolean("IsSelectionCandidate",false);s.putString("ResultCalculation","");s.putString("SingleValueCalculation","");n.setMembers(l);i.getDimensions().add(n);var o=e.PrFactory.createStructure();o.putString("DefaultDisplayKeyAttribute","Measure.ID");o.putString("DefaultKeyAttribute","Measure.ID");o.putString("DefaultTextAttribute","Measure.LONG_TEXT");o.putNewList("Children");o.put("AttributeNames",e.PrListBuilder.create().add(e.PrFactory.createString("Measure.ID")).add(e.PrFactory.createString("Measure.LONG_TEXT")).build());o.putNewList("DefaultResultSetAttributes").addString("Measure.LONG_TEXT");o.putString("Name","Measure");o.putString("Description","My Measure");n.setHirachy(o);r.appendTuple((new e.ListBuilder).init().add(e.PrFactory.createString("A")).add(e.PrFactory.createString("A")).build());t.append((new e.ListBuilder).init().add(e.PrFactory.createInteger(1)).add(e.PrFactory.createInteger(5)).add(e.PrFactory.createInteger(4)).add(e.PrFactory.createInteger(2)).build());r.appendTuple((new e.ListBuilder).init().add(e.PrFactory.createString("A")).add(e.PrFactory.createString("B")).build());t.append((new e.ListBuilder).init().add(e.PrFactory.createInteger(1)).add(e.PrFactory.createInteger(5)).add(e.PrFactory.createInteger(4)).add(e.PrFactory.createInteger(2)).build());r.appendTuple((new e.ListBuilder).init().add(e.PrFactory.createString("B")).add(e.PrFactory.createString("A")).build());t.append((new e.ListBuilder).init().add(e.PrFactory.createInteger(1)).add(e.PrFactory.createInteger(5)).add(e.PrFactory.createInteger(999)).add(e.PrFactory.createInteger(2)).build());r.appendTuple((new e.ListBuilder).init().add(e.PrFactory.createString("B")).add(e.PrFactory.createString("B")).build());t.append((new e.ListBuilder).init().add(e.PrFactory.createInteger(1)).add(e.PrFactory.createInteger(5)).add(e.PrFactory.createInteger(4)).add(e.PrFactory.createInteger(2)).build());i.appendTuple((new e.ListBuilder).init().add(e.PrFactory.createString("C")).build());i.appendTuple((new e.ListBuilder).init().add(e.PrFactory.createString("D")).build());i.appendTuple((new e.ListBuilder).init().add(e.PrFactory.createString("E")).build());i.appendTuple((new e.ListBuilder).init().add(e.PrFactory.createString("F")).build());return t.toStructure()};e.GenericResultSetBuilder.main=function(){};e.GenericResultSetBuilder.prototype.m_cells=null;e.GenericResultSetBuilder.prototype.m_rows=0;e.GenericResultSetBuilder.prototype.m_columns=0;e.GenericResultSetBuilder.prototype.m_axes=null;e.GenericResultSetBuilder.prototype.append=function(t){if(t.size()!==this.m_columns){if(this.m_columns===0){this.m_columns=t.size()}else{throw e.XException.createIllegalStateException("changing column count while building resultset is unsupported")}}this.m_rows++;for(var r=0;r<t.size();r++){this.m_cells.getCells().add(e.GenericCellBuilder.create().setValue(t.get(r)).setQueryDataCellReference(e.XInteger.convertToString(r+1)))}};e.GenericResultSetBuilder.prototype.insert=function(t,r,i){if(r>=this.m_columns){var a=r+1;for(var n=0;n<this.m_rows;n++){for(var l=this.m_columns;l<a;l++){this.m_cells.getCells().insert(n*a+l,e.GenericCellBuilder.create().setValue(null).setQueryDataCellReference(e.XInteger.convertToString(l+1)))}}this.m_columns=a}for(var s=this.m_rows-1;s<=t;s++){for(var o=0;o<this.m_columns;o++){this.m_cells.getCells().add(e.GenericCellBuilder.create().setValue(null).setQueryDataCellReference(e.XInteger.convertToString(o+1)))}}if(this.m_rows<=t){this.m_rows=t+1}this.m_cells.getCells().get(t*this.m_columns+r).setValue(i)};e.GenericResultSetBuilder.prototype.getAxes=function(){return this.m_axes};e.GenericResultSetBuilder.prototype.toStructure=function(){var t=e.PrFactory.createStructure();var r=t.putNewList("Grids").addNewStructure();var i=r.putNewList("Axes");for(var a=0;a<this.m_axes.size();a++){i.add(this.m_axes.get(a).toStructure())}if(this.m_rows>0&&this.m_columns>0){r.put("Cells",this.m_cells.toStructure())}r.put("CellArraySizes",e.PrListBuilder.create().add(e.PrFactory.createInteger(this.m_rows)).add(e.PrFactory.createInteger(this.m_columns)).build());return t};e.GenericResultSetBuilder.prototype.toStructureLimit=function(t,r,i,a){var n=e.PrFactory.createStructure();var l=n.putNewList("Grids").addNewStructure();var s=l.putNewList("Axes");for(var o=0;o<this.m_axes.size();o++){s.add(this.m_axes.get(o).toStructurelimit(e.XString.isEqual(this.m_axes.get(o).getType(),"Rows")?t:i,e.XString.isEqual(this.m_axes.get(o).getType(),"Rows")?r:a))}if(this.m_rows>0&&this.m_columns>0){l.put("Cells",this.m_cells.toStructureLimit(t,r,i,a,this.m_columns))}l.put("CellArraySizes",e.PrListBuilder.create().add(e.PrFactory.createInteger(e.XMath.min(this.m_rows,r-t))).add(e.PrFactory.createInteger(e.XMath.min(this.m_columns,a-i))).build());return n};e.GenericResultSetBuilder.prototype.insertRow=function(t){this.m_rows++;for(var r=0;r<this.m_columns;r++){this.m_cells.getCells().insert(t*this.m_columns+r,e.GenericCellBuilder.create().setValue(null).setQueryDataCellReference(e.XInteger.convertToString(t+1)))}};e.GenericResultSetBuilder.prototype.insertColumn=function(t){this.m_columns++;for(var r=0;r<this.m_rows;r++){this.m_cells.getCells().insert(r*this.m_columns+t,e.GenericCellBuilder.create().setValue(null).setQueryDataCellReference(e.XInteger.convertToString(t+1)))}};e.GenericTupleBuilder=function(){};e.GenericTupleBuilder.prototype=new e.XObject;e.GenericTupleBuilder.prototype._ff_c="GenericTupleBuilder";e.GenericTupleBuilder.create=function(){return(new e.GenericTupleBuilder).init(e.XList.create())};e.GenericTupleBuilder.create2=function(t){return(new e.GenericTupleBuilder).init(t)};e.GenericTupleBuilder.prototype.m_tuples=null;e.GenericTupleBuilder.prototype.init=function(e){this.m_tuples=e;return this};e.GenericTupleBuilder.prototype.toStructure=function(){var t=e.PrFactory.createStructure();var r=e.PrFactory.createList();var i=e.PrFactory.createList();var a=e.PrFactory.createList();var n=e.PrFactory.createList();var l=e.PrFactory.createList();for(var s=0;s<this.m_tuples.size();s++){r.add(e.PrFactory.createDouble(this.m_tuples.get(s).getMemberIndex()));i.add(e.PrFactory.createDouble(this.m_tuples.get(s).getParentIndex()));a.add(e.PrFactory.createDouble(this.m_tuples.get(s).getDisplayLevel()));n.add(e.PrFactory.createDouble(this.m_tuples.get(s).getLevel()));l.add(e.PrFactory.createDouble(this.m_tuples.get(s).getDrillState()))}t.put("MemberIndexes",e.GenericEncodedList.encodeNone2(r));t.put("ParentIndexes",e.GenericEncodedList.encodeNone2(i));t.put("DisplayLevel",e.GenericEncodedList.encodeNone2(a));t.put("Level",e.GenericEncodedList.encodeNone2(n));t.put("DrillState",e.GenericEncodedList.encodeNone2(l));return t};e.GenericTupleBuilder.prototype.toStructureLimit=function(t,r){var i=e.PrFactory.createStructure();var a=e.PrFactory.createList();var n=e.PrFactory.createList();var l=e.PrFactory.createList();var s=e.PrFactory.createList();var o=e.PrFactory.createList();for(var u=t;u<this.m_tuples.size()&&u<r;u++){a.add(e.PrFactory.createDouble(this.m_tuples.get(u).getMemberIndex()));n.add(e.PrFactory.createDouble(this.m_tuples.get(u).getParentIndex()));l.add(e.PrFactory.createDouble(this.m_tuples.get(u).getDisplayLevel()));s.add(e.PrFactory.createDouble(this.m_tuples.get(u).getLevel()));o.add(e.PrFactory.createDouble(this.m_tuples.get(u).getDrillState()))}i.put("MemberIndexes",e.GenericEncodedList.encodeNone2(a));i.put("ParentIndexes",e.GenericEncodedList.encodeNone2(n));i.put("DisplayLevel",e.GenericEncodedList.encodeNone2(l));i.put("Level",e.GenericEncodedList.encodeNone2(s));i.put("DrillState",e.GenericEncodedList.encodeNone2(o));return i};e.GenericTupleBuilder.prototype.getEntries=function(){return this.m_tuples};e.GenericTupleEntryBuilder=function(){};e.GenericTupleEntryBuilder.prototype=new e.XObject;e.GenericTupleEntryBuilder.prototype._ff_c="GenericTupleEntryBuilder";e.GenericTupleEntryBuilder.create=function(){return(new e.GenericTupleEntryBuilder).init()};e.GenericTupleEntryBuilder.prototype.m_memberIndex=0;e.GenericTupleEntryBuilder.prototype.m_parentIndex=0;e.GenericTupleEntryBuilder.prototype.m_displayLevel=0;e.GenericTupleEntryBuilder.prototype.m_level=0;e.GenericTupleEntryBuilder.prototype.m_drillState=0;e.GenericTupleEntryBuilder.prototype.init=function(){this.setMemberIndex(0);this.setParentIndex(-1);this.setDisplayLevel(0);this.setLevel(0);this.setDrillState(0);return this};e.GenericTupleEntryBuilder.prototype.getMemberIndex=function(){return this.m_memberIndex};e.GenericTupleEntryBuilder.prototype.setMemberIndex=function(e){this.m_memberIndex=e;return this};e.GenericTupleEntryBuilder.prototype.getParentIndex=function(){return this.m_parentIndex};e.GenericTupleEntryBuilder.prototype.setParentIndex=function(e){this.m_parentIndex=e;return this};e.GenericTupleEntryBuilder.prototype.getDisplayLevel=function(){return this.m_displayLevel};e.GenericTupleEntryBuilder.prototype.setDisplayLevel=function(e){this.m_displayLevel=e;return this};e.GenericTupleEntryBuilder.prototype.getLevel=function(){return this.m_level};e.GenericTupleEntryBuilder.prototype.setLevel=function(e){this.m_level=e;return this};e.GenericTupleEntryBuilder.prototype.getDrillState=function(){return this.m_drillState};e.GenericTupleEntryBuilder.prototype.setDrillState=function(e){this.m_drillState=e;return this};e.OlapSqlProcessor=function(){};e.OlapSqlProcessor.prototype=new e.XObject;e.OlapSqlProcessor.prototype._ff_c="OlapSqlProcessor";e.OlapSqlProcessor.create=function(){return(new e.OlapSqlProcessor).setServerInfo("/sap/sql/ina/GetServerInfo").setInaPath("/sap/sql/ina/GetResponse")};e.OlapSqlProcessor.prototype.m_serverInfo=null;e.OlapSqlProcessor.prototype.m_inaPath=null;e.OlapSqlProcessor.prototype.m_metaData=null;e.OlapSqlProcessor.prototype.setServerInfo=function(e){this.m_serverInfo=e;return this};e.OlapSqlProcessor.prototype.setInaPath=function(e){this.m_inaPath=e;return this};e.OlapSqlProcessor.prototype.setMetaData=function(e){this.m_metaData=e;return this};e.OlapSqlProcessor.prototype.execSyncQuery=function(t,r){var i=t.processExecuteQuery(e.SyncType.BLOCKING,null,null,r);if(i.getData()===null){throw e.XException.createRuntimeException(t.hasErrors()?t.getErrors().get(t.getErrors().size()-1).getText():"Unknown sql error")}return i.getData()};e.OlapSqlProcessor.prototype.onProcess=function(t,r,i){try{if(e.XString.isEqual(r,this.m_serverInfo)){return e.XPair.create(e.XIntegerValue.create(200),e.JsonParserFactory.createFromString('{"ServerInfo":{"DataBaseManagementSystem":"HDB","SystemId":"BIX","Client":"001","UserLanguageCode":"EN","ReentranceTicket":"AjQxMDMBABhBAE4AWgBFAEkARwBFAFIAIAAgACAAIAACAAYwADAAMQADABBCAEkAWAAgACAAIAAgACAABAAYMgAwADIAMQAxADAAMQA1ADEAMAAwADUABwAEAAAAAggAAQEJAAJFAA8AAzAwMRAACEJJWCAgICAg/wD8MIH5BgkqhkiG9w0BBwKggeswgegCAQExCzAJBgUrDgMCGgUAMAsGCSqGSIb3DQEHATGByDCBxQIBATAaMA4xDDAKBgNVBAMTA0JJWAIICiAVERITGQEwCQYFKw4DAhoFAKBdMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8XDTIxMTAxNTEwMDU1MFowIwYJKoZIhvcNAQkEMRYEFPrcJrRp12yWu!A5iTm3jzcglq5AMAkGByqGSM44BAMELzAtAhRhD2J3MOsawGvbkQAL5TpswR7b2AIVAJ8RUQj4uPcfhQ0!v99ocCEctIyW"},"Services":[{"Capabilities":[{"Capability":"SuppressQueryDataCells"},{"Capability":"ValueHelpWithAttributes"},{"Capability":"TuplesOperand"},{"Capability":"DetailedResponseExpansion"},{"Capability":"SupportsOperatorVariance"},{"Capability":"SupportsSpatialFilter"},{"Capability":"SpatialFilterSRID"},{"Capability":"SupportsSpatialTransformations"},{"Capability":"SpatialChoropleth"},{"Capability":"SpatialClustering"},{"Capability":"SupportsIgnoreExternalDimensions"},{"Capability":"ResultSetInterval"},{"Capability":"SupportsExtendedSort"},{"Capability":"SubmitReturnsVariableValues"},{"Capability":"RRI"},{"Capability":"ZeroSuppression"},{"Capability":"LogOffPath","Value":"/sap/bw/ina/Logoff"},{"Capability":"AttributeHierarchyHierarchyFields"},{"Capability":"HierarchyNavigationCounter"},{"Capability":"NewValuesExtendedFormat"},{"Capability":"RsCellValueTypes"},{"Capability":"QDataCells"},{"Capability":"Supplements"},{"Capability":"HierarchyNameVariable"},{"Capability":"FastPath","Value":"/sap/bw/ina/GetResponse"},{"Capability":"FastPathXXLWebService","Value":"/sap/bw/ina/GetXXLValue"},{"Capability":"NewValuesImplicitUnlock"},{"Capability":"ExtendedDimensionTypes"},{"Capability":"ChangeCounter"},{"Capability":"ActionClose"},{"Capability":"SupportsCummulative"},{"Capability":"HierarchyCatalog"},{"Capability":"CatalogServiceV20"},{"Capability":"SAPDate"},{"Capability":"ExtHierarchy"},{"Capability":"VariableReSubmit"},{"Capability":"SemanticalErrorType"},{"Capability":"AttributeHierarchy"},{"Capability":"ClientCapabilities"},{"Capability":"CellsValueFormatted"},{"Capability":"MaxResultRecords"},{"Capability":"StatefulServer","Description":"User Session is stateful. Please use url /sap/public/bc/icf/logoff?sap-client=000 to close session."},{"Capability":"SupportsSetOperand"},{"Capability":"ReadMode"},{"Capability":"ServerStructureNames"},{"Capability":"SupportsEncodedResultSet"},{"Capability":"Obtainability"},{"Capability":"Workspace","Description":"BPC workspace integration"},{"Capability":"DatasourceAtService"},{"Capability":"Workstatus","Description":"BPC workstatus integration"},{"Capability":"PagingTupleCountTotal"},{"Capability":"MetadataBaseMeasureName"},{"Capability":"SupportsHierarchySelectionAsFlatSelection"},{"Capability":"SupportsDimensionFilterCapability"},{"Capability":"DimF4SelectionWithCompoundment"},{"Capability":"Exceptions"},{"Capability":"Conditions"},{"Capability":"DefinitionReturnsVariableValues"},{"Capability":"SupportsDataCellMixedValues"},{"Capability":"SupportsCalculatedKeyFigures"},{"Capability":"SupportsRestrictedKeyFigures"},{"Capability":"StackedRestrictionsCheck"},{"Capability":"SupportsOriginalTexts"},{"Capability":"UnifiedDataCells"},{"Capability":"MDSLikePaging"},{"Capability":"HierarchyLevelOffsetFilter"},{"Capability":"CartesianFilterIntersect"},{"Capability":"SupportsMemberValueExceptions"},{"Capability":"SupportsKeyfigureHierarchies"},{"Capability":"ExpandHierarchyBottomUp"},{"Capability":"InitialDrillLevelRelative"},{"Capability":"MDMHierarchyWithDrillLevel"},{"Capability":"SupportsDataRefresh"},{"Capability":"SupportsDataRefreshAndDataTopicality"},{"Capability":"ResultSetAxisType"},{"Capability":"DimensionHierarchyLevels"},{"Capability":"SupportsVariableVariants"},{"Capability":"ReadModesV2"},{"Capability":"ExceptionsV2"},{"Capability":"SupportsSIDPresentation"},{"Capability":"VariableMasking"},{"Capability":"ComplexTupleFilter"},{"Capability":"ExtendedVariableDefinition"},{"Capability":"PresentationLength"},{"Capability":"SuppressKeyfigureCalculation"},{"Capability":"RemoteBlending"},{"Capability":"CubeBlending"},{"Capability":"StructureHierarchyZeroBased"},{"Capability":"MaintainsVariableVariants"},{"Capability":"ResultSetUnitIndex"},{"Capability":"CustomMeasureSortOrder"},{"Capability":"ExceptionAggregationDimsAndFormulas"},{"Capability":"UniversalDisplayHierarchyZeroBased"},{"Capability":"QDataCellModelDefaults"},{"Capability":"SupportsMemberVisibility"},{"Capability":"SupportsMemberVisibility"},{"Capability":"UniversalDisplayHierarchyAlignment"},{"Capability":"ClientInfo"},{"Capability":"StructureRestrictionsInValueHelp"},{"Capability":"SupportsOperatorTotals"},{"Capability":"QueryCurrencyTranslation"},{"Capability":"UniversalDisplayHierarchyCustomDimensions"},{"Capability":"INACurrentMember"},{"Capability":"DynamicRestrictionOnFormula"},{"Capability":"SuppressSupplements"},{"Capability":"TextInHierarchy"},{"Capability":"F4FilterForTextField"},{"Capability":"RespectUnassignedNodeSetting"},{"Capability":"ResultSetHierarchyLevel"},{"Capability":"TransientHierarchy1"},{"Capability":"DynamicMembersOnNonMeasureStructure"},{"Capability":"VariableAutoSubmit"},{"Capability":"ResultStructure"}],"Service":"Analytics"},{"Capabilities":[{"Capability":"EnableClientEPMPlugin","Value":"false"}],"Service":"BWSettings"},{"Capabilities":[{"Capability":"FastPath","Value":"/sap/bw/ina/GetCatalog"},{"Capability":"ExtendedDimensionTypes"},{"Capability":"HierarchyCatalog"},{"Capability":"SemanticalErrorType"},{"Capability":"AttributeHierarchy"},{"Capability":"ClientCapabilities"},{"Capability":"SupportsNonCartesianProduct"},{"Capability":"SupportsEncodedResultSet"},{"Capability":"SupportsDimensionFilterCapability"}],"Service":"Catalog"},{"Capabilities":[{"Capability":"FastPath","Value":"/sap/bw/ina/GetResponse"},{"Capability":"Paging","Value":"Y"}],"Service":"HierarchyMember"},{"Capabilities":[{"Capability":"SupportsBatch","Value":"/sap/bw/ina/BatchProcessing"}],"Service":"InA"},{"Capabilities":[{"Capability":"FastPath","Value":"/sap/bw/ina/GetResponse"},{"Capability":"SupportsExtendedSort"}],"Service":"Masterdata"},{"Capabilities":[{"Capability":"AttributeHierarchyHierarchyFields"},{"Capability":"ClientCapabilities"},{"Capability":"DatasourceAtService"},{"Capability":"FastPath","Value":"/sap/bw/ina/GetResponse"},{"Capability":"HierarchyCatalog"},{"Capability":"HierarchyNavigationCounter"},{"Capability":"NewValuesExtendedFormat"},{"Capability":"NewValuesImplicitUnlock"},{"Capability":"Obtainability"},{"Capability":"QDataCells"},{"Capability":"ResultSetInterval"},{"Capability":"SAPDate"},{"Capability":"StatefulServer"},{"Capability":"Supplements"},{"Capability":"SupportsCummulative"},{"Capability":"SupportsEncodedResultSet"},{"Capability":"SupportsSetOperand"},{"Capability":"VariableReSubmit"},{"Capability":"ZeroSuppression"},{"Capability":"AttributeHierarchy"},{"Capability":"DefinitionReturnsVariableValues"},{"Capability":"DetailedResponseExpansion"},{"Capability":"DimensionHierarchyLevels"},{"Capability":"ExceptionsV2"},{"Capability":"ExpandHierarchyBottomUp"},{"Capability":"ExpandQueryAxis"},{"Capability":"ExtendedDimensionTypes"},{"Capability":"ExtendedVariableDefinition"},{"Capability":"F4FilterForTextField"},{"Capability":"HierarchyNameVariable"},{"Capability":"InitialDrillLevelRelative"},{"Capability":"MDSLikePaging"},{"Capability":"MetadataBaseMeasureName"},{"Capability":"PresentationLength"},{"Capability":"QDataCellModelDefaults"},{"Capability":"ReadModesV2"},{"Capability":"RespectUnassignedNodeSetting"},{"Capability":"StructureHierarchyZeroBased"},{"Capability":"SubmitReturnsVariableValues"},{"Capability":"SupportsDataCellMixedValues"},{"Capability":"SupportsExtendedSort"},{"Capability":"SupportsKeyfigureHierarchies"},{"Capability":"SupportsMemberVisibility"},{"Capability":"SupportsRestrictedKeyFigures"},{"Capability":"SupportsSIDPresentation"},{"Capability":"SuppressSupplements"},{"Capability":"UniversalDisplayHierarchyZeroBased"},{"Capability":"TextInHierarchy"}],"Service":"Planning"},{"Capabilities":[{"Capability":"FastPath","Value":"/sap/bw/ina/GetResponse"},{"Capability":"SupportsEncodedResultSet"},{"Capability":"ServerStructureNames"},{"Capability":"DatasourceAtService"},{"Capability":"SupportsSetOperand"},{"Capability":"Obtainability"},{"Capability":"AttributeHierarchy"}],"Service":"QueryDefinition"},{"Capabilities":[{"Capability":"FastPath","Value":"/sap/bw/ina/GetResponse"}],"Service":"UserManagement"},{"Capabilities":[{"Capability":"FastPath","Value":"/sap/bw/ina/ValueHelp"},{"Capability":"ExtendedDimensionTypes"},{"Capability":"SemanticalErrorType"},{"Capability":"AttributeHierarchy"},{"Capability":"ClientCapabilities"},{"Capability":"SupportsEncodedResultSet"},{"Capability":"InitialDrillLevelRelative"}],"Service":"ValueHelp"},{"Capabilities":[{"Capability":"FastPath","Value":"/sap/bw/ina/GetResponse"}],"Service":"Workspace"},{"Capabilities":[],"Service":"Metadata"}],"Settings":{"EnableClientEPMPlugin":"false"} }'))}else if(e.XString.isEqual(r,this.m_inaPath)){if(t.asStructure().containsKey("Metadata")){if(t.asStructure().containsKey("Metadata")&&t.asStructure().getStructureByKey("Metadata").containsKey("DataSource")&&e.XString.isEqual(t.asStructure().getStructureByKey("Metadata").getStructureByKey("DataSource").getStringByKey("ObjectName"),"$$DataSource$$")){return e.XPair.create(e.XIntegerValue.create(200),this.generateMetadata2().toStructure())}else{var a=this.generateMetadata(i,t.asStructure().getStructureByKey("Metadata").getStructureByKey("DataSource").getStringByKey("ObjectName"));return e.XPair.create(e.XIntegerValue.create(200),a.toStructure())}}else{var n=t.asStructure().getStructureByKey("Analytics").getStructureByKey("Definition").getStructureByKey("ResultSetFeatureRequest").getStructureByKey("SubSetDescription");if(t.asStructure().containsKey("Analytics")&&t.asStructure().getStructureByKey("Analytics").containsKey("DataSource")&&e.XString.isEqual(t.asStructure().getStructureByKey("Analytics").getStructureByKey("DataSource").getStringByKey("ObjectName"),"$$DataSource$$")){return e.XPair.create(e.XIntegerValue.create(200),this.generateResultSet(n.getIntegerByKey("RowFrom"),n.getIntegerByKey("RowTo")).toStructure())}else{var l=t.asStructure().getStructureByKey("Analytics").getStructureByKey("DataSource").getStringByKey("ObjectName");var s=this.generateMetadata(i,l);var o=e.SqlReference.create("CustomDimension1");var u="CustomDimension1";var c=null;var p=this.convertToOlapRequest(t.asStructure().getStructureByKey("Analytics").getStructureByKey("Definition").getListByKey("Dimensions"));if(e.notNull(this.m_metaData)&&this.m_metaData.isStructure()){var g=this.m_metaData.asStructure().getListByKey("DataSources");for(var d=0,y=g.size();d<y;d++){if(e.XString.isEqual(l,g.getStructureAt(d).getStringByKey("Name"))){var S=g.getStructureAt(d).getStringByKey("SqlDataSource");var m=t.asStructure().getStructureByKey("Analytics").getStructureByKey("Definition").getStructureByKey("Filter");var f=t.asStructure().getStructureByKey("Analytics").getStructureByKey("Definition").getStructureByKey("DynamicFilter");if(e.isNull(f)){f=m}var b=null;if(e.notNull(f)){var h=f.getStructureByKey("Selection");b=(new e.OlapFilterToSqlConverter).evaluateSelection(h)}if(e.XString.containsString(S," ")){S=e.SqlOperation.format('({0}) "datasource"',(new e.StringListBuilder).init().add(S).build());u="datasource"}else{S=e.SqlOperation.format('{0} "datasource"',(new e.StringListBuilder).init().add(S).build());u="datasource"}c=o=e.RawSqlTableSource.create(S);var D=this.filterAxis(t,u,this.convertToOlapRequest(s.toStructure().asStructure().getStructureByKey("Cube").getListByKey("Dimensions")),o,"");if(e.notNull(b)){S=e.SqlOperation.format('(select * from ({0}) "datasource" where {1}) "datasource"',(new e.StringListBuilder).init().add(D.toSqlString(new e.SqlCodeGenOptions)).add(b.toSqlString(new e.SqlCodeGenOptions)).build());u="datasource"}else{S=e.SqlOperation.format('({0}) "datasource"',(new e.StringListBuilder).init().add(D.toSqlString(new e.SqlCodeGenOptions)).build());u="datasource"}o=e.RawSqlTableSource.create(S)}}}var v=e.SqlQuery.create().from(o).setDistinct(true);var T=e.SqlQuery.create().from(o).setDistinct(true);var _=e.SqlQuery.create();_.select((new e.SqlSelectAll).setTableReference(e.SqlReference.create(u)));var A=null;var B=false;var O=false;var C=false;var q=e.SqlQuery.create();var N=e.SqlQuery.create();for(var R=0;R<p.getRequest().size();++R){var E=p.getRequest().get(R).getType()===e.OlapRequestEntryType.COLUMN?T:v;if(p.getRequest().get(R).getDim().getType()===e.OlapDimensionType.NORMAL){if(p.getRequest().get(R).getType()===e.OlapRequestEntryType.COLUMN){C=true}else{O=true}var L=e.SqlSelectAlias.create(e.SqlCast.create(e.SqlReference.create2(u,p.getRequest().get(R).getDim().getName()),"varchar"),p.getRequest().get(R).getDim().getName());E.select(L);var G=p.getRequest().get(R).getType()===e.OlapRequestEntryType.COLUMN?N:q;G.select(e.SqlReference.create(p.getRequest().get(R).getDim().getName()));G.groupBy(e.SqlReference.create(p.getRequest().get(R).getDim().getName()));var I=false;var F=t.asStructure().getStructureByKey("Analytics").getStructureByKey("Definition").getListByKey("Sort");if(e.notNull(F)){for(var x=0;x<F.size();x++){if(e.XString.isEqual(F.getStructureAt(x).getStringByKey("Dimension"),p.getRequest().get(R).getDim().getName())&&e.XString.isEqual(F.getStructureAt(x).getStringByKey("Direction"),"Desc")){I=true}}}E.orderBy(e.SqlReference.create(p.getRequest().get(R).getDim().getName()),I);var w=e.SqlOperation.equals(e.SqlReference.create2(u,p.getRequest().get(R).getDim().getName()),e.SqlReference.create2(p.getRequest().get(R).getType()===e.OlapRequestEntryType.COLUMN?"c":"r",p.getRequest().get(R).getDim().getName()));var P=e.SqlReference.create2(u,p.getRequest().get(R).getDim().getName());_.groupBy(P);if(e.isNull(A)){A=w}else{A=e.SqlOperation.and(A,w)}}else if(p.getRequest().get(R).getDim().getType()===e.OlapDimensionType.MEASURE){E.select(e.SqlReference.create(p.getRequest().get(R).getDim().getName()));if(p.getRequest().get(R).getType()===e.OlapRequestEntryType.ROW){B=true}for(var M=0,X=p.getRequest().get(R).getDim().getMembers().size();M<X;M++){_.groupBy(e.SqlReference.create2(u,p.getRequest().get(R).getDim().getMembers().get(M).getName()))}}}var V=this.virtualAxisRequest(t,u,p,v,O,e.OlapRequestEntryType.ROW,B,0,-1);var K=this.virtualAxisRequest(t,u,p,T,C,e.OlapRequestEntryType.COLUMN,!B,0,-1);var z=n.getIntegerByKey("RowFrom");var U=n.getIntegerByKey("RowTo");if(U===-1){U=z+500}var H=U-z;var Q=n.getIntegerByKey("ColumnFrom");var k=n.getIntegerByKey("ColumnTo");if(k===-1){k=Q+500}var j=k-Q;var W=this.virtualAxisRequest(t,u,p,v,O,e.OlapRequestEntryType.ROW,B,z,H);var Y=this.virtualAxisRequest(t,u,p,T,C,e.OlapRequestEntryType.COLUMN,!B,Q,j);var J=e.SqlTableAlias.create(W,"r");var Z=e.SqlTableAlias.create(Y,"c");if(B){_.from(Z);_.from(e.SqlTableAlias.create(q,"r"));q.from(J);if(q.getSelection().size()===0){q.select(e.SqlSelectAlias.create(e.SqlIntegerConstant.create(0),"___INA_SQL_DUMMY"));q.orderBy(e.SqlReference.create("___INA_SQL_DUMMY"),false)}}else{_.from(e.SqlTableAlias.create(N,"c"));_.from(J);N.from(Z);if(N.getSelection().size()===0){N.select(e.SqlSelectAlias.create(e.SqlIntegerConstant.create(0),"___INA_SQL_DUMMY"));N.orderBy(e.SqlReference.create("___INA_SQL_DUMMY"),false)}}var $=p.setDataSource(c,u).ToSql();_.from(e.RawSqlTableSource.create(e.SqlOperation.format('({0}) "{1}"',(new e.StringListBuilder).init().add($).add(u).build())));if(e.notNull(A)){_.where(A.toSqlString(new e.SqlCodeGenOptions))}var ee=_.toSqlString(new e.SqlCodeGenOptions);var te=O||B?this.execSyncQuery(i,W.toSqlString(new e.SqlCodeGenOptions)):e.SqlJsonResultSet.create(e.JsonParserFactory.createFromString('[{"columns":[],"values":[[]]}]').asList());var re=C||!B?this.execSyncQuery(i,Y.toSqlString(new e.SqlCodeGenOptions)):e.SqlJsonResultSet.create(e.JsonParserFactory.createFromString('[{"columns":[],"values":[[]]}]').asList());var ie=this.execSyncQuery(i,ee);var ae=O||B?this.execSyncQuery(i,e.SqlOperation.format("select count(*) from ({0}) x",(new e.StringListBuilder).init().add(V.toSqlString(new e.SqlCodeGenOptions)).build())):null;var ne=C||!B?this.execSyncQuery(i,e.SqlOperation.format("select count(*) from ({0}) x",(new e.StringListBuilder).init().add(K.toSqlString(new e.SqlCodeGenOptions)).build())):null;var le=e.notNull(ae)&&ae.next()?e.XDouble.convertToInt(ae.getDoubleAt(0)):1;var se=e.notNull(ne)&&ne.next()?e.XDouble.convertToInt(ne.getDoubleAt(0)):1;return e.XPair.create(e.XIntegerValue.create(200),this.ConvertResultSet(ie,p,s,H,j,le,se,U,k,te,re))}}}return e.XPair.create(e.XIntegerValue.create(404),e.PrStructure.create())}catch(t){var oe=e.PrStructure.create();oe.putString("message",e.XException.getMessage(t));oe.putString("stacktrace",e.XException.getStackTrace(t,0));return e.XPair.create(e.XIntegerValue.create(500),oe)}};e.OlapSqlProcessor.prototype.filterAxis=function(t,r,i,a,n){var l=e.XList.create();var s=-1;for(var o=0;o<i.getRequest().size();++o){if(i.getRequest().get(o).getDim().getType()===e.OlapDimensionType.NORMAL){l.add(e.SqlReference.create(i.getRequest().get(o).getDim().getName()))}else{s=o;l.add(null)}}if(s!==-1){var u=i.getRequest().get(s).getDim().getMembers();if(u.size()>0){var c=null;for(var p=0;p<u.size();p++){var g=e.SqlQuery.create();for(var d=0;d<l.size();d++){if(l.get(d)===null){g.select(e.SqlSelectAlias.create(e.SqlStringConstant.create(u.get(p).getName()),i.getRequest().get(s).getDim().getName()))}else{g.select(l.get(d))}}for(var y=0;y<u.size();y++){if(u.get(y).getRawValue()===null){g.select(e.SqlReference.create(u.get(y).getName()))}}g.from(a);if(e.isNull(c)){c=g}else{c=e.SqlUnion.create(c,g)}}return c}}var S=e.SqlQuery.create();for(var m=0;m<l.size();m++){if(l.get(m)!==null){S.select(l.get(m))}}S.from(a);return S};e.OlapSqlProcessor.prototype.virtualAxisRequest=function(t,r,i,a,n,l,s,o,u){var c=e.SqlWith.create();c.addDependency("q0",a);if(a.getSelection().size()===0){a.select(e.SqlSelectAlias.create(e.SqlIntegerConstant.create(0),"___INA_SQL_DUMMY"));a.orderBy(e.SqlReference.create("___INA_SQL_DUMMY"),false)}var p=e.SqlQuery.create();p.selectAll();p.limit(o,u);c.setBody(p);var g=e.XList.create();for(var d=0;d<i.getRequest().size();++d){if(i.getRequest().get(d).getType()===l){if(i.getRequest().get(d).getDim().getType()===e.OlapDimensionType.NORMAL){g.add(e.SqlReference.create(i.getRequest().get(d).getDim().getName()))}else{if(s){g.add(e.SqlReference.create(i.getRequest().get(d).getDim().getName()))}}}}var y=0;for(var S=0,m=0;S<i.getRequest().size();++S){if(i.getRequest().get(S).getType()===l){if(i.getRequest().get(S).getDim().getType()===e.OlapDimensionType.NORMAL){var f=e.SqlReference.create2(r,i.getRequest().get(S).getDim().getName());if(i.getRequest().get(S).getHasTotal()){var b=e.SqlOperation.equals(f,e.SqlStringConstant.create("___INA_SQL_TOTAL"));p.orderBy(e.RawSqlConstant.create(e.SqlOperation.format("CASE WHEN {0} THEN 1 ELSE 2 END",e.StringListBuilder.create().add(b.toSqlString(new e.SqlCodeGenOptions)).build())),i.getRequest().get(S).getFollowedByTotal());var h=e.SqlQuery.create();for(var D=0;D<g.size();D++){if(D===m){h.select(e.SqlSelectAlias.create(e.SqlStringConstant.create("___INA_SQL_TOTAL"),i.getRequest().get(S).getDim().getName()));if(i.getRequest().get(S).getHasConditionalTotal()){h.having(e.SqlOperation.greater(e.RawSqlConstant.create("count(*)"),e.SqlIntegerConstant.create(1)).toSqlString(new e.SqlCodeGenOptions))}}else if(g.get(D)!==null){h.select(g.get(D));h.groupBy(g.get(D))}}var v=e.SqlReference.create(e.SqlOperation.format("q{0}",e.StringListBuilder.create().add(e.XInteger.convertToString(y)).build()));h.from(v);c.addDependency(e.SqlOperation.format("q{0}",e.StringListBuilder.create().add(e.XInteger.convertToString(y+1)).build()),e.SqlUnion.create(e.SqlQuery.create().selectAll().from(v),h));y++}var T=false;var _=t.asStructure().getStructureByKey("Analytics").getStructureByKey("Definition").getListByKey("Sort");if(e.notNull(_)){for(var A=0;A<_.size();A++){if(e.XString.isEqual(_.getStructureAt(A).getStringByKey("Dimension"),i.getRequest().get(S).getDim().getName())&&e.XString.isEqual(_.getStructureAt(A).getStringByKey("Direction"),"Desc")){T=true}}}p.orderBy(f,T)}else if(i.getRequest().get(S).getDim().getMembers().size()>1){var B="case";for(var O=0;O<i.getRequest().get(S).getDim().getMembers().size();O++){B=e.SqlOperation.format("{0} when {1} then {2}",e.StringListBuilder.create().add(B).add(e.SqlOperation.equals(e.SqlReference.create2(r,i.getRequest().get(S).getDim().getName()),e.SqlStringConstant.create(i.getRequest().get(S).getDim().getMembers().get(O).getName())).toSqlString(new e.SqlCodeGenOptions)).add(e.XInteger.convertToString(O)).build())}p.orderBy(e.RawSqlConstant.create(e.SqlOperation.format("{0} END",e.StringListBuilder.create().add(B).build())),false)}m++}}p.from(e.SqlTableAlias.create2(e.SqlReference.create(e.SqlOperation.format("q{0}",e.StringListBuilder.create().add(e.XInteger.convertToString(y)).build())),r));return c};e.OlapSqlProcessor.prototype.generateResultSet=function(t,r){var i=this.generateMetadata2();var a=e.GenericResultSetBuilder.create();var n=e.GenericAxisBuilder.create().setName("Rows").setType("Rows");n.getDimensions().add(i.getDimensions().get(0));n.getDimensions().add(i.getDimensions().get(1));a.getAxes().add(n);if(e.notNull(this.m_metaData)&&this.m_metaData.isStructure()){var l=this.m_metaData.asStructure().getListByKey("DataSources");n.setTotalTuples(l.size());for(var s=t,o=r===-1?l.size():e.XMath.min(l.size(),r);s<o;s++){var u=l.getStructureAt(s).getStringByKey("Name");var c=l.getStructureAt(s).getStringByKey("Description");n.appendTuple2((new e.ListBuilder).init().add((new e.StringMapBuilder).init().put("ID",e.PrFactory.createString(u)).put("LONG_TEXT",e.PrFactory.createString(c)).build()).add((new e.StringMapBuilder).init().put("ID",e.PrFactory.createString("Query")).put("LONG_TEXT",e.PrFactory.createString("Query")).build()).build())}}else{n.appendTuple2((new e.ListBuilder).init().add((new e.StringMapBuilder).init().put("ID",e.PrFactory.createString("Test1")).put("LONG_TEXT",e.PrFactory.createString("My Test DataSource 1")).build()).build());n.appendTuple2((new e.ListBuilder).init().add((new e.StringMapBuilder).init().put("ID",e.PrFactory.createString("Test2")).put("LONG_TEXT",e.PrFactory.createString("My Test DataSource 2")).build()).build());n.appendTuple2((new e.ListBuilder).init().add((new e.StringMapBuilder).init().put("ID",e.PrFactory.createString("Test2")).put("LONG_TEXT",e.PrFactory.createString("My Test DataSource 3")).build()).build())}return a};e.OlapSqlProcessor.prototype.generateMetadata2=function(){var t=e.GenericCubeBuilder.create().setBaseDataSource(e.GenericDataSourceBuilder.create().setObjectName("Root").setDescription("Root").setType("InfoCube")).setDataSource(e.GenericDataSourceBuilder.create().setObjectName("$$DataSource$$").setType("Query").setDescription("Basic"));var r=e.GenericDimensionBuilder.create().setName("ObjectName").setDescription("ObjectName").setAxisConstraints(e.StringListBuilder.create().add("Columns").add("Rows").add("Free").build()).setDataType(null).setKeyAttribute(e.XStringUtils.concatenate2("ObjectName",".ID")).setAxisDefault("Rows");r.getAttributes().add(e.GenericAttributeBuilder.create().setIsKey(true).setName("ID").setDataType("String").setPresentationType("Key"));r.getAttributes().add(e.GenericAttributeBuilder.create().setName("LONG_TEXT").setDataType("String").setPresentationType("Text"));t.getDimensions().add(r);r=e.GenericDimensionBuilder.create().setName("Type").setDescription("Type").setAxisConstraints(e.StringListBuilder.create().add("Columns").add("Rows").add("Free").build()).setDataType(null).setKeyAttribute(e.XStringUtils.concatenate2("meta_object_type",".ID")).setAxisDefault("Rows");r.getAttributes().add(e.GenericAttributeBuilder.create().setIsKey(true).setName("ID").setDataType("String").setPresentationType("Key"));r.getAttributes().add(e.GenericAttributeBuilder.create().setName("LONG_TEXT").setDataType("String").setPresentationType("Text"));t.getDimensions().add(r);return t};e.OlapSqlProcessor.prototype.convertToOlapRequest=function(t){var r=e.XList.create();for(var i=0;i<t.size();i++){var a=new e.OlapRequestEntry;var n=new e.OlapDimension;n.setName(t.getStructureAt(i).getStringByKey("Name"));if(t.getStructureAt(i).containsKey("Members")){n.setType(e.OlapDimensionType.MEASURE);n.setMembers(e.XList.create());var l=t.getStructureAt(i).getListByKey("Members");for(var s=0;s<l.size();s++){if(!e.XString.isEqual(l.getStructureAt(s).getStringByKey("Visibility"),"Hidden")){var o=l.getStructureAt(s).getStructureByKey("Formula");var u=null;if(e.notNull(o)){var c=e.OlapFormulaToSql.convert(o);u=e.OlapDimensionMember.create(l.getStructureAt(s).getStringByKey("Name"));u.setRawValue(e.RawSqlConstant.create(c));n.getMembers().add(u);continue}u=e.OlapDimensionMember.create(l.getStructureAt(s).getStructureByKey("MemberOperand").getStringByKey("Value"));u.setDisplayName(l.getStructureAt(s).getStructureByKey("MemberOperand").getStringByKey("Description"));u.setAggregation(e.Aggregation.create("sum",0));n.getMembers().add(u)}}}else{n.setType(e.OlapDimensionType.NORMAL)}a.setDim(n);var p=t.getStructureAt(i).getStringByKey("Axis");a.setType(e.XString.isEqual(p,"Rows")?e.OlapRequestEntryType.ROW:e.OlapRequestEntryType.COLUMN);var g=t.getStructureAt(i).getListByKey("ResultStructure");if(e.notNull(g)&&g.size()===2){if(e.XString.isEqual(g.getStructureAt(1).getStringByKey("Result"),"Total")&&e.XString.isEqual(g.getStructureAt(1).getStringByKey("Visibility"),"Always")){a.setFollowedByTotal(true);a.setHasTotal(true)}else if(e.XString.isEqual(g.getStructureAt(0).getStringByKey("Result"),"Total")&&e.XString.isEqual(g.getStructureAt(0).getStringByKey("Visibility"),"Always")){a.setFollowedByTotal(false);a.setHasTotal(true)}else if(e.XString.isEqual(g.getStructureAt(1).getStringByKey("Result"),"Total")&&e.XString.isEqual(g.getStructureAt(1).getStringByKey("Visibility"),"Conditional")){a.setFollowedByTotal(true);a.setHasTotal(true);a.setHasConditionalTotal(true)}else if(e.XString.isEqual(g.getStructureAt(0).getStringByKey("Result"),"Total")&&e.XString.isEqual(g.getStructureAt(0).getStringByKey("Visibility"),"Conditional")){a.setFollowedByTotal(false);a.setHasTotal(true);a.setHasConditionalTotal(true)}}r.add(a)}var d=e.OlapRequest.create(r,"");return d};e.OlapSqlProcessor.prototype.generateMetadata=function(t,r){var i=e.GenericCubeBuilder.create().setBaseDataSource(e.GenericDataSourceBuilder.create().setObjectName("Root").setDescription("Root").setType("InfoCube")).setDataSource(e.GenericDataSourceBuilder.create().setObjectName("Basic").setType("Query").setDescription("Basic"));if(e.notNull(this.m_metaData)&&this.m_metaData.isStructure()){var a=false;var n=this.m_metaData.asStructure().getListByKey("DataSources");for(var l=0,s=n.size();l<s;l++){if(e.XString.isEqual(r,n.getStructureAt(l).getStringByKey("Name"))){var o=n.getStructureAt(l).getListByKey("Dimensions");for(var u=0;u<o.size();u++){var c=o.getStructureAt(u).getStringByKey("Name");var p=o.getStructureAt(u).getStringByKey("Description");var g=o.getStructureAt(u).getStringByKey("Type");var d=o.getStructureAt(u).getStringByKey("Axis");var y=e.XString.isEqual(g,"Measure");var S=e.GenericDimensionBuilder.create().setName(c).setDescription(p).setAxisConstraints(e.StringListBuilder.create().add("Columns").add("Rows").add("Free").build()).setDataType(null).setKeyAttribute(e.XStringUtils.concatenate2(c,".ID")).setAxisDefault(d);S.getAttributes().add(e.GenericAttributeBuilder.create().setIsKey(true).setName("ID").setDataType("String").setIsFilterable(true).setPresentationType("Key").setObtainability(e.ObtainabilityType.USER_INTERFACE));S.getAttributes().add(e.GenericAttributeBuilder.create().setName("LONG_TEXT").setDataType("String").setIsFilterable(true).setPresentationType("LongText").setObtainability(e.ObtainabilityType.ALWAYS));if(y){a=true;S.setDimensionType(2);S.setAxisConstraints(e.StringListBuilder.create().add("Columns").add("Rows").build());var m=o.getStructureAt(u).getListByKey("Members");for(var f=0;f<m.size();f++){S.putMember((new e.StringMapBuilder).init().put("ID",e.PrFactory.createString(m.getStructureAt(f).getStringByKey("Name"))).put("LONG_TEXT",e.PrFactory.createString(m.getStructureAt(f).getStringByKey("Description"))).build())}}else{S.setDimensionType(3)}i.getDimensions().add(S)}break}}if(!a){var b=e.GenericDimensionBuilder.create().setName("CustomDimension1").setDescription("CustomDimension1").setAxisConstraints(e.StringListBuilder.create().add("Columns").add("Rows").build()).setDataType(null).setKeyAttribute(e.XStringUtils.concatenate2("CustomDimension1",".ID")).setAxisDefault("Columns").setDimensionType(2);b.getAttributes().add(e.GenericAttributeBuilder.create().setIsKey(true).setName("ID").setDataType("String"));b.getAttributes().add(e.GenericAttributeBuilder.create().setName("LONG_TEXT").setDataType("String"));i.getDimensions().add(b)}return i}var h=t.processGetTables(e.SyncType.BLOCKING,null,null,"","public","CustomDimension1").getData();while(h.next()){var D=h.getStringAt(2);var v=t.processGetColumns(e.SyncType.BLOCKING,null,null,"","",D,"").getData();var T=e.GenericDimensionBuilder.create().setName("Measure").setDescription("Data").setDimensionType(2).setAxisDefault("Columns").setAxisConstraints(e.StringListBuilder.create().add("Columns").add("Rows").add("Free").build()).setDataType(null).setKeyAttribute("Measure.ID");T.getAttributes().add(e.GenericAttributeBuilder.create().setIsKey(true).setName("ID").setDataType("String"));T.getAttributes().add(e.GenericAttributeBuilder.create().setName("LONG_TEXT").setDataType("String"));i.getDimensions().clear();while(v.next()){var _=v.getStringAt(3);if(e.XString.isEqual(_,"area")||e.XString.isEqual(_,"area_land")||e.XString.isEqual(_,"area_water")||e.XString.isEqual(_,"population")||e.XString.isEqual(_,"population_growth")||e.XString.isEqual(_,"birth_rate")||e.XString.isEqual(_,"death_rate")||e.XString.isEqual(_,"migration_rate")){T.putMember((new e.StringMapBuilder).init().put("ID",e.PrFactory.createString(_)).put("LONG_TEXT",e.PrFactory.createString(_)).build())}else{var A=e.GenericDimensionBuilder.create().setName(_).setDescription(_).setDimensionType(3).setAxisDefault("Rows").setAxisConstraints(e.StringListBuilder.create().add("Columns").add("Rows").add("Free").build()).setDataType(null).setKeyAttribute(e.XStringUtils.concatenate2(_,".ID"));A.getAttributes().add(e.GenericAttributeBuilder.create().setIsKey(true).setName("ID").setDataType("String"));A.getAttributes().add(e.GenericAttributeBuilder.create().setName("LONG_TEXT").setDataType("String"));i.getDimensions().add(A)}}if(T.getMembers().size()>0){i.getDimensions().add(T);break}}return i};e.OlapSqlProcessor.prototype.ConvertResultSet=function(t,r,i,a,n,l,s,o,u,c,p){var g=e.GenericResultSetBuilder.create();var d=e.GenericAxisBuilder.create().setName("Rows").setType("Rows");var y=e.GenericAxisBuilder.create().setName("Columns").setType("Columns");g.getAxes().add(d);g.getAxes().add(y);d.setTotalTuples(l);y.setTotalTuples(s);var S=u>s?n-(u-s):n;var m=o>l?a-(o-l):a;if(e.notNull(p)){this.populateResultSet(p,r,i,g,e.GenericAxisBuilder.create(),y,true)}if(e.notNull(c)){this.populateResultSet(c,r,i,g,d,e.GenericAxisBuilder.create(),true)}if(S>0&&m>0){g.insert(0,S-1,null);g.insert(m-1,0,null)}this.populateResultSet(t,r,i,g,d,y,false);return g.toStructure()};e.OlapSqlProcessor.prototype.populateResultSet=function(t,r,i,a,n,l,s){var o=s;while(t.next()){var u=r.getRequest().getIterator();var c=e.XList.create();var p=e.XList.create();var g=o;o=false;var d=-1;var y=null;var S=e.XList.create();while(u.hasNext()){var m=u.next();var f=m.getType()===e.OlapRequestEntryType.COLUMN?p:c;if(m.getDim().getType()===e.OlapDimensionType.MEASURE){var b=null;for(var h=0;h<i.getDimensions().size();h++){if(e.XString.isEqual(i.getDimensions().get(h).getName(),m.getDim().getName())){b=i.getDimensions().get(h);break}}if(s){f.add(this.measureIdToDesc(m,b,t.getStringByKey(m.getDim().getName())!==null?t.getStringByKey(m.getDim().getName()):"null"))}else{d=f.size();f.add(null);y=f;for(var D=0,v=m.getDim().getMembers().size();D<v;D++){var T=m.getDim().getMembers().get(D).getName();var _=null;if(!t.hasNullByKey(T)){_=e.PrFactory.createDouble(t.getDoubleByKeyExt(T,-1));if(_.asNumber().getDouble()===-1){for(var A=0;A<t.getMetaData().size();A++){if(e.XString.isEqual(T,t.getMetaData().get(A))&&t.getMetaData().getType(A)===e.SqlResultSetType.STRING){_=e.PrFactory.createString(t.getStringAt(A))}}}}S.add(e.XPair.create(this.measureIdToDesc(m,b,T),_))}}}else{var B=e.PrFactory.createString(t.getStringByKey(m.getDim().getName())!==null?t.getStringByKey(m.getDim().getName()):"null");f.add((new e.StringMapBuilder).init().put("ID",B).put("LONG_TEXT",B).build())}if(g){for(var O=0;O<i.getDimensions().size();O++){if(e.XString.isEqual(i.getDimensions().get(O).getName(),m.getDim().getName())){(m.getType()===e.OlapRequestEntryType.COLUMN?l:n).getDimensions().add(i.getDimensions().get(O))}}}}if(d===-1||S.size()===0){if(d!==-1){y.removeAt(d)}if(s){n.getOrAppendTupleIndex2(c);l.getOrAppendTupleIndex2(p)}}else{for(var C=0;C<S.size();C++){y.set(d,S.get(C).getFirstObject());var q=c.size()===0?0:!s?n.getOrAppendTupleIndex3(c,false,false,false):n.getOrAppendTupleIndex2(c);var N=p.size()===0?0:!s?l.getOrAppendTupleIndex3(p,false,false,false):l.getOrAppendTupleIndex2(p);if(q!==-1&&N!==-1){a.insert(q,N,S.get(C).getSecondObject())}}}}};e.OlapSqlProcessor.prototype.measureIdToDesc=function(t,r,i){var a=e.PrFactory.createString(i);var n=a;if(e.notNull(r)){for(var l=0;l<r.getMembers().size();l++){if(e.XString.isEqual(r.getMembers().getStructureAt(l).getStringByKey(e.XStringUtils.concatenate2(t.getDim().getName(),".ID")),i)){n=e.PrFactory.createString(r.getMembers().getStructureAt(l).getStringByKeyExt(e.XStringUtils.concatenate2(t.getDim().getName(),".LONG_TEXT"),i));break}}}var s=(new e.StringMapBuilder).init().put("ID",a).put("LONG_TEXT",n).build();return s};e.RpcOlapSqlInaUtil={QY_MESSAGES:"Messages",QY_MESSAGE_CLASS:"MessageClass",QY_NUMBER:"Number",QY_TYPE:"Type",QY_TEXT:"Text",VA_SEVERITY_ERROR:2,createErrorResponse:function(t){var r=e.PrFactory.createStructure();var i=r.putNewList(e.RpcOlapSqlInaUtil.QY_MESSAGES);var a=t.size();for(var n=0;n<a;n++){var l=t.get(n);var s=i.addNewStructure();s.putString(e.RpcOlapSqlInaUtil.QY_TEXT,l.getText());s.putInteger(e.RpcOlapSqlInaUtil.QY_TYPE,e.RpcOlapSqlInaUtil.VA_SEVERITY_ERROR);s.putInteger(e.RpcOlapSqlInaUtil.QY_NUMBER,l.getCode());s.putString(e.RpcOlapSqlInaUtil.QY_MESSAGE_CLASS,"RpcSql")}return r},getErrors:function(t){var r=e.XList.create();if(e.notNull(t)&&t.isStructure()){var i=t.asStructure().getByKey(e.RpcOlapSqlInaUtil.QY_MESSAGES);if(e.notNull(i)&&i.isList()){var a=i.asList();for(var n=0,l=a.size();n<l;n++){if(a.getStructureAt(n).getIntegerByKey(e.RpcOlapSqlInaUtil.QY_TYPE)===e.RpcOlapSqlInaUtil.VA_SEVERITY_ERROR){r.add(e.XMessage.createError("RpcSql",a.getStructureAt(n).getStringByKey(e.RpcOlapSqlInaUtil.QY_TEXT),null,false,null))}}}}return r}};e.ArrayIterator=function(){};e.ArrayIterator.prototype=new e.XObject;e.ArrayIterator.prototype._ff_c="ArrayIterator";e.ArrayIterator.create=function(t){var r=new e.ArrayIterator;r.m_a=t;r.m_pos=0;return r};e.ArrayIterator.prototype.m_a=null;e.ArrayIterator.prototype.m_pos=0;e.ArrayIterator.prototype.hasNext=function(){return this.m_pos<this.m_a.size()};e.ArrayIterator.prototype.next=function(){return this.m_a.get(this.m_pos++)};e.DummyIterator=function(){};e.DummyIterator.prototype=new e.XObject;e.DummyIterator.prototype._ff_c="DummyIterator";e.DummyIterator.prototype.hasNext=function(){return false};e.DummyIterator.prototype.next=function(){return null};e.OlapRpcFunctionFactory=function(){};e.OlapRpcFunctionFactory.prototype=new e.RpcFunctionFactory;e.OlapRpcFunctionFactory.prototype._ff_c="OlapRpcFunctionFactory";e.OlapRpcFunctionFactory.staticSetup=function(){var t=new e.OlapRpcFunctionFactory;e.RpcFunctionFactory.registerFactory(null,e.SystemType.VIRTUAL_INA_SQL,t)};e.OlapRpcFunctionFactory.prototype.newRpcFunction=function(t,r,i,a){var n=e.OlapRpcVirtualFunction.create(t,e.XUri.createFromUrl(r));return n};e.RpcOlapSqlProxy=function(){};e.RpcOlapSqlProxy.prototype=new e.XObject;e.RpcOlapSqlProxy.prototype._ff_c="RpcOlapSqlProxy";e.RpcOlapSqlProxy.prototype.m_connectionstring=null;e.RpcOlapSqlProxy.prototype.m_drivername=null;e.RpcOlapSqlProxy.prototype.m_username=null;e.RpcOlapSqlProxy.prototype.m_password=null;e.RpcOlapSqlProxy.prototype.m_metadata=null;e.RpcOlapSqlProxy.prototype.getDataBaseProvider=function(){var t=e.SqlDriverFactory.create(this.m_drivername,null);t.processOpenExt(e.SyncType.BLOCKING,null,null,this.m_connectionstring,this.m_username,this.m_password);return t};e.RpcOlapSqlProxy.prototype.onHttpRequest=function(t){var r=t.getClientHttpRequest().getJsonContent();var i=t.getClientHttpRequest().getRelativePath();var a=t.newServerResponse();a.setContentType(e.ContentType.APPLICATION_JSON);var n=e.OlapSqlProcessor.create();n.setMetaData(this.m_metadata);var l=n.setServerInfo("/sap/sql/ina/GetServerInfo").setInaPath("/sap/sql/ina/GetResponse").onProcess(r,i,this.getDataBaseProvider());a.setStatusCode(l.getFirstObject().getInteger());a.setString(l.getSecondObject().toString());t.setResponse(a)};e.RpcOlapSqlProxy.prototype.initServerContainer=function(t){e.OlapEngineModule.getInstance();this.m_drivername=t.getByKey("drivername");this.m_connectionstring=t.getByKey("connectionstring");this.m_username=t.getByKey("username");this.m_password=t.getByKey("password");var r=e.DefaultSession.create();if(e.notNull(r)){var i=e.XFile.create(r,t.getByKey("metadata"));if(e.notNull(i)&&i.isValid()){var a=i.load();if(e.notNull(a)){this.m_metadata=a.getJsonContent()}}}};e.OlapDimensionType=function(){};e.OlapDimensionType.prototype=new e.XConstant;e.OlapDimensionType.prototype._ff_c="OlapDimensionType";e.OlapDimensionType.MEASURE=null;e.OlapDimensionType.NORMAL=null;e.OlapDimensionType.staticSetup=function(){e.OlapDimensionType.MEASURE=e.OlapDimensionType.create("MEASURE");e.OlapDimensionType.NORMAL=e.OlapDimensionType.create("NORMAL")};e.OlapDimensionType.create=function(t){return e.XConstant.setupName(new e.OlapDimensionType,t)};e.OlapRequestEntryType=function(){};e.OlapRequestEntryType.prototype=new e.XConstant;e.OlapRequestEntryType.prototype._ff_c="OlapRequestEntryType";e.OlapRequestEntryType.ROW=null;e.OlapRequestEntryType.COLUMN=null;e.OlapRequestEntryType.staticSetup=function(){e.OlapRequestEntryType.ROW=e.OlapRequestEntryType.create("ROW");e.OlapRequestEntryType.COLUMN=e.OlapRequestEntryType.create("COLUMN")};e.OlapRequestEntryType.create=function(t){return e.XConstant.setupName(new e.OlapRequestEntryType,t)};e.ShellSqlOlap=function(){};e.ShellSqlOlap.prototype=new e.DfProgram;e.ShellSqlOlap.prototype._ff_c="ShellSqlOlap";e.ShellSqlOlap.COLUMN_SIZE=20;e.ShellSqlOlap.parseLine=function(t){var r=e.XStringTokenizer.splitString(t,",");var i=r.getIterator();var a=e.XList.create();var n=null;while(i.hasNext()){var l=e.XString.trim(i.next());var s=e.XStringTokenizer.splitString(l," on ");while(s.size()===1&&i.hasNext()){l=e.XStringUtils.concatenate3(l,",",e.XString.trim(i.next()));s=e.XStringTokenizer.splitString(l," on ")}if(s.size()===2){var o=new e.OlapRequestEntry;var u=new e.OlapDimension;u.setName(s.get(0));if(e.XString.containsString(u.getName()," with ")){u.setType(e.OlapDimensionType.MEASURE);u.setMembers(e.XList.create());var c=e.XStringTokenizer.splitString(u.getName()," with ");u.setName(e.XString.trim(c.get(0)));var p=e.XStringTokenizer.splitString(e.XString.trim(c.get(1)),",");var g=p.getIterator();while(g.hasNext()){u.getMembers().add(e.OlapDimensionMember.create(e.XString.trim(g.next())))}}else{u.setType(e.OlapDimensionType.NORMAL)}o.setDim(u);var d=e.XString.trim(s.get(1));if(e.XString.containsString(d," where ")){var y=e.XStringTokenizer.splitString(d," where ");d=y.get(0);n=y.get(1)}else{n=null}o.setType(e.XString.isEqual(d,"Rows")?e.OlapRequestEntryType.ROW:e.OlapRequestEntryType.COLUMN);a.add(o)}}return e.OlapRequest.create(a,n)};e.ShellSqlOlap.sortAxis=function(t){for(var r=0,i=t.size();r<i;++r){var a=t.get(r).getValuesAsReadOnlyList();var n=t.get(r).getByKey(e.PrFactory.createString("Total"));if(e.isNull(n)){continue}var l=n.getInteger();for(var s=0,o=a.size();s<o;s++){var u=a.get(s);if(u.getInteger()===o-1){n.setInteger(u.getInteger());u.setInteger(l);break}}}};e.ShellSqlOlap.generateIndex=function(t,r){var i=t.getIterator();var a=r.getIterator();var n=0;while(a.hasNext()&&i.hasNext()){var l=i.next();var s=a.next();var o=l.getByKey(s);if(e.isNull(o)){l.put(s,o=e.XIntegerValue.create(l.size()))}n=l.size()*n+o.getInteger()}return n};e.ShellSqlOlap.prototype.req=null;e.ShellSqlOlap.prototype.sql=null;e.ShellSqlOlap.prototype.doSetupProgramMetadata=function(t){e.DfProgram.prototype.doSetupProgramMetadata.call(this,t);t.addParameterList("query","olap query")};e.ShellSqlOlap.prototype.newProgram=function(){var t=new e.ShellSqlOlap;t.setup();return t};e.ShellSqlOlap.prototype.getProgramName=function(){return"sqlap"};e.ShellSqlOlap.prototype.getDefaultContainerType=function(){return e.ProgramContainerType.CONSOLE};e.ShellSqlOlap.prototype.evalArguments=function(){e.DfProgram.prototype.evalArguments.call(this)};e.ShellSqlOlap.prototype.runProcess=function(){var t=this.getArgumentList();var r=e.XStringBuffer.create();for(var i=0;i<t.size();++i){if(i!==0){r.append(" ")}r.append(t.get(i))}var a=r.toString();this.req=e.ShellSqlOlap.parseLine(a);this.sql=this.req.ToSql();e.XLogger.println(this.sql);var n=e.SqlDriverFactory.create("org.sqlite.JDBC",null);n.processOpenExt(e.SyncType.NON_BLOCKING,this,null,"jdbc:sqlite::memory:",null,null);return false};e.ShellSqlOlap.prototype.convert=function(t){var r=t.getMetaData();var i=e.PrFactory.createList();var a=i.addNewStructure();var n=a.putNewList("columns");for(var l=0;l<r.size();l++){n.add(e.PrFactory.createString(r.get(l)))}var s=a.putNewList("values");var o=e.XMath.pow(-1,.5);if(!e.XMath.isNaN(o)){e.noSupport()}while(t.next()){var u=s.addNewList();for(var c=0;c<r.size();c++){var p=r.getType(c);if(p===e.SqlResultSetType.DOUBLE){u.add(e.PrFactory.createDouble(t.getDoubleAt(c)));continue}if(p===e.SqlResultSetType.LONG){u.add(e.PrFactory.createLong(t.getLongAtExt(c,-1)));continue}if(p===e.SqlResultSetType.INTEGER){u.add(e.PrFactory.createInteger(t.getIntegerAtExt(c,-1)));continue}if(p===e.SqlResultSetType.BOOLEAN){u.add(e.PrFactory.createBoolean(t.getBooleanAtExt(c,true)));continue}if(p===e.SqlResultSetType.STRING){u.add(e.PrFactory.createString(t.getStringAtExt(c,null)));continue}u.addNull()}}return i};e.ShellSqlOlap.prototype.onHttpResponse=function(t,r,i){if(r.getStatusCode()!==200){throw e.XException.createRuntimeException(e.XStringUtils.concatenate2("Failed to get sql query result with message: ",r.getStringContentWithCharset(e.XCharset.UTF8)))}var a=r.getJsonContent();this.onSqlResponse(a);this.exitNow(0)};e.ShellSqlOlap.prototype.onSqlResponse=function(t){var r=e.XList.create();var i=e.XList.create();var a=e.XList.create();var n=e.XList.create();var l=e.XList.create();var s=e.XList.create();var o=e.XListOfString.create();var u=e.XListOfString.create();var c=t.asList();for(var p=0;p<c.size();p++){var g=c.get(p);if(g.isStructure()){var d=g.asStructure().getByKey("values").asList().getIterator();while(d.hasNext()){var y=d.next();var S=this.req.getRequest().getIterator();var m=l.size()===0&&s.size()===0;var f=0;var b=0;while(S.hasNext()){var h=S.next();if(m){if(h.getType()===e.OlapRequestEntryType.COLUMN){o.add(h.getDim().getName())}else{u.add(h.getDim().getName())}}if(h.getDim().getType()!==e.OlapDimensionType.MEASURE){if(h.getType()===e.OlapRequestEntryType.COLUMN){f++}else{b++}continue}if(m){(h.getType()===e.OlapRequestEntryType.COLUMN?l:s).add(e.XIntegerValue.create(h.getType()===e.OlapRequestEntryType.COLUMN?f++:b++))}var D=h.getDim().getMembers().getIterator();while(D.hasNext()){var v=D.next();var T=e.XList.create();var _=e.XList.create();var A=null;var B=y.asList();var O=B.getIterator();var C=g.asStructure().getByKey("columns").asList().getIterator();while(O.hasNext()&&C.hasNext()){var q=C.next();var N=O.next();var R=h.getDim().getMembers().getIterator();var E=false;while(R.hasNext()){if(q.isEqualTo(e.PrFactory.createString(R.next().getName()))){E=true;break}}if(E){if(q.isEqualTo(e.PrFactory.createString(v.getName()))){(h.getType()===e.OlapRequestEntryType.COLUMN?T:_).add(q);A=N}}else{var L=this.req.getRequest().getIterator();while(L.hasNext()){var G=L.next();if(G.getDim().getType()===e.OlapDimensionType.NORMAL&&q.isEqualTo(e.PrFactory.createString(G.getDim().getName()))){(G.getType()===e.OlapRequestEntryType.COLUMN?T:_).add(N);break}}}}while(i.size()<T.size()){i.add(e.XSimpleMap.create())}while(a.size()<_.size()){a.add(e.XSimpleMap.create())}e.ShellSqlOlap.generateIndex(i,T);e.ShellSqlOlap.generateIndex(a,_);n.add(e.OlapResultValue.create(_,T,A))}}}}}e.ShellSqlOlap.sortAxis(i);e.ShellSqlOlap.sortAxis(a);var I=n.getIterator();while(I.hasNext()){var F=I.next();var x=e.ShellSqlOlap.generateIndex(a,F.getRow());var w=e.ShellSqlOlap.generateIndex(i,F.getCol());while(r.size()<=x){r.add(e.XList.create())}var P=r.get(x);if(P.size()<=w){var M=r.getIterator();while(M.hasNext()){var X=M.next();while(X.size()<=w){X.add(null)}}}var V=P.get(w);if(e.notNull(V)&&V.isNumeric()&&F.getValue().isNumeric()){P.set(w,e.PrFactory.createDouble(V.asNumber().getDouble()+F.getValue().asNumber().getDouble()))}else{P.set(w,F.getValue())}}this.printTable(this.mapToSortedArray(a),r,this.printColmap(this.mapToSortedArray(a),this.mapToSortedArray(i),r,o,u))};e.ShellSqlOlap.prototype.printColmap=function(t,r,i,a,n){var l=e.XList.create();var s=e.XList.create();for(var o=r.size(),u=o-1;u>=0;--u){l.add(new e.DummyIterator);var c=e.XStringBuffer.create();s.add(c);var p=a.get(u);var g=(t.size()-1)*(e.ShellSqlOlap.COLUMN_SIZE+1)+e.ShellSqlOlap.COLUMN_SIZE;if(u+1!==o){if(g<e.XString.size(p)){p=e.XString.substring(p,0,g)}for(var d=0;d<g-e.XString.size(p);++d){c.append(" ")}c.append(p);c.append("|")}else{for(var y=0;y<n.size()-1;y++){this.printName(n.get(y),c);c.append("|")}var S=e.XMath.div(e.ShellSqlOlap.COLUMN_SIZE-1,2);var m=n.get(n.size()-1);if(e.XString.size(m)>S){m=e.XString.substring(m,0,S)}c.append(m);for(var f=e.XString.size(m);f<S;f++){c.append(" ")}c.append("\\");g=e.ShellSqlOlap.COLUMN_SIZE-1-S;if(g<e.XString.size(p)){p=e.XString.substring(p,0,g)}for(var b=e.XString.size(p);b<g;b++){c.append(" ")}c.append(p);c.append("|")}}for(var h=0;i.size()>0&&h<i.get(0).size();h++){var D=0;while(D<l.size()&&!l.get(D).hasNext()){D++}if(D<l.size()){if(h!==0){s.get(D).append("|")}this.printName(this.PrToString(l.get(D).next()),s.get(D))}for(var v=D+1;v<l.size();v++){for(var T=0;T<e.ShellSqlOlap.COLUMN_SIZE+1;T++){s.get(v).append(" ")}}for(var _=D-1;_>=0;_--){l.set(_,e.ArrayIterator.create(r.get(r.size()-1-_)));if(h!==0){s.get(_).append("|")}this.printName(this.PrToString(l.get(_).next()),s.get(_))}}var A=0;for(var B=l.size()-1;B>=0;--B){var O=s.get(B).toString();var C=e.XStringBuffer.create();for(var q=0;q<e.XString.size(O);q++){C.append(e.XString.isEqual(e.XString.substring(O,q,q+1),"|")?"+":"-")}A=e.XString.size(O);this.println(C.toString());this.println(O)}return A};e.ShellSqlOlap.prototype.mapToSortedArray=function(t){var r=e.XArray.create(t.size());for(var i=0;i<r.size();i++){var a=e.XArray.create(t.get(i).size());var n=t.get(i).getKeysAsReadOnlyList();for(var l=0;l<a.size();l++){a.set(t.get(i).getByKey(n.get(l)).getInteger(),n.get(l))}r.set(i,a)}return r};e.ShellSqlOlap.prototype.PrToString=function(t){return t.getType()===e.PrElementType.STRING?t.asString().getString():t.getStringRepresentation()};e.ShellSqlOlap.prototype.printTable=function(t,r,i){var a=e.XList.create();for(var n=t.size()-1;n>=0;n--){a.add(new e.DummyIterator)}for(var l=0;l<r.size();l++){var s=e.XStringBuffer.create();var o=0;while(o<a.size()&&!a.get(o).hasNext()){o++}var u=t.size()-o;if(o<a.size()){u--}for(var c=0;c<u;++c){for(var p=0;p<e.ShellSqlOlap.COLUMN_SIZE;++p){s.append(" ")}s.append("|")}if(o<a.size()){this.printName(this.PrToString(a.get(o).next()),s);s.append("|")}for(var g=o-1;g>=0;g--){a.set(g,e.ArrayIterator.create(t.get(t.size()-1-g)));this.printName(this.PrToString(a.get(g).next()),s);s.append("|")}for(var d=0;d<r.get(l).size();d++){var y=r.get(l).get(d);if(d!==0){s.append("|")}if(e.isNull(y)){var S="NULL";s.append(S);for(var m=0;m<e.ShellSqlOlap.COLUMN_SIZE-e.XString.size(S);++m){s.append(" ")}}else{var f=this.PrToString(y);s.append(f);for(var b=0;b<e.ShellSqlOlap.COLUMN_SIZE-e.XString.size(f);++b){s.append(" ")}}}var h=s.toString();var D=e.XStringBuffer.create();for(var v=0;v<i;v++){D.append(v<(a.size()-o-1)*(e.ShellSqlOlap.COLUMN_SIZE+1)-1?v<e.XString.size(h)&&e.XString.isEqual(e.XString.substring(h,v,v+1),"|")?"|":" ":v<e.XString.size(h)&&e.XString.isEqual(e.XString.substring(h,v,v+1),"|")?"+":"-")}this.println(D.toString());this.println(h)}};e.ShellSqlOlap.prototype.printName=function(t,r){r.append(e.XString.size(t)>e.ShellSqlOlap.COLUMN_SIZE?e.XString.substring(t,0,e.ShellSqlOlap.COLUMN_SIZE):t);for(var i=0;i<e.ShellSqlOlap.COLUMN_SIZE-e.XString.size(t);++i){r.append(" ")}};e.ShellSqlOlap.prototype.onOpened=function(e,t,r){t.executeUpdate("CREATE TABLE `test` ( `Country` varchar(2) DEFAULT NULL, `Product` varchar(2) DEFAULT NULL, `Revenue` int DEFAULT NULL, `Profit` int DEFAULT NULL, `Year` int DEFAULT 2020);");t.executeUpdate("INSERT INTO `test` VALUES ('DE','UM',10,2,2020),('DE','UM',20,4,2020),('FR','UM',15,3,2020),('IT','PE',25,2,2020),('IT','PA',31,3,2020),('IT','PE',10,2,2020),('IT','PE',25,2,2021);");this.onSqlResponse(this.convert(t.executeQuery(this.sql)));this.exitNow(0)};e.OlapRpcVirtualFunction=function(){};e.OlapRpcVirtualFunction.prototype=new e.DfRpcFunction;e.OlapRpcVirtualFunction.prototype._ff_c="OlapRpcVirtualFunction";e.OlapRpcVirtualFunction.create=function(t,r){var i=t.getSystemDescription().getProperties().getStringByKey("METADATA");var a=e.XFile.create(t.getProcess(),i);var n=new e.OlapRpcVirtualFunction;n.setupFunction(t,r);var l=a.load();n.m_metadata=e.notNull(l)?l.getJsonContent():null;n.m_driver=e.RpcSqlDriver.create2("rpc",t.getConnectionPool(),t.getSystemDescription().getHost());n.m_driver.open(e.XUri.create());return n};e.OlapRpcVirtualFunction.prototype.m_driver=null;e.OlapRpcVirtualFunction.prototype.m_metadata=null;e.OlapRpcVirtualFunction.prototype.processFunctionExecution=function(t,r,i){var a=this.getRpcRequest();e.XLogger.println("VIRTUAL_INA_SQL Request");e.XLogger.println(a.getUri().getPath());if(a.getRequestStructure()===null){e.XLogger.println("null")}else{e.XLogger.println(a.getRequestStructure().toString())}var n=e.OlapSqlProcessor.create().setMetaData(this.m_metadata).setServerInfo("/sinaInfo").setInaPath("/sinaIna").onProcess(a.getRequestStructure(),a.getUri().getPath(),this.m_driver);e.XLogger.println("VIRTUAL_INA_SQL Response");if(n.getSecondObject()===null){e.XLogger.println("null")}else{e.XLogger.println(n.getSecondObject().toString())}this.setServerStatusCode(n.getFirstObject().getInteger());this.getRpcResponse().setRootElement(n.getSecondObject(),n.getSecondObject().toString());this.setData(this.getRpcResponse());return this.processSyncAction(t,r,i)};e.OlapEngineModule=function(){};e.OlapEngineModule.prototype=new e.DfModule;e.OlapEngineModule.prototype._ff_c="OlapEngineModule";e.OlapEngineModule.s_module=null;e.OlapEngineModule.getInstance=function(){if(e.isNull(e.OlapEngineModule.s_module)){e.DfModule.checkInitialized(e.RuntimeModule.getInstance());e.OlapEngineModule.s_module=e.DfModule.startExt(new e.OlapEngineModule);e.OlapDimensionType.staticSetup();e.OlapRequestEntryType.staticSetup();e.OlapRpcFunctionFactory.staticSetup();e.DfModule.stopExt(e.OlapEngineModule.s_module)}return e.OlapEngineModule.s_module};e.OlapEngineModule.prototype.getName=function(){return"ff4500.olap.engine"};e.OlapEngineModule.getInstance();return sap.firefly});
//# sourceMappingURL=ff4500.olap.engine.js.map