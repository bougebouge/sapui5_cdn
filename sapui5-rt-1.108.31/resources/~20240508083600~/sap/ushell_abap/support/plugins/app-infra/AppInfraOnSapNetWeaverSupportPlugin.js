// Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/core/support/Plugin","sap/ui/core/HTML","sap/ui/layout/VerticalLayout","sap/m/Text","sap/base/i18n/ResourceBundle","sap/base/security/encodeXML","sap/m/Panel","sap/m/Toolbar","sap/m/Image","sap/m/Title"],function(jQuery,e,t,n,s,r,a,i,p,o,u){"use strict";var c=e.extend("sap.ushell_abap.support.plugins.app-infra.AppInfraOnSapNetWeaverSupportPlugin",{constructor:function(t){this.sModulePath=sap.ui.require.toUrl("sap/ushell_abap/support/plugins/app-infra");this.oI18n=r.create({url:this.sModulePath+"/i18n/AppInfraOnSapNetWeaverSupportPlugin.properties"});e.apply(this,["sapUiAppInfraOnSapNetWeaverSupportPlugin",this.oI18n.getText("BACKEND_INFRASTRUCTURE"),t])}});c.prototype.isToolPlugin=function(){return true};c.prototype.isAppPlugin=function(){return false};var l=a("@08@"),h=a("@09@"),d=a("@0A@");c.prototype.getReportLine=function(e,t){var n=t&&t.putAtBeginningOfEachLine?t.putAtBeginningOfEachLine:"";e=e===""?"&nbsp;":a(e);e="<div>"+n+e.replace(l,"<img src='"+this.sModulePath+"/ABAP_ICON_GREEN_LIGHT.png'>").replace(h,"<img src='"+this.sModulePath+"/ABAP_ICON_YELLOW_LIGHT.png'>").replace(d,"<img src='"+this.sModulePath+"/ABAP_ICON_RED_LIGHT.png'>")+"</div>";return e};c.prototype.writeReportLine=function(e,t){e.write(this.getReportLine(t))};c.prototype.getReportLines=function(e,t){var n=this;return e.reduce(function(e,s){return e+n.getReportLine(s,t)},"")};c.prototype.writeFormatted=function(e){try{var r=this,a=[],c;this.oInfo=new n("backEndInformation",{content:[new s({text:e.topic}),new s({text:"\n"}),new s({text:this.oI18n.getText("SYSTEM_ID")+" : "+e.sapNetWeaverAsAbap.systemId+" ( "+e.sapNetWeaverAsAbap.systemText+" )"}),new s({text:this.oI18n.getText("CLIENT")+" : "+e.sapNetWeaverAsAbap.client+" ( "+e.sapNetWeaverAsAbap.clientDescription+" )"}),new s({text:this.oI18n.getText("SAP_NETWEAVER_RELEASE")+" : "+e.sapNetWeaverAsAbap.release}),new s({text:"\n"}),new s({text:this.oI18n.getText("SAP_UI_SOFTWARE_COMPONENT")+" : "+e.sapUi.softwareComponent+" ( "+e.sapUi.softwareComponentDescription+" )"}),new s({text:this.oI18n.getText("VERSION")+" : "+e.sapUi.version}),new s({text:this.oI18n.getText("SUPPORT_PACKAGE_LEVEL")+" : "+e.sapUi.supportPackageLevel}),new s({text:"\n"})].map(function(e){return e.addStyleClass("checkInfo")})});a.push(this.oInfo);e.checks.forEach(function(e){function n(e){switch(e.outcome.status){case"S":return r.sModulePath+"/ABAP_ICON_GREEN_LIGHT.png";case"W":return r.sModulePath+"/ABAP_ICON_YELLOW_LIGHT.png";case"E":return r.sModulePath+"/ABAP_ICON_RED_LIGHT.png";default:console.error('SAPUI5 Apps: Check of Infrastructure on SAP NetWeaver Application Server for ABAP - Received invalid status: "'+e.outcome.status+'" for Check "'+e.title+'"');return r.sModulePath+"/ABAP_ICON_LIGHT_OUT.png"}}c=new i({expandable:true,expanded:false,width:"auto",headerToolbar:new p({content:[new o({src:n(e)}),new u({level:"H3",text:e.outcome.message})]})});function s(e){switch(e){case"S":return"checkSuccessful";case"W":return"checkEndedWithWarnings";case"E":return"checkEndedWithErrors";default:return""}}c.addStyleClass(s(e.outcome.status));var l=(new t).setContent('<div class="checkSummary">'+r.getReportLines(e.outcome.summary)+'</div><div>&nbsp;</div>&nbsp;<div class="sapMText">'+r.oI18n.getText("DETAILS_BELOW")+'</div><div>&nbsp;</div><div class="checkDetails">'+r.getReportLines(e.outcome.details,{putAtBeginningOfEachLine:"&emsp;&emsp;&emsp;"})+"</div>");c.addContent(l);a.push(c)});return new n({content:a,width:"100%"})}catch(e){return new s({text:this.oI18n.getText("ERROR_RESPONSE_FROM_BACKEND_NOT_PROPERLY_FORMATTED")})}};c.prototype.init=function(){if(this.runsAsToolPlugin()){var e=this,t=sap.ui.getCore().createRenderManager();t.write('<div id="'+this.getId()+'-Area"></div>').flush(this.$().get(0));this.addStylesheet("sap/ushell_abap/support/plugins/app-infra/AppInfraOnSapNetWeaverSupportPlugin");t.destroy();var n=this.check().done(function(t){e.writeFormatted(t).placeAt(e.getId()+"-Area")}).fail(function(){new s("noBackEndResult",{text:e.oI18n.getText("ERROR_UNABLE_TO_RETRIEVE_INFORMATION_FROM_BACKEND")}).placeAt(e.getId()+"-Area")});return n}};c.prototype.exit=function(){e.prototype.exit.apply(this,arguments)};c.prototype.destroy=function(){if(this.oInfo){this.oInfo.destroy()}e.prototype.destroy.apply(this,arguments)};c.prototype.check=function(){return jQuery.getJSON("/sap/bc/ui2/check_app_infra",{})};return c});
//# sourceMappingURL=AppInfraOnSapNetWeaverSupportPlugin.js.map