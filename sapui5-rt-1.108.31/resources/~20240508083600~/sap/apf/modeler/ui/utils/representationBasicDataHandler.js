/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.define(["sap/apf/modeler/ui/utils/constants","sap/apf/modeler/ui/utils/propertyTypeOrchestration"],function(e,t){"use strict";function r(e,t,r,o){this.oRepresentationView=e;this.oRepresentation=r.oRepresentation;this.oStepPropertyMetadataHandler=t;this.oRepresentationTypeHandler=r.oRepresentationTypeHandler;this.oRepresentationHandler=r;this.nCounter=0;this.oViewValidator=o;this.propertyTypeHandlerPromises=[]}r.prototype._prepareCommonView=function(t,r,o,n){var a,i={},p={};if(o.length===0){return}p.oConfigurationEditor=t.oRepresentationView.getViewData().oConfigurationEditor;p.oParentObject=t.oRepresentation;p.oCoreApi=t.oRepresentationView.getViewData().oCoreApi;p.oConfigurationHandler=t.oRepresentationView.getViewData().oConfigurationHandler;p.oRepresentationTypeHandler=t.oRepresentationTypeHandler;p.oRepresentationHandler=t.oRepresentationHandler;p.oStepPropertyMetadataHandler=t.oStepPropertyMetadataHandler;p.sPropertyType=r;p.oBasicDataLayout=t.oRepresentationView.getController().byId("idBasicDataLayout");p.oTextPool=t.oRepresentationView.getViewData().oConfigurationHandler.getTextPool();p.oViewValidator=t.oViewValidator;i.oViewDataForPropertyType=p;i.aPropertiesToBeCreated=o;i.oPropertyOrchestration=n;a=new sap.ui.view({viewName:"sap.apf.modeler.ui.view.propertyTypeHandler",type:sap.ui.core.mvc.ViewType.XML,id:t.oRepresentationView.getController().createId("id"+r),viewData:i});t.oRepresentationView.getController().byId("idBasicDataLayout").insertItem(a,t.nCounter);t.nCounter++;t.oRepresentationView.attachEvent(e.events.REMOVEALLPROPERTIESFROMPARENTOBJECT,a.getController().handleRemoveOfProperty.bind(a.getController()));t.propertyTypeHandlerPromises.push(a.getController().initPromise)};function o(t,r){t._prepareCommonView(t,e.propertyTypes.DIMENSION,t.oRepresentationHandler.getActualDimensions(),r)}function n(t,r){t._prepareCommonView(t,e.propertyTypes.LEGEND,t.oRepresentationHandler.getActualLegends(),r)}function a(t,r){t._prepareCommonView(t,e.propertyTypes.MEASURE,t.oRepresentationHandler.getActualMeasures(),r)}function i(t,r){t._prepareCommonView(t,e.propertyTypes.PROPERTY,t.oRepresentationHandler.getActualProperties(),r)}function p(t,r){t._prepareCommonView(t,e.propertyTypes.HIERARCHIALCOLUMN,t.oRepresentationHandler.getHierarchicalProperty(),r)}r.prototype.instantiateBasicDataAsPromise=function(){var r=this;var s=r.oRepresentation.getId();var l=jQuery.Deferred();this.propertyTypeHandlerPromises.push(l);t.getConsumableAndAvailablePropertiesAsPromise(s,e.aggregationRoles.DIMENSION,r.oStepPropertyMetadataHandler).then(function(y){t.getConsumableAndAvailablePropertiesAsPromise(s,e.aggregationRoles.MEASURE,r.oStepPropertyMetadataHandler).then(function(e){var s;var y;var d;r.destroyBasicData();if(r.oRepresentation.getRepresentationType()==="TreeTableRepresentation"){d=new t.PropertyTypeOrchestration;p(r,d);i(r,d)}else if(r.oRepresentation.getRepresentationType()==="TableRepresentation"){d=new t.PropertyTypeOrchestration;i(r,d)}else{y=new t.PropertyTypeOrchestration;o(r,y);n(r,y);s=new t.PropertyTypeOrchestration;a(r,s)}l.resolve()})});return jQuery.when.apply(jQuery,this.propertyTypeHandlerPromises)};r.prototype.destroyBasicData=function(){this.oViewValidator.clearFields();this.nCounter=0;this.oRepresentationView.getController().byId("idBasicDataLayout").destroyItems()};return r});
//# sourceMappingURL=representationBasicDataHandler.js.map