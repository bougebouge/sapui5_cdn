/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.define(["sap/apf/utils/trace"],function(e){"use strict";sap.ui.controller("sap.apf.ui.reuse.controller.pathGallery",{onInit:function(){this.oCoreApi=this.getView().getViewData().oInject.oCoreApi;this.oUiApi=this.getView().getViewData().oInject.uiApi;this.oSerializationMediator=this.getView().getViewData().oInject.oSerializationMediator;if(sap.ui.Device.system.desktop){this.getView().addStyleClass("sapUiSizeCompact")}},openPathGallery:function(){if(this.oDialog){this.oDialog.destroy()}this.oDialog=new sap.ui.jsfragment("sap.apf.ui.reuse.fragment.pathGallery",this);var e=new sap.ui.model.json.JSONModel;var t=this.getPathGalleryData();e.setData(t);this.oDialog.setModel(e);if(sap.ui.Device.system.desktop){this.oDialog.addStyleClass("sapUiSizeCompact")}this.oDialog.setInitialFocus(this.oDialog);this.oDialog.open()},getPathGalleryData:function(){var e=this;var t=this.getView().getViewData()?this.getView().getViewData().jsonData:{};var i=function(){var t={steps:e.oCoreApi.getStepTemplates()};return t};if(t.GalleryElements.length!==0){var a=t.GalleryElements;var s=i();var o,r,n,l;for(o=0;o<a.length;o++){for(r=0;r<a[o].StructuredAnalysisPath.steps.length;r++){for(n=0;n<s.steps.length;n++){var p=a[o].StructuredAnalysisPath.steps[r].stepId;var h=a[o].StructuredAnalysisPath.steps[r].selectedRepresentationId;if(p===s.steps[n].id){for(l in s.steps[n].getRepresentationInfo()){if(h===s.steps[n].getRepresentationInfo()[l].representationId){t.GalleryElements[o].StructuredAnalysisPath.steps[r].imgSrc=s.steps[n].getRepresentationInfo()[l].picture;t.GalleryElements[o].StructuredAnalysisPath.steps[r].title=e.oCoreApi.getTextNotHtmlEncoded(s.steps[n].title.key)}}}}}}}return t},openPath:function(t,i,a){e.log("pathGallery.openPath",", ",a,", guid",i,"***********************");var s=this;var o;var r=s.oUiApi.getAnalysisPath().getCarouselView();this.oUiApi.getAnalysisPath().getCarouselView().oController.removeAllThumbnails();s.oSerializationMediator.openPath(i,function(s){return function(n,l,p){var h=s.oUiApi.getLayoutView().getController();var u=s.oUiApi.getAnalysisPath().getController();e.log("pathGallery.openPath continuation",", activeStepindex=",a,", guid=",i);if(p===undefined&&typeof n==="object"){u.setIsOpenPath(true);s.oUiApi.contextChanged();u.refresh(-1);s.oCoreApi.updatePath(u.callBackForUpdatePath.bind(u));s.oCoreApi.setDirtyState(false);h.setPathTitle();if(s.oDialog!==undefined){s.oDialog.close()}r.rerender();s.oUiApi.getLayoutView().setBusy(false)}else{o=s.oCoreApi.createMessageObject({code:"6008",aParameters:[t]});o.setPrevious(p);s.oUiApi.getLayoutView().setBusy(false);s.oCoreApi.putMessage(o)}}}(this),a)}})});
//# sourceMappingURL=pathGallery.controller.js.map