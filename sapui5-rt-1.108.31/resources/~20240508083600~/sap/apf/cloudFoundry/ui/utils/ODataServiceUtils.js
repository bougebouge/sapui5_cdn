sap.ui.define(["sap/ui/model/odata/v2/ODataModel"],function(e){"use strict";var t="/destination/";var n="/sap/opu/odata/iwfnd/catalogservice;v=2/";var r="/$metadata";var a="/odata/v2/";var i={CATALOG:"CATALOG",SERVICE:"SERVICE",OTHER:"OTHER"};var u={PENDING:"PENDING",ANALYTICAL_SERVICE:"ANALYTICAL_SERVICE",NOT_ANALYTICAL_SERVICE:"NOT_ANALYTICAL_SERVICE",WRONG_ODATA_VERSION:"WRONG_ODATA_VERSION",NOT_ACCESSIBLE:"NOT_ACCESSIBLE"};function o(e){return t+e+n}function s(e){var t=(e||"").match(new RegExp("https?:\\/\\/[^\\/]+\\/(.+)"));return t?"/"+t[1]:""}function f(e,t){if(!e||typeof e!=="string"||!t||typeof t!=="string"){return undefined}else if(!t.includes("://")){return undefined}var n;if(e.startsWith(t)){n=e.slice(t.length)}else if(e.includes("://")){return undefined}else{n=e}if(n.startsWith("/")){return n}return"/"+n}function c(e,n){return t+e+n}function E(e){var a=function(e,a){jQuery.ajax(t+e.name+r).then(function(){a(i.SERVICE)}).fail(function(){if(e.proxyType=="OnPremise"){jQuery.ajax(t+e.name+n).then(function(){a(i.CATALOG)}).fail(function(){a(i.OTHER)})}else{a(i.OTHER)}})};return e.map(function(e){return new Promise(function(t){a(e,t)})}).reduce(function(t,n,r){t[e[r].name]=n;return t},{})}function A(t,n){return new Promise(function(r,a){var i=c(t,n);var o=new e(i);o.attachMetadataFailed(function(e){var t=e.getParameter("response");if(t&&t.headers["odata-version"]&&!t.headers["odata-version"].startsWith("2")){a(u.WRONG_ODATA_VERSION)}else{a(u.NOT_ACCESSIBLE)}});var s=o.getMetaModel();s.loaded().then(function(){var e=s.getODataEntityContainer().entitySet.some(function(e){return s.getODataEntityType(e.entityType).property.some(function(e){return e["sap:aggregation-role"]==="measure"})});r(e?u.ANALYTICAL_SERVICE:u.NOT_ANALYTICAL_SERVICE)})})}function d(e){return new Promise(function(n,r){jQuery.ajax(t+e+a).done(function(e,t,a){if(a.status===200&&jQuery(e).filter("h1").text().trim()==="OData endpoints:"){var i=jQuery(e).filter("a").map(function(e,t){return{Url:s(t.href)}}).toArray();n(i)}else{r()}}).fail(function(){r()})})}return{DESTINATION_TYPE:i,SERVICE_STATUS:u,getCatalogURL:o,getRelativeServiceURL:s,getFullServiceURL:c,getRelativeURL:f,pingDestinations:E,isAnalyticalService:A,discoverServices:d}},true);
//# sourceMappingURL=ODataServiceUtils.js.map