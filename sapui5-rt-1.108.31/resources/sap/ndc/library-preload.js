//@ui5-bundle sap/ndc/library-preload.js
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ndc/BarcodeScannerButton", ["./BarcodeScanner","./BarcodeScannerButtonRenderer","./library","sap/m/Button","sap/ui/core/Control","sap/ui/model/resource/ResourceModel"],function(e,t,a,i,n,r){"use strict";var o=n.extend("sap.ndc.BarcodeScannerButton",{metadata:{library:"sap.ndc",properties:{provideFallback:{type:"boolean",defaultValue:true},width:{type:"sap.ui.core.CSSSize",defaultValue:null},dialogTitle:{type:"string",defaultValue:null},preferFrontCamera:{type:"boolean",defaultValue:false},frameRate:{type:"float"},zoom:{type:"float"},keepCameraScan:{type:"boolean",defaultValue:false},disableBarcodeInputDialog:{type:"boolean",defaultValue:false}},aggregations:{_btn:{type:"sap.m.Button",multiple:false,visibility:"hidden"}},events:{scanSuccess:{parameters:{text:{type:"string"},format:{type:"string"},cancelled:{type:"boolean"}}},scanFail:{},inputLiveUpdate:{parameters:{newValue:{type:"string"}}}}},renderer:t});var s;o.prototype.init=function(){s=new r({bundleName:"sap.ndc.messagebundle"});this.setAggregation("_btn",new i({icon:"sap-icon://bar-code",tooltip:s.getProperty("BARCODE_SCANNER_BUTTON_TOOLTIP"),press:this._onBtnPressed.bind(this),width:"100%"}));var t=e.getStatusModel();this.setModel(t,"status")};o.prototype._onBtnPressed=function(t){e.scan(this._onScanSuccess.bind(this),this._onScanFail.bind(this),this._onInputLiveUpdate.bind(this),this.getProperty("dialogTitle"),this.getProperty("preferFrontCamera"),this.getProperty("frameRate"),this.getProperty("zoom"),this.getProperty("keepCameraScan"),this.getProperty("disableBarcodeInputDialog"))};o.prototype._onScanSuccess=function(e){this.fireScanSuccess(e)};o.prototype._onScanFail=function(e){this.fireScanFail(e)};o.prototype._onInputLiveUpdate=function(e){this.fireInputLiveUpdate(e)};o.prototype.setProvideFallback=function(e){var t=this.getProvideFallback();var a;e=!!e;if(t!==e){this.setProperty("provideFallback",e);a=this.getAggregation("_btn");if(e){a.unbindProperty("visible");a.setVisible(true)}else{a.bindProperty("visible","status>/available")}}return this};return o});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ndc/BarcodeScannerButtonRenderer", [],function(){"use strict";var e={apiVersion:2};e.render=function(e,n){e.openStart("span",n);e.style("display","inline-block");e.style("width",n.getWidth());e.openEnd();e.renderControl(n.getAggregation("_btn"));e.close("span")};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ndc/BarcodeScannerUIContainer", ["sap/ui/core/Control"],function(e){"use strict";var a=e.extend("sap.ndc.BarcodeScannerUIContainer",{metadata:{properties:{prefixId:"string"}},renderer:{apiVersion:2,render:function(e,a){e.openStart("div",a);e.class("sapNdcRTCDialogVideo");e.openEnd();e.openStart("video",a.getId()+"-video");e.attr("autoplay","autoplay");e.attr("webkit-playsinline","webkit-playsinline");e.attr("playsinline","playsinline");e.class("sapNdcRTCDialogVideoContainer");e.openEnd();e.close("video");e.close("div");e.openStart("div",a.getId()+"-overlay");e.class("sapNdcRTCDialogOverlay");e.openEnd();e.openStart("div",a.getId()+"-overlay-box");e.class("sapNdcRTCDialogOverlayBox");e.openEnd();e.openStart("div",a.getId()+"-overlay-line");e.class("sapNdcRTCDialogOverlayLine");e.openEnd();e.close("div");e.close("div");e.close("div");e.openStart("div",a.getId()+"-highlight");e.attr("hidden",true);e.class("sapNdcRTCDialogHighlight");e.openEnd();e.close("div")}}});return a});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ndc/library", ["sap/m/library","sap/ui/core/Core","sap/ui/core/library"],function(){"use strict";var e=sap.ui.getCore().initLibrary({name:"sap.ndc",dependencies:["sap.ui.core","sap.m"],types:[],interfaces:[],controls:["sap.ndc.BarcodeScannerButton","sap.ndc.BarcodeScannerUIContainer"],elements:[],noLibraryCSS:true,version:"1.108.28"});return e});
sap.ui.require.preload({
	"sap/ndc/BarcodeScanner.js":function(){
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.loader.config({shim:{"sap/ndc/thirdparty/zxingcpp/zxing_reader":{amd:true,exports:"ZXing"}}});sap.ui.define(["sap/base/Log","sap/ui/model/json/JSONModel","sap/ui/model/BindingMode","sap/ui/model/resource/ResourceModel","sap/m/Input","sap/m/Label","sap/m/Button","sap/m/Dialog","sap/m/BusyDialog","sap/ui/dom/includeStylesheet","./BarcodeScannerUIContainer","sap/m/MessageToast","sap/m/library","sap/ui/base/Event","sap/ui/base/EventProvider","sap/ui/Device","sap/ui/thirdparty/jquery","sap/base/util/deepClone"],function(e,a,n,t,r,i,o,c,s,d,l,u,f,g,p,P,jQuery,v){"use strict";document.addEventListener("settingsDone",ae);document.addEventListener("SettingCompleted",ae);document.addEventListener("mockSettingsDone",ae);d({url:sap.ui.require.toUrl("sap/ndc/css/sapNdcBarcodeScanner.css")});var y={},b,B,h,S,m,C,E,I,w={Initial:"Initial",Loading:"Loading",Available:"Available",UnAvailable:"UnAvailable"},A=new a({scannerAPI:"unknown",available:false,config:{defaultConstraints:{audio:false,video:{facingMode:"environment"}},deviceId:undefined,preferFrontCamera:false,enableGS1Header:false},scanDialog:{title:"",onLiveUpdate:null,barcodeOverlaySetup:false,scanningStartTime:0,keepCameraScan:false,disableBarcodeInputDialog:false},callBackHandler:{onFnFail:null,onFnSuccess:null,callBackFromSetPhysicalScan:false},devices:{mainCamera:undefined,needCheck:true,all:[],front:[],back:[]},apis:{ZebraEnterpriseBrowser:{key:"ZebraEnterpriseBrowser",description:"Zebra Enterprise Browser",status:w.Initial,enableBarcodeState:"init",enableZebraBarcodeRetryCount:6},Cordova:{key:"Cordova",description:"Cordova",status:w.Initial,scannerAPI:null},ZXingCPP:{key:"ZXingCPP",description:"WebAssembly build (using Emcripten) of zxing-cpp",status:w.Initial,instance:null,scannerAPI:null}},bReady:true}),D=new a({scannerAPI:"unknown",available:false,deviceId:undefined,devices:[],apis:{ZebraEnterpriseBrowser:{key:"ZebraEnterpriseBrowser",status:w.Initial},Cordova:{key:"Cordova",status:w.Initial},ZXingCPP:{key:"ZXingCPP",status:w.Initial}}}).setDefaultBindingMode(n.OneWay),k=new t({bundleName:"sap.ndc.messagebundle"});function R(e){return A.getProperty("/apis/"+e+"/")}function Z(a,n,t){if(!a||!R(a)){e.error("BarcodeScanner.updateScannerAPI: scanner API '"+a+"' is not a valid status code, stop update scanner API. Please check!");return}var r="/apis/"+a+"/";if(n){if(w[n]){A.setProperty(r+"status",n);D.setProperty(r+"status",n)}else{e.error("BarcodeScanner.updateScannerAPI: scanner API status '"+n+"' is not a valid status code, please check!")}}if(typeof t==="boolean"&&t){A.setProperty("/scannerAPI",a);D.setProperty("/scannerAPI",a)}A.checkUpdate(true);D.checkUpdate(true)}function _(e,a){Z(e,w.Available,a)}function O(e){A.setProperty("/apis/"+e+"/instance",null);A.setProperty("/apis/"+e+"/scannerAPI",null);Z(e,w.UnAvailable)}function M(){return A.getProperty("/scannerAPI")}function x(e){if(e==="unknown"){A.setProperty("/scannerAPI",e);D.setProperty("/scannerAPI",e)}else{Z(e,undefined,true)}}function T(a,n){if(!a||!R(a)){e.error("BarcodeScanner.checkScannerAPIStatus: scanner API '"+a+"' doesn't exist. Please check!");return false}var t=A.getProperty("/apis/"+a+"/status");return n===t}function F(e){return T(e,w.Available)}function L(e){return T(e,w.UnAvailable)}function X(){A.setProperty("/available",false);D.setProperty("/available",false);H()}function H(){O("ZXingCPP");e.debug("BarcodeScanner.disableZXingCPP: Set status of Feature scanner APIs (ZXingCPP) to unavailable!")}function U(){try{var a=cordova.plugins.barcodeScanner;if(a){A.setProperty("/apis/Cordova/scannerAPI",a);_("Cordova");if(M()==="unknown"){x("Cordova")}e.debug("BarcodeScanner.initScannerAPIs: Cordova BarcodeScanner plugin is available!");H()}else{e.debug("BarcodeScanner.initScannerAPIs: Cordova BarcodeScanner plugin is unavailable!");O("Cordova");N()}}catch(a){e.debug("BarcodeScanner.initScannerAPIs: Cordova BarcodeScanner plugin is unavailable!");O("Cordova");N()}}function N(){jQuery(document).ready(function(){if(q()){V()}});G()}function z(a){e.error(a);e.warning("BarcodeScanner.loadZXingCPPFailed: no feature scanner API available now.");X();A.checkUpdate(true)}function G(){e.debug("BarcodeScanner.loadZXingCPPAPI: load ZXingCPP API");Z("ZXingCPP",w.Loading);sap.ui.require(["sap/ndc/thirdparty/zxingcpp/zxing_reader"],function(a){A.setProperty("/apis/ZXingCPP/instance",a);if(M()==="unknown"){x("ZXingCPP")}e.debug("BarcodeScanner.loadZXingCPPAPI: ZXingCPP API is Initial!");Z("ZXingCPP",w.Initial)},function(e){z("BarcodeScanner.loadZXingCPPAPI: ZXingCPP API is unavailable.\n"+e)})}function W(a,n){var t=new s({title:k.getProperty("BARCODE_DIALOG_BUSY_TITLE"),text:k.getProperty("BARCODE_DIALOG_BUSY_TEXT_ZXINGCPP")});t.open();Z("ZXingCPP",w.Loading);var r={locateFile:function(e,a){return j(e,a,"zxingcpp")}};var i=A.getProperty("/apis/ZXingCPP/instance");i(r).then(function(n){A.setProperty("/apis/ZXingCPP/scannerAPI",n);e.debug("BarcodeScanner.loadZXingCPPInstance: wasm lib instance of ZXingCPP is available!");_("ZXingCPP");if(M()==="unknown"){x("ZXingCPP")}e.debug("BarcodeScanner.loadZXingCPPInstance: ZXingCPP API is available!");t.close();a()},function(e){z("BarcodeScanner.loadZXingCPPInstance: can not load wasm lib instance of ZXingCPP.\n"+e);t.close();n()})}function j(e,a,n){if(!a||a===""){return sap.ui.require.toUrl("sap/ndc/thirdparty/"+n+"/")+e}return a+e}function q(){return!!(window&&window.navigator&&window.navigator.mediaDevices&&window.navigator.mediaDevices.enumerateDevices)}function V(){e.debug("BarcodeScanner.getDeviceCameras: start to get device cameras");window.navigator.mediaDevices.enumerateDevices().then(function(a){var n=A.getProperty("/devices");var t=0;a.forEach(function(a){if(a.kind==="videoinput"){t++;var r={deviceId:a.deviceId,groupId:a.groupId,kind:a.kind,label:a.label};if(r.label&&r.label!==""){if(r.label.indexOf("0, facing back")>0){e.debug("BarcodeScanner.getDeviceCameras: has a camera with label contains '0, facing back', set it as main camera.");n.needCheck=false;n.mainCamera=r}if(r.label.indexOf("back")>0){n.back.push(r)}else if(r.label.indexOf("front")>0){n.front.push(r)}}else{r.label="Camera "+t}n.all.push(r)}});if(!n.mainCamera){if(n.back.length===1){e.debug("BarcodeScanner.getDeviceCameras: has only one camera which label contains 'back', set it as main camera.");n.mainCamera=v(n.back[0]);n.needCheck=false}else if(n.all.length===1){e.debug("BarcodeScanner.getDeviceCameras: has only one camera, set it as main camera.");n.mainCamera=v(n.all[0]);n.needCheck=false}}A.setProperty("/devices",n);J()}).catch(function(a){A.setProperty("/devices/needCheck",false);e.error("BarcodeScanner.getDeviceCameras: Can not get device cameras.\nError Message: "+a)})}function Y(a,n){var t=v(a);var r=function(){if(t.length===0){A.setProperty("/devices/needCheck",false);J();e.debug("BarcodeScanner.findMainCamera: can not find the main camera.");n()}else{var a=t[t.length-1];var i=v(A.getProperty("/config/defaultConstraints"));i.video.deviceId={exact:a.deviceId};var o=pe();i.video=Object.assign(i.video,o);window.navigator.mediaDevices.getUserMedia(i).then(function(n){var i=typeof n.stop==="function"?n:n.getTracks()[0];K(i).then(function(){a.flashLight=true;A.setProperty("/devices/mainCamera",a);A.setProperty("/devices/needCheck",false);J();e.debug("BarcodeScanner.findMainCamera: the main camera is "+a.deviceId);b=n;if(b){de()}else{B.getModel().setProperty("/isNoScanner",true);ne(k.getResourceBundle().getText("BARCODE_DIALOG_CAMERA_STREAM_ERROR_MSG"))}},function(){i.stop();e.debug("BarcodeScanner.findMainCamera: "+a.deviceId+" is not the main camera, check the next camera");t.pop();r()})}).catch(function(a){e.debug("BarcodeScanner.findMainCamera: getUserMedia() failed.\nError Message: "+a);if(A.getProperty("/config/defaultConstraints/video/zoom")!==undefined){e.debug("BarcodeScanner.findMainCamera: getUserMedia() failed maybe caused by unsupported constraint 'zoom', delete it and try again.");delete A.getProperty("/config/defaultConstraints/video").zoom}else{t.pop()}r()})}};r()}function J(){e.debug("BarcodeScanner.updateDevicesInStatusModel: update the devices in status model");var a=v(A.getProperty("/devices/all"));D.setProperty("/devices",a)}function K(a){if(!("ImageCapture"in window)){return new Promise(function(a,n){e.debug("BarcodeScanner.checkFlashLight: Device does not support image capture");n()})}else if(!a){return new Promise(function(a,n){e.debug("BarcodeScanner.checkFlashLight: Camera is not opened");n()})}else{var n=new ImageCapture(a);return new Promise(function(a,t){n.getPhotoCapabilities().then(function(n){if(n.fillLightMode&&n.fillLightMode.includes("flash")){e.debug("BarcodeScanner.checkFlashLight: Camera does support flash light");a()}else{e.debug("BarcodeScanner.checkFlashLight: Camera doesn't support flash light");t()}}).catch(function(a){e.debug("BarcodeScanner.checkFlashLight: Camera not started or not available.\nError Message: "+a);t()})})}}function Q(){return!!(window&&window.navigator&&window.navigator.mediaDevices&&window.navigator.mediaDevices.getUserMedia)}function $(){try{if(self!=top&&typeof cordova==="undefined"){window.cordova=top.cordova}}catch(a){e.info("BarcodeScanner.checkCordovaInIframe: cordova is unavailable in cross-origin iframe")}}function ee(){try{if(self!=top&&(typeof EB==="undefined"||typeof window.Rho==="undefined")){if(typeof top.EB!=="undefined"||typeof top.Rho!=="undefined"){window.EB=top.EB;window.Rho=top.Rho}}if(typeof EB!=="undefined"&&typeof EB.Barcode!=="undefined"){_("ZebraEnterpriseBrowser",true);e.debug("BarcodeScanner.initZebraEB: Zebra Enterprise Browser plugin is available!")}else{O("ZebraEnterpriseBrowser");e.debug("BarcodeScanner.initZebraEB: Zebra Enterprise Browser plugin is unavailable!")}}catch(a){e.info("BarcodeScanner.initZebraEB: EB and Rho are unavailable")}}function ae(){$();A.setProperty("/available",true);D.setProperty("/available",true);if(P.os.android){jQuery(document).ready(function(){ee();ye()})}else{O("ZebraEnterpriseBrowser");e.debug("BarcodeScanner.init: Not Android device, Zebra Enterprise Browser plugin is unavailable!")}if(sap.Settings&&typeof sap.Settings.isFeatureEnabled==="function"){sap.Settings.isFeatureEnabled("cordova.plugins.barcodeScanner",function(a){if(a){U()}else{X();e.warning("BarcodeScanner.init: Feature disabled in sap.Settings");U()}},function(){e.warning("BarcodeScanner.init: Feature check failed");U()})}else{if(sap.Settings===undefined){e.debug("BarcodeScanner.init: No sap.Settings. No feature vector available.")}else{e.warning("BarcodeScanner.init: Feature vector (sap.Settings.isFeatureEnabled) is unavailable")}U()}}function ne(a){if(a){e.warning("BarcodeScanner.openBarcodeInputDialog: isNoScanner. Message: "+a);var n=k.getResourceBundle().getText("BARCODE_DIALOG_CAMERA_OTHER_ERROR_MSG",a);if(a.name){var t="BARCODE_DIALOG_CAMERA_"+a.name.toUpperCase()+"_ERROR_MSG";n=k.getResourceBundle().getText(t)}u.show(n,{duration:1e3})}var c=A.getProperty("/scanDialog/disableBarcodeInputDialog");if(c){y.closeScanDialog()}else{B.destroyContent();B.setTitle("");B.setStretch(false);B.setContentHeight("auto");if(E){E.hidden=true}B.removeStyleClass("sapUiNoContentPadding");B.setTitle(A.getProperty("/scanDialog/title"));var s=new i(B.getId()+"-txt_barcode",{text:"{i18n>BARCODE_DIALOG_MSG}",visible:"{/isNoScanner}"});B.addContent(s);var d=new r(B.getId()+"-inp_barcode",{value:"{/barcode}",valueLiveUpdate:true,ariaLabelledBy:s.getId(),liveChange:function(e){var a=A.getProperty("/scanDialog/onLiveUpdate");if(typeof a==="function"){a({newValue:e.getParameter("newValue")})}},placeholder:"{i18n>BARCODE_DIALOG_PLACEHOLDER}"});B.addContent(d);var l=f.ButtonType;B.setBeginButton(new o(B.getId()+"-btn_barcode_ok",{type:l.Emphasized,text:"{i18n>BARCODE_DIALOG_OK}",press:function(e){var a=A.getProperty("/callBackHandler/onFnSuccess");if(typeof a==="function"){var n="unknown";if(A.getProperty("/scanDialog/scanningStartTime")>0){var t=Date.now();n=t-A.getProperty("/scanDialog/scanningStartTime")}a({text:B.getModel().getProperty("/barcode"),scanningTime:n,cancelled:false})}y.closeScanDialog()}}));B.setEndButton(new o({text:"{i18n>BARCODE_DIALOG_CANCEL}",press:function(){y.closeScanDialog()}}));B.setBusy(false)}}function te(){if(!A.getProperty("/config/preferFrontCamera")){delete A.getProperty("/config/defaultConstraints/video").facingMode;var a=A.getProperty("/devices");if(!A.getProperty("/config/deviceId")&&!a.mainCamera&&!P.os.ios&&!P.os.macintosh&&a.needCheck&&a.all.length>1){var n=a.back.length>1?a.back:a.all;var t=a.back.length>1?"back":"all";e.debug("BarcodeScanner.openCorrectCamera: start to find the main camera in "+t+" camera list.");Y(n,re);return}}re()}function re(a){e.debug("BarcodeScanner.openCamera: start to open camera");if(A.getProperty("/config/deviceId")){delete A.getProperty("/config/defaultConstraints/video").facingMode;A.setProperty("/config/defaultConstraints/video/deviceId",{exact:A.getProperty("/config/deviceId")})}else if(A.getProperty("/config/preferFrontCamera")){A.setProperty("/config/defaultConstraints/video/facingMode","user");delete A.getProperty("/config/defaultConstraints/video").deviceId}else{var n=A.getProperty("/devices");if(n.mainCamera&&n.mainCamera.deviceId!==""){A.setProperty("/config/defaultConstraints/video/deviceId",{exact:n.mainCamera.deviceId})}else{A.setProperty("/config/defaultConstraints/video/facingMode","environment")}}var t=v(A.getProperty("/config/defaultConstraints"));var r=pe();t.video=Object.assign(t.video,r);window.navigator.mediaDevices.getUserMedia(t).then(function(e){b=e;if(b){de(a)}else{B&&B.getModel().setProperty("/isNoScanner",true);ne(k.getResourceBundle().getText("BARCODE_DIALOG_CAMERA_STREAM_ERROR_MSG"))}}).catch(function(a){e.debug("BarcodeScanner.openCamera: getUserMedia() failed.\nError Message: "+a);if(A.getProperty("/config/defaultConstraints/video/zoom")!==undefined){e.debug("BarcodeScanner.openCamera: getUserMedia() failed maybe caused by unsupported constraint 'zoom', delete it and try again.");delete A.getProperty("/config/defaultConstraints/video").zoom;re()}else{B&&B.getModel().setProperty("/isNoScanner",true);ne(a)}})}function ie(){A.checkUpdate(true);var e;if(!B||B&&B.getContent().length===0){e=new a;B=new c("sapNdcBarcodeScannerDialog",{icon:"sap-icon://bar-code",title:k.getProperty("BARCODE_DIALOG_SCANNING_TITLE"),stretch:true,horizontalScrolling:false,verticalScrolling:false,endButton:new o({text:"{i18n>BARCODE_DIALOG_CANCEL}",enabled:false,press:function(){B.getModel().setProperty("/isNoScanner",false);ve();ne()}}),afterClose:function(){ve();if(B){B.destroyContent();B.destroy()}B=null}});B.setEscapeHandler(function(a){y.closeScanDialog();var n=A.getProperty("/callBackHandler/onFnSuccess");if(typeof n==="function"){n({text:e.getProperty("/barcode"),cancelled:true})}a.resolve()});B.setModel(e);B.setModel(k,"i18n")}B.addStyleClass("sapUiNoContentPadding");B.setBusy(true);if(F("ZXingCPP")&&Q()){B.attachAfterOpen(function(){te()});B.destroyContent();I=undefined;E=undefined;m=undefined;C=undefined;h=new l;B.addContent(h);B.setContentWidth("100%");B.setContentHeight("100%");A.setProperty("/scanDialog/barcodeOverlaySetup",false)}else{if(A.getProperty("/available")){B.getModel().setProperty("/isNoScanner",false)}else{B.getModel().setProperty("/isNoScanner",true)}ne()}B.open()}function oe(){A.setProperty("/bReady",true);A.setProperty("/callBackHandler/callBackFromSetPhysicalScan",false);EB.Barcode.triggerType=EB.Barcode.SOFT_ONCE;EB.Barcode.start()}function ce(){var a;if(A.getProperty("/config/preferFrontCamera")){a={preferFrontCamera:true}}A.getProperty("/apis/Cordova/scannerAPI").scan(function(e){if(e.cancelled==="false"||!e.cancelled){e.cancelled=false;var a=A.getProperty("/callBackHandler/onFnSuccess");if(typeof a==="function"){a(e)}}else{ie()}A.setProperty("/bReady",true)},function(a){e.error("BarcodeScanner.scanWithCordova: Barcode scanning failed.");A.setProperty("/bReady",true);var n=A.getProperty("/callBackHandler/onFnFail");if(typeof n==="function"){if(typeof a==="string"){var t=a;a={text:t};e.debug("BarcodeScanner.scanWithCordova: Change the type of oEvent from string to object")}n(a)}},a)}function se(){if(T("ZXingCPP",w.Initial)){e.debug("BarcodeScanner.scanWithZXingCPP: ZXingCPP instances is not loaded, start to load them.");W(function(){ie()},function(){if(F("ZebraEnterpriseBrowser")){x("ZebraEnterpriseBrowser");e.debug("BarcodeScanner.scanWithZXingCPP: Zebra is available, set the current scanner API to Zebra.")}else{x("unknown");e.warning("BarcodeScanner.scanWithZXingCPP: Zebra is unavailable too, set the current scanner API to unknown.")}ie()})}else{e.debug("BarcodeScanner.scanWithZXingCPP: get scan dialog.");ie()}}function de(a){B.getEndButton().setEnabled(true);B.setBusy(false);if(!I){I=h.getDomRef("highlight")}if(!m){m=h?h.getDomRef("video"):undefined}try{m.srcObject=b;m.play().then(function(){Pe();if(P.support.orientation&&a!==false){P.orientation.attachHandler(ge)}e.debug("BarcodeScanner.playbackVideoAndDecode: video screen size "+m.videoHeight+"X"+m.videoWidth);S=typeof b.stop==="function"?b:b.getTracks()[0];var n=S.getSettings();e.debug("BarcodeScanner.playbackVideoAndDecode: video screen frameRate is "+n.frameRate+", zoom is "+n.zoom);le()})}catch(a){e.debug("BarcodeScanner.playbackVideoAndDecode is failed. error: "+a)}}function le(){e.debug("BarcodeScanner.decodeWithZXingCPP: start to decode");if(!m||!m.srcObject){e.debug("BarcodeScanner.decodeWithZXingCPP: video dom doesn't exist, stop decoding");return}try{if(!C){C=h?document.createElement("canvas"):undefined}if(!C){e.debug("BarcodeScanner.decodeWithZXingCPP: canvas dom doesn't exist, stop decoding");return}var a=C.getContext("2d",{willReadFrequently:true});var n=m.videoWidth;var t=m.videoHeight;C.width=n;C.height=t;a.drawImage(m,0,0,n,t);var r=a.getImageData(0,0,n,t);var i=r.data;var o;var c=A.getProperty("/apis/ZXingCPP/scannerAPI");try{o=c._malloc(i.length);c.HEAPU8.set(i,o)}catch(a){e.error("BarcodeScanner.decodeWithZXingCPP: zxing.HEAPU8 error: "+a)}var s=c.readBarcodesFromPixmap(o,n,t,true,"",1);c._free(o);var d=s.size();if(d>0&&s.get(0).format){e.debug("BarcodeScanner.decodeWithZXingCPP: decode successful");var l=s.get(0);ue(l);if(l.cancelled==="false"||!l.cancelled){l.cancelled=false;var u=A.getProperty("/callBackHandler/onFnSuccess");if(typeof u==="function"){l.scanningTime="unknown";if(A.getProperty("/scanDialog/scanningStartTime")>0){var f=Date.now();l.scanningTime=f-A.getProperty("/scanDialog/scanningStartTime")}if(A.getProperty("/config/enableGS1Header")){l.text=l.symbologyIdentifier+l.text}u(l)}y.closeScanDialog()}}else{if(I&&A.getProperty("/scanDialog/barcodeOverlaySetup")){fe()}setTimeout(le,0)}}catch(e){}}function ue(e){var a,n,t;var r=0,i=0,o=0,c=0,s;if(I&&!A.getProperty("/scanDialog/barcodeOverlaySetup")){I.innerHTML="";A.setProperty("/scanDialog/barcodeOverlaySetup",true)}if(I){n=m.clientWidth/m.videoWidth;t=m.clientHeight/m.videoHeight;if(e.position){e.resultPoints=[e.position.topLeft,e.position.topRight,e.position.bottomRight,e.position.bottomLeft]}if(e.resultPoints){o=e.resultPoints[0].y;c=e.resultPoints[0].x;i=e.resultPoints[0].x;r=e.resultPoints[0].y;for(s=0;s<e.resultPoints.length;s++){a=e.resultPoints[s];if(a.x<c&&a.x<i){c=a.x}else if(a.x>c&&a.x>i){i=a.x}if(a.y<o&&a.y<r){o=a.y}else if(a.y>o&&a.y>r){r=a.y}}}I.hidden=false;I.style.top=o*t+"px";I.style.left=c*n+"px";I.style.width=(i-c>0?(i-c)*n:5)+"px";I.style.height=(r-o>0?(r-o)*t:5)+"px"}}function fe(){I.hidden=true;I.style.top="0";I.style.left="0";I.style.width="0";I.style.height="0"}function ge(a){B.setBusy(true);var n=a.landscape?"landscape":"portrait";e.debug("BarcodeScanner.orientationChangeListener: device orientation changed to "+n+", call openCamera again to resize");if(E){E.hidden=true}ve(false);if(P.os.ios||P.os.macintosh){B._positionDialog()}setTimeout(function(){re(false)},500)}function pe(){var e=h.getDomRef().clientHeight,a=h.getDomRef().clientWidth,n=1920,t=1440;if(e>a){t=Math.trunc(1920*a/e)}else{t=Math.trunc(1920*e/a)}return{width:{ideal:n},height:{ideal:t}}}function Pe(){e.debug("BarcodeScanner.scanFrame: start to set up overlay dom");if(!B||!m||!m.videoHeight||!m.videoWidth){e.debug("BarcodeScanner.scanFrame: scan dialog or video screen is closed, stop set up");return}var a=.15;if(!E&&h){E=h.getDomRef("overlay")}if(E){E.hidden=false;var n=m.clientWidth,t=m.clientHeight;var r=n*(1-2*a);var i=t*(1-2*a);if(r<=i){i=r*(1-2*a)}var o=h.getDomRef("overlay-box");if(o){o.style.width=r+"px";o.style.height=i+"px";E.style.width=r+"px";E.style.height=i+"px";E.style.borderWidth=(t-i)/2+"px "+(n-r)/2+"px"}}}function ve(e){if(S){S.stop();S=undefined}if(b){b=undefined}if(P.support.orientation&&e!==false){P.orientation.detachHandler(ge)}if(m&&m.srcObject){m.srcObject=undefined}}function ye(){A.checkUpdate(true);var a=A.getProperty("/apis/ZebraEnterpriseBrowser/enableZebraBarcodeRetryCount");var n=A.getProperty("/apis/ZebraEnterpriseBrowser/enableBarcodeState");if(M()==="ZebraEnterpriseBrowser"&&F("ZebraEnterpriseBrowser")&&n!==true){var t=function(a){if(a["data"]==""||a["time"]==""){var n=A.getProperty("/callBackHandler/onFnFail");if(typeof n==="function"){var t={text:"Zebra Scan failed",resultStatus:"Error"};if(A.getProperty("/callBackHandler/callBackFromSetPhysicalScan")){t=new g("scanFailEvent",new p,t)}n(t)}e.error("BarcodeScanner.zebraEBScanEnable: Zebra Enterprise Browser Scan Failed")}else{e.debug("BarcodeScanner.zebraEBScanEnable: Zebra EB Scan Result: "+a.data+"; Scan Json: "+JSON.stringify(a));var r=A.getProperty("/callBackHandler/onFnSuccess");if(typeof r==="function"){var i="unknown";if(A.getProperty("/scanDialog/scanningStartTime")>0){var o=Date.now();i=o-A.getProperty("/scanDialog/scanningStartTime")}var c={text:a.data,format:a.source,resultStatus:"Success",scanningTime:i,cancelled:false};if(A.getProperty("/callBackHandler/callBackFromSetPhysicalScan")){c=new g("scanSuccessEvent",new p,c)}r(c);A.setProperty("/scanDialog/scanningStartTime",0)}}};if(A.getProperty("/config/enableGS1Header")){EB.Barcode.codeIdType=EB.Barcode.CODEIDTYPE_AIM}else{EB.Barcode.codeIdType=EB.Barcode.CODEIDTYPE_NONE}EB.Barcode.enable({},t);A.setProperty("/apis/ZebraEnterpriseBrowser/enableBarcodeState",true);e.debug("BarcodeScanner.zebraEBScanEnable: try to enable EB Barcode in ("+(6-a)+") times")}else if(a>1&&n==="init"){a--;A.setProperty("/apis/ZebraEnterpriseBrowser/enableZebraBarcodeRetryCount",a);ee();setTimeout(ye,500)}else{e.debug("BarcodeScanner.zebraEBScanEnable: The scanner API is not ZebraEnterpriseBrowser or cannot been enabled.")}}function be(){var e=A.getProperty("/scanDialog/keepCameraScan");var a=false;if(M()==="ZebraEnterpriseBrowser"&&F("ZebraEnterpriseBrowser")&&(!e||typeof e!=="boolean")){a=true}return a}y.scan=function(a,n,t,r,i,o,c,s,d){if(!A.getProperty("/bReady")){e.error("BarcodeScanner.scan: Barcode scanning is already in progress.");return}e.debug("BarcodeScanner.scan: start to scan barcode.");A.setProperty("/bReady",false);if(typeof a==="function"){A.setProperty("/callBackHandler/onFnSuccess",a)}else{A.setProperty("/callBackHandler/onFnSuccess",null)}if(typeof n==="function"){A.setProperty("/callBackHandler/onFnFail",n)}else{A.setProperty("/callBackHandler/onFnFail",null)}if(typeof t==="function"){A.setProperty("/scanDialog/onLiveUpdate",t)}else{A.setProperty("/scanDialog/onLiveUpdate",null)}if(typeof r==="string"&&r!=null&&r.trim()!=""){A.setProperty("/scanDialog/title",r)}else{A.setProperty("/scanDialog/title",k.getProperty("BARCODE_DIALOG_TITLE"))}A.setProperty("/scanDialog/scanningStartTime",Date.now());A.setProperty("/config/preferFrontCamera",i);if(A.getProperty("/config/defaultConstraints/video/frameRate")!==undefined){delete A.getProperty("/config/defaultConstraints/video").frameRate}if(typeof o==="number"&&o>0){A.setProperty("/config/defaultConstraints/video/frameRate",o)}else if(typeof o!=="undefined"){u.show(k.getResourceBundle().getText("BARCODE_DIALOG_CAMERA_UPDATE_PARAMETER_ERROR_MSG","frameRate"),{duration:1e3})}if(A.getProperty("/config/defaultConstraints/video/zoom")!==undefined){delete A.getProperty("/config/defaultConstraints/video").zoom}if(typeof c==="number"&&c>0){A.setProperty("/config/defaultConstraints/video/zoom",c)}else if(typeof c!=="undefined"){u.show(k.getResourceBundle().getText("BARCODE_DIALOG_CAMERA_UPDATE_PARAMETER_ERROR_MSG","zoom"),{duration:1e3})}A.setProperty("/scanDialog/keepCameraScan",s);A.setProperty("/scanDialog/disableBarcodeInputDialog",d);A.checkUpdate(true);if(be()){e.debug("BarcodeScanner.scan: Zebra EB is available, use it to scan barcode.");oe()}else if(F("Cordova")){e.debug("BarcodeScanner.scan: Cordova is available, use it to scan barcode.");ce()}else{e.debug("BarcodeScanner.scan: both of Zebra EB and Cordova are NOT available, use ZXingCPP to scan barcode.");se()}};y.closeScanDialog=function(){if(B){B.close();B.fireAfterClose();A.setProperty("/scanDialog/scanningStartTime",0);A.setProperty("/scanDialog/onLiveUpdate",null)}A.setProperty("/bReady",true);A.checkUpdate(true)};y.getStatusModel=function(){return D};y.getScanAPIInfo=function(){return M()};y.setScanAPIInfo=function(a){if(!a){e.error("BarcodeScanner.setScanAPIInfo: scannerAPI is undefined.");return false}if(M()!==a){var n=A.getProperty("/apis/"+a);if(!n){e.error("BarcodeScanner.scan: The scanner API '"+a+"' doesn't exist, will use current scanner API '"+A.getProperty("/apis/"+M()+"/description")+"' to scan the barcode.");return false}else if(a==="ZXingCPP"){if(L(a)){e.error("BarcodeScanner.scan: The scanner API '"+a+"' is unavailable, will use current scanner API '"+A.getProperty("/apis/"+M()+"/description")+"' to scan the barcode.");return false}else{e.debug("BarcodeScanner.scan: Switch to scanner API '"+a+"' to scan the barcode.");x(a);return true}}else if(!F(a)){e.error("BarcodeScanner.scan: The scanner API '"+a+"' is unavailable, will use current scanner API '"+A.getProperty("/apis/"+M()+"/description")+"' to scan the barcode.");return false}else{e.debug("BarcodeScanner.scan: Switch to scanner API '"+a+"' to scan the barcode.");x(a);return true}}else{e.debug("BarcodeScanner.setScanAPIInfo: '"+a+"' is already current scanner API. It need not to be changed.");return true}};y.setPhysicalScan=function(a){if(typeof a==="function"){A.setProperty("/callBackHandler/callBackFromSetPhysicalScan",true);A.setProperty("/callBackHandler/onFnSuccess",a);A.setProperty("/callBackHandler/onFnFail",a);if(P.os.android){jQuery(document).on("visibilitychange",function(){if(document.visibilityState==="visible"){ee();ye()}})}else{O("ZebraEnterpriseBrowser");e.debug("BarcodeScanner.setPhysicalScan: Not Android device, Zebra Enterprise Browser plugin is unavailable!")}}else{e.debug("setPhysicalScan is failed.")}};y.setConfig=function(a){if(typeof a==="object"&&Object.keys(a).length>0){var n=A.getProperty("/config");for(var t in a){if(n.hasOwnProperty(t)){n[t]=a[t];if(be()&&t==="enableGS1Header"){A.setProperty("/apis/ZebraEnterpriseBrowser/enableBarcodeState",false);EB.Barcode.disable(ye)}if(t==="deviceId"){D.setProperty("/deviceId",a[t])}e.debug("The parameter("+t+") has been changed.")}else{e.error("The parameter("+t+") is unavailable.")}}A.setProperty("/config",n)}else{e.error("The options are not available.")}};ae();return y},true);
},
	"sap/ndc/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.ndc","type":"library","embeds":[],"applicationVersion":{"version":"1.108.28"},"title":"SAPUI5 library with controls with native device capabilities.","description":"SAPUI5 library with controls with native device capabilities.","ach":"MOB-SDK-UI5","resources":"resources.json","offline":true,"openSourceComponents":[{"name":"zxing-cpp/zxing-cpp","packagedWithMySelf":true,"version":"2.1.0"}]},"sap.ui":{"technology":"UI5","supportedThemes":[]},"sap.ui5":{"dependencies":{"minUI5Version":"1.108","libs":{"sap.ui.core":{"minVersion":"1.108.28"},"sap.m":{"minVersion":"1.108.28"}}},"library":{"i18n":{"bundleUrl":"messagebundle.properties","supportedLocales":["","ar","bg","ca","cs","cy","da","de","el","en","en-GB","en-US-sappsd","en-US-saprigi","en-US-saptrc","es","es-MX","et","fi","fr","fr-CA","hi","hr","hu","id","it","iw","ja","kk","ko","lt","lv","mk","ms","nl","no","pl","pt","pt-PT","ro","ru","sh","sk","sl","sr","sv","th","tr","uk","vi","zh-CN","zh-TW"]},"css":false,"content":{"controls":["sap.ndc.BarcodeScannerButton","sap.ndc.BarcodeScannerUIContainer"],"elements":[],"types":[],"interfaces":[]}}}}'
});
//# sourceMappingURL=library-preload.js.map
