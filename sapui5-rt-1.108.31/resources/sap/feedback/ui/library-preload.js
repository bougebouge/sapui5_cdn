//@ui5-bundle sap/feedback/ui/library-preload.js
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/Component", ["sap/ui/core/Component","sap/base/Log","./utils/Constants","./config/StartupConfig","./utils/InitDetection","./utils/Utils","./controller/PluginController","sap/base/util/ObjectPath"],function(t,e,n,i,r,o,a,s){"use strict";return t.extend("sap.feedback.ui.flpplugin.Component",{metadata:{manifest:"json",properties:{url:{name:"url",type:"string"},tenantId:{name:"tenantId",type:"string"},tenantRole:{name:"tenantRole",type:"string"},isPushEnabled:{name:"isPushEnabled",type:"boolean"},pushChannelPath:{name:"pushChannelPath",type:"string"},productName:{name:"productName",type:"string"},platformType:{name:"platformType",type:"string"},scopeSet:{name:"scopeSet",type:"string"}}},_oPluginController:null,_oStartupConfig:null,_bIsLoaded:false,init:function(){if(!this._isManuallyConfigured()){return this._prepareAndRun()}},load:function(){return new Promise(function(t,i){if(this._bIsLoaded===false){this._prepareAndRun().then(function(){t()},function(){i()})}else{e.error("Plug-in already loaded with an existing configuration.",null,n.S_PLUGIN_COMPONENT_NAME);i()}}.bind(this))},_prepareAndRun:function(){return new Promise(function(t,i){var r=this._loadStartupConfigData();if(r){this._oStartupConfig=this._createStartupConfigObject(r);this._run().then(function(){this._bIsLoaded=true;t()}.bind(this),function(){i()})}else{e.error("Config data could not be loaded correctly.",null,n.S_PLUGIN_COMPONENT_NAME);i()}}.bind(this))},_loadStartupConfigData:function(){if(this.getProperty("url")&&this.getProperty("tenantId")){var t={};t.qualtricsInternalUri=this.getProperty("url");t.tenantId=this.getProperty("tenantId");if(this.getProperty("tenantRole")){t.tenantRole=this.getProperty("tenantRole")}if(this.getProperty("isPushEnabled")){t.isPushEnabled=this.getProperty("isPushEnabled")}if(this.getProperty("pushChannelPath")){t.pushChannelPath=this.getProperty("pushChannelPath")}if(this.getProperty("productName")){t.productName=this.getProperty("productName")}if(this.getProperty("platformType")){t.platformType=this.getProperty("platformType")}if(this.getProperty("scopeSet")){t.scopeSet=this.getProperty("scopeSet")}return t}else if(this.getComponentData()&&this.getComponentData().config){var i=this.getComponentData().config;if(i&&this._isMandatoryStartupConfigValid(i)===true){return i}else{e.error("Feedback config could not be read.",null,n.S_PLUGIN_COMPONENT_NAME)}}return null},_isManuallyConfigured:function(){if(this.getProperty("url")&&this.getProperty("tenantId")){return true}return false},_createStartupConfigObject:function(t){var e=new i(t.qualtricsInternalUri,t.tenantId,n.E_DATA_FORMAT.version1);e.setTenantRole(t.tenantRole);if(t.isPushEnabled){e.setDataFormat(n.E_DATA_FORMAT.version2);e.setIsPushEnabled(t.isPushEnabled)}if(t.productName){e.setProductName(t.productName)}if(t.platformType){e.setPlatformType(t.platformType)}if(t.scopeSet){e.setScopeSet(t.scopeSet)}return e},_isMandatoryStartupConfigValid:function(t){var i=t.qualtricsInternalUri;if(o.isString(i)&&!o.stringIsEmpty(i)){var r=t.tenantId;if(o.isString(r)&&!o.stringIsEmpty(r)){return true}else{e.error("Feedback config insufficient - tenant id missing.",t,n.S_PLUGIN_COMPONENT_NAME)}}else{e.error("Feedback config insufficient - url missing.",t,n.S_PLUGIN_COMPONENT_NAME)}return false},_run:function(){return new Promise(function(t){this._validateIfInitializable(this._oStartupConfig.getQualtricsUri()).then(function(i){if(i){this._oStartupConfig.setIsLibraryLoadable(i);this._startPluginController(this._oStartupConfig).then(function(){t()},function(){e.error("Plugin Controller could not be initialized.",this._oStartupConfig,n.S_PLUGIN_COMPONENT_NAME);t()}.bind(this))}}.bind(this),function(i){if(!i){this._oStartupConfig.setIsLibraryLoadable(i);e.error("Unable to request feedback library.",this._oStartupConfig,n.S_PLUGIN_COMPONENT_NAME)}t()}.bind(this))}.bind(this))},_validateIfInitializable:function(t){var e=new r(t);return e.isUrlLoadable()},_startPluginController:function(t){return new Promise(function(i,r){if(this._isDeviceFormatSupported()){var o=this.getModel("i18n").getResourceBundle();this._oPluginController=new a(t,this._getRenderer(),o);this._oPluginController.init().then(function(){i()},function(t){e.error("Feedback plugin startup failed.",t.message,n.S_PLUGIN_COMPONENT_NAME);r()})}else{e.error("Device not supported.",this._oStartupConfig,n.S_PLUGIN_COMPONENT_NAME);r()}}.bind(this))},_isDeviceFormatSupported:function(){if(sap.ui.Device.system.phone){return false}return true},_getRenderer:function(){return new Promise(function(t,e){this._oShellContainer=s.get("sap.ushell.Container");if(!this._oShellContainer){e("Illegal state: shell container not available; this component must be executed in a unified shell runtime context.")}else{var n=this._oShellContainer.getRenderer();if(n){t(n)}else{this._onRendererCreated=function(i){n=i.getParameter("renderer");if(n){t(n)}else{e("Illegal state: shell renderer not available after receiving 'rendererLoaded' event.")}};this._oShellContainer.attachRendererCreatedEvent(this._onRendererCreated)}}}.bind(this))}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/config/CentralConfig", ["sap/ui/base/Object","./PushConfig"],function(n,i){"use strict";return n.extend("sap.feedback.ui.flpplugin.config.CentralConfig",{_oPushConfig:null,getPushConfig:function(){return this._oPushConfig},setPushConfig:function(n){this._oPushConfig=n}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/config/ConfigurationLoader", ["sap/ui/base/Object","./PushConfig","sap/base/Log","../utils/Constants"],function(n,i,t,o){"use strict";return n.extend("sap.feedback.ui.flpplugin.config.ConfigurationLoader",{_oStartupConfig:null,init:function(n){if(!n){throw Error("oStartupConfig is not provided!")}this._oStartupConfig=n},getPushConfiguration:function(){return this._loadPushConfiguration().then(function(n){var t=new i(this._oStartupConfig);t.init();t.initFromJSON(n);return t}.bind(this)).catch(function(){return null})},_loadPushConfiguration:function(){return new Promise(function(n,i){var u=this._getConfigurationFilePath();fetch(u).then(function(n){return n.json()}).then(function(i){n(i)}).catch(function(n){t.error("Fiori Feedback Plug-in error occured on loading the push configuration.",n.statusText,o.S_PLUGIN_CONFIGLOADER_NAME);i()})}.bind(this))},_getConfigurationFilePath:function(){return sap.ui.require.toUrl("sap/feedback/ui/flpplugin/config/PushConfigSample.json")}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/config/PushConfig", ["sap/ui/base/Object","../push/config/FeaturePushConfig","../utils/Utils","../utils/ScopeCheck","../push/config/trigger/TriggerFactory"],function(i,n,t,e,s){"use strict";return i.extend("sap.feedback.ui.flpplugin.config.PushConfig",{_oStartupConfig:null,_oFeatureConfig:null,_iDynamicPushIntervalTimerInMinutes:null,_iMinimumTimeToStartTimerForDynamicPushInHrs:null,_iQuietPeriodInHrs:null,_iSnoozePeriodInHrs:null,_iIntervalInitialDynamicPushInDays:null,_iDeviationInitialDynamicPushInDays:null,_iIntervalInitialInAppPushInDays:null,_iDeviationInitialInAppPushInDays:null,_iIntervalNextDynamicPushInDays:null,_iDeviationNextDynamicPushInDays:null,_iIntervalNextInAppPushInDays:null,_iDeviationNextInAppPushInDays:null,constructor:function(i){if(!i){throw Error("oStartupConfig is not provided!")}this._oStartupConfig=i},init:function(){this._oFeatureConfig={}},initFromJSON:function(i){this._initStaticProd();if(e.isImmediateTestModeParamActive()){this._initStaticTest()}this._parseFeaturePushConfig(i.pushConfig.featurePushConfigs)},_parseFeaturePushConfig:function(i){i.forEach(function(i){if(e.isFeaturePushAvailable(this._oStartupConfig)){var t=i.trigger;var a=t.type;var r=s.createTrigger(t);var u=new n;u.initFromJSON(i);u.setTriggerConfig(a,r);this.addFeaturePushConfig(u)}}.bind(this))},setMinimumTimeToStartTimerForDynamicPush:function(i){this._iMinimumTimeToStartTimerForDynamicPushInHrs=i},setDynamicPushIntervalTimer:function(i){this._iDynamicPushIntervalTimerInMinutes=i},getQuietPeriodInHrs:function(){return this._iQuietPeriodInHrs},getSnoozePeriodInHrs:function(){return this._iSnoozePeriodInHrs},getIntervalInitialDynamicPushInDays:function(){return this._iIntervalInitialDynamicPushInDays},getDeviationInitialDynamicPushInDays:function(){return this._iDeviationInitialDynamicPushInDays},getIntervalNextDynamicPushInDays:function(){return this._iIntervalNextDynamicPushInDays},getDeviationNextDynamicPushInDays:function(){return this._iDeviationNextDynamicPushInDays},getIntervalInitialInAppPushInDays:function(){return this._iIntervalInitialInAppPushInDays},getDeviationInitialInAppPushInDays:function(){return this._iDeviationInitialInAppPushInDays},getIntervalNextInAppPushInDays:function(){return this._iIntervalNextInAppPushInDays},getDeviationNextInAppPushInDays:function(){return this._iDeviationNextInAppPushInDays},getMinimumTimeToStartTimerForDynamicPush:function(){return this._iMinimumTimeToStartTimerForDynamicPushInHrs},getDynamicPushIntervalTimer:function(){return this._iDynamicPushIntervalTimerInMinutes},addFeaturePushConfig:function(i){if(this._oFeatureConfig){this._oFeatureConfig[i.getCombinedKey()]=i}},findFeaturePushConfigById:function(i,n){var e=t.getCombinedKey(i,n);var s=this._oFeatureConfig[e];if(s&&s.isActive()){return s}return null},findGenericFeaturePushConfigWithTriggerType:function(i){var n=[];Object.keys(this._oFeatureConfig).forEach(function(t){var e=this._oFeatureConfig[t];if(e.isActive()&&e.getIsGeneric()&&e.getTriggerType()===i){n.push(e)}}.bind(this));return n},findExpiredFeatureConfigs:function(){var i=[];Object.keys(this._oFeatureConfig).forEach(function(n){var t=this._oFeatureConfig[n];if(t.isExpired()){i.push(t)}}.bind(this));return i},_initStaticProd:function(){this.setDynamicPushIntervalTimer(30);this.setMinimumTimeToStartTimerForDynamicPush(12);this._iQuietPeriodInHrs=48;this._iSnoozePeriodInHrs=25;this._iIntervalInitialDynamicPushInDays=35;this._iDeviationInitialDynamicPushInDays=7;this._iIntervalInitialInAppPushInDays=14;this._iDeviationInitialInAppPushInDays=7;this._iIntervalNextDynamicPushInDays=90;this._iDeviationNextDynamicPushInDays=28;this._iIntervalNextInAppPushInDays=45;this._iDeviationNextInAppPushInDays=7},_initStaticTest:function(){this.setDynamicPushIntervalTimer(2);this.setMinimumTimeToStartTimerForDynamicPush(12);this._iQuietPeriodInHrs=0;this._iSnoozePeriodInHrs=0;this._iIntervalInitialDynamicPushInDays=0;this._iDeviationInitialDynamicPushInDays=0;this._iIntervalInitialInAppPushInDays=0;this._iDeviationInitialInAppPushInDays=0;this._iIntervalNextDynamicPushInDays=0;this._iDeviationNextDynamicPushInDays=0;this._iIntervalNextInAppPushInDays=0;this._iDeviationNextInAppPushInDays=0}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/config/StartupConfig", ["sap/ui/base/Object","../utils/Utils"],function(t,e){"use strict";return t.extend("sap.feedback.ui.flpplugin.config.StartupConfig",{_sQualtricsUri:null,_sTenantId:null,_sTenantRole:null,_bIsPushEnabled:false,_iDataFormat:null,_sProductName:null,_sPlatformType:null,_bIsLibraryLoadable:false,_sScopeSet:null,_aScopeSet:[],constructor:function(t,e,s){this.setQualtricUri(t);this.setTenantId(e);this.setDataFormat(s)},setQualtricUri:function(t){this._sQualtricsUri=t},getQualtricsUri:function(){return this._sQualtricsUri},setTenantId:function(t){this._sTenantId=t},getTenantId:function(){return this._sTenantId},setTenantRole:function(t){this._sTenantRole=t},getTenantRole:function(){return this._sTenantRole},setIsPushEnabled:function(t){if(t===true||t.toLowerCase()==="true"||t.toLowerCase()==="x"){this._bIsPushEnabled=true}else{this._bIsPushEnabled=false}},getIsPushEnabled:function(){return this._bIsPushEnabled},setDataFormat:function(t){this._iDataFormat=t},getDataFormat:function(){return this._iDataFormat},setProductName:function(t){this._sProductName=t},getProductName:function(){return this._sProductName},setPlatformType:function(t){this._sPlatformType=t},getPlatformType:function(){return this._sPlatformType},setIsLibraryLoadable:function(t){this._bIsLibraryLoadable=t},getIsLibraryLoadable:function(){return this._bIsLibraryLoadable},setScopeSet:function(t){if(t){this._sScopeSet=t;this._aScopeSet=this._sScopeSet.split(",").map(function(t){return t.trim().toLowerCase()})}},hasScopeItem:function(t){if(e.isString(t)&&!e.stringIsEmpty(t)&&this._aScopeSet&&this._aScopeSet.length>0){if(this._aScopeSet.includes(t.trim().toLowerCase())){return true}}return false}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/controller/ContextDataController", ["sap/ui/base/Object","sap/base/util/extend","../utils/Utils","../utils/Constants","../data/AppContextData"],function(t,e,s,n,i){"use strict";return t.extend("sap.feedback.ui.flpplugin.controller.ContextDataController",{_oStartupConfig:{},_oAppContextData:null,_oSessionData:null,_sClientAction:null,_sLastTheme:null,_iFollowUpCount:null,constructor:function(t){if(!t){throw Error("oStartupConfig is not provided!")}this._oStartupConfig=t},init:function(){this._oAppContextData=new i;this._collectSessionContextData(this._oStartupConfig.getTenantId(),this._oStartupConfig.getTenantRole(),this._oStartupConfig.getProductName(),this._oStartupConfig.getPlatformType())},updateContextData:function(t,e,s){this._resetContextData();this.setDeviceInfos();this.setClientAction(t);var n=this._oStartupConfig.getDataFormat();this._setSessionContextData(n);if(s){this._setTelemetryData(s)}else{this._clearTelemetryData()}return this._collectAppContextData(n).then(function(){this._collectPushContextData(e)}.bind(this))},setClientAction:function(t){this._sClientAction=t;this._updateClientAction()},setLastTheme:function(t){this._sLastTheme=t;this._updateLastTheme()},setFollowUpCount:function(t){this._iFollowUpCount=t;this._updateFollowUpCount()},setDeviceInfos:function(){this._updateDeviceData()},_collectPushContextData:function(t){if(s.isClientActionPushEvent(this._sClientAction)&&t){this._setPushContextData(t)}},_setPushContextData:function(t){if(!sap.qtx){sap.qtx={}}sap.qtx.push={};sap.qtx.push.type=t.getType();sap.qtx.push.areaId=t.getAreaId();sap.qtx.push.triggerName=t.getTriggerName();sap.qtx.push.shortText=t.getShortText();sap.qtx.push.payload=t.getPayloadDataString()},_collectSessionContextData:function(t,e,s,n){this._oSessionData={tenantId:t,tenantRole:e,productName:s,platformType:n}},_setSessionContextData:function(t){if(t===n.E_DATA_FORMAT.version1){if(!sap.qtxAppContext){sap.qtxAppContext={}}sap.qtxAppContext=e(sap.qtxAppContext,this._oSessionData)}else if(t===n.E_DATA_FORMAT.version2){if(!sap.qtx){sap.qtx={}}sap.qtx.session=this._oSessionData}},_setTelemetryData:function(t){this._ensureExistenceOfMetricsOnGlobalQtx();if(t){sap.qtx.metrics.push.triggered=t.getPushEventTriggeredCount();sap.qtx.metrics.push.executed=t.getPushEventExecutedCount();sap.qtx.metrics.push.snoozed=t.getPushEventSnoozedCount();sap.qtx.metrics.push.timeSinceLastPush=t.getTimeSinceLastPushEvent()}},_clearTelemetryData:function(){if(sap.qtx&&sap.qtx.metrics){sap.qtx.metrics={}}},_resetContextData:function(){sap.qtxAppContext={};if(!sap.qtx){sap.qtx={}}sap.qtx.appcontext={};sap.qtx.push={};sap.qtx.metrics={}},_collectAppContextData:function(t){return this._oAppContextData.getData(t).then(function(e){this._setAppContextData(e,t)}.bind(this))},_setAppContextData:function(t,s){if(s===n.E_DATA_FORMAT.version1){sap.qtxAppContext=e(sap.qtxAppContext,t)}else if(s===n.E_DATA_FORMAT.version2){sap.qtx.appcontext=t;this._updateClientAction()}},_ensureExistenceOfAppContextOnGlobalQtx:function(){if(!sap.qtx){sap.qtx={}}if(!sap.qtx.appcontext){sap.qtx.appcontext={}}},_ensureExistenceOfDeviceOnGlobalQtx:function(){if(!sap.qtx){sap.qtx={}}if(!sap.qtx.device){sap.qtx.device={}}},_ensureExistenceOfMetricsOnGlobalQtx:function(){if(!sap.qtx){sap.qtx={}}if(!sap.qtx.metrics){sap.qtx.metrics={}}if(!sap.qtx.metrics.push){sap.qtx.metrics.push={}}},_updateClientAction:function(){this._ensureExistenceOfAppContextOnGlobalQtx();sap.qtx.appcontext.clientAction=this._sClientAction},_updateLastTheme:function(){this._ensureExistenceOfAppContextOnGlobalQtx();sap.qtx.appcontext.previousTheme=this._sLastTheme},_updateFollowUpCount:function(){this._ensureExistenceOfAppContextOnGlobalQtx();sap.qtx.appcontext.followUpCount=this._iFollowUpCount},_updateDeviceData:function(){this._ensureExistenceOfDeviceOnGlobalQtx();sap.qtx.device={};sap.qtx.device.type=this._getDeviceType();sap.qtx.device.orientation=this._getScreenOrientation();sap.qtx.device.osName=sap.ui.Device.os.name;sap.qtx.device.browserName=sap.ui.Device.browser.name},_getDeviceType:function(){if(sap.ui.Device.system.tablet&&!sap.ui.Device.system.desktop){return"tablet"}else if(!sap.ui.Device.system.tablet&&sap.ui.Device.system.desktop){return"desktop"}else if(sap.ui.Device.system.combi){return"combi"}else if(sap.ui.Device.system.phone){return"phone"}else{return n.S_DEFAULT_VALUE}},_getScreenOrientation:function(){if(sap.ui.Device.orientation.landscape){return"landscape"}else if(sap.ui.Device.orientation.portrait){return"portrait"}else{return n.S_DEFAULT_VALUE}}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/controller/PluginController", ["sap/ui/base/Object","sap/base/Log","../utils/Constants","../utils/Utils","../utils/ScopeCheck","../utils/UI5Utils","./ContextDataController","../push/config/trigger/TriggerType","../push/DynamicPushTrigger","../ui/ShellBarButton","../ui/PopOverVisual","./WebAppFeedbackLoader","../utils/Storage","../survey/RequestDispatcher","../survey/SurveyFactory"],function(t,e,i,n,o,a,r,s,u,h,l,_,c,d,g){"use strict";return t.extend("sap.feedback.ui.flpplugin.controller.PluginController",{_oStartupConfig:null,_oCentralConfig:null,_oContextDataController:null,_oShellButton:null,_oWebAppFeedbackLoader:null,_fnRendererPromise:null,_oResourceBundle:null,_oLocalStorage:null,_sLastThemeId:null,_sCurrentThemeId:null,_oRequestDispatcher:null,_oDynamicPushTrigger:null,constructor:function(t,e,i){this._oStartupConfig=t;this._fnRendererPromise=e;this._oResourceBundle=i},init:function(){if(this._initStorage()){this._initLastTheme();return new Promise(function(t,n){if(this._oStartupConfig){this._initAndGetCentralConfiguration().then(function(o){if(o){this._initContextData();this._initRequestDispatcher(o);this._initUI();this._initWebAppFeedback();this._initDynamicPushTrigger(o);this._updateInitialContextData().then(function(){t()}).catch(function(n){e.error("Fiori Feedback Plug-in error occured on updating context data on init.",n.message,i.S_PLUGIN_PLGCTRL_NAME);t()})}else{n()}}.bind(this))}else{n()}}.bind(this))}else{return Promise.reject()}},_initStorage:function(){if(n.isLocalStorageAvailable()){this._oLocalStorage=new c;this._oLocalStorage.init();return true}return false},_initLastTheme:function(){var t=a.getTheme();var e=t;if(this._oLocalStorage){e=this._oLocalStorage.getLastTheme();if(!e){e=t}}this._updateThemeState(e,t,true)},_initContextData:function(){this._oContextDataController=new r(this._oStartupConfig);return this._oContextDataController.init()},_initRequestDispatcher:function(t){if(this._oLocalStorage){if(o.isFeaturePushAvailable(this._oStartupConfig)||o.isDynamicPushAvailable(this._oStartupConfig)){if(!this._oRequestDispatcher){this._oRequestDispatcher=new d;this._oRequestDispatcher.init(this._oStartupConfig,t,this._oContextDataController,this._oResourceBundle,this._oLocalStorage)}}}},_initAndGetCentralConfiguration:function(){var t=g.createCentralConfiguration();var e=g.createConfigurationLoader();e.init(this._oStartupConfig);return e.getPushConfiguration().then(function(e){t.setPushConfig(e);this._oCentralConfig=t;return t}.bind(this)).catch(function(){return null})},_initUI:function(){this._oVisual=new l;if(this._oVisual){this._oShellButton=new h(this._fnRendererPromise,this._onSurveyShow.bind(this),this._oResourceBundle);this._oShellButton.init()}},_initWebAppFeedback:function(){this._oWebAppFeedbackLoader=new _(this._oStartupConfig);this._oWebAppFeedbackLoader.init(this._onAPILoadedCallback.bind(this));this._oWebAppFeedbackLoader.loadAPI()},_initDynamicPushTrigger:function(t){if(o.isDynamicPushAvailable(this._oStartupConfig)&&this._oRequestDispatcher){this._oDynamicPushTrigger=new u(t,this._oLocalStorage);this._oDynamicPushTrigger.init(this._oRequestDispatcher.handleDynamicPush.bind(this._oRequestDispatcher))}},_initGenericFeaturePushTriggers:function(){if(o.isFeaturePushAvailable(this._oStartupConfig)){sap.ui.getCore().attachThemeChanged(function(t){this._onThemeChanged(t)}.bind(this))}},_updateInitialContextData:function(){return this._oContextDataController.updateContextData(i.E_CLIENT_ACTION.init)},_onAPILoadedCallback:function(){return this._oContextDataController.updateContextData(i.E_CLIENT_ACTION.init).then(function(){a.getAppLifeCycleService().attachAppLoaded({},this._onAppLoaded,this);this._initGenericFeaturePushTriggers()}.bind(this)).catch(function(t){e.error("Fiori Feedback Plug-in error occured on updating context data on load.",t.message,i.S_PLUGIN_PLGCTRL_NAME)})},_openSurvey:function(t,e){if(this._oContextDataController){this._oContextDataController.setClientAction(t);this._oContextDataController.setLastTheme(this._sLastThemeId);this._oContextDataController.setFollowUpCount(e)}QSI.API.unload();QSI.API.load().then(function(){QSI.API.run()})},_onSurveyShow:function(){return new Promise(function(t,n){if(this._oWebAppFeedbackLoader.getIsAPILoaded()){this._oContextDataController.updateContextData(i.E_CLIENT_ACTION.navBarClick,null).then(function(){this._oVisual.show();t()}.bind(this)).catch(function(t){e.error("Fiori Feedback Plug-in error occured on updating context data on show.",t.message,i.S_PLUGIN_PLGCTRL_NAME);n()})}}.bind(this))},_onAppLoaded:function(){return this._oContextDataController.updateContextData(i.E_CLIENT_ACTION.appLoaded).then(function(){if(o.isFeaturePushAvailable(this._oStartupConfig)){sap.ui.getCore().getEventBus().publish("sap.feedback","inapp.feature",{areaId:i.S_GENERIC_TRIGGER_AREAID,triggerName:s.E_TRIGGER_TYPE.recurring})}}.bind(this)).catch(function(t){e.error("Fiori Feedback Plug-in error occured on updating context data.",t.message,i.S_PLUGIN_PLGCTRL_NAME)})},_onThemeChanged:function(t){var n=t.getParameters().theme;if(this._sCurrentThemeId!==n){this._updateThemeState(this._sCurrentThemeId,n,false);return this._oContextDataController.updateContextData(i.E_CLIENT_ACTION.themeChanged).then(function(){sap.ui.getCore().getEventBus().publish("sap.feedback","inapp.feature",{areaId:i.S_GENERIC_TRIGGER_AREAID,triggerName:s.E_TRIGGER_TYPE.themeChanged})}).catch(function(t){e.error("Fiori Feedback Plug-in error occured on updating context data.",t.message,i.S_PLUGIN_PLGCTRL_NAME)})}},_updateThemeState:function(t,e,i){if(this._oLocalStorage){if(!i){this._updateThemeToggleStart(t,e)}this._oLocalStorage.updateLastTheme(t);this._sLastThemeId=t;this._oLocalStorage.updateCurrentTheme(e);this._sCurrentThemeId=e}else{this._sCurrentThemeId=e}},_updateThemeToggleStart:function(t,e){if(this._oLocalStorage){if(n.isHorizonTheme(e)){this._oLocalStorage.setThemeToggleStart(Date.now())}else if(n.isHorizonTheme(t)){this._oLocalStorage.deleteThemeToggleStart()}}}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/controller/WebAppFeedbackLoader", ["sap/ui/base/Object","sap/base/Log","../utils/Constants"],function(t,e,i){"use strict";return t.extend("sap.feedback.ui.flpplugin.controller.WebAppFeedbackLoader",{_oStartupConfig:null,_isAPILoaded:false,constructor:function(t){if(!t){throw Error("oStartupConfig is not provided!")}this._oStartupConfig=t},init:function(t){this._registerAPILoadedEvent(t)},getIsAPILoaded:function(){return this._isAPILoaded},_registerAPILoadedEvent:function(t){window.addEventListener("qsi_js_loaded",function(){if(QSI&&QSI.API){this._isAPILoaded=true}else{this._isAPILoaded=false;e.error("Qualtrics API did not load correctly. QSI.API not available.",null,i.S_PLUGIN_WEBAPPFEEDBACKCTRL_NAME)}if(t){t()}}.bind(this),false)},loadAPI:function(){try{var t=document.createElement("script");t.type="text/javascript";t.src=this._oStartupConfig.getQualtricsUri();document.body&&document.body.appendChild(t)}catch(t){e.error("Cannot inject Qualtrics snippet",t.message,i.S_PLUGIN_WEBAPPFEEDBACKLDR_NAME)}},reloadIntercepts:function(){if(QSI&&QSI.API){QSI.API.unload();QSI.API.load().then(QSI.API.run())}}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/data/AppContextData", ["sap/ui/base/Object","sap/base/Log","sap/ushell/services/AppConfiguration","../utils/Constants","../utils/Utils","../utils/UI5Utils"],function(t,a,e,p,n,i){"use strict";return t.extend("sap.feedback.ui.flpplugin.data.AppContextData",{_dataV1:null,_dataV2:null,constructor:function(){},getData:function(t){return this._updateData().then(function(){if(t===p.E_DATA_FORMAT.version1){return this._dataV1}else if(t===p.E_DATA_FORMAT.version2){return this._dataV2}return null}.bind(this))},_updateData:function(){this._resetData();return this._collectData().then(function(t){this._setData(t)}.bind(this),function(){this._resetData()}.bind(this))},_resetData:function(){this._dataV1={ui5Version:p.S_DEFAULT_VALUE,ui5Theme:p.S_DEFAULT_VALUE,fioriId:p.S_DEFAULT_VALUE,appTitle:p.S_DEFAULT_VALUE,language:p.S_DEFAULT_VALUE,componentId:p.S_DEFAULT_VALUE,appVersion:p.S_DEFAULT_VALUE,ach:p.S_DEFAULT_VALUE};this._dataV2={appFrameworkId:p.S_DEFAULT_VALUE,appFrameworkVersion:p.S_DEFAULT_VALUE,theme:p.S_DEFAULT_VALUE,appId:p.S_DEFAULT_VALUE,appTitle:p.S_DEFAULT_VALUE,languageTag:p.S_DEFAULT_VALUE,technicalAppComponentId:p.S_DEFAULT_VALUE,appVersion:p.S_DEFAULT_VALUE,appSupportInfo:p.S_DEFAULT_VALUE}},_setData:function(t){this._dataV1={ui5Version:t.appFrameworkVersion,ui5Theme:t.theme,fioriId:t.appId,appTitle:t.appTitle,language:t.languageTag,componentId:t.technicalAppComponentId,appVersion:t.appVersion,ach:t.appSupportInfo};this._dataV2=t},_getLanguage:function(t){if(t){var a=t.getLanguage();if(a&&a.length===2){return a.toUpperCase()}}return i.getLanguage().toUpperCase()},_collectData:function(){return new Promise(function(t,e){var o=i.getCurrentApp();if(n.isSupportedAppType(o)){this._collectionAppInfoData(o).then(function(a){var e=this._assignAppInfoData(a);t(e)}.bind(this))}else{a.warning("App not of a supported app type.",null,p.S_PLUGIN_APPCONTEXTDATA_NAME);e()}}.bind(this))},_collectionAppInfoData:function(t){return new Promise(function(a,i){var o=["appId","appVersion","appSupportInfo","technicalAppComponentId","appFrameworkId","appFrameworkVersion"];t.getInfo(o).then(function(t){var i=e.getMetadata();if(i&&i.title){t.appTitle=i.title}if(t.appId&&t.appId===p.S_LAUNCHPAD_VALUE){t.appTitle=n.stringToTitleCase(t.appId)}a(t)}).catch(function(t){i(t)})})},_assignAppInfoData:function(t){var a={};var e=i.getUserInfo();if(e){var o=e.getUser();if(o){a.languageTag=this._getLanguage(o)}}a.theme=i.getTheme();if(t){a.appFrameworkId=n.convertAppFrameworkTypeToId(t["appFrameworkId"])||p.S_DEFAULT_VALUE;a.appFrameworkVersion=t["appFrameworkVersion"]||p.S_DEFAULT_VALUE;a.appId=t["appId"]||p.S_DEFAULT_VALUE;a.appTitle=t["appTitle"]||p.S_DEFAULT_VALUE;a.technicalAppComponentId=t["technicalAppComponentId"]||p.S_DEFAULT_VALUE;a.appVersion=t["appVersion"]||p.S_DEFAULT_VALUE;a.appSupportInfo=t["appSupportInfo"]||p.S_DEFAULT_VALUE}return a}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/data/PushContextData", ["sap/ui/base/Object","sap/base/Log","../utils/Utils","../utils/Constants"],function(t,e,a,i){"use strict";return t.extend("sap.feedback.ui.flpplugin.data.PushContextData",{_iType:null,_sAreaId:null,_sTriggerName:null,_sShortText:null,_oPayloadData:null,constructor:function(t,e,i,r){this._sAreaId=t;this._sTriggerName=e;this._iType=i;if(a.isString(r)&&!a.stringIsEmpty(r)){this._sShortText=r.trim()}},getAreaId:function(){return this._sAreaId},getTriggerName:function(){return this._sTriggerName},getType:function(){return this._iType},getShortText:function(){return this._sShortText||""},getIsBackendPushedSurvey:function(){return this._iType===i.E_PUSH_SRC_TYPE.backend},setPayloadData:function(t){this._oPayloadData=t},getPayloadDataString:function(){var t="";if(this._oPayloadData){try{t=JSON.stringify(this._oPayloadData)}catch(t){e.error("Fiori Feedback Plug-in error occured on parsing payload push data.",t.message,i.S_PLUGIN_PUSHCONTEXTDATA_NAME)}}return t}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/data/TelemetryData", ["sap/ui/base/Object"],function(t){"use strict";return t.extend("sap.feedback.ui.flpplugin.data.TelemetryData",{_pushEventTriggeredCount:0,_pushEventExecutedCount:0,_pushEventSnoozedCount:0,_timeSinceLastPushEvent:0,constructor:function(){},getPushEventTriggeredCount:function(){return this._pushEventTriggeredCount},setPushEventTriggeredCount:function(t){this._pushEventTriggeredCount=t},getPushEventExecutedCount:function(){return this._pushEventExecutedCount},setPushEventExecutedCount:function(t){this._pushEventExecutedCount=t},getPushEventSnoozedCount:function(){return this._pushEventSnoozedCount},setPushEventSnoozedCount:function(t){this._pushEventSnoozedCount=t},getTimeSinceLastPushEvent:function(){return this._timeSinceLastPushEvent},setTimeSinceLastPushEvent:function(t){this._timeSinceLastPushEvent=t}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/data/UserState", ["sap/ui/base/Object","sap/base/Log","../push/state/FeaturePushState","../utils/Utils","../utils/Constants"],function(t,e,s,i,n){"use strict";return t.extend("sap.feedback.ui.flpplugin.data.UserState",{_iVersion:1,_iLastPush:undefined,_sLastTheme:undefined,_sCurrentTheme:undefined,_iThemeToggleStart:undefined,_oFeaturePushStates:undefined,_iDynamicPushDate:undefined,_iInAppPushDate:undefined,_iSnoozeCount:0,constructor:function(){this._oFeaturePushStates={}},initFromJSON:function(t){if(t.version){this._iVersion=t.version}if(t.lastPush){this._iLastPush=t.lastPush}if(t.dynamicPushDate){this._iDynamicPushDate=t.dynamicPushDate}if(t.inAppPushDate){this._iInAppPushDate=t.inAppPushDate}if(t.lastTheme){this._sLastTheme=t.lastTheme}if(t.currentTheme){this._sCurrentTheme=t.currentTheme}if(t.toggleStart){this._iThemeToggleStart=t.toggleStart}if(t.snoozeCount){this._iSnoozeCount=t.snoozeCount}this._oFeaturePushStates={};if(t.featurePushStates){Object.keys(t.featurePushStates).forEach(function(i){try{var u=new s;u.initFromJSON(t.featurePushStates[i]);if(u.getCombinedKey()){this._oFeaturePushStates[u.getCombinedKey()]=u}}catch(t){e.warning("Feature Push state could not be parsed correctly, will be ignored.",t.message,n.S_PLUGIN_USERSTATE_NAME)}}.bind(this))}},getLastPush:function(){return this._iLastPush},getDynamicPushDate:function(){return this._iDynamicPushDate},setDynamicPushDate:function(t){this._iDynamicPushDate=t},getInAppPushDate:function(){return this._iInAppPushDate},setInAppPushDate:function(t){this._iInAppPushDate=t},updateLastPushToNow:function(){this._iLastPush=Date.now()},getLastTheme:function(){return this._sLastTheme||""},setLastTheme:function(t){this._sLastTheme=t},getCurrentTheme:function(){return this._sCurrentTheme||""},setCurrentTheme:function(t){this._sCurrentTheme=t},getThemeToggleStart:function(){return this._iThemeToggleStart},setThemeToggleStart:function(t){this._iThemeToggleStart=t},clearThemeToggleStart:function(){this._iThemeToggleStart=undefined},getSnoozeCount:function(){return this._iSnoozeCount},increaseSnoozeCount:function(){this._iSnoozeCount++},resetSnoozeCount:function(){this._iSnoozeCount=0},createAndAddFeaturePushState:function(t,e,i){var n=new s;n.init(t,e,i);this.addFeaturePushState(n);return n},addFeaturePushState:function(t){var e=t.getCombinedKey();this._oFeaturePushStates[e]=t},getFeaturePushState:function(t,e){var s=i.getCombinedKey(t,e);return this._oFeaturePushStates[s]},findFeaturePushStatesReachedExpiryDate:function(){var t=[];Object.keys(this._oFeaturePushStates).forEach(function(e){var s=this._oFeaturePushStates[e];if(s.hasReachedExpiryDate()){t.push(s)}}.bind(this));return t},removeFeaturePushState:function(t,e){var s=i.getCombinedKey(t,e);if(this._oFeaturePushStates.hasOwnProperty(s)){delete this._oFeaturePushStates[s]}},toJSON:function(){var t={};if(this._iVersion){t.version=this._iVersion}if(this._iLastPush){t.lastPush=this._iLastPush}if(this._iDynamicPushDate){t.dynamicPushDate=this._iDynamicPushDate}if(this._iInAppPushDate){t.inAppPushDate=this._iInAppPushDate}if(this._sLastTheme){t.lastTheme=this._sLastTheme}if(this._sCurrentTheme){t.currentTheme=this._sCurrentTheme}if(this._iThemeToggleStart){t.toggleStart=this._iThemeToggleStart}if(this._iSnoozeCount){t.snoozeCount=this._iSnoozeCount}if(this._oFeaturePushStates){t.featurePushStates={};Object.keys(this._oFeaturePushStates).forEach(function(e){t.featurePushStates[e]=this._oFeaturePushStates[e].toJSON()}.bind(this))}return t}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/push/DynamicPushTrigger", ["sap/ui/base/Object","sap/base/Log","../utils/Constants"],function(i,t,n){"use strict";return i.extend("sap.feedback.ui.flpplugin.push.DynamicPushTrigger",{_oCentralConfig:null,_oStorage:null,_oTimeout:null,_fnHandleDynamicPush:null,_iDynamicPushDelayInMinutes:null,_iNextDynamicPushDate:null,_iMinimumTimeToStartTimerForDynamicPushInHrs:null,constructor:function(i,t){if(!i){throw Error("oCentralConfig is not provided!")}this._oCentralConfig=i;if(!t){throw Error("oStorage is not provided!")}this._oStorage=t},init:function(i){if(!i){t.error("Callback for Dynamic Push trigger not set, could not start Dynamic Push trigger.",null,n.S_PLUGIN_DYNAMICPUSHTRIGGER_NAME);return}var e=this._oCentralConfig.getPushConfig();if(e){this._iDynamicPushDelayInMinutes=e.getDynamicPushIntervalTimer();this._iMinimumTimeToStartTimerForDynamicPushInHrs=e.getMinimumTimeToStartTimerForDynamicPush();var r=this._readUserState();this._iNextDynamicPushDate=r.getDynamicPushDate()}if(!Number.isFinite(this._iDynamicPushDelayInMinutes)){t.error("Interval for Dynamic Push is invalid, could not start Dynamic Push trigger.",null,n.S_PLUGIN_DYNAMICPUSHTRIGGER_NAME);return}if(!Number.isFinite(this._iMinimumTimeToStartTimerForDynamicPushInHrs)){t.error("Minimum time to start timer for Dynamic Push is invalid, could not start Dynamic Push trigger.",null,n.S_PLUGIN_DYNAMICPUSHTRIGGER_NAME);return}this._fnHandleDynamicPush=i;if(this._canTimerStart()){this._startTimer(this._iDynamicPushDelayInMinutes)}},stopTimer:function(){clearTimeout(this._oTimeout);this._oTimeout=null},_onTimeoutCallback:function(){this._oTimeout=null;if(this._fnHandleDynamicPush){this._fnHandleDynamicPush()}this._oTimeout=this._startTimer(this._iDynamicPushDelayInMinutes)},_startTimer:function(){this._oTimeout=setTimeout(this._onTimeoutCallback.bind(this),this._iDynamicPushDelayInMinutes*n.E_TIME.minutesToMilliseconds);t.info("Fiori Feedback Plug-in: dynamical push will be triggered in ",this._iDynamicPushDelayInMinutes+" minutes",n.S_PLUGIN_DYNAMICPUSHTRIGGER_NAME)},_readUserState:function(){return this._oStorage.readUserState()},_canTimerStart:function(){if(this._iNextDynamicPushDate-Date.now()<=this._iMinimumTimeToStartTimerForDynamicPushInHrs*n.E_TIME.hoursToMilliseconds){return true}return false}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/push/config/FeaturePushConfig", ["sap/ui/base/Object","../../utils/Utils"],function(i,e){"use strict";return i.extend("sap.feedback.ui.flpplugin.push.config.FeaturePushConfig",{_sAreaId:null,_sTriggerName:null,_iValidFrom:null,_iValidTo:null,_bIsEnabled:null,_sTriggerType:null,_oTriggerConfig:null,_bIsGeneric:false,init:function(i,e,r,t,n,s){this._sAreaId=i;this._sTriggerName=e;if(!Number.isInteger(r)){throw Error("Valid-from not a number for "+i+"/"+e)}if(!Number.isInteger(t)){throw Error("Valid-to not a number for "+i+"/"+e)}if(r>=t){throw Error("Valid-from date cannot be bigger than Valid-to date.")}this._iValidFrom=r;this._iValidTo=t;this._bIsEnabled=n;if(s){this._bIsGeneric=s}},initFromJSON:function(i){var e=i.areaId;var r=i.triggerName;var t=new Date(i.validFrom).getTime();var n=new Date(i.validTo).getTime();var s=i.isEnabled;var a=i.isGeneric;this.init(e,r,t,n,s,a)},setTriggerConfig:function(i,e){this._sTriggerType=i;this._oTriggerConfig=e},getCombinedKey:function(){return e.getCombinedKey(this._sAreaId,this._sTriggerName)},getAreaId:function(){return this._sAreaId},getTriggerName:function(){return this._sTriggerName},getValidFrom:function(){return this._iValidFrom},getValidTo:function(){return this._iValidTo},getIsEnabled:function(){return this._bIsEnabled},getTriggerType:function(){return this._sTriggerType},getTriggerConfig:function(){return this._oTriggerConfig},getIsGeneric:function(){return this._bIsGeneric},isQualifiedForPush:function(i,e){return this._oTriggerConfig.isQualifiedForPush(i,e)},isActive:function(){if(this._bIsEnabled&&!this.isExpired()){return true}return false},isExpired:function(){var i=Date.now();if(this._isValidNow(i)||this._isValidInFuture(i)){return false}return true},_isValidNow:function(i){if(!Number.isInteger(i)){return false}if(this._iValidFrom<i&&this._iValidTo>i){return true}return false},_isValidInFuture:function(i){if(!Number.isInteger(i)){return false}if(this._iValidFrom>i&&this._iValidTo>i&&this._iValidTo>this._iValidFrom){return true}return false}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/push/config/trigger/BaseTrigger", ["sap/ui/base/Object"],function(t){"use strict";return t.extend("sap.feedback.ui.flpplugin.push.config.trigger.BaseTrigger",{_iInterval:-1,_iMaxLimitCount:-1,_iThresholdCountStart:-1,_canForcePush:false,constructor:function(){},getInterval:function(){return this._iInterval},getMaxLimitCount:function(){return this._iMaxLimitCount},getThresholdCountStart:function(){return this._iThresholdCountStart},canForcePush:function(){return this._canForcePush},isQualifiedForPush:function(t,i){var e=t.getTriggeredCount();var n=t.getExecutedCount();if(this._isMinimumThresholdReached(e)&&this._hasNotReachedMaxLimit(n)&&this._isIntervalMatching(e)){return true}return false},_isMinimumThresholdReached:function(t){return t>=this._iThresholdCountStart},_hasNotReachedMaxLimit:function(t){return t<this._iMaxLimitCount},_isIntervalMatching:function(t){if(this._iInterval===t||t%this._iInterval===0){return true}return false}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/push/config/trigger/RecurringTrigger", ["./BaseTrigger"],function(r){"use strict";return r.extend("sap.feedback.ui.flpplugin.push.config.trigger.RecurringTrigger",{constructor:function(){return r.prototype.constructor.apply(this,arguments)},init:function(r,i,t){if(!Number.isInteger(r)){throw Error("Interval is not a valid number - "+r)}if(!Number.isInteger(i)){throw Error("Max Limit is not a valid number - "+i)}if(!Number.isInteger(t)){throw Error("Start Threshold is not a valid number - "+t)}this._iInterval=r;this._iMaxLimitCount=i;this._iThresholdCountStart=t},initFromJSON:function(r){var i=r.interval;var t=r.maxLimit;var n=r.startThreshold;this.init(i,t,n)}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/push/config/trigger/ThemeChangedTrigger", ["./BaseTrigger","../../../utils/Utils"],function(t,e){"use strict";return t.extend("sap.feedback.ui.flpplugin.push.config.trigger.ThemeChangedTrigger",{_sStartThemeId:null,_sTargetThemeId:null,constructor:function(){return t.prototype.constructor.apply(this,arguments)},init:function(t,e,r,i,s,a){if(!Number.isInteger(t)){throw Error("Interval is not a valid number - "+t)}if(!Number.isInteger(e)){throw Error("Max Limit is not a valid number - "+e)}if(!Number.isInteger(r)){throw Error("Start Threshold is not a valid number - "+r)}if(!i){throw Error("Start Theme ID is missing")}if(!s){throw Error("Target Theme ID is missing")}if(a&&typeof a!=="boolean"){throw Error("Force Push shall be either 'true' or 'false'")}this._iInterval=t;this._iMaxLimitCount=e;this._iThresholdCountStart=r;this._sStartThemeId=i;this._sTargetThemeId=s;this._canForcePush=a?a:false},initFromJSON:function(t){var e=t.interval;var r=t.maxLimit;var i=t.startThreshold;var s=t.startThemeId;var a=t.targetThemeId;var h=t.forcePush;this.init(e,r,i,s,a,h)},getStartThemeId:function(){return this._sStartThemeId},getTargetThemeId:function(){return this._sTargetThemeId},isQualifiedForPush:function(e,r){var i=t.prototype.isQualifiedForPush.apply(this,arguments);var s=r.getLastTheme();var a=r.getCurrentTheme();if(i===true){if(this._isStartThemeMatching(s)){if(this._isTargetThemeMatching(a)){return true}}}return false},_isStartThemeMatching:function(t){if(e.isString(t)){if(t.toLowerCase()===this._sStartThemeId.toLowerCase()||this._sStartThemeId.trim()==="*"){return true}}return false},_isTargetThemeMatching:function(t){if(e.isString(t)){if(t.toLowerCase()===this._sTargetThemeId.toLowerCase()||this._sTargetThemeId.trim()==="*"){return true}}return false}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/push/config/trigger/ThemeTimeSlotTrigger", ["./BaseTrigger","../../../utils/Utils","../../../utils/Constants"],function(t,e,r){"use strict";return t.extend("sap.feedback.ui.flpplugin.push.config.trigger.ThemeTimeSlotTrigger",{_sTargetingThemeId:null,_aTimeSlots:null,constructor:function(){return t.prototype.constructor.apply(this,arguments)},init:function(t,e,r,i,n){if(!Number.isInteger(t)){throw Error("Interval is not a valid number - "+t)}if(!Number.isInteger(e)){throw Error("Start Threshold is not a valid number - "+e)}if(!r){throw Error("Targeting Theme ID is missing - "+r)}if(!i||!Array.isArray(i)||i.length<1){throw Error("Time slots are invalid")}if(n&&typeof n!=="boolean"){throw Error("Force Push shall be either 'true' or 'false'")}this._iInterval=t;this._iMaxLimitCount=i.length;this._iThresholdCountStart=e;this._sTargetingThemeId=r;this._aTimeSlots=i;this._canForcePush=n?true:false},initFromJSON:function(t){var e=t.interval;var r=t.startThreshold;var i=t.targetingThemeId;var n=t.timeSlots;var s=t.forcePush;this.init(e,r,i,n,s)},getTargetingThemeId:function(){return this._sTargetingThemeId},getTimeSlots:function(){return this._aTimeSlots},getTimeSlotFor:function(t){if(t<=this._aTimeSlots.length){return this._aTimeSlots[t]}return null},isQualifiedForPush:function(e,r){var i=t.prototype.isQualifiedForPush.apply(this,arguments);var n=r.getCurrentTheme();if(i===true){if(this._isTargetingThemeMatching(n)){if(this._isTimeSlotReached(e,r)){return true}}}return false},_isTargetingThemeMatching:function(t){if(e.isString(t)){if(t.toLowerCase()===this._sTargetingThemeId.toLowerCase()||this._sTargetingThemeId.trim()==="*"){return true}}return false},_isTimeSlotReached:function(t,e){var r=t.getExecutedCount();var i=this.getTimeSlotFor(r);var n=e.getThemeToggleStart();if(i&&n){return this._hasDurationPassed(i,n)}return false},_hasDurationPassed:function(t,e){var i=new Date(e+t*r.E_TIME.minutesToMilliseconds).getTime();if(i&&i<Date.now()){return true}return false}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/push/config/trigger/TriggerFactory", ["./ThemeTimeSlotTrigger","./ThemeChangedTrigger","./RecurringTrigger"],function(e,r,i){"use strict";return{createTrigger:function(n){var g=null;switch(n.name){case"themeTimeSlotTrigger":g=new e;g.initFromJSON(n);break;case"themeChangedTrigger":g=new r;g.initFromJSON(n);break;case"recurringTrigger":g=new i;g.initFromJSON(n);break}return g}}});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/push/config/trigger/TriggerType", [],function(){"use strict";var e={E_TRIGGER_TYPE:{recurring:"recurring",themeChanged:"themeChanged",dynamic:"dynamic"}};return e});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/push/state/FeaturePushState", ["sap/ui/base/Object","../../utils/Utils","../../utils/Constants"],function(e,t,i){"use strict";return e.extend("sap.feedback.ui.flpplugin.push.state.FeaturePushState",{_sAreaId:null,_sTriggerName:null,_sTriggerType:null,_iTriggeredCount:0,_iExecutedCount:0,_iLastChanged:null,init:function(e,t,i,r,n){this._sAreaId=e;this._sTriggerName=t;this._sTriggerType=i;if(r){this._iTriggeredCount=r}if(n){this._iExecutedCount=n}this._iLastChanged=Date.now()},initFromJSON:function(e){this._sAreaId=e.areaId;this._sTriggerName=e.triggerName;this._sTriggerType=e.triggerType;if(e.triggeredCount){this._iTriggeredCount=e.triggeredCount}if(e.executedCount){this._iExecutedCount=e.executedCount}if(e.lastChanged){this._iLastChanged=e.lastChanged}},getCombinedKey:function(){return t.getCombinedKey(this._sAreaId,this._sTriggerName)},getAreaId:function(){return this._sAreaId},getTriggerName:function(){return this._sTriggerName},getTriggerType:function(){return this._sTriggerType},getTriggeredCount:function(){return this._iTriggeredCount},getExecutedCount:function(){return this._iExecutedCount},increaseTriggeredCount:function(){this._iTriggeredCount++;this._iLastChanged=Date.now()},increaseExecutedCount:function(){this._iExecutedCount++;this._iLastChanged=Date.now()},hasReachedExpiryDate:function(){if(!Number.isInteger(this._iLastChanged)){this._iLastChanged=Date.now();return false}var e=Date.now()-this._iLastChanged;if(e/864e5>=i.I_DAYS_UNTIL_STATE_EXPIRY){return true}return false},toJSON:function(){var e={areaId:this._sAreaId,triggerName:this._sTriggerName,triggerType:this._sTriggerType,lastChanged:this._iLastChanged};if(this._iTriggeredCount>=0){e.triggeredCount=this._iTriggeredCount}if(this._iExecutedCount>=0){e.executedCount=this._iExecutedCount}return e}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/survey/Balancer", ["sap/ui/base/Object","../utils/Utils","../utils/Constants"],function(e,t,a){"use strict";return e.extend("sap.feedback.ui.flpplugin.survey.Balancer",{init:function(e){if(!e){throw Error("oStorage is not provided!")}this._oStorage=e},balance:function(e){return this._isSurveyTimeframeReached(e)},_isSurveyTimeframeReached:function(e){var t=this._readUserState();var i=null;if(e===a.E_PUSH_SRC_TYPE.dynamic){i=t.getDynamicPushDate()}else if(e===a.E_PUSH_SRC_TYPE.pushInApp){i=t.getInAppPushDate()}else{i=Date.now()+850301}return i<=Date.now()},_readUserState:function(){return this._oStorage.readUserState()}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/survey/DateCalculator", ["../utils/Constants"],function(t){"use strict";return{calculateInitialDynamicPushDate:function(t){return this._calculateNextSurveyDate(t.getIntervalInitialDynamicPushInDays(),t.getDeviationInitialDynamicPushInDays())},calculateInitialInAppPushDate:function(t){return this._calculateNextSurveyDate(t.getIntervalInitialInAppPushInDays(),t.getDeviationInitialInAppPushInDays())},calculateNextDynamicPushDate:function(t){return this._calculateNextSurveyDate(t.getIntervalNextDynamicPushInDays(),t.getDeviationNextDynamicPushInDays())},calculateNextInAppPushDate:function(t){return this._calculateNextSurveyDate(t.getIntervalNextInAppPushInDays(),t.getDeviationNextInAppPushInDays())},_calculateNextSurveyDate:function(a,e){var n=a+Math.round(Math.random()*e*2)-e;return Date.now()+n*t.E_TIME.daysToMilliseconds}}});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/survey/PresentationController", ["sap/ui/base/Object","sap/base/Log","../data/PushContextData","../data/TelemetryData","../utils/Constants","../ui/UiFactory","./DateCalculator","../utils/Utils"],function(t,e,o,a,n,s,r,i){"use strict";return t.extend("sap.feedback.ui.flpplugin.survey.PresentationController",{_oContextDataController:null,_oResourceBundle:null,_oUserStorage:null,_oCentralConfig:null,_oSurveyInvitationDialog:null,init:function(t,e,o,a){if(!t){throw Error("oContextDataController is not provided!")}if(!e){throw Error("oResourceBundle is not provided!")}if(!o){throw Error("oUserStorage is not provided!")}if(!a){throw Error("oCentralConfig is not provided!")}this._oContextDataController=t;this._oResourceBundle=e;this._oUserStorage=o;this._oCentralConfig=a},surveyUser:function(t,e){return this._prepareAndRunPushSurvey(t,e)},_prepareAndRunPushSurvey:function(t,e){var o=this._preparePushContextData(t,e);if(!this._oSurveyInvitationDialog){this._oSurveyInvitationDialog=s.createSurveyInvitationDialog(this._oResourceBundle)}return new Promise(function(a,n){this._oSurveyInvitationDialog.show(function(t){if(t){this._updateContextDataAndOpenSurvey(o,e).then(a)}else{this._snoozePush();a()}}.bind(this),t.type)}.bind(this))},_preparePushContextData:function(t,e){var a=null;var n,s,r,i;var u=t.type;if(e){n=e.oConfig.getAreaId();s=e.oConfig.getTriggerName()}else{n=t.areaId;s=t.triggerName}r=t.shortText||"";i=t.payload||null;a=new o(n,s,u,r);if(i){a.setPayloadData(i)}return a},_updateContextDataAndOpenSurvey:function(t,o){var a=n.E_CLIENT_ACTION.inAppPushFeedback;if(t.getType()===n.E_PUSH_SRC_TYPE.dynamic){a=n.E_CLIENT_ACTION.dynamicPushFeedBack}var s=0;if(o){s=o.oState.getExecutedCount()}var r=this._collectTelemetry(o);return this._oContextDataController.updateContextData(a,t,r).then(function(){return this._openSurvey(a,s).then(function(){this._updateLastPushTimestamp();this._updatePushState(o);this._updateNextPushDates(t.getType())}.bind(this))}.bind(this)).catch(function(t){e.error("Fiori Feedback Plug-in error occured on updating push context data.",t.message,n.S_PLUGIN_SURVEY_PRESENTATION_CONTROLLER_NAME)})},_collectTelemetry:function(t){var e=new a;var o=i.readUserState(this._oUserStorage);if(o){e.setPushEventSnoozedCount(o.getSnoozeCount());var n=Date.now()-o.getLastPush();e.setTimeSinceLastPushEvent(n)}if(t&&t.oState){e.setPushEventTriggeredCount(t.oState.getTriggeredCount());e.setPushEventExecutedCount(t.oState.getExecutedCount())}return e},_snoozePush:function(){var t=i.readUserState(this._oUserStorage);if(t){var e=t.getSnoozeCount();if(e>=n.I_MAX_SNOOZE_COUNT){this._skipOnSnooze()}else{this._updateSnoozeValues(e+1)}}},_skipOnSnooze:function(){this._updateNextPushDates(n.E_PUSH_SRC_TYPE.pushInApp);this._updateNextPushDates(n.E_PUSH_SRC_TYPE.dynamic);var t=i.readUserState(this._oUserStorage);t.resetSnoozeCount();this._saveUserState(t)},_updateSnoozeValues:function(t){var e=i.readUserState(this._oUserStorage);var o=e.getInAppPushDate();var a=e.getDynamicPushDate();var s=Date.now()+n.E_TIME.hoursToMilliseconds*(this._getPushConfig().getSnoozePeriodInHrs()*t);if(o&&o<s){e.setInAppPushDate(s)}if(a&&a<s){e.setDynamicPushDate(s)}e.increaseSnoozeCount();this._saveUserState(e)},_openSurvey:function(t,e){if(this._oContextDataController){this._oContextDataController.setClientAction(t);this._oContextDataController.setLastTheme(this._sLastThemeId);this._oContextDataController.setFollowUpCount(e)}QSI.API.unload();return QSI.API.load().then(function(){QSI.API.run()})},_updateLastPushTimestamp:function(){var t=i.readUserState(this._oUserStorage);t.updateLastPushToNow();t.resetSnoozeCount();this._saveUserState(t)},_updatePushState:function(t){if(t){var o=t.oState;var a=i.readUserState(this._oUserStorage);a.resetSnoozeCount();var s=a.getFeaturePushState(o.getAreaId(),o.getTriggerName());if(s){s.increaseExecutedCount();this._saveUserState(a)}else{e.error("Feature Push state could not be updated.",null,n.S_PLUGIN_SURVEY_PRESENTATION_CONTROLLER_NAME)}}},_updateNextPushDates:function(t){var e=Date.now()+n.E_TIME.hoursToMilliseconds*this._getPushConfig().getQuietPeriodInHrs();var o=i.readUserState(this._oUserStorage);if(o){if(t===n.E_PUSH_SRC_TYPE.dynamic){o.setDynamicPushDate(r.calculateNextDynamicPushDate(this._getPushConfig()));var a=o.getInAppPushDate();if(a&&a<e){o.setInAppPushDate(e)}}else if(t===n.E_PUSH_SRC_TYPE.pushInApp){o.setInAppPushDate(r.calculateNextInAppPushDate(this._getPushConfig()));var s=o.getDynamicPushDate();if(s&&s<e){o.setDynamicPushDate(e)}}this._saveUserState(o)}},_getPushConfig:function(){return this._oCentralConfig.getPushConfig()},_saveUserState:function(t){this._oUserStorage.saveUserState(t)}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/survey/RequestDispatcher", ["sap/ui/base/Object","sap/base/Log","./SurveyFactory","./RequestHandler","../utils/Constants","./DateCalculator","../utils/Utils","../utils/ScopeCheck","../push/config/trigger/TriggerType"],function(i,t,e,r,n,a,s,o,u){"use strict";return i.extend("sap.feedback.ui.flpplugin.survey.RequestDispatcher",{_oStartupConfig:null,_oCentralConfig:null,_oContextDataController:null,_oRequestHandler:null,_oResourceBundle:null,_bInitializationErrorOccured:false,_oPresentationController:null,init:function(i,e,a,s,o){if(!i){t.error("oStartupConfig is missing during initialization!",null,n.S_PLUGIN_SURVEY_REQ_DISPATCHER);this._bInitializationErrorOccured=true}if(!e){t.error("oCentralConfig is missing during initialization!",null,n.S_PLUGIN_SURVEY_REQ_DISPATCHER);this._bInitializationErrorOccured=true}if(!a){t.error("oContextDataController is missing during initialization!",null,n.S_PLUGIN_SURVEY_REQ_DISPATCHER);this._bInitializationErrorOccured=true}if(!s){t.error("oResourceBundle is missing during initialization!",null,n.S_PLUGIN_SURVEY_REQ_DISPATCHER);this._bInitializationErrorOccured=true}if(!o){t.error("oUserStorage is missing during initialization!",null,n.S_PLUGIN_SURVEY_REQ_DISPATCHER);this._bInitializationErrorOccured=true}if(!this._bInitializationErrorOccured){this._oStartupConfig=i;this._oCentralConfig=e;this._oContextDataController=a;this._oResourceBundle=s;this._oUserStorage=o;this._oRequestHandler=new r;this._setupInitialPushDates();this._oRequestHandler.init(this._onRequestReceivedCallback.bind(this))}},handleDynamicPush:function(){if(this._canUserDigestSurvey(n.E_PUSH_SRC_TYPE.dynamic)){var i={areaId:n.S_GENERIC_TRIGGER_AREAID,triggerName:u.E_TRIGGER_TYPE.dynamic,type:n.E_PUSH_SRC_TYPE.dynamic};this._triggerPushSurvey(i,null)}},_onRequestReceivedCallback:function(i){var t=e.createValidationHandler();t.init(this._oUserStorage,this._oCentralConfig);var r=t.validate(i);if(r){var n=this._isForcePush(r.oConfig);if(this._canUserDigestSurvey(i.type)||n){this._triggerPushSurvey(i,r)}}},_canUserDigestSurvey:function(i){if(!s.isQualtricsSurveyPopupOpen()){var t=e.createBalancer();t.init(this._oUserStorage);return t.balance(i)}return false},_triggerPushSurvey:function(i,t){if(!this._PresentationController){this._PresentationController=e.createPresentationController();this._PresentationController.init(this._oContextDataController,this._oResourceBundle,this._oUserStorage,this._oCentralConfig)}this._PresentationController.surveyUser(i,t)},_isForcePush:function(i){return i.getTriggerConfig().canForcePush()&&!s.isQualtricsSurveyPopupOpen()},_setupInitialPushDates:function(){var i=this._oUserStorage.readUserState();if(i){var t=i.getDynamicPushDate();var e=i.getInAppPushDate();var r=false;if(!t&&o.isDynamicPushAvailable(this._oStartupConfig)){var n=a.calculateInitialDynamicPushDate(this._getPushConfig());i.setDynamicPushDate(n);r=true}if(!e&&o.isFeaturePushAvailable(this._oStartupConfig)){var s=a.calculateInitialInAppPushDate(this._getPushConfig());i.setInAppPushDate(s);r=true}if(r){this._oUserStorage.saveUserState(i)}}},_getPushConfig:function(){return this._oCentralConfig.getPushConfig()}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/survey/RequestHandler", ["sap/ui/base/Object","sap/base/Log","sap/ui/core/EventBus","../utils/Constants","../utils/Utils"],function(e,a,i,t,r){"use strict";return e.extend("sap.feedback.ui.flpplugin.survey.RequestHandler",{_fnOnRequestReceivedCallback:null,init:function(e){if(!e){throw Error("fnOnRequestReceivedCallback is not provided!")}this._fnOnRequestReceivedCallback=e;var a=sap.ui.getCore().getEventBus();a.subscribe("sap.feedback","inapp.feature",this._onFeatureEventBusFired,this)},_onFeatureEventBusFired:function(e,i,r){r.type=t.E_PUSH_SRC_TYPE.pushInApp;try{if(this._fnOnRequestReceivedCallback&&this._isValidEventData(r)){this._fnOnRequestReceivedCallback(r)}}catch(e){a.error("Push message could not be processed.",e.message,t.S_PLUGIN_SURVEY_REQ_HANDLER_NAME)}},_isValidEventData:function(e){if(e.hasOwnProperty("areaId")&&e.hasOwnProperty("triggerName")){var i=e.areaId;var s=e.triggerName;var n=e.payload;if(!r.isString(i)||r.stringIsEmpty(i)){a.error("Event Payload data is invalid - Area ID is invalid",i,t.S_PLUGIN_SURVEY_REQ_HANDLER_NAME);return false}if(!r.isString(s)||r.stringIsEmpty(s)){a.error("Event Payload data is invalid - Trigger Name is invalid",s,t.S_PLUGIN_SURVEY_REQ_HANDLER_NAME);return false}if(n&&!r.isObject(n)){a.error("Event Payload data is invalid - Payload is invalid",n,t.S_PLUGIN_SURVEY_REQ_HANDLER_NAME);return false}}else{a.error("Event Payload data is invalid: Area ID: "+e.areaId+" Trigger Name: "+e.triggerName+"",null,t.S_PLUGIN_SURVEY_REQ_HANDLER_NAME);return false}return true},unsubscribeFromTheEventBusForTesting:function(){var e=sap.ui.getCore().getEventBus();e.unsubscribe("sap.feedback","inapp.feature",this._onFeatureEventBusFired,this)}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/survey/SurveyFactory", ["./ValidationHandler","./Balancer","./PresentationController","../config/CentralConfig","../config/ConfigurationLoader"],function(n,e,r,t,a){"use strict";return{createBalancer:function(){return new e},createCentralConfiguration:function(){return new t},createPresentationController:function(){return new r},createValidationHandler:function(){return new n},createConfigurationLoader:function(){return new a}}});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/survey/ValidationHandler", ["sap/ui/base/Object","../utils/Utils","../utils/Constants"],function(e,t,r){"use strict";return e.extend("sap.feedback.ui.flpplugin.survey.ValidationHandler",{_oStorage:null,_oCentralConfig:null,init:function(e,t){if(!e){throw Error("oStorage is not provided!")}if(!t){throw Error("oCentralConfig is not provided!")}this._oStorage=e;this._oCentralConfig=t},validate:function(e){if(e.areaId&&e.triggerName){var t=e.areaId;var i=e.triggerName;var n=t===r.S_GENERIC_TRIGGER_AREAID?true:false;return this._getRelevantStateConfig(t,i,n)}return null},_getRelevantStateConfig:function(e,t,r){var i=this._collectConfigurationForEvent(e,t,r);if(i&&i.length>0){var n=this._combineRelatedStateConfigs(i);var a=this._selectStateConfig(n);if(a){this._increaseTriggeredCount(a)}return a}return null},_increaseTriggeredCount:function(e){if(e.oConfig){var r=t.readUserState(this._oStorage);if(r){var i=r.getFeaturePushState(e.oConfig.getAreaId(),e.oConfig.getTriggerName());if(i){i.increaseTriggeredCount();this._saveUserState(r)}}}},_collectConfigurationForEvent:function(e,t,r){if(r===true){return this._findGenericConfigsWithTriggerType(t)}else{var i=this._oCentralConfig.getPushConfig().findFeaturePushConfigById(e,t);if(i){return[i]}return null}},_combineRelatedStateConfigs:function(e){var r=[];e.forEach(function(e){var i={};i.sCombinedKey=e.getCombinedKey();i.oConfig=e;var n=this._findStateById(e.getAreaId(),e.getTriggerName());if(!n){var a=t.readUserState(this._oStorage);n=a.createAndAddFeaturePushState(e.getAreaId(),e.getTriggerName(),e.getTriggerType());this._saveUserState(a)}if(n){i.oState=n;r.push(i)}}.bind(this));return r},_selectStateConfig:function(e){if(e&&e.length>0){var r=this._filterQualifiedConfigs(e);if(r.length===1){return r[0]}else if(r.length>1){var i=t.getRandomInt(0,r.length);return r[i]}}return null},_filterQualifiedConfigs:function(e){var r=[];if(e&&e.length>0){var i=t.readUserState(this._oStorage);e.forEach(function(e){if(e.oConfig.isQualifiedForPush(e.oState,i)){r.push(e)}})}return r},_findGenericConfigsWithTriggerType:function(e){var t=this._oCentralConfig.getPushConfig().findGenericFeaturePushConfigWithTriggerType(e);if(t&&t.length>0){return t}return null},_findStateById:function(e,r){var i=t.readUserState(this._oStorage);if(i){return i.getFeaturePushState(e,r)}return null},_saveUserState:function(e){if(e){this._oStorage.saveUserState(e)}}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/ui/PopOverVisual", ["sap/ui/base/Object","../utils/Utils"],function(t,i){"use strict";return t.extend("sap.feedback.ui.flpplugin.ui.PopOverVisual",{constructor:function(){},show:function(){QSI.API.unload();QSI.API.load().then(function(){this._clickButton()}.bind(this))},_clickButton:function(){var t=i.getTriggerButton();if(t){t.click()}}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/ui/ShellBarButton", ["sap/ui/base/Object","sap/base/Log","sap/ui/core/InvisibleText","../utils/Constants"],function(e,t,i,n){"use strict";return e.extend("sap.feedback.ui.flpplugin.ui.ShellBarButton",{_fnRendererPromise:null,_oResourceBundle:null,_oInvisibleSurveyButton:null,_oHeaderItemOptions:{},_oHeaderItem:null,_fnDialogCallback:null,_bIsButtonHidden:false,constructor:function(e,i,s){if(!e){t.error("Renderer expected",null,n.S_PLUGIN_UI_SHELLBARBUTTON_NAME)}if(!i){t.error("Dialog callback expected",null,n.S_PLUGIN_UI_SHELLBARBUTTON_NAME)}if(!s){t.error("ResourceBundle expected",null,n.S_PLUGIN_UI_SHELLBARBUTTON_NAME)}this._fnRendererPromise=e;this._fnDialogCallback=i;this._oResourceBundle=s},init:function(){this._createInvisibleText();this._defineButtonOptions();return this._fnRendererPromise.then(function(e){this._oHeaderItem=e.addHeaderEndItem("sap.ushell.ui.shell.ShellHeadItem",this._oHeaderItemOptions,true)}.bind(this))},_createInvisibleText:function(){this._oInvisibleSurveyButton=new i({id:n.S_INVISIBLE_ITEM_ID,text:this._getText("SHELLBAR_BUTTON_TOOLTIP")}).toStatic()},_defineButtonOptions:function(){this._oHeaderItemOptions={id:n.S_SHELL_BTN_ID,icon:"sap-icon://feedback",tooltip:this._getText("SHELLBAR_BUTTON_TOOLTIP"),ariaLabel:this._getText("SHELLBAR_BUTTON_TOOLTIP"),text:this._getText("SHELLBAR_BUTTON_TOOLTIP"),press:this._fnDialogCallback.bind(this)}},_getText:function(e){if(this._oResourceBundle){var t=this._oResourceBundle.getText(e);return t}return e}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/ui/SurveyInvitationDialog", ["sap/ui/base/Object","./Ui5ControlFactory","../utils/Constants"],function(t,i,e){"use strict";return t.extend("sap.feedback.ui.flpplugin.ui.SurveyInvitationDialog",{_oResourceBundle:null,_oSurveyInvitationDialog:null,_fnDialogCallback:null,_oAskLaterButton:null,constructor:function(t){this._oResourceBundle=t},_dialogCallBack:function(t){this._oSurveyInvitationDialog.close();this._fnDialogCallback(t)},show:function(t,o){if(!this._oSurveyInvitationDialog||this._oSurveyInvitationDialog&&!this._oSurveyInvitationDialog.isOpen()){this._fnDialogCallback=t}if(!this._oSurveyInvitationDialog){this._oProvideButton=i.createButton({id:"ProvideButton",type:sap.m.ButtonType.Emphasized,text:this._getText("YOUR_OPINION_PROVIDEBUTTON"),press:function(){this._dialogCallBack(true)}.bind(this)});this._oAskLaterButton=i.createButton({id:"AskLaterButton",press:function(){this._dialogCallBack(false)}.bind(this)});this._oSurveyInvitationDialog=i.createDialog({type:sap.m.DialogType.Message,title:this._getText("YOUR_OPINION_TITLE"),content:i.createFormattedText({htmlText:this._getText("YOUR_OPINION_TEXT")}),beginButton:this._oProvideButton,endButton:this._oAskLaterButton,escapeHandler:function(t){t.resolve();this._fnDialogCallback(false)}.bind(this)})}if(!this._oSurveyInvitationDialog.isOpen()){var n=this._getText("YOUR_OPINION_NOTNOW");if(o===e.E_PUSH_SRC_TYPE.dynamic){n=this._getText("YOUR_OPINION_ASKLATERBUTTON")}this._oAskLaterButton.setText(n);this._oSurveyInvitationDialog.open()}},_getText:function(t){var i=this._oResourceBundle.getText(t);return i}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/ui/Ui5ControlFactory", ["sap/m/Button","sap/m/Dialog","sap/m/FormattedText"],function(t,e,n){"use strict";return{createButton:function(e){return new t(e)},createDialog:function(t){return new e(t)},createFormattedText:function(t){return new n(t)}}});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/ui/UiFactory", ["./SurveyInvitationDialog"],function(n){"use strict";return{createSurveyInvitationDialog:function(i){return new n(i)}}});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/utils/Constants", [],function(){"use strict";var e={S_PLUGIN_COMPONENT_NAME:"sap.feedback.ui.flpplugin.Component",S_PLUGIN_PLGCTRL_NAME:"sap.feedback.ui.flpplugin.controller.PluginController",S_PLUGIN_CTXTDATACTRL_NAME:"sap.feedback.ui.flpplugin.controller.ContextDataController",S_PLUGIN_WEBAPPFEEDBACKLDR_NAME:"sap.feedback.ui.flpplugin.controller.WebAppFeedbackLoader",S_PLUGIN_APPCONTEXTDATA_NAME:"sap.feedback.ui.flpplugin.data.AppContextData",S_PLUGIN_PUSHCONTEXTDATA_NAME:"sap.feedback.ui.flpplugin.data.PushContextData",S_PLUGIN_CONFIGLOADER_NAME:"sap.feedback.ui.flpplugin.config.ConfigurationLoader",S_PLUGIN_INAPPFEATPUSHCTRL_NAME:"sap.feedback.ui.flpplugin.push.PushController",S_PLUGIN_DYNAMICPUSHTRIGGER_NAME:"sap.feedback.ui.flpplugin.push.DynamicPushTrigger",S_PLUGIN_LOCALSTATE_NAME:"sap.feedback.ui.flpplugin.push.state.LocalState",S_PLUGIN_STORAGE_NAME:"sap.feedback.ui.flpplugin.utils.Storage",S_PLUGIN_SURVEY_REQ_HANDLER_NAME:"sap.feedback.ui.flpplugin.survey.RequestHandler",S_PLUGIN_SURVEY_REQ_DISPATCHER:"sap.feedback.ui.flpplugin.survey.RequestDispatcher",S_PLUGIN_SURVEY_PRESENTATION_CONTROLLER_NAME:"sap.feedback.ui.flpplugin.survey.PresentationController",S_PLUGIN_UI_SHELLBARBUTTON_NAME:"sap.feedback.ui.flpplugin.ui.ShellBarButton",S_DEFAULT_VALUE:"N/A",S_LAUNCHPAD_VALUE:"LAUNCHPAD",S_SHELL_BTN_ID:"sap_qualtrics_surveyTriggerButton",S_INVISIBLE_ITEM_ID:"surveyTriggerButton",S_GENERIC_TRIGGER_AREAID:"sap.feedback.generic",S_STOR_PUSH_STATE:"sap.feedback.ui.pushState",S_STOR_THEME_START:"sap.feedback.ui.theme_start",S_STOR_THEME_FOLLOWUP_OPTIN:"sap.feedback.ui.theme_followup_opt_in",S_STOR_THEME_FOLLOWUP_OPTOUT:"sap.feedback.ui.theme_followup_opt_out",S_STOR_LAST_THEME:"sap.feedback.ui.last_theme",S_THEME_URL_PARAM_SWITCH:"qtx-teched",S_SCOPE_FIORI_NEXT_BETA1:"techEd21",S_SCOPE_FEATURE_PUSH:"featurePush",S_SCOPE_DYNAMIC_PUSH:"dynamicPush",S_IMMEDIATE_TEST:"immediateTestMode",I_DAYS_UNTIL_STATE_EXPIRY:180,I_MAX_SNOOZE_COUNT:2,E_CLIENT_ACTION:{init:"init",navBarClick:"navBarClick",appLoaded:"appLoaded",backendPush:"backendPush",inAppUserFeedback:"inAppUserFeedback",inAppPushFeedback:"inAppPushFeedback",themeChanged:"themeChanged",themeChangedOptIn:"themeChangedOptIn",themeChangedOptOut:"themeChangedOptOut",dynamicPushFeedBack:"dynamicPushFeedback"},E_THEME_NAME:{horizon:"sap_horizon",horizon_evening:"sap_horizon_dark",horizonHcb:"sap_horizon_hcb",horizonHcw:"sap_horizon_hcw",fiori3:"sap_fiori_3",fiori3Dark:"sap_fiori_3_dark",fiori3Hcb:"sap_fiori_3_hcb",fiori3Hcw:"sap_fiori_3_hcw",belize:"sap_belize",belizePlus:"sap_belize_plus",belizeHcb:"sap_belize_hcb",belizeHcw:"sap_belize_hcw"},E_PUSH_SRC_TYPE:{backend:1,userInApp:2,qualtrics:3,pushInApp:4,dynamic:5},E_DISPLAY_FORMAT:{popover:1,iframe:2},E_SHELLBAR_BUTTON_STATE:{unchanged:1,restart:2},E_DATA_FORMAT:{version1:1,version2:2},E_APP_FRAMEWORK:{unknown:1,ui5:2,gui:3,angular:4,react:5,vue:6,tr:7,wda:8,nwbc:9},E_TIME:{minutesToMilliseconds:6e4,hoursToMilliseconds:36e5,daysToMilliseconds:864e5},E_TRIGGER_NAME:{themeTimeSlotTrigger:"themeTimeSlotTrigger",themeChangedTrigger:"themeChangedTrigger",recurringTrigger:"recurringTrigger"}};return e});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/utils/InitDetection", ["sap/ui/base/Object"],function(n){"use strict";return n.extend("sap.feedback.ui.flpplugin.utils.InitDetection",{_sUrl:null,constructor:function(n){this._sUrl=n},isUrlLoadable:function(){return this._canLoadUrl(this._sUrl)},_canLoadUrl:function(n){return new Promise(function(t,e){var i={method:"HEAD",mode:"no-cors"};var r=new Request(n,i);fetch(r).then(function(n){return n}).then(function(){t(true)}).catch(function(){e(false)})})}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/utils/ScopeCheck", ["./Utils","./Constants"],function(e,t){"use strict";return{isUrlParamActive:function(e,t){var i=this._getWindowSearchLocation();if(i){var r=new URLSearchParams(i);if(r&&r.has(e)){var a=r.get(e);if(a.trim().toLocaleLowerCase()===t){return true}}}return false},isScopeItemActive:function(e,t){if(e&&e.hasScopeItem(t)){return true}return false},_getWindowSearchLocation:function(){return window.location.search},isFeaturePushConfigParamActive:function(){return this.isUrlParamActive(t.S_SCOPE_FEATURE_PUSH,"true")},isDynamicPushConfigParamActive:function(){return this.isUrlParamActive(t.S_SCOPE_DYNAMIC_PUSH,"true")},isFeaturePushScopeSetActive:function(e){return this.isScopeItemActive(e,t.S_SCOPE_FEATURE_PUSH)},isDynamicPushScopeSetActive:function(e){return this.isScopeItemActive(e,t.S_SCOPE_DYNAMIC_PUSH)},isImmediateTestModeParamActive:function(){return this.isUrlParamActive(t.S_IMMEDIATE_TEST,"true")},isFeaturePushAvailable:function(t){if((this.isFeaturePushConfigParamActive()||this.isFeaturePushScopeSetActive(t))&&e.isLocalStorageAvailable()){return true}return false},isDynamicPushAvailable:function(t){if((this.isDynamicPushConfigParamActive()||this.isDynamicPushScopeSetActive(t))&&e.isLocalStorageAvailable()){return true}return false}}});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/utils/Storage", ["sap/ui/base/Object","sap/base/Log","../data/UserState","./Utils","./Constants"],function(e,t,a,r,i){"use strict";return e.extend("sap.feedback.ui.flpplugin.utils.Storage",{_oLocalStorage:null,init:function(){this._oLocalStorage=r.getLocalStorage();var e=this._getValueForKey(i.S_STOR_PUSH_STATE);if(this._oLocalStorage&&!e){this._upgradeAndInitNew()}},_initNew:function(){var e=new a;this.saveUserState(e);return e},_upgradeAndInitNew:function(){var e=this._initNew();this._migrateThemeData(e);this.saveUserState(e)},readUserState:function(){var e=this._getValueForKey(i.S_STOR_PUSH_STATE);if(!e){return this._initNew()}try{var r=JSON.parse(e);if(r){var s=new a;s.initFromJSON(r);return s}}catch(e){t.error("Reading user state failed.",e.message,i.S_PLUGIN_STORAGE_NAME)}return null},saveUserState:function(e){if(e){try{var a=JSON.stringify(e);this.updateValue(i.S_STOR_PUSH_STATE,a)}catch(e){t.error("Saving user state failed.",e.message,i.S_PLUGIN_STORAGE_NAME)}}},_migrateThemeData:function(e){var t=this._getValueForKey(i.S_STOR_LAST_THEME);if(t){e.setLastTheme(t);this.deleteKey(i.S_STOR_LAST_THEME)}var a=this._getValueForKey(i.S_STOR_THEME_START);if(a){var s=a;if(r.isStringValidNumber(a)){s=parseInt(a)}e.setThemeToggleStart(s);this.deleteKey(i.S_STOR_THEME_START)}if(this._getValueForKey(i.S_STOR_THEME_FOLLOWUP_OPTIN)){this.deleteKey(i.S_STOR_THEME_FOLLOWUP_OPTIN)}if(this._getValueForKey(i.S_STOR_THEME_FOLLOWUP_OPTOUT)){this.deleteKey(i.S_STOR_THEME_FOLLOWUP_OPTOUT)}},updateLastTheme:function(e){var t=this.readUserState();if(t&&t.setLastTheme){t.setLastTheme(e);this.saveUserState(t)}},getLastTheme:function(){var e=this.readUserState();return e.getLastTheme()},updateCurrentTheme:function(e){var t=this.readUserState();if(t&&t.setCurrentTheme){t.setCurrentTheme(e);this.saveUserState(t)}},setThemeToggleStart:function(e){var t=this.readUserState();if(t){t.setThemeToggleStart(e);this.saveUserState(t)}},deleteThemeToggleStart:function(){var e=this.readUserState();if(e){e.clearThemeToggleStart();this.saveUserState(e)}},deleteKey:function(e){if(this._oLocalStorage&&e){this._oLocalStorage.removeItem(e)}},updateValue:function(e,t){if(this._oLocalStorage&&e&&t){this._oLocalStorage.setItem(e,t)}},_getValueForKey:function(e){if(this._oLocalStorage&&e){return this._oLocalStorage.getItem(e)}return null},getStringForKey:function(e){return this._getValueForKey(e)},getNumberForKey:function(e){var t=this._getValueForKey(e);if(t&&r.isStringValidNumber(t)){return parseInt(t)}return null}})});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/utils/UI5Utils", [],function(){"use strict";return{getAppLifeCycleService:function(){return sap.ushell.Container.getService("AppLifeCycle")},getCurrentApp:function(){return this.getAppLifeCycleService().getCurrentApplication()},getUserInfo:function(){return sap.ushell.Container.getService("UserInfo")},getAppConfig:function(){return sap.ui.getCore().getConfiguration()},getTheme:function(){return this.getAppConfig().getTheme()},getLanguage:function(){return this.getAppConfig().getLocale().getLanguage()}}});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/flpplugin/utils/Utils", ["./Constants","sap/ui/thirdparty/jquery"],function(t,e){"use strict";return{getTriggerButton:function(){return e("#surveyTriggerButton")},getLocalStorage:function(){return localStorage},hasValue:function(t){if(typeof t!=="undefined"&&t){return true}return false},getRandomInt:function(t,e){t=Math.ceil(t);e=Math.floor(e);return Math.floor(Math.random()*(e-t))+t},isSupportedAppType:function(t){if(t&&t.applicationType){var e=t.applicationType.toLowerCase();if(e==="ui5"||e==="wda"||e==="gui"||e==="tr"||e==="nwbc"){return true}}return false},convertAppFrameworkTypeToId:function(e){if(e){return t.E_APP_FRAMEWORK[e.toLowerCase()]||t.E_APP_FRAMEWORK["unknown"]}return t.E_APP_FRAMEWORK["unknown"]},isObject:function(t){if(typeof t==="object"||t instanceof Object){return true}return false},isString:function(t){if(t===""||typeof t==="string"||t instanceof String){return true}return false},stringIsEmpty:function(t){if(this.isString(t)){return t.length===0||!t.trim()}return false},stringToTitleCase:function(t){if(t){return t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})}return t},isHorizonTheme:function(e){if(e&&(e===t.E_THEME_NAME.horizon||e===t.E_THEME_NAME.horizon_evening||e===t.E_THEME_NAME.horizonHcw||e===t.E_THEME_NAME.horizonHcb)){return true}return false},_isLocalStorageAvailable:function(t){try{return"localStorage"in t&&t["localStorage"]!==null&&t["localStorage"]!==undefined}catch(t){return false}},isLocalStorageAvailable:function(){return this._isLocalStorageAvailable(window)},isStringValidNumber:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},isPositiveInteger:function(t){return/^\d+$/.test(t)},getCombinedKey:function(t,e){if(this.isString(t)&&!this.stringIsEmpty(t)&&this.isString(e)&&!this.stringIsEmpty(e)){return t.trim().toLowerCase()+"/"+e.trim().toLowerCase()}return null},isClientActionPushEvent:function(e){if(e===t.E_CLIENT_ACTION.backendPush||e===t.E_CLIENT_ACTION.inAppUserFeedback||e===t.E_CLIENT_ACTION.inAppPushFeedback||e===t.E_CLIENT_ACTION.dynamicPushFeedBack){return true}return false},readUserState:function(t){return t.readUserState()},isQualtricsSurveyPopupOpen:function(){var t=false;var e=document.getElementsByClassName("QSIPopOver");if(e&&e.length){t=true}return t}}});
/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/feedback/ui/library", ["sap/ui/core/library"],function(){"use strict";var e=sap.ui.getCore().initLibrary({name:"sap.feedback.ui",dependencies:["sap.ui.core"],interfaces:[],elements:[],noLibraryCSS:true,version:"1.108.0"});return e});
sap.ui.require.preload({
	"sap/feedback/ui/flpplugin/manifest.json":'{"_version":"1.7.0","sap.fiori":{"_version":"1.2.0","registrationIds":["F4413"],"archeType":"transactional"},"sap.app":{"id":"sap.feedback.ui.flpplugin","type":"component","applicationVersion":{"version":"1.108.0"},"i18n":"i18n/i18n.properties","ach":"CA-FLP-EXT-FX","title":"{{APP_TITLE}}","description":"{{APP_DESCRIPTION}}"},"sap.ui":{"technology":"UI5","deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"dependencies":{"minUI5Version":"1.84.0","libs":{"sap.ui.core":{},"sap.ushell":{},"sap.m":{}}},"contentDensities":{"compact":false,"cozy":false},"componentName":"sap.feedback.ui.flpplugin","services":{"ShellUIService":{"factoryName":"sap.ushell.ui5service.ShellUIService"}},"models":{"i18n":{"type":"sap.ui.model.resource.ResourceModel","settings":{"bundleName":"sap.feedback.ui.flpplugin.i18n.i18n"}}}},"sap.flp":{"type":"plugin","config":{}}}',
	"sap/feedback/ui/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.feedback.ui","type":"library","embeds":["flpplugin"],"applicationVersion":{"version":"1.108.0"},"title":"UI5 library: sap.feedback.ui","description":"UI5 library: sap.feedback.ui","resources":"resources.json","offline":true},"sap.ui":{"technology":"UI5","supportedThemes":[]},"sap.ui5":{"dependencies":{"minUI5Version":"1.108","libs":{"sap.ui.core":{"minVersion":"1.108.0"},"sap.ushell":{"minVersion":"1.108.1","lazy":true},"sap.m":{"minVersion":"1.108.0","lazy":true}}},"library":{"i18n":false,"css":false,"content":{"controls":[],"elements":[],"types":[],"interfaces":[]}}}}'
});
//# sourceMappingURL=library-preload.js.map
