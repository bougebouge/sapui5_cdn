/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.define(["./BaseTrigger","../../../utils/Utils","../../../utils/Constants"],function(t,e,r){"use strict";return t.extend("sap.feedback.ui.flpplugin.push.config.trigger.ThemeTimeSlotTrigger",{_sTargetingThemeId:null,_aTimeSlots:null,constructor:function(){return t.prototype.constructor.apply(this,arguments)},init:function(t,e,r,i,n){if(!Number.isInteger(t)){throw Error("Interval is not a valid number - "+t)}if(!Number.isInteger(e)){throw Error("Start Threshold is not a valid number - "+e)}if(!r){throw Error("Targeting Theme ID is missing - "+r)}if(!i||!Array.isArray(i)||i.length<1){throw Error("Time slots are invalid")}if(n&&typeof n!=="boolean"){throw Error("Force Push shall be either 'true' or 'false'")}this._iInterval=t;this._iMaxLimitCount=i.length;this._iThresholdCountStart=e;this._sTargetingThemeId=r;this._aTimeSlots=i;this._canForcePush=n?true:false},initFromJSON:function(t){var e=t.interval;var r=t.startThreshold;var i=t.targetingThemeId;var n=t.timeSlots;var s=t.forcePush;this.init(e,r,i,n,s)},getTargetingThemeId:function(){return this._sTargetingThemeId},getTimeSlots:function(){return this._aTimeSlots},getTimeSlotFor:function(t){if(t<=this._aTimeSlots.length){return this._aTimeSlots[t]}return null},isQualifiedForPush:function(e,r){var i=t.prototype.isQualifiedForPush.apply(this,arguments);var n=r.getCurrentTheme();if(i===true){if(this._isTargetingThemeMatching(n)){if(this._isTimeSlotReached(e,r)){return true}}}return false},_isTargetingThemeMatching:function(t){if(e.isString(t)){if(t.toLowerCase()===this._sTargetingThemeId.toLowerCase()||this._sTargetingThemeId.trim()==="*"){return true}}return false},_isTimeSlotReached:function(t,e){var r=t.getExecutedCount();var i=this.getTimeSlotFor(r);var n=e.getThemeToggleStart();if(i&&n){return this._hasDurationPassed(i,n)}return false},_hasDurationPassed:function(t,e){var i=new Date(e+t*r.E_TIME.minutesToMilliseconds).getTime();if(i&&i<Date.now()){return true}return false}})});
//# sourceMappingURL=ThemeTimeSlotTrigger.js.map