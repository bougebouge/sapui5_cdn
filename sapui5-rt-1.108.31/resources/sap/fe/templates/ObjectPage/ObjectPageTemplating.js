/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/CommonUtils","sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/helpers/BindingToolkit","sap/fe/core/templating/DataModelPathHelper","sap/fe/macros/CommonHelper","sap/fe/macros/field/FieldTemplating","sap/fe/macros/internal/form/FormTemplating","sap/m/library","sap/ui/base/ManagedObject","sap/ui/model/odata/v4/AnnotationHelper"],function(e,t,n,r,i,a,o,u,l,s){"use strict";var d={};var c=o.getLabelForConnectedFields;var v=a.formatValueRecursively;var f=a.addTextArrangementToBindingExpression;var g=r.enhanceDataModelPath;var p=n.resolveBindingString;var m=n.or;var b=n.isEmpty;var y=n.ifElse;var E=n.getExpressionFromAnnotation;var T=n.constant;var $=n.concat;var S=n.compileExpression;var h=n.and;var C=t.UI;var A=t.Entity;var D=t.Draft;function O(e){return P(e)||x(e)||F(e)||I()}function I(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function F(e,t){if(!e)return;if(typeof e==="string")return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor)n=e.constructor.name;if(n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(e,t)}function x(e){if(typeof Symbol!=="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function P(e){if(Array.isArray(e))return B(e)}function B(e,t){if(t==null||t>e.length)t=e.length;for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n]}return r}var V=u.ButtonType;var N=function(t,n,r,i){var a,o,u,l;var s=e.getTranslatedText("T_NEW_OBJECT",n.resourceBundle,undefined,n.entitySet);var d=e.getTranslatedText("T_ANNOTATION_HELPER_DEFAULT_OBJECT_PAGE_HEADER_TITLE",n.resourceBundle,undefined,n.entitySet);var D=(t===null||t===void 0?void 0:t.Title)===undefined||(t===null||t===void 0?void 0:t.Title)===""||(t===null||t===void 0?void 0:(a=t.Title)===null||a===void 0?void 0:a.Value)==="";var O=!D?e.getTranslatedText("T_ANNOTATION_HELPER_DEFAULT_OBJECT_PAGE_HEADER_TITLE_NO_HEADER_INFO",n.resourceBundle):"";var I,F,x=T(true),P;if((t===null||t===void 0?void 0:(o=t.Title)===null||o===void 0?void 0:o.$Type)==="com.sap.vocabularies.UI.v1.DataField"){var B,V,N,_,M,w,U,G,H,j,R;I=E(t===null||t===void 0?void 0:(B=t.Title)===null||B===void 0?void 0:B.Value);if(t!==null&&t!==void 0&&(V=t.Title)!==null&&V!==void 0&&(N=V.Value)!==null&&N!==void 0&&(_=N.$target)!==null&&_!==void 0&&(M=_.annotations)!==null&&M!==void 0&&(w=M.Common)!==null&&w!==void 0&&(U=w.Text)!==null&&U!==void 0&&(G=U.annotations)!==null&&G!==void 0&&(H=G.UI)!==null&&H!==void 0&&H.TextArrangement){I=f(I,r)}I=v(I,r);x=((j=I)===null||j===void 0?void 0:j._type)==="Constant"?T(!((R=I)!==null&&R!==void 0&&R.value)):b(I)}else if((t===null||t===void 0?void 0:(u=t.Title)===null||u===void 0?void 0:u.$Type)==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&(t===null||t===void 0?void 0:(l=t.Title)===null||l===void 0?void 0:l.Target.$target.$Type)==="com.sap.vocabularies.UI.v1.ConnectedFieldsType"){var L,Q;F=g(r,"$Type/@UI.HeaderInfo/Title/Target/$AnnotationPath");I=c(F,false);P=((L=I)===null||L===void 0?void 0:L._type)==="Constant"?T(!((Q=I)!==null&&Q!==void 0&&Q.value)):b(I);x=I?P:T(true)}var k=t!==null&&t!==void 0&&t.TypeName?$(d,": ",p(t.TypeName.toString())):s;var J=i?A.IsActive:true;return S(y(h(m(C.IsCreateModeSticky,C.IsCreateMode),x),k,y(h(J,x),O,I)))};d.getExpressionForTitle=N;var _=function(e,t){var n,r,i,a,o,u,l,s,d;var c=E(e===null||e===void 0?void 0:(n=e.Description)===null||n===void 0?void 0:n.Value);if(e!==null&&e!==void 0&&(r=e.Description)!==null&&r!==void 0&&(i=r.Value)!==null&&i!==void 0&&(a=i.$target)!==null&&a!==void 0&&(o=a.annotations)!==null&&o!==void 0&&(u=o.Common)!==null&&u!==void 0&&(l=u.Text)!==null&&l!==void 0&&(s=l.annotations)!==null&&s!==void 0&&(d=s.UI)!==null&&d!==void 0&&d.TextArrangement){c=f(c,t)}return S(v(c,t))};d.getExpressionForDescription=_;var M=function(t,n){var r;var i=e.getTranslatedText("T_OP_OBJECT_PAGE_SAVE",t.resourceBundle);var a=e.getTranslatedText("T_OP_OBJECT_PAGE_CREATE",t.resourceBundle);var o;if((r=n.startingEntitySet.annotations.Session)!==null&&r!==void 0&&r.StickySessionSupported){o=y(C.IsCreateModeSticky,a,i)}else{o=y(D.IsNewObject,a,i)}return S(o)};d.getExpressionForSaveButton=M;var w=function(e,t){var n=e.filter(function(e){return G(e)});var r;if(n.length){var i=n.map(function(e){return p(e.visible,"boolean")});r=m.apply(void 0,O(i));var a=U(t,true);return S(m(r,p(a,"boolean")))}return U(t,true)};d.getFooterVisible=w;var U=function(e,t){var n="";var r;var i=[];for(var a in e){var o=e[a];if(o.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"&&o.Determining===true){var u=o["@".concat("com.sap.vocabularies.UI.v1.Hidden")];if(!u){return true}else if(u.$Path){if(i.indexOf(u.$Path)===-1){i.push(u.$Path)}}}}if(i.length){for(var l=0;l<i.length;l++){if(i[l]){r="(%{"+i[l]+"} === true ? false : true )"}if(l==i.length-1){n=n+r}else{n=n+r+"||"}}return"{= "+(t?"(":"")+n+(t?" || ${ui>/isEditable}) ":" ")+"&& ${internal>isCreateDialogOpen} !== true}"}else{return"{= "+(t?"${ui>/isEditable} && ":"")+"${internal>isCreateDialogOpen} !== true}"}};d.getDataFieldBasedFooterVisibility=U;var G=function(e){var t=["Primary","DefaultApply","Secondary","ForAction","ForNavigation","SwitchToActiveObject","SwitchToDraftObject","DraftActions"];return t.indexOf(e.type)<0};d.isManifestAction=G;var H=function(e){if(!e){return V.Emphasized}var t;var n,r,i="";e.forEach(function(e){var a=e.Criticality;var o=e["@com.sap.vocabularies.UI.v1.Hidden"];if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"&&!n&&a){if(!t&&o===true){t=V.Emphasized;return}if(o&&o.$Path){r=o.$Path;if(i){i=i+" && "}i=i+"%{"+r+"} === true";t="{= ("+i+") ? 'Emphasized' : 'Default' }"}switch(a.$EnumMember){case"com.sap.vocabularies.UI.v1.CriticalityType/Negative":case"com.sap.vocabularies.UI.v1.CriticalityType/Positive":case"1":case 1:case"3":case 3:if(!o){t=V.Default;n=true}t=t||V.Default;break;default:t=V.Emphasized}if(a.$Path){var u=i?"!("+i+") && ":"";t="{= "+u+"((${"+a.$Path+"} === 'com.sap.vocabularies.UI.v1.CriticalityType/Negative') || (${"+a.$Path+"} === '1') || (${"+a.$Path+"} === 1) "+"|| (${"+a.$Path+"} === 'com.sap.vocabularies.UI.v1.CriticalityType/Positive') || (${"+a.$Path+"} === '3') || (${"+a.$Path+"} === 3)) ? "+"'Default'"+" : "+"'Emphasized'"+" }"}}});return t||V.Emphasized};d.buildEmphasizedButtonExpression=H;var j=function(e){var t=s.getNavigationPath(e);if(t){return"{path:'"+t+"'}"}else{return"{path: ''}"}};d.getElementBinding=j;var R=function(e){if(e["@com.sap.vocabularies.Common.v1.DraftRoot"]&&e["@com.sap.vocabularies.Common.v1.DraftRoot"]["EditAction"]){return true}else{return false}};d.checkDraftState=R;var L=function(e){if(R(e)){return"{= (%{DraftAdministrativeData/DraftIsCreatedByMe}) ? ( ${ui>/isEditable} && !${ui>createMode} && %{DraftAdministrativeData/DraftIsCreatedByMe} ) : false }"}else{return false}};d.getSwitchToActiveVisibility=L;var Q=function(e){if(R(e)){return"{= (%{DraftAdministrativeData/DraftIsCreatedByMe}) ? ( !(${ui>/isEditable}) && !${ui>createMode} && ${HasDraftEntity} && %{DraftAdministrativeData/DraftIsCreatedByMe} ) : false }"}else{return false}};d.getSwitchToDraftVisibility=Q;var k=function(e){if(R(e)){return"{= (%{DraftAdministrativeData/DraftIsCreatedByMe}) ? ( !${ui>createMode} && %{DraftAdministrativeData/DraftIsCreatedByMe} ) : false }"}else{return false}};d.getSwitchDraftAndActiveVisibility=k;var J=function(e,t){var n;if(e&&e.length){n=e.find(function(e){return e.type===t})}return n};d._findAction=J;var z=function(e){var t=J(e,"Secondary");return t?t.enabled:"true"};d.getDeleteCommandExecutionEnabled=z;var q=function(e){var t=J(e,"Secondary");return t?t.visible:"true"};d.getDeleteCommandExecutionVisible=q;var W=function(e){var t=J(e,"Primary");return t?t.visible:"true"};d.getEditCommandExecutionVisible=W;var K=function(e){var t=J(e,"Primary");return t?t.enabled:"true"};d.getEditCommandExecutionEnabled=K;var X=function(e){var t=e.getPath(),n=e.getObject("".concat(t,"@"));var r=n.hasOwnProperty("@com.sap.vocabularies.Common.v1.DraftRoot");var i=n.hasOwnProperty("@com.sap.vocabularies.Session.v1.StickySessionSupported");var a;if(r){a=e.getObject("".concat(t,"@com.sap.vocabularies.Common.v1.DraftRoot/EditAction"))}else if(i){a=e.getObject("".concat(t,"@com.sap.vocabularies.Session.v1.StickySessionSupported/EditAction"))}return!a?a:"".concat(t,"/").concat(a)};d.getEditAction=X;var Y=function(e,t){var n,r,i;if(e&&e["@Org.OData.Core.V1.Computed"]){n=e["@Org.OData.Core.V1.Computed"].Bool?e["@Org.OData.Core.V1.Computed"].Bool=="true":true}if(e&&e["@Org.OData.Core.V1.Immutable"]){r=e["@Org.OData.Core.V1.Immutable"].Bool?e["@Org.OData.Core.V1.Immutable"].Bool=="true":true}i=n||r;if(t){i=i||t=="com.sap.vocabularies.Common.v1.FieldControlType/ReadOnly"}if(i){return true}else{return false}};d.isReadOnlyFromStaticAnnotations=Y;var Z=function(e){var t;if(e){if(l.bindingParser(e)){t="%"+e+" === 1 "}}if(t){return"{= "+t+"? false : true }"}else{return undefined}};d.readOnlyExpressionFromDynamicAnnotations=Z;var ee=function(e,t,n){if(e){if(e["targetOutbound"]&&e["targetOutbound"]["outbound"]||e["targetOutbound"]&&e["targetOutbound"]["outbound"]&&e["targetSections"]){return".handlers.onDataPointTitlePressed($controller, ${$source>/},'"+JSON.stringify(t)+"','"+e["targetOutbound"]["outbound"]+"','"+n+"' )"}else if(e["targetSections"]){return".handlers.navigateToSubSection($controller, '"+JSON.stringify(e["targetSections"])+"')"}else{return undefined}}};d.getExpressionForMicroChartTitlePress=ee;var te=function(e){if(e&&(e["targetOutbound"]||e["targetOutbound"]&&e["targetSections"])){return"External"}else if(e&&e["targetSections"]){return"InPage"}else{return"None"}};d.getMicroChartTitleAsLink=te;var ne=function(e,t,n){var r=e[t],i=["Heroes","Decoration","Workers","LongRunners"];var a=n;if(r&&r.requestGroupId&&i.some(function(e){return e===r.requestGroupId})){a="$auto."+r.requestGroupId}return a};d.getGroupIdFromConfig=ne;var re=function(e,t){var n=ne(e,t);var r;if(n){r="{ path : '', parameters : { $$groupId : '"+n+"' } }"}return r};d.getBindingWithGroupIdFromConfig=re;var ie=function(e){return e&&e.length===1&&!!e[0].isValueMultilineText};d.doesFieldGroupContainOnlyOneMultiLineDataField=ie;var ae=function(e){return e.showBreadCrumbs&&e.fclEnabled!==undefined?"{fclhelper>/breadCrumbIsVisible}":e.showBreadCrumbs};d.getVisibleExpressionForBreadcrumbs=ae;var oe=function(e){var t="!${ui>createMode}";if(e.fclEnabled){t="${fclhelper>/showShareIcon} && "+t}return"{= "+t+" }"};d.getShareButtonVisibility=oe;var ue=function(e,t,n,r){var i=e?Y(e,n):true;var a=Z(n);if(!i&&!a){return true}var o=t?Y(t,r):true;var u=Z(r);if(!o&&!u){return true}if(i&&o&&!a&&!u){return false}if(a&&!u){return a}else if(!a&&u){return u}else{return le(n,r)}};d.getVisiblityOfHeaderInfo=ue;var le=function(e,t){return"{= %"+e+" === 1 ? ( %"+t+" === 1 ? false : true ) : true }"};d.combineTitleAndDescriptionExpression=le;var se=function(e){var t="${$view>/getBindingContext}",n="${$view>/#fe::ObjectPage/getHeaderTitle/getExpandedHeading/getItems/1/getText}",r="${$view>/#fe::ObjectPage/getHeaderTitle/getExpandedContent/0/getItems/0/getText}";var a={title:n,entitySetName:i.addSingleQuotes(e),description:r};return i.generateFunction(".editFlow.deleteDocument",t,i.objectToString(a))};d.getPressExpressionForDelete=se;var de=function(e,t,n){var r=i.addSingleQuotes(e&&e.Action),a=e&&e.InvocationGrouping&&e.InvocationGrouping["$EnumMember"],o=a==="com.sap.vocabularies.UI.v1.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated";var u={contexts:"${$view>/getBindingContext}",entitySetName:i.addSingleQuotes(t),invocationGrouping:i.addSingleQuotes(o),model:"${$source>/}.getModel()",label:i.addSingleQuotes(e&&e.Label,true),isNavigable:n&&n.isNavigable,defaultValuesExtensionFunction:n&&n.defaultValuesExtensionFunction?"'".concat(n.defaultValuesExtensionFunction,"'"):undefined};return i.generateFunction(".handlers.onCallAction","${$view>/}",r,i.objectToString(u))};d.getPressExpressionForEdit=de;var ce=function(e,t,n){var r=i.addSingleQuotes(e&&e.Action),a=e&&e.InvocationGrouping&&e.InvocationGrouping["$EnumMember"],o=a==="com.sap.vocabularies.UI.v1.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated";var u={contexts:"${$view>/#fe::ObjectPage/}.getBindingContext()",entitySetName:i.addSingleQuotes(t),invocationGrouping:i.addSingleQuotes(o),model:"${$source>/}.getModel()",label:i.addSingleQuotes(e&&e.Label,true),isNavigable:n&&n.isNavigable,defaultValuesExtensionFunction:n&&n.defaultValuesExtensionFunction?"'".concat(n.defaultValuesExtensionFunction,"'"):undefined};return i.generateFunction(".handlers.onCallAction","${$view>/}",r,i.objectToString(u))};d.getPressExpressionForFooterAnnotationAction=ce;var ve=function(e,t,n,r,a,o,u){var l=i.addSingleQuotes(e&&e.Action),s=e&&e.InvocationGrouping&&e.InvocationGrouping["$EnumMember"],d=s==="com.sap.vocabularies.UI.v1.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated";var c={contexts:"${$view>/#fe::ObjectPage/}.getBindingContext()",entitySetName:t?i.addSingleQuotes(t):"",invocationGrouping:i.addSingleQuotes(d),model:"${$source>/}.getModel()",label:i.addSingleQuotes(e===null||e===void 0?void 0:e.Label,true),isNavigable:n===null||n===void 0?void 0:n.isNavigable,defaultValuesExtensionFunction:n!==null&&n!==void 0&&n.defaultValuesExtensionFunction?"'".concat(n.defaultValuesExtensionFunction,"'"):undefined};var v={positiveActionVisible:r,positiveActionEnabled:a,editActionVisible:o,editActionEnabled:u};return i.generateFunction(".handlers.onPrimaryAction","$controller","${$view>/}","${$view>/getBindingContext}",l,i.objectToString(c),i.objectToString(v))};d.getPressExpressionForPrimaryAction=ve;var fe=function(e,t){if(t&&t.Facet&&t.Facet.targetAnnotationType==="DataPoint"){return re(e,t.Facet.targetAnnotationValue)}};d.getStashableHBoxBinding=fe;var ge=function(e,t){if(e){if(e["targetOutbound"]&&e["targetOutbound"]["outbound"]){return".handlers.onDataPointTitlePressed($controller, ${$source>}, "+JSON.stringify(t)+","+JSON.stringify(e["targetOutbound"]["outbound"])+")"}else if(e["targetSections"]){return".handlers.navigateToSubSection($controller, '"+JSON.stringify(e["targetSections"])+"')"}else{return undefined}}};d.getPressExpressionForLink=ge;var pe=function(e){var t;if((e===null||e===void 0?void 0:(t=e.targetObject)===null||t===void 0?void 0:t.$Type)==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){return undefined}return"Bare"};d.getHeaderFormHboxRenderType=pe;return d},false);
//# sourceMappingURL=ObjectPageTemplating.js.map