/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2021 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/ui/model/odata/v4/ODataMetaModel","sap/ui/core/util/XMLPreprocessor","sap/ui/core/XMLTemplateProcessor","sap/fe/macros/macroLibrary","sap/fe/core/TemplateModel","sap/fe/macros/ResourceModel"],function(e,t,n,i,s){"use strict";function o(o,r,a,c,u,f,d){var l="./test/",m={read:function(){return Promise.resolve(a)},mHeaders:{}},p=new e(m,l+"$metadata",undefined,null);i.deregister();if(u){i.register()}function b(e,n,i,o){var r={models:Object.assign({},o),bindingContexts:{}};Object.keys(i).forEach(function(t){var n=o[t]||p;if(!(n instanceof sap.ui.model.Model)&&!(n instanceof sap.ui.model.odata.v4.ODataMetaModel)){n=new s(n,p)}e.ok(typeof n.getObject(i[t])!=="undefined",t+": "+i[t]+" exists");r.bindingContexts[t]=n.createBindingContext(i[t]);r.models[t]=n});if(r.models["this"]){r.bindingContexts["this"]=r.models["this"].createBindingContext("/")}return Promise.resolve(t.process(n,{},r))}o.module("Smoke Tests for "+r);o.test("Check if metadata is available",function(e){return Promise.all([p.requestObject("/").then(function(t){e.ok(t,"Entity Container found")}),p.requestObject("/$").then(function(t){e.ok(t,"Metadata Document found")})])});var g;function h(e){e.fileType=e.fileType||"fragment";o.module("Tests for "+r+" against "+e.fileType+" "+e.sFragmentName+(e.sDescription?" ("+e.sDescription+")":""),{beforeEach:function(){if(f){g=d.stub(f,"getText").callsFake(function(e){if(e==="T_NEW_OBJECT"){return"New Object"}else{return"Unnamed Object"}})}},afterEach:function(){if(g){g.restore()}}});e.tests.forEach(function(t,i){o.test(t.description||"Test "+e.fileType+" scope: "+i,function(i){return p.requestObject("/$").then(function(){return n.loadTemplatePromise(e.sFragmentName,e.fileType)}).then(function(n){return b(i,n,t.mBindingContexts,Object.assign({},e.mModels,t.mModels))}).then(function(e){var n=[].filter.call(e.ownerDocument.querySelectorAll("*"),r),s,o=0;function r(e){return e.getAttribute("unittest:id")!==null}function a(e,t,n){function s(s){if(t[s]===undefined){i.ok(!e.hasAttribute(s),'unittest:id="'+n+"\": attribute '"+s+"' is expected not to be rendered")}else{var o=e.getAttribute(s);i.strictEqual(o,t[s],'unittest:id="'+n+"\": attribute '"+s+"' properly created as "+o)}}if(t){o++;Object.keys(t).forEach(s)}}n.forEach(c);function c(e){s=e.getAttribute("unittest:id");a(e,t.oExpectedResultsPerTest[s],s)}i.equal(o,Object.keys(t.oExpectedResultsPerTest).length,"All tests have been executed for this test case")}).catch(function(e){var n=t.sExpectedException;if(e&&n){i.strictEqual(e.message||e,n,"expected exception occurred: "+n)}else{throw e}})})})}c.forEach(h)}return{testFragments:o}});
//# sourceMappingURL=TemplatingTestUtils.js.map