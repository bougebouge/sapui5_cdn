/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/MassEditHelper","sap/fe/core/helpers/ModelHelper","sap/m/MessageBox","sap/ui/core/mvc/ControllerExtension","sap/ui/core/mvc/OverrideExecution","../CommonUtils"],function(e,t,o,n,r,i,a,s){"use strict";var c,l,p,u,g,E,d,f,_;var M=t.publicExtension;var C=t.privateExtension;var T=t.finalExtension;var S=t.extensible;var v=t.defineUI5Class;function A(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;D(e,t)}function D(e,t){D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,o){t.__proto__=o;return t};return D(e,t)}function x(e,t,o,n,r){var i={};Object.keys(n).forEach(function(e){i[e]=n[e]});i.enumerable=!!i.enumerable;i.configurable=!!i.configurable;if("value"in i||i.initializer){i.writable=true}i=o.slice().reverse().reduce(function(o,n){return n(e,t,o)||o},i);if(r&&i.initializer!==void 0){i.value=i.initializer?i.initializer.call(r):void 0;i.initializer=undefined}if(i.initializer===void 0){Object.defineProperty(e,t,i);i=null}return i}var O=(c=v("sap.fe.core.controllerextensions.MassEdit"),l=M(),p=T(),u=M(),g=T(),E=C(),d=S(a.After),c(f=(_=function(t){A(i,t);function i(){return t.apply(this,arguments)||this}var a=i.prototype;a.getMessageDetailForNonEditable=function e(t,o,n){var r=t.getText("C_MASS_EDIT_CONFIRM_MESSAGE_DETAIL_HEADER"),i=t.getText("C_MASS_EDIT_CONFIRM_MESSAGE_DETAIL_REASON",[n]),a=t.getText("C_MASS_EDIT_CONFIRM_MESSAGE_DETAIL_REASON_DRAFT",[o]),s=t.getText("C_MASS_EDIT_CONFIRM_MESSAGE_DETAIL_REASON_NON_EDITABLE",[o]);return"<p><strong>".concat(r,"</strong></p>\n")+(!!i&&"<p>".concat(i,"</p>\n")+"<ul>"+(!!a&&"<li>".concat(a,"</li>"))+(!!s&&"<li>".concat(s,"</li>"))+"</ul>")};a.getResourceText=function e(t,o){var n=t&&s.getTranslatedTextFromExpBindingString(t,o);return n&&n.toLocaleLowerCase()};a._openConfirmDialog=function t(o,i,a){var s=this;var c=(i||[]).length;var l=this.getView();return new Promise(function(t){l.getModel("sap.fe.i18n").getResourceBundle().then(function(p){var u=p.getText("C_MASS_EDIT_CONFIRM_BUTTON_TEXT"),g=p.getText("C_COMMON_OBJECT_PAGE_CANCEL"),E=a-c,d=o.data("entityType"),f=o.getModel().getMetaModel(),_=f.getObject("".concat(d,"@com.sap.vocabularies.UI.v1.HeaderInfo")),M=s.getResourceText(_.TypeName,l)||p.getText("C_MASS_EDIT_DIALOG_DEFAULT_TYPENAME"),C=s.getResourceText(_.TypeNamePlural,l)||p.getText("C_MASS_EDIT_DIALOG_DEFAULT_TYPENAME_PLURAL"),T=p.getText("C_MASS_EDIT_CONFIRM_MESSAGE",[E,a,c,C]),S=o.data("targetCollectionPath"),v=o.getModel().getMetaModel(),A=n.isDraftSupported(v,S),D=o.data("displayModePropertyBinding")==="true",x=A&&D&&s.getMessageDetailForNonEditable(p,M,C);r.warning(T,{details:x,actions:[u,g],emphasizedAction:u,contentWidth:"100px",onClose:function(o){var n=[];if(o===u){e.info("Mass Edit: Confirmed to edit ",c.toString()," selections.");n=i}else if(o===g){e.info("Mass Edit: Cancelled.")}t(n)}})}).catch(function(t){e.error(t)})})};a._confirmContexts=function e(t,o){var n=t.getBindingContext("internal"),r=+n.getProperty("numberOfSelectedContexts")||0;o=o||[];if(o.length&&o.length!==r){return this._openConfirmDialog(t,o,r)}return Promise.resolve(o)};a.openMassEditDialog=function t(n){var r=this.getView().getController(),i=this.fetchContextsForEdit(n);return i.then(this._confirmContexts.bind(this,n)).then(function(e){return e&&e.length>0?o.createDialog(n,e,r):Promise.resolve()}).then(function(e){if(e){n.addDependent(e);e.open()}}).catch(function(t){e.error("Mass Edit: Something went wrong in mass edit dialog creation.",t)})};a.fetchContextsForEdit=function e(t){var o=t.getBindingContext("internal"),n=o.getProperty("updatableContexts")||[];return Promise.resolve(n)};return i}(i),x(_.prototype,"getMessageDetailForNonEditable",[l,p],Object.getOwnPropertyDescriptor(_.prototype,"getMessageDetailForNonEditable"),_.prototype),x(_.prototype,"openMassEditDialog",[u,g],Object.getOwnPropertyDescriptor(_.prototype,"openMassEditDialog"),_.prototype),x(_.prototype,"fetchContextsForEdit",[E,d],Object.getOwnPropertyDescriptor(_.prototype,"fetchContextsForEdit"),_.prototype),_))||f);return O},false);
//# sourceMappingURL=MassEdit.js.map