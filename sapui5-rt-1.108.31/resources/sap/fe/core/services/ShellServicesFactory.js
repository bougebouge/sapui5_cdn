/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/ui/core/service/Service","sap/ui/core/service/ServiceFactory"],function(e,t,n){"use strict";function r(e,t){return c(e)||a(e,t)||s(e,t)||i()}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){if(!e)return;if(typeof e==="string")return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor)n=e.constructor.name;if(n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}function o(e,t){if(t==null||t>e.length)t=e.length;for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n]}return r}function a(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,s,o,a=[],c=!0,l=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=s.call(n)).done)&&(a.push(r.value),a.length!==t);c=!0){}}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return a}}function c(e){if(Array.isArray(e))return e}function l(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;u(e,t)}function u(e,t){u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,n){t.__proto__=n;return t};return u(e,t)}var h=function(e){l(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.init=function e(){this.initPromise=Promise.resolve(this);this.instanceType="mock"};n.getLinks=function e(){return Promise.resolve([])};n.getLinksWithCache=function e(){return Promise.resolve([])};n.toExternal=function e(){};n.getStartupAppState=function e(){return Promise.resolve(null)};n.backToPreviousApp=function e(){};n.hrefForExternal=function e(){return""};n.hrefForExternalAsync=function e(){return Promise.resolve({})};n.getAppState=function e(){return Promise.resolve({})};n.createEmptyAppState=function e(){return Promise.resolve({})};n.createEmptyAppStateAsync=function e(){return Promise.resolve({})};n.isNavigationSupported=function e(){return Promise.resolve({})};n.isInitialNavigation=function e(){return false};n.isInitialNavigationAsync=function e(){return Promise.resolve({})};n.expandCompactHash=function e(){return Promise.resolve({})};n.parseShellHash=function e(){return{}};n.splitHash=function e(){return Promise.resolve({})};n.constructShellHash=function e(){return""};n.setDirtyFlag=function e(){};n.registerDirtyStateProvider=function e(){};n.deregisterDirtyStateProvider=function e(){};n.createRenderer=function e(){return{}};n.getUser=function e(){return{}};n.hasUShell=function e(){return false};n.registerNavigationFilter=function e(){};n.unregisterNavigationFilter=function e(){};n.setBackNavigation=function e(){};n.setHierarchy=function e(){};n.setTitle=function e(){};n.getContentDensity=function e(){if(document.body.classList.contains("sapUiSizeCozy")){return"cozy"}else if(document.body.classList.contains("sapUiSizeCompact")){return"compact"}else{return""}};n.getPrimaryIntent=function e(){return Promise.resolve()};n.waitForPluginsLoad=function e(){return Promise.resolve(true)};return t}(t);function f(e){return new Promise(function(t,n){e.done(t).fail(n)})}var v=function(t){l(n,t);function n(){return t.apply(this,arguments)||this}var i=n.prototype;i.init=function e(){var t=this;var n=this.getContext();var i=n.scopeObject;this.oShellContainer=n.settings.shellContainer;this.instanceType="real";this.linksCache={};this.fnFindSemanticObjectsInCache=function(e){var t=e;var n=[];var r=[];for(var i=0;i<t.length;i++){if(!!t[i][0]&&!!t[i][0].semanticObject){if(this.linksCache[t[i][0].semanticObject]){n.push(this.linksCache[t[i][0].semanticObject].links);Object.defineProperty(e[i][0],"links",{value:this.linksCache[t[i][0].semanticObject].links})}else{r.push(t[i])}}}return{oldArgs:e,newArgs:r,cachedLinks:n}};this.initPromise=new Promise(function(e,n){t.resolveFn=e;t.rejectFn=n});var s=this.oShellContainer.getServiceAsync("CrossApplicationNavigation");var o=this.oShellContainer.getServiceAsync("URLParsing");var a=this.oShellContainer.getServiceAsync("ShellNavigation");var c=this.oShellContainer.getServiceAsync("PluginManager");var l=i.getService("ShellUIService");Promise.all([s,o,a,l,c]).then(function(e){var n=r(e,5),i=n[0],s=n[1],o=n[2],a=n[3],c=n[4];t.crossAppNavService=i;t.urlParsingService=s;t.shellNavigation=o;t.shellUIService=a;t.shellPluginManager=c;t.resolveFn()}).catch(this.rejectFn)};i.getLinks=function e(t){var n=this;return new Promise(function(e,r){n.crossAppNavService.getLinks(t).fail(function(e){r(new Error("".concat(e," sap.fe.core.services.ShellServicesFactory.getLinks")))}).then(e)})};i.getLinksWithCache=function e(t){var n=this;return new Promise(function(e,r){if(t.length===0){e([])}else{var i=n.fnFindSemanticObjectsInCache(t);if(i.newArgs.length===0){e(i.cachedLinks)}else{n.crossAppNavService.getLinks(i.newArgs).fail(function(e){r(new Error("".concat(e," sap.fe.core.services.ShellServicesFactory.getLinksWithCache")))}).then(function(t){if(t.length!==0){var r={};for(var s=0;s<t.length;s++){if(t[s].length>0&&i.newArgs[s][0].links===undefined){r[i.newArgs[s][0].semanticObject]={links:t[s]};n.linksCache=Object.assign(n.linksCache,r)}}}if(i.cachedLinks.length===0){e(t)}else{var o=[];var a=0;for(var c=0;c<i.oldArgs.length;c++){if(a<t.length){if(t[a].length>0&&i.oldArgs[c][0].semanticObject===i.newArgs[a][0].semanticObject){o.push(t[a]);a++}else{o.push(i.oldArgs[c][0].links)}}else{o.push(i.oldArgs[c][0].links)}}e(o)}})}}})};i.getShellContainer=function e(){return this.oShellContainer};i.toExternal=function e(t,n){this.crossAppNavService.toExternal(t,n)};i.getStartupAppState=function e(t){var n=this;return new Promise(function(e,r){n.crossAppNavService.getStartupAppState(t).fail(function(e){r(new Error("".concat(e," sap.fe.core.services.ShellServicesFactory.getStartupAppState")))}).then(e)})};i.backToPreviousApp=function e(){return this.crossAppNavService.backToPreviousApp()};i.hrefForExternal=function e(t,n,r){return this.crossAppNavService.hrefForExternal(t,n,!!r)};i.hrefForExternalAsync=function e(t,n){return this.crossAppNavService.hrefForExternalAsync(t,n)};i.getAppState=function e(t,n){return f(this.crossAppNavService.getAppState(t,n))};i.createEmptyAppState=function e(t){return this.crossAppNavService.createEmptyAppState(t)};i.createEmptyAppStateAsync=function e(t){return this.crossAppNavService.createEmptyAppStateAsync(t)};i.isNavigationSupported=function e(t,n){return f(this.crossAppNavService.isNavigationSupported(t,n))};i.isInitialNavigation=function e(){return this.crossAppNavService.isInitialNavigation()};i.isInitialNavigationAsync=function e(){return this.crossAppNavService.isInitialNavigationAsync()};i.expandCompactHash=function e(t){return this.crossAppNavService.expandCompactHash(t)};i.parseShellHash=function e(t){return this.urlParsingService.parseShellHash(t)};i.splitHash=function e(t){return this.urlParsingService.splitHash(t)};i.constructShellHash=function e(t){return this.urlParsingService.constructShellHash(t)};i.setDirtyFlag=function e(t){this.oShellContainer.setDirtyFlag(t)};i.registerDirtyStateProvider=function e(t){this.oShellContainer.registerDirtyStateProvider(t)};i.deregisterDirtyStateProvider=function e(t){this.oShellContainer.deregisterDirtyStateProvider(t)};i.createRenderer=function e(){return this.oShellContainer.createRenderer()};i.getUser=function e(){return this.oShellContainer.getUser()};i.hasUShell=function e(){return true};i.registerNavigationFilter=function e(t){this.shellNavigation.registerNavigationFilter(t)};i.unregisterNavigationFilter=function e(t){this.shellNavigation.unregisterNavigationFilter(t)};i.setBackNavigation=function e(t){this.shellUIService.setBackNavigation(t)};i.setHierarchy=function e(t){this.shellUIService.setHierarchy(t)};i.setTitle=function e(t){this.shellUIService.setTitle(t)};i.getContentDensity=function e(){return this.oShellContainer.getUser().getContentDensity()};i.getPrimaryIntent=function e(t,n){var r=this;return new Promise(function(e,i){r.crossAppNavService.getPrimaryIntent(t,n).fail(function(e){i(new Error("".concat(e," sap.fe.core.services.ShellServicesFactory.getPrimaryIntent")))}).then(e)})};i.waitForPluginsLoad=function t(){var n=this;return new Promise(function(t){var r;if(!((r=n.shellPluginManager)!==null&&r!==void 0&&r.getPluginLoadingPromise)){t(false)}else{n.shellPluginManager.getPluginLoadingPromise("RendererExtensions").fail(function(n){e.error(n,"sap.fe.core.services.ShellServicesFactory.waitForPluginsLoad");t(false)}).then(function(){return t(true)})}})};return n}(t);var p=function(e){l(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.createInstance=function e(t){t.settings.shellContainer=sap.ushell&&sap.ushell.Container;var n=t.settings.shellContainer?new v(t):new h(t);return n.initPromise.then(function(){t.scopeObject.getShellServices=function(){return n};return n})};return t}(n);return p},false);
//# sourceMappingURL=ShellServicesFactory.js.map