/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/base/util/deepClone","sap/base/util/deepEqual","sap/base/util/isPlainObject","sap/fe/core/CommonUtils","sap/fe/core/helpers/KeepAliveHelper","sap/fe/core/helpers/ToES6Promise","sap/fe/core/templating/SemanticObjectHelper","sap/fe/macros/field/FieldHelper","sap/fe/macros/field/FieldRuntime","sap/fe/navigation/SelectionVariant","sap/ui/core/Core","sap/ui/core/Fragment","sap/ui/core/util/XMLPreprocessor","sap/ui/core/XMLTemplateProcessor","sap/ui/mdc/link/Factory","sap/ui/mdc/link/LinkItem","sap/ui/mdc/link/SemanticObjectMapping","sap/ui/mdc/link/SemanticObjectMappingItem","sap/ui/mdc/link/SemanticObjectUnavailableAction","sap/ui/mdc/LinkDelegate","sap/ui/model/json/JSONModel"],function(e,t,n,i,a,r,c,o,s,l,u,m,f,d,v,p,h,g,b,O,j,y){"use strict";var S=o.getDynamicPathFromSemanticObject;function k(e,t){try{var n=e()}catch(e){return t(e)}if(n&&n.then){return n.then(void 0,t)}return n}function _(e,t,n){if(!e.s){if(n instanceof P){if(n.s){if(t&1){t=n.s}n=n.v}else{n.o=_.bind(null,e,t);return}}if(n&&n.then){n.then(_.bind(null,e,t),_.bind(null,e,2));return}e.s=t;e.v=n;var i=e.o;if(i){i(e)}}}var P=function(){function e(){}e.prototype.then=function(t,n){var i=new e;var a=this.s;if(a){var r=a&1?t:n;if(r){try{_(i,1,r(this.v))}catch(e){_(i,2,e)}return i}else{return this}}this.o=function(e){try{var a=e.v;if(e.s&1){_(i,1,t?t(a):a)}else if(n){_(i,1,n(a))}else{_(i,2,a)}}catch(e){_(i,2,e)}};return i};return e}();function M(e){return e instanceof P&&e.s&1}function L(e,t,n){var i=-1,a,r;function c(o){try{while(++i<e.length&&(!n||!n())){o=t(i);if(o&&o.then){if(M(o)){o=o.v}else{o.then(c,r||(r=_.bind(null,a=new P,2)));return}}}if(a){_(a,1,o)}else{a=o}}catch(e){_(a||(a=new P),2,e)}}c();return a}function C(e,t,n){var i=[];for(var a in e){i.push(a)}return L(i,function(e){return t(i[e])},n)}var A=Object.assign({},j);var x={iLinksShownInPopup:3,sapmLink:"sap.m.Link",sapuimdcLink:"sap.ui.mdc.Link",sapuimdclinkLinkItem:"sap.ui.mdc.link.LinkItem",sapmObjectIdentifier:"sap.m.ObjectIdentifier",sapmObjectStatus:"sap.m.ObjectStatus"};A.getConstants=function(){return x};A._getEntityType=function(e,t){if(t){return t.createBindingContext(e.entityType)}else{return undefined}};A._getSemanticsModel=function(e,t){if(t){return new y(e)}else{return undefined}};A._getDataField=function(e,t){return t.createBindingContext(e.dataField)};A._getContact=function(e,t){return t.createBindingContext(e.contact)};A.fnTemplateFragment=function(){var e=this;var t,n;var i={};var a;if(this.resolvedpayload){a=this.resolvedpayload}else{a=this.payload}if(a&&!a.LinkId){a.LinkId=this.oControl&&this.oControl.isA(x.sapuimdcLink)?this.oControl.getId():undefined}if(a.LinkId){n=this.oControl.getModel("$sapuimdcLink").getProperty("/titleLinkHref");a.titlelink=n}var r=this._getSemanticsModel(a,this.oMetaModel);this.semanticModel=r;if(a.entityType&&this._getEntityType(a,this.oMetaModel)){t="sap.fe.macros.field.QuickViewLinkForEntity";i.bindingContexts={entityType:this._getEntityType(a,this.oMetaModel),semantic:r.createBindingContext("/")};i.models={entityType:this.oMetaModel,semantic:r}}else if(a.dataField&&this._getDataField(a,this.oMetaModel)){t="sap.fe.macros.field.QuickViewLinkForDataField";i.bindingContexts={dataField:this._getDataField(a,this.oMetaModel),semantic:r.createBindingContext("/")};i.models={dataField:this.oMetaModel,semantic:r}}else if(a.contact&&this._getContact(a,this.oMetaModel)){t="sap.fe.macros.field.QuickViewLinkForContact";i.bindingContexts={contact:this._getContact(a,this.oMetaModel)};i.models={contact:this.oMetaModel}}i.models.entitySet=this.oMetaModel;i.models.metaModel=this.oMetaModel;if(this.oControl&&this.oControl.getModel("viewData")){i.models.viewData=this.oControl.getModel("viewData");i.bindingContexts.viewData=this.oControl.getModel("viewData").createBindingContext("/")}var c=v.loadTemplate(t,"fragment");return Promise.resolve(d.process(c,{name:t},i)).then(function(t){return f.load({definition:t,controller:e})}).then(function(t){if(t){if(i.models&&i.models.semantic){t.setModel(i.models.semantic,"semantic");t.setBindingContext(i.bindingContexts.semantic,"semantic")}if(i.bindingContexts&&i.bindingContexts.entityType){t.setModel(i.models.entityType,"entityType");t.setBindingContext(i.bindingContexts.entityType,"entityType")}}e.resolvedpayload=undefined;return t})};A.fetchAdditionalContent=function(e,t){var n;this.oControl=t;var i=e===null||e===void 0?void 0:(n=e.navigationPath)===null||n===void 0?void 0:n.match(/{(.*?)}/);var a=i&&i.length>1&&i[1]?t.getModel().bindContext(i[1],t.getBindingContext(),{$$ownRequest:true}):null;this.payload=e;if(t&&t.isA(x.sapuimdcLink)){this.oMetaModel=t.getModel().getMetaModel();return this.fnTemplateFragment().then(function(e){if(a){e.setBindingContext(a.getBoundContext())}return[e]})}return Promise.resolve([])};A._fetchLinkCustomData=function(e){if(e.getParent()&&e.isA(x.sapuimdcLink)&&(e.getParent().isA(x.sapmLink)||e.getParent().isA(x.sapmObjectIdentifier)||e.getParent().isA(x.sapmObjectStatus))){return e.getCustomData()}else{return undefined}};A.fetchLinkItems=function(e,t,n){if(t&&A._getSemanticObjects(e)){var i=t.getObject();if(n){n.initialize(A._getSemanticObjects(e))}var a=this._link&&this._fetchLinkCustomData(this._link);this.aLinkCustomData=a&&this._fetchLinkCustomData(this._link).map(function(e){return e.mProperties.value});var r=A._calculateSemanticAttributes(i,e,n,this._link);var c=r.results;var o=r.payload;return A._retrieveNavigationTargets("",c,o,n,this._link).then(function(e){return e.length===0?null:e})}else{return Promise.resolve(null)}};A._findLinkType=function(e,t){var n,i;if((t===null||t===void 0?void 0:t.length)===1){i=new h({text:t[0].getText(),href:t[0].getHref()});n=e.hasQuickViewFacets==="false"?1:2}else if(e.hasQuickViewFacets==="false"&&(t===null||t===void 0?void 0:t.length)===0){n=0}else{n=2}return{linkType:n,linkItem:i}};A.fetchLinkType=function(t,n){try{var i=false;var a=this;var r=n;var c=Object.assign({},t);var o={initialType:{type:2,directLink:undefined},runtimeType:undefined};if(!a.appStateKeyMap){a.appStateKeyMap={}}return Promise.resolve(k(function(){function e(e){if(i)return e;throw new Error("no payload or semanticObjects found")}var t=function(){var e;if(c!==null&&c!==void 0&&c.semanticObjects){a._link=n;return Promise.resolve(r._retrieveUnmodifiedLinkItems()).then(function(e){function t(){var t=A._findLinkType(c,e);var n={initialType:{type:t.linkType,directLink:t.linkItem?t.linkItem:undefined},runtimeType:undefined};i=true;return n}var n=function(){if(e.length===1){return Promise.resolve(r.retrieveLinkItems()).then(function(t){e=t})}}();return n&&n.then?n.then(t):t(n)})}else if((c===null||c===void 0?void 0:(e=c.contact)===null||e===void 0?void 0:e.length)>0){i=true;return o}else if(c!==null&&c!==void 0&&c.entityType&&c!==null&&c!==void 0&&c.navigationPath){i=true;return o}}();return t&&t.then?t.then(e):e(t)},function(t){e.error("Error in SimpleLinkDelegate.fetchLinkType: ",t)}))}catch(e){return Promise.reject(e)}};A._RemoveTitleLinkFromTargets=function(e,t,n){var i,a;var r=false;if(t&&n&&n[0]){var c,o;var s=n[0].intent.split("?")[0];if(e&&e[0]){o="#".concat(e[0].getProperty("key"));c=s===o;if(c){i=e[0].getProperty("href");this.payload.titlelinkhref=i;if(e[0].isA(x.sapuimdclinkLinkItem)){a=e[0].getParent();a.getModel("$sapuimdcLink").setProperty("/titleLinkHref",i);var l=a.getModel("$sapuimdcLink").getProperty("/linkItems").filter(function(e){if("#".concat(e.key)!==o){return e}});if(l&&l.length>0){a.getModel("$sapuimdcLink").setProperty("/linkItems/",l)}r=true}}}}return r};A._IsSemanticObjectDynamic=function(e,t){if(e&&t.aLinkCustomData){return t.aLinkCustomData.filter(function(t){return e.filter(function(e){return e!==t}).length>0}).length>0}else{return false}};A._getLineContext=function(e,t){if(!t){if(e.getAggregation("content")[0]&&e.getAggregation("content")[0].getBindingContext()){return e.getAggregation("content")[0].getBindingContext()}}return t};A._setFilterContextUrlForSelectionVariant=function(e,t,n){if(e.getViewData().entitySet&&t){var i=n.constructContextUrl(e.getViewData().entitySet,e.getModel());t.setFilterContextUrl(i)}return t};A._setObjectMappings=function(e,t,n,i){var a=false;var r=new u(i.toJSONObject());n.forEach(function(n){var i=n.semanticObject;var c=S(n.semanticObject);if(c&&t[c]){i=t[c]}if(e===i){var o=n.items;for(var s in o){var l=o[s].key;var u=o[s].value;if(l!==u){if(t[l]){r.removeParameter(u);r.removeSelectOption(u);r.renameParameter(l,u);r.renameSelectOption(l,u);t[u]=t[l];delete t[l];a=true}else if(l.split("/").length>1){var m=l.split("/").slice(-1)[0];if(!t[m]){delete t[m];r.removeParameter(m);r.removeSelectOption(m)}else if(m!==u){r.renameParameter(m,u);r.renameSelectOption(m,u);t[u]=t[m];delete t[m]}}else{delete t[l];r.removeParameter(u);r.removeSelectOption(u)}}}}});return{params:t,hasChanged:a,selectionVariant:r}};A._getAppStateKeyAndUrlParameters=function(e,t,i,a){try{var r;var o=[];if(n(i,(r=e.appStateKeyMap[""])===null||r===void 0?void 0:r.selectionVariant)){var s=e.appStateKeyMap[""];return Promise.resolve([s.semanticAttributes,s.appstatekey])}var l=function(){if(e.appStateKeyMap["".concat(a)]===undefined||!n(e.appStateKeyMap["".concat(a)].selectionVariant,i)){return Promise.resolve(c(t.getAppStateKeyAndUrlParameters(i.toJSONString()))).then(function(t){o=t;e.appStateKeyMap["".concat(a)]={semanticAttributes:o[0],appstatekey:o[1],selectionVariant:i}})}else{var r=e.appStateKeyMap["".concat(a)];o=[r.semanticAttributes,r.appstatekey]}}();return Promise.resolve(l&&l.then?l.then(function(){return o}):o)}catch(e){return Promise.reject(e)}};A._getLinkItemWithNewParameter=function(e,t,n,i,a,r,c,o,s,l){try{return Promise.resolve(a.expandCompactHash(i.getHref()).then(function(u){try{function b(){var c={target:{semanticObject:m.semanticObject,action:m.action},params:v,appStateKey:o};delete c.params["sap-xapp-state"];i.setHref("#".concat(a.constructShellHash(c)));r.aSemanticLinks.push(i.getHref());return A._RemoveTitleLinkFromTargets.bind(e)([i],t,n)}var m=a.parseShellHash(u);var f=Object.assign({},c);var d=A._setObjectMappings(m.semanticObject,f,r.semanticObjectMappings,s),v=d.params,p=d.hasChanged,h=d.selectionVariant;var g=function(){if(p){return Promise.resolve(A._getAppStateKeyAndUrlParameters(e,l,h,m.semanticObject)).then(function(e){o=e[1]})}}();return Promise.resolve(g&&g.then?g.then(b):b(g))}catch(O){return Promise.reject(O)}}))}catch(e){return Promise.reject(e)}};A._removeEmptyLinkItem=function(e){return e.filter(function(e){return e!==undefined})};A.modifyLinkItems=function(t,n,i){try{var r=this;return Promise.resolve(s.checkPrimaryActions(t,true)).then(function(c){var o=c;var s=o.titleLink;var l=o.hasTitleLink;if(i.length!==0){r.payload=t;var m=i[0].getParent();var f=a.getTargetView(m);var d=a.getAppComponent(f);var v=d.getShellServices();if(!v.hasUShell()){e.error("QuickViewDelegate: Cannot retrieve the shell services");return Promise.reject()}var p=f.getModel().getMetaModel();var h=m.getBindingContext();var g={semanticObject:t.mainSemanticObject,action:""};return k(function(){function e(){var e=d.getNavigationService();var n=f.getController();var a;var c;h=A._getLineContext(f,h);var o=p.getMetaPath(h.getPath());c=n._intentBasedNavigation.removeSensitiveData(h.getObject(),o);c=n._intentBasedNavigation.prepareContextForExternalNavigation(c,h);a=e.mixAttributesAndSelectionVariant(c.semanticAttributes,new u);g.propertiesWithoutConflict=c.propertiesWithoutConflict;n.intentBasedNavigation.adaptNavigationContext(a,g);A._removeTechnicalParameters(a);a=A._setFilterContextUrlForSelectionVariant(f,a,e);return Promise.resolve(A._getAppStateKeyAndUrlParameters(r,e,a,"")).then(function(n){function c(){return A._removeEmptyLinkItem(i)}var o=n[0];var u=n[1];var m;t.aSemanticLinks=[];i=A._removeEmptyLinkItem(i);var f=C(i,function(n){return Promise.resolve(A._getLinkItemWithNewParameter(r,l,s,i[n],v,t,o,u,a,e)).then(function(e){m=e;if(m===true){i[n]=undefined}})});return f&&f.then?f.then(c):c(f)})}var a=m&&r._fetchLinkCustomData(m).map(function(e){return e.mProperties.value});var c=function(){if(A._IsSemanticObjectDynamic(a,r)){var e=A._calculateSemanticAttributes(n.getObject(),t,undefined,r._link);var c=e.results;var o=e.payload;return Promise.resolve(A._retrieveNavigationTargets("",c,o,undefined,r._link)).then(function(e){i=e})}}();return c&&c.then?c.then(e):e(c)},function(t){e.error("Error while getting the navigation service",t);return undefined})}else{return i}})}catch(e){return Promise.reject(e)}};A.beforeNavigationCallback=function(e,t){var n=t.getSource(),i=t.getParameter("href"),a=p.getService("URLParsing"),c=i&&a.parseShellHash(i);r.storeControlRefreshStrategyForHash(n,c);return Promise.resolve(true)};A._removeTechnicalParameters=function(e){e.removeSelectOption("@odata.context");e.removeSelectOption("@odata.metadataEtag");e.removeSelectOption("SAP__Messages")};A._getSemanticObjectCustomDataValue=function(e,t){var n,i;for(var a=0;a<e.length;a++){n=e[a].getKey();i=e[a].getValue();t[n]={value:i}}};A._isDynamicPath=function(e){if(e&&e.indexOf("{")===0&&e.indexOf("}")===e.length-1){return true}else{return false}};A._updatePayloadWithResolvedSemanticObjectValue=function(e,t,n){var i;if(A._isDynamicPath(e.mainSemanticObject)){if(n){t.mainSemanticObject=n}else{t.mainSemanticObject=undefined}}switch(typeof n){case"string":(i=t.semanticObjectsResolved)===null||i===void 0?void 0:i.push(n);t.semanticObjects.push(n);break;case"object":for(var a in n){var r;(r=t.semanticObjectsResolved)===null||r===void 0?void 0:r.push(n[a]);t.semanticObjects.push(n[a])}break;default:}};A._createNewPayloadWithDynamicSemanticObjectsResolved=function(e,t,n){var i,a;for(var r in e.semanticObjects){i=e.semanticObjects[r];if(A._isDynamicPath(i)){a=i.substr(1,i.indexOf("}")-1);i=t[a].value;A._updatePayloadWithResolvedSemanticObjectValue(e,n,i)}else{n.semanticObjects.push(i)}}};A._updateSemanticObjectsForMappings=function(e,t,n){t.semanticObjectMappings.forEach(function(t){if(t.semanticObject&&A._isDynamicPath(t.semanticObject)){t.semanticObject=n.semanticObjects[e.semanticObjects.indexOf(t.semanticObject)]}})};A._updateSemanticObjectsUnavailableActions=function(e,t,n){var i;t.forEach(function(t){if(t!==null&&t!==void 0&&t.semanticObject&&A._isDynamicPath(t.semanticObject)){i=e.semanticObjects.findIndex(function(e){return e===t.semanticObject});if(i!==undefined){t.semanticObject=n.semanticObjects[i]}}})};A._updateSemanticObjectsWithResolvedValue=function(e,t){for(var n=0;n<e.semanticObjects.length;n++){if(t.mainSemanticObject===(e.semanticObjectsResolved&&e.semanticObjectsResolved[n])){t.mainSemanticObject=e.semanticObjects[n]}if(t.semanticObjects[n]){t.semanticObjects[n]=e.semanticObjects[n]}else{t.semanticObjects.splice(n,1)}}};A._removeEmptySemanticObjectsMappings=function(e){for(var t=0;t<e.semanticObjectMappings.length;t++){if(e.semanticObjectMappings[t]&&e.semanticObjectMappings[t].semanticObject===undefined){e.semanticObjectMappings.splice(t,1)}}};A._setPayloadWithDynamicSemanticObjectsResolved=function(e,n){var i;if(n.semanticObjectsResolved&&n.semanticObjectsResolved.length>0){i={entityType:e.entityType,dataField:e.dataField,contact:e.contact,mainSemanticObject:e.mainSemanticObject,navigationPath:e.navigationPath,propertyPathLabel:e.propertyPathLabel,semanticObjectMappings:t(e.semanticObjectMappings),semanticObjects:n.semanticObjects};A._updateSemanticObjectsForMappings(e,i,n);var a=t(e.semanticObjectUnavailableActions);A._updateSemanticObjectsUnavailableActions(e,a,i);i.semanticObjectUnavailableActions=a;if(n.mainSemanticObject){i.mainSemanticObject=n.mainSemanticObject}else{i.mainSemanticObject=undefined}A._updateSemanticObjectsWithResolvedValue(n,i);A._removeEmptySemanticObjectsMappings(i);return i}else{return{}}};A._getPayloadWithDynamicSemanticObjectsResolved=function(e,t){var n;var i={};var a={semanticObjects:[],semanticObjectsResolved:[],semanticObjectMappings:[]};if(e.semanticObjects){if(t&&t.length>0){A._getSemanticObjectCustomDataValue(t,i);A._createNewPayloadWithDynamicSemanticObjectsResolved(e,i,a);n=A._setPayloadWithDynamicSemanticObjectsResolved(e,a);return n}}else{return undefined}};A._updatePayloadWithSemanticAttributes=function(t,n,a,r,c){t.forEach(function(t){if(n){n.addContextObject(t,a)}r[t]={};for(var o in a){var s=null,l=null;if(n){s=n.getSemanticObjectAttribute(t,o);if(!s){s=n.createAttributeStructure();n.addSemanticObjectAttribute(t,o,s)}}if(a[o]===undefined||a[o]===null){if(s){s.transformations.push({value:undefined,description:"ℹ Undefined and null values have been removed in SimpleLinkDelegate."})}continue}if(i(a[o])){if(c&&c[t]){var u=Object.keys(c[t]);var m=void 0,f=void 0,d=void 0,v=void 0;for(var p=0;p<u.length;p++){v=u[p];if(v.indexOf(o)===0){m=c[t][v];f=v.split("/")[v.split("/").length-1];d=a[o][f];if(m&&f&&d){r[t][m]=d}}}}if(s){s.transformations.push({value:undefined,description:"ℹ Plain objects has been removed in SimpleLinkDelegate."})}continue}var h=c&&c[t]&&c[t][o]?c[t][o]:o;if(s&&o!==h){l={value:undefined,description:"ℹ The attribute ".concat(o," has been renamed to ").concat(h," in SimpleLinkDelegate."),reason:"🔴 A com.sap.vocabularies.Common.v1.SemanticObjectMapping annotation is defined for semantic object ".concat(t," with source attribute ").concat(o," and target attribute ").concat(h,". You can modify the annotation if the mapping result is not what you expected.")}}if(r[t][h]){e.error("SimpleLinkDelegate: The attribute ".concat(o," can not be renamed to the attribute ").concat(h," due to a clash situation. This can lead to wrong navigation later on."))}r[t][h]=a[o];if(s){if(l){s.transformations.push(l);var g=n.createAttributeStructure();g.transformations.push({value:a[o],description:"ℹ The attribute ".concat(h," with the value ").concat(a[o]," has been added due to a mapping rule regarding the attribute ").concat(o," in SimpleLinkDelegate.")});n.addSemanticObjectAttribute(t,h,g)}}}})};A._calculateSemanticAttributes=function(e,t,n,i){var a=i&&this._fetchLinkCustomData(i);var r=A._getPayloadWithDynamicSemanticObjectsResolved(t,a);var c=r?r:t;this.resolvedpayload=r;var o=A._getSemanticObjects(c);var s=A._convertSemanticObjectMapping(A._getSemanticObjectMappings(c));if(!o.length){o.push("")}var l={};A._updatePayloadWithSemanticAttributes(o,n,e,l,s);return{payload:c,results:l}};A._retrieveNavigationTargets=function(t,n,i,r,c){var o=this;if(!i.semanticObjects){return Promise.resolve([])}var s=i.semanticObjects;var u={ownNavigation:undefined,availableActions:[]};var f=0;return m.loadLibrary("sap.ui.fl",{async:true}).then(function(){return new Promise(function(m){sap.ui.require(["sap/ui/fl/Utils"],function(d){try{var v=d.getAppComponentForControl(c===undefined?o.oControl:c);var p=v?v.getShellServices():null;if(!p){m(u.availableActions,u.ownNavigation)}if(!p.hasUShell()){e.error("SimpleLinkDelegate: Service 'CrossApplicationNavigation' or 'URLParsing' could not be obtained");m(u.availableActions,u.ownNavigation)}var g=s.map(function(e){return[{semanticObject:e,params:n?n[e]:undefined,appStateKey:t,sortResultsBy:"text"}]});var b=k(function(){return Promise.resolve(p.getLinks(g)).then(function(e){var t=false;for(var n=0;n<e.length;n++){for(var c=0;c<e[n].length;c++){if(e[n][c].length>0){t=true;break}if(t){break}}}if(!e||!e.length||!t){m(u.availableActions,u.ownNavigation)}var d=A._getSemanticObjectUnavailableActions(i);var v=A._convertSemanticObjectUnavailableAction(d);var g=l._fnFixHashQueryString(a.getHash());if(g){g+="?"}var b=function(e,t){return!!v&&!!v[e]&&v[e].indexOf(t)>-1};var O=function(e){var t=p.parseShellHash(e.intent);if(b(t.semanticObject,t.action)){return}var n="#".concat(p.constructShellHash({target:{shellHash:e.intent}}));if(e.intent&&e.intent.indexOf(g)===0){u.ownNavigation=new h({href:n,text:e.text});return}var i=new h({key:t.semanticObject&&t.action?"".concat(t.semanticObject,"-").concat(t.action):undefined,text:e.text,description:undefined,href:n,icon:undefined,initiallyVisible:e.tags&&e.tags.indexOf("superiorAction")>-1});if(i.getProperty("initiallyVisible")){f++}u.availableActions.push(i);if(r){r.addSemanticObjectIntent(t.semanticObject,{intent:i.getHref(),text:i.getText()})}};for(var j=0;j<s.length;j++){e[j][0].forEach(O)}if(f===0){for(var y=0;y<u.availableActions.length;y++){if(y<o.getConstants().iLinksShownInPopup){u.availableActions[y].setProperty("initiallyVisible",true)}else{break}}}m(u.availableActions,u.ownNavigation)})},function(){e.error("SimpleLinkDelegate: '_retrieveNavigationTargets' failed executing getLinks method");m(u.availableActions,u.ownNavigation)});return Promise.resolve(b&&b.then?b.then(function(){}):void 0)}catch(e){return Promise.reject(e)}})})})};A._getSemanticObjects=function(e){return e.semanticObjects?e.semanticObjects:[]};A._getSemanticObjectUnavailableActions=function(e){var t=[];if(e.semanticObjectUnavailableActions){e.semanticObjectUnavailableActions.forEach(function(e){t.push(new O({semanticObject:e.semanticObject,actions:e.actions}))})}return t};A._getSemanticObjectMappings=function(e){var t=[];var n=[];if(e.semanticObjectMappings){e.semanticObjectMappings.forEach(function(e){n=[];if(e.items){e.items.forEach(function(e){n.push(new b({key:e.key,value:e.value}))})}t.push(new g({semanticObject:e.semanticObject,items:n}))})}return t};A._convertSemanticObjectMapping=function(e){if(!e.length){return undefined}var t={};e.forEach(function(e){if(!e.getSemanticObject()){throw Error("SimpleLinkDelegate: 'semanticObject' property with value '".concat(e.getSemanticObject(),"' is not valid"))}t[e.getSemanticObject()]=e.getItems().reduce(function(e,t){e[t.getKey()]=t.getValue();return e},{})});return t};A._convertSemanticObjectUnavailableAction=function(e){var t;var n;var i=[];if(!e.length){return undefined}var a={};e.forEach(function(e){t=e.getSemanticObject();if(!t){throw Error("SimpleLinkDelegate: 'semanticObject' property with value '".concat(t,"' is not valid"))}i=e.getActions();if(a[t]===undefined){a[t]=i}else{n=a[t];i.forEach(function(e){n.push(e)});a[t]=n}});return a};return A},false);
//# sourceMappingURL=QuickViewLinkDelegate.js.map