/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/helpers/ClassSupport","sap/ui/mdc/condition/FilterOperatorUtil","sap/ui/mdc/condition/Operator","sap/ui/mdc/enum/FieldDisplay","sap/ui/model/SimpleType","sap/ui/model/type/Boolean","sap/ui/model/type/Date","sap/ui/model/type/Float","sap/ui/model/type/Integer","sap/ui/model/type/String"],function(e,r,t,a,n,o,i,u,s,p,l){"use strict";var f,c,d;var y={};var m=r.defineUI5Class;function _(e,r){e.prototype=Object.create(r.prototype);e.prototype.constructor=e;T(e,r)}function T(e,r){T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(r,t){r.__proto__=t;return r};return T(e,r)}var h=(f=m("sap.fe.macros.filter.type.Value"),f(c=(d=function(r){_(o,r);function o(e,a){var n;n=r.call(this,e,a)||this;var o=(e===null||e===void 0?void 0:e.operator)||n.getDefaultOperatorName();n.operator=t.getOperator(o);if(!n.operator&&o.includes(".")){n._registerCustomOperator(o)}return n}y=o;var f=o.prototype;f._registerCustomOperator=function e(r){var n=this;var o=r.substring(0,r.lastIndexOf(".")).replace(/\./g,"/"),i=r.substring(r.lastIndexOf(".")+1);sap.ui.require([o],function(e){if(!e){return}n.operator=new a({filterOperator:"",tokenFormat:"",name:r,valueTypes:["self"],tokenParse:"^(.*)$",format:function(e){return n.formatConditionValues(e.values)},parse:function(e,t,n,o){if(typeof e==="object"){if(e.operator!==r){throw Error("not matching operator")}return e.values}return a.prototype.parse.apply(this,[e,t,n,o])},getModelFilter:function(r){return e[i].call(e,n.formatConditionValues(r.values))}});t.addOperator(n.operator)})};f._isMultiValueOperator=function e(r){return r.valueTypes.filter(function(e){return!!e&&e!==o.OPERATOR_VALUE_TYPE_STATIC}).length>1};f.hasCustomOperator=function e(){return this.operator.name.includes(".")};f._stringToExternal=function e(r,t){var a;var n=this._getTypeInstance(t);if(t&&o._isArrayType(t)){if(!Array.isArray(r)){r=[r]}a=r.map(function(e){return n?n.parseValue(e,o.INTERNAL_VALUE_TYPE):e})}else{a=n?n.parseValue(r,o.INTERNAL_VALUE_TYPE):r}return a};o._isArrayType=function e(r){if(!r){return false}return r==="array"||r.endsWith("[]")};f._externalToString=function e(r,t){var a;var n=this._getTypeInstance(t);if(t&&o._isArrayType(t)){if(!Array.isArray(r)){r=[r]}a=r.map(function(e){return n?n.formatValue(e,o.INTERNAL_VALUE_TYPE):e})}else{a=n?n.formatValue(r,o.INTERNAL_VALUE_TYPE):r}return a};f._getTypeInstance=function r(t){t=this.getElementTypeName(t)||t;switch(t){case"string":return new l;case"number":case"int":return new p;case"float":return new s;case"date":return new u;case"boolean":return new i;default:e.error("Unexpected filter type");throw new Error("Unexpected filter type")}};f.getDefaultOperatorName=function e(){return t.getEQOperator().name};f.formatConditionValues=function e(r){return Array.isArray(r)&&r.length?r[0]:r};f.getElementTypeName=function e(r){if(r!==null&&r!==void 0&&r.endsWith("[]")){return r.substring(0,r.length-2)}return undefined};f.formatValue=function e(r,t){if(!r){return undefined}var a=this._isMultiValueOperator(this.operator),i=this._getTypeInstance(o.INTERNAL_VALUE_TYPE);var u=this.operator.parse(r||"",i,n.Value,false);var s=!a&&Array.isArray(u)?u[0]:u;return this._stringToExternal(s,t)};f.parseValue=function e(r,t){if(!r){return undefined}var a=this._isMultiValueOperator(this.operator),n=this._getTypeInstance(t);var o=this._externalToString(r,t);var i=a?o:[o];if(this.hasCustomOperator()){return{operator:this.operator.name,values:[this.operator.format({values:i},n)],validated:undefined}}return this.operator.format({values:i},n)};f.validateValue=function e(r){};return o}(o),d.INTERNAL_VALUE_TYPE="string",d.OPERATOR_VALUE_TYPE_STATIC="static",d))||c);y=h;return y},false);
//# sourceMappingURL=Value.js.map