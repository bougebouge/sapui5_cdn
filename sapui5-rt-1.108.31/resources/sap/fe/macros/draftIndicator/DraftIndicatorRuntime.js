/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/macros/library","sap/fe/macros/ResourceModel","sap/ui/core/Fragment","sap/ui/core/util/XMLPreprocessor","sap/ui/core/XMLTemplateProcessor","sap/ui/model/json/JSONModel"],function(e,t,r,o,n,a,i){"use strict";var s=t.DraftIndicatorState;function p(e){while(e&&!(e.getMetadata().getName()==="sap.ui.core.mvc.XMLView")){e=e.getParent()}return e}var c={mDraftPopovers:undefined,closeDraftAdminPopover:function(e){e.getSource().getParent().getParent().close()},onDraftLinkPressed:function(t,s,c){var f=this;var d=t.getSource(),l=p(d),u=d.getBindingContext(),g=u.getModel().getMetaModel(),m=l.getId();this.mDraftPopovers=this.mDraftPopovers||{};this.mDraftPopovers[m]=this.mDraftPopovers[m]||{};var v=this.mDraftPopovers[m][s];if(v){v.setBindingContext(u);v.openBy(d)}else{var P=new i({bIndicatorType:c});var h="sap.fe.macros.field.DraftPopOverAdminData",D=a.loadTemplate(h,"fragment");Promise.resolve(n.process(D,{name:h},{bindingContexts:{entityType:g.createBindingContext("/".concat(s,"/$Type")),prop:P.createBindingContext("/")},models:{entityType:g,metaModel:g,prop:P}})).then(function(e){return o.load({definition:e,controller:f})}).then(function(e){e.setModel(r.getModel(),"i18n");l.addDependent(e);e.setBindingContext(u);e.setModel(P,"prop");f.mDraftPopovers[m][s]=e;e.openBy(d);l.attachEventOnce("beforeExit",function(){delete f.mDraftPopovers})}).catch(function(t){e.error("Error while opening the draft popup",t)})}},getVisible:function(e,t,r){if(!e&&!t&&r==s.NoChanges){return true}else if(!e&&t&&r==s.WithChanges){return true}else if(e&&t&&r==s.Active){return true}else{return false}}};return c},false);
//# sourceMappingURL=DraftIndicatorRuntime.js.map