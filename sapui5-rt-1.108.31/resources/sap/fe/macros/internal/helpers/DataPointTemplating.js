/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/formatters/ValueFormatter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/PropertyHelper","sap/fe/core/templating/UIFormatters","sap/ui/model/odata/v4/AnnotationHelper"],function(e,r,t,a,i,n){"use strict";var o={};var v=i.getDisplayMode;var l=i.getBindingWithUnitOrCurrency;var u=i.getBindingWithTimezone;var d=i.formatWithTypeInformation;var s=i.EDM_TYPE_MAPPING;var c=a.isProperty;var f=a.hasStaticPercentUnit;var g=t.getRelativePaths;var p=t.enhanceDataModelPath;var m=r.unresolveableExpression;var O=r.isPathInModelExpression;var T=r.getExpressionFromAnnotation;var I=r.formatResult;var b=r.compileExpression;var _=["Edm.Single","Edm.Double","Edm.Decimal"];var E=function(e){return e!==null&&e!==void 0&&e.TargetValue?T(e.TargetValue):m};var P=sap.ui.getCore().getLibraryResourceBundle("sap.fe.macros");var D=function(r){var t;var a=(r===null||r===void 0?void 0:(t=r.targetObject)===null||t===void 0?void 0:t.Value)||"";var i=g(r);var n=T(a,i);var o=E(r.targetObject);if(n&&o){var v,l,u,s;var p=r.targetObject.Value;if(!c(p)){p=r.targetObject.Value.$target}var m=((v=p.annotations)===null||v===void 0?void 0:(l=v.Measures)===null||l===void 0?void 0:l.Unit)||((u=p.annotations)===null||u===void 0?void 0:(s=u.Measures)===null||s===void 0?void 0:s.ISOCurrency);if(!m){return P.getText("T_COMMON_PROGRESS_INDICATOR_DISPLAY_VALUE_NO_UOM",[b(n),b(o)])}if(f(a===null||a===void 0?void 0:a.$target)){return"".concat(b(n)," %")}n=d(p,n);var O=m.$target?d(m.$target,T(m,i)):T(m,i);return b(I([n,o,O],e.formatProgressIndicatorText))}return undefined};o.buildExpressionForProgressIndicatorDisplayValue=D;var x=function(e){var r,t,a,i,n,o;var v=g(e);var l=e===null||e===void 0?void 0:(r=e.targetObject)===null||r===void 0?void 0:(t=r.Value)===null||t===void 0?void 0:t.$target;if(!c(l)){return""}var u=((a=l.annotations)===null||a===void 0?void 0:(i=a.Measures)===null||i===void 0?void 0:i.Unit)||((n=l.annotations)===null||n===void 0?void 0:(o=n.Measures)===null||o===void 0?void 0:o.ISOCurrency);return u?b(T(u,v)):""};o.buildUnitBindingExpression=x;var A=function(e,r){if(r){return N(n.value(r,{context:e}))}};var N=function(e){if(e){var r=e>1?P.getText("T_ANNOTATION_HELPER_RATING_INDICATOR_SUBTITLE_LABEL_PLURAL"):P.getText("T_ANNOTATION_HELPER_RATING_INDICATOR_SUBTITLE_LABEL");return P.getText("T_ANNOTATION_HELPER_RATING_INDICATOR_SUBTITLE",[String(e),r])}};var M=function(e,r){if(r&&r.SampleSize){return A(e,r.SampleSize)}else if(r&&r.Description){var t=n.value(r.Description,{context:e});return"${path:"+t+"}"}};M.requiresIContext=true;o.getHeaderRatingIndicatorText=M;var h=function(e){var r,t,a;var i=g(e);if(e!==null&&e!==void 0&&(r=e.targetObject)!==null&&r!==void 0&&(t=r.annotations)!==null&&t!==void 0&&(a=t.Common)!==null&&a!==void 0&&a.Text){var n,o;var v=T(e===null||e===void 0?void 0:(n=e.targetObject.annotations)===null||n===void 0?void 0:(o=n.Common)===null||o===void 0?void 0:o.Text,i);if(O(v)){v.parameters={$$noPatch:true}}return v}return undefined};var V=function(e,r,t){if(t){if(!e.formatOptions){e.formatOptions={}}e.formatOptions=Object.assign(e.formatOptions,{preserveDecimals:false,maxFractionDigits:t})}return e};var y=function(e,r,t,a){var i;var n;var o=(r===null||r===void 0?void 0:(i=r.path)===null||i===void 0?void 0:i.indexOf("/"))===-1?g(e):[];n=T(r,o);var v=e.targetObject;if(t&&O(n)){var l;d(v,n);n.type=(l=s[t])===null||l===void 0?void 0:l.type;if(_.includes(t)){n=V(n,r,a)}}return n};var R=function(r,t,a){var i,n,o,l;var d=r.targetObject;var s=(d===null||d===void 0?void 0:d.Value)||"";var c=s===null||s===void 0?void 0:(i=s.$target)===null||i===void 0?void 0:i.type;var f;if(_.includes(c)&&d.ValueFormat){if(d.ValueFormat.NumberOfFractionalDigits){f=d.ValueFormat.NumberOfFractionalDigits}}var g=p(r,s.path);var m=g?h(g):undefined;var O=y(g,s,c,f);var T=m?t.displayMode||v(g):"Value";var E;switch(T){case"Description":E=m;break;case"ValueDescription":E=I([O,m],e.formatWithBrackets);break;case"DescriptionValue":E=I([m,O],e.formatWithBrackets);break;default:if((n=g.targetObject)!==null&&n!==void 0&&(o=n.annotations)!==null&&o!==void 0&&(l=o.Common)!==null&&l!==void 0&&l.Timezone){E=u(g,O)}else{E=S(g,O,a||(t===null||t===void 0?void 0:t.measureDisplayMode)==="Hidden")}}return b(E)};o.buildFieldBindingExpression=R;var S=function(e,r,t){var a,i,n,o,v,u;if((a=e.targetObject)!==null&&a!==void 0&&(i=a.annotations)!==null&&i!==void 0&&(n=i.Measures)!==null&&n!==void 0&&n.Unit||(o=e.targetObject)!==null&&o!==void 0&&(v=o.annotations)!==null&&v!==void 0&&(u=v.Measures)!==null&&u!==void 0&&u.ISOCurrency){if(t&&f(e.targetObject)){return r}return l(e,r,undefined,t?{showMeasure:false}:undefined)}return r};o._computeBindingWithUnitOrCurrency=S;var j=function(r){var t,a,i,n,o;var v=(r===null||r===void 0?void 0:(t=r.targetObject)===null||t===void 0?void 0:t.Value)||"";var l=g(r);var u=T(v,l);var s=E(r.targetObject);var c=v.$target;var f=((a=c.annotations)===null||a===void 0?void 0:(i=a.Measures)===null||i===void 0?void 0:i.Unit)||((n=c.annotations)===null||n===void 0?void 0:(o=n.Measures)===null||o===void 0?void 0:o.ISOCurrency);if(f){var p=f.$target?d(f.$target,T(f,l)):T(f,l);return b(I([u,s,p],e.computePercentage))}return b(I([u,s,""],e.computePercentage))};o.buildExpressionForProgressIndicatorPercentValue=j;return o},false);
//# sourceMappingURL=DataPointTemplating.js.map