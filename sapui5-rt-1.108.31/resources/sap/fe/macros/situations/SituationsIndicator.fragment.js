/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/buildingBlocks/BuildingBlock","sap/fe/core/buildingBlocks/BuildingBlockRuntime","sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/BindingToolkit","sap/fe/macros/ResourceModel","sap/fe/macros/situations/SituationsPopover"],function(e,t,r,n,i,a,o){"use strict";var s,l,u,c,p,f,v,d;var y={};var b=o.showPopover;var g=i.ref;var m=i.pathInModel;var h=i.ifElse;var P=i.greaterThan;var S=i.fn;var T=i.equal;var w=i.and;var B=n.convertMetaModelContext;var O=r.xml;var k=t.xmlAttribute;var j=t.defineBuildingBlock;var z=t.BuildingBlockBase;function M(e,t){if(!t){t=e.slice(0)}return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function N(e,t,r,n){if(!r)return;Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function A(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function x(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;E(e,t)}function E(e,t){E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,r){t.__proto__=r;return t};return E(e,t)}function C(e,t,r,n,i){var a={};Object.keys(n).forEach(function(e){a[e]=n[e]});a.enumerable=!!a.enumerable;a.configurable=!!a.configurable;if("value"in a||a.initializer){a.writable=true}a=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},a);if(i&&a.initializer!==void 0){a.value=a.initializer?a.initializer.call(i):void 0;a.initializer=undefined}if(a.initializer===void 0){Object.defineProperty(e,t,a);a=null}return a}function _(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}var R=(s=j({name:"SituationsIndicator",namespace:"sap.fe.macros.internal.situations"}),l=k({type:"sap.ui.model.Context",required:true}),u=k({type:"string",required:false}),s(c=(p=function(t){x(r,t);function r(){var e;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++){n[i]=arguments[i]}e=t.call.apply(t,[this].concat(n))||this;N(e,"entitySet",f,A(e));N(e,"propertyPath",v,A(e));return e}y=r;r.getSituationsNavigationProperty=function t(r){var n;switch(r._type){case"NavigationProperty":n=r.targetType.navigationProperties;break;case"EntityType":n=r.navigationProperties;break;default:n=r.entityType.navigationProperties}var i=n.filter(function(e){var t,r;return!e.isCollection&&((t=e.targetType.annotations.Common)===null||t===void 0?void 0:(r=t.SAPObjectNodeType)===null||r===void 0?void 0:r.Name)==="BusinessSituation"});var a=i.length>=1?i[0]:undefined;if(i.length>1){var o=i.map(function(e){return"'".concat(e.name,"'")}).join(", ");var s;switch(r._type){case"NavigationProperty":s=r.targetType.name;break;case"EntityType":s=r.name;break;default:s=r.entityType.name}e.error("Entity type '".concat(s,"' has multiple paths to SAP Situations (").concat(o,"). Using '").concat(a===null||a===void 0?void 0:a.name,'\'.\nHint: Make sure there is at most one navigation property whose target entity type is annotated with\n<Annotation Term="com.sap.vocabularies.Common.v1.SAPObjectNodeType">\n  <Record>\n    <PropertyValue Property="Name" String="BusinessSituation" />\n  </Record>\n</Annotation>.'))}return a};var n=r.prototype;n.getTemplate=function e(){var t=B(this.entitySet);var n=r.getSituationsNavigationProperty(t);if(!n){return undefined}var i=m("".concat(n.name,"/SitnNumberOfInstances"));var o;if(!this.propertyPath){o=P(i,0)}else{o=w(P(i,0),T(m("semanticKeyHasDraftIndicator","internal"),this.propertyPath))}var s=h(P(i,1),i,"");var l=h(T(i,1),a.getText("situationsTooltipSingular"),S("formatMessage",[a.getText("situationsTooltipPlural"),i]));var u=S(b,[g("$controller"),g("$event"),n.name]);return O(d||(d=M(['\n\t\t\t<m:Button core:require="{rt: \'sap/fe/macros/situations/SituationsPopover\', formatMessage: \'sap/base/strings/formatMessage\'}"\n\t\t\t\ttype="Attention"\n\t\t\t\ticon="sap-icon://alert"\n\t\t\t\ttext="','"\n\t\t\t\ttooltip="','"\n\t\t\t\tvisible="','"\n\t\t\t\tpress="','"\n\t\t\t/>'])),s,l,o,u)};return r}(z),f=C(p.prototype,"entitySet",[l],{configurable:true,enumerable:true,writable:true,initializer:null}),v=C(p.prototype,"propertyPath",[u],{configurable:true,enumerable:true,writable:true,initializer:null}),p))||c);y=R;return y},false);
//# sourceMappingURL=SituationsIndicator.fragment.js.map