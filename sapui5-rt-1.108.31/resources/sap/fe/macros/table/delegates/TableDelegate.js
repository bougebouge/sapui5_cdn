/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/base/util/deepClone","sap/base/util/deepEqual","sap/base/util/deepExtend","sap/fe/core/ActionRuntime","sap/fe/core/CommonUtils","sap/fe/core/converters/MetaModelConverter","sap/fe/core/formatters/ValueFormatter","sap/fe/core/helpers/ExcelFormatHelper","sap/fe/core/helpers/ModelHelper","sap/fe/core/type/TypeUtil","sap/fe/macros/CommonHelper","sap/fe/macros/DelegateUtil","sap/fe/macros/filterBar/FilterBarDelegate","sap/fe/macros/ResourceModel","sap/fe/macros/table/TableHelper","sap/fe/macros/table/TableSizeHelper","sap/fe/macros/table/Utils","sap/ui/core/Fragment","sap/ui/mdc/odata/v4/TableDelegate","sap/ui/model/Filter","sap/ui/model/json/JSONModel"],function(e,t,a,n,r,i,o,l,s,u,c,d,p,f,g,m,v,h,y,P,b,C){"use strict";var D=o.getInvolvedDataModelObjects;function T(e,t){try{var a=e()}catch(e){return t(e)}if(a&&a.then){return a.then(void 0,t)}return a}function _(e,t){try{var a=e()}catch(e){return t(true,e)}if(a&&a.then){return a.then(t.bind(null,false),t.bind(null,true))}return t(false,a)}var F="sap_fe_TableDelegate_propertyInfoMap";var I="/semanticKeyHasDraftIndicator";var x=i.FilterRestrictions;function S(e,t,a){if(e instanceof window.Element){return}var n=a?"".concat(F,"_add"):F;p.setCustomData(e,n,t)}function E(e,t){if(e instanceof window.Element){return null}var a=t?"".concat(F,"_add"):F;return p.getCustomData(e,a)}return Object.assign({},P,{_computeVisualSettingsForFieldGroup:function(e,t,a){if(t.name.indexOf("DataFieldForAnnotation::FieldGroup::")===0){var r=e.getColumns().find(function(e){return e.getDataProperty()===t.name});var i=r?r.data("showDataFieldsLabel")==="true":false;var o=e.getModel().getMetaModel();var l=o.createBindingContext(t.metadataPath.replace(/@.*/,""));var s=o.getObject(t.metadataPath);var u=s.Target?l.getObject(s.Target.$AnnotationPath):null;var c=[];u.Data.forEach(function(e){var t;switch(e.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":t=v.getWidthForDataFieldForAnnotation(e,i,a,l);break;case"com.sap.vocabularies.UI.v1.DataField":if(i){t=v.getWidthForDataField(e,i,a,l)}break;case"com.sap.vocabularies.UI.v1.DataFieldForAction":t={labelWidth:0,propertyWidth:v.getButtonWidth(e.Label)};break;default:}if(t){c.push(t.labelWidth+t.propertyWidth)}});var d=c.reduce(function(e,t){return Math.max(e,t)},0);t.visualSettings=n(t.visualSettings,{widthCalculation:{verticalArrangement:true,minWidth:Math.ceil(d)}})}},_computeVisualSettingsForPropertyWithValueHelp:function(e,t){var a=e?e.getParent():null;if(!t.propertyInfos){var r=e.getModel().getMetaModel();if(t.metadataPath===undefined){throw new Error("a `metadataPath` property is expected when computing VisualSettings for property with ValueHelp")}var i=r.getObject("".concat(t.metadataPath,"@"));if(i&&i["@com.sap.vocabularies.Common.v1.ValueList"]){t.visualSettings=n(t.visualSettings,{widthCalculation:{gap:a&&a.getReadOnly()?0:4}})}}},_computeVisualSettingsForPropertyWithUnit:function(e,t,a,r,i){var o=e?e.getParent():null;var l=r||i;if(l){t.visualSettings=n(t.visualSettings,{widthCalculation:{gap:Math.ceil(v.getButtonWidth(l))}})}if(a){t.visualSettings=n(t.visualSettings,{widthCalculation:{gap:o&&o.getReadOnly()?0:6}})}},_computeLabel:function(e,t){if(e.label){var a;var n=t[e.label];if((n===null||n===void 0?void 0:n.length)>1&&(a=e.path)!==null&&a!==void 0&&a.includes("/")&&e.additionalLabels){e.label=e.label+" ("+e.additionalLabels.join(" / ")+")"}delete e.additionalLabels}},_updatePropertyInfo:function(e,t){var a=this;var r={};var i=e.getP13nMode();t.forEach(function(e){if(!e.propertyInfos&&e.label){if((i===null||i===void 0?void 0:i.indexOf("Sort"))>-1&&e.sortable||(i===null||i===void 0?void 0:i.indexOf("Filter"))>-1&&e.filterable||(i===null||i===void 0?void 0:i.indexOf("Group"))>-1&&e.groupable){r[e.label]=r[e.label]!==undefined?r[e.label].concat([e]):[e]}}});t.forEach(function(i){a._computeVisualSettingsForFieldGroup(e,i,t);a._computeVisualSettingsForPropertyWithValueHelp(e,i);i.typeConfig=n(i.typeConfig,{});a._computeLabel(i,r)});return t},getColumnsFor:function(e){return e.getParent().getTableDefinition().columns},_getAggregatedPropertyMap:function(e){return e.getParent().getTableDefinition().aggregates},fetchExportCapabilities:function(t){var a={XLSX:{}};var n;return p.fetchModel(t).then(function(e){n=e;return n.getMetaModel().getObject("/$EntityContainer@Org.OData.Capabilities.V1.SupportedFormats")}).then(function(e){var t=(e||[]).map(function(e){return e.toLowerCase()});if(t.indexOf("application/pdf")>-1){return n.getMetaModel().getObject("/$EntityContainer@com.sap.vocabularies.PDF.v1.Features")}return undefined}).then(function(e){if(e){a["PDF"]=Object.assign({},e)}}).catch(function(t){e.error("An error occurs while computing export capabilities: ".concat(t))}).then(function(){return a})},_isFilterableNavigationProperty:function(e,t,a){var n=p.getCustomData(a,"metaPath");if(!n){return false}var r=D(t.getContext(n)),i=D(t.getContext(e.annotationPath)).navigationProperties,o=i.findIndex(function(e){var t;return((t=e.targetType)===null||t===void 0?void 0:t.name)===r.targetEntityType.name}),l=i.slice(o>0?o:0);return!e.relativePath.includes("/")||e.isPartOfLineItem===true&&!l.some(function(e){return e._type=="NavigationProperty"&&e.isCollection})},_fetchPropertyInfo:function(e,t,a,n,r){var i=t.annotationPath,o=e.getObject(i),l=e.createBindingContext(i),s=t.typeConfig&&t.typeConfig.className&&p.isTypeFilterable(t.typeConfig.className)?c.getTypeConfig(t.typeConfig.className,t.typeConfig.oFormatOptions,t.typeConfig.oConstraints):{},u=d.isPropertyFilterable(t.relativePath,{context:l},o),f=t.typeConfig&&t.typeConfig.className.indexOf("Edm.")!==0,m=p.getCustomData(a,"enableAnalytics")==="true",v=m?this._getAggregatedPropertyMap(a):{},h=t.exportSettings||null,y=t.typeConfig&&t.typeConfig.className?this._getExportFormat(t.typeConfig.className):undefined;var P=t.isDataPointFakeTargetProperty?g.getText("TargetValue"):p.getLocalizedText(t.label,n||a);if(h){if(y&&!h.timezoneProperty){h.format=y}if(h.template){h.template=t.exportSettings.template}}var b={name:t.name,metadataPath:i,groupLabel:t.groupLabel,group:t.group,label:P,tooltip:t.tooltip,typeConfig:s,visible:t.availability!=="Hidden"&&!f,exportSettings:h,unit:t.unit};if(t.visualSettings&&Object.keys(t.visualSettings).length>0){b.visualSettings=t.visualSettings}if(y){var C=a?a.getParent():null;b.visualSettings={widthCalculation:{gap:C&&C.getReadOnly()?1:1.5}}}if(t.propertyInfos&&t.propertyInfos.length){var D;b.propertyInfos=t.propertyInfos;if((D=t.exportSettings)!==null&&D!==void 0&&D.wrap){b.exportSettings.wrap=t.exportSettings.wrap}if(r&&t.additionalPropertyInfos&&t.additionalPropertyInfos.length){b.propertyInfos=b.propertyInfos.concat(t.additionalPropertyInfos)}}else{b.path=t.relativePath;b.sortable=t.sortable;b.filterable=!t.isDataPointFakeTargetProperty&&!!u&&this._isFilterableNavigationProperty(t,e,a)&&(!m||!v[b.name]);b.key=t.isKey;b.groupable=t.isGroupable;if(t.textArrangement){var T=this.getColumnsFor(a).find(function(e){return e.name===t.textArrangement.textProperty});if(T){b.mode=t.textArrangement.mode;b.valueProperty=t.relativePath;b.descriptionProperty=T.relativePath}}b.text=t.textArrangement&&t.textArrangement.textProperty;b.caseSensitive=t.caseSensitive;if(t.additionalLabels){b.additionalLabels=t.additionalLabels.map(function(e){return p.getLocalizedText(e,n||a)})}}this._computeVisualSettingsForPropertyWithUnit(a,b,t.unit,t.unitText,t.timezoneText);return b},_fetchCustomPropertyInfo:function(e,t,a){var n=p.getLocalizedText(e.header,a||t);var r={name:e.name,groupLabel:null,group:null,label:n,type:"Edm.String",visible:e.availability!=="Hidden",exportSettings:e.exportSettings,visualSettings:e.visualSettings};if(e.propertyInfos&&e.propertyInfos.length){r.propertyInfos=e.propertyInfos;r.exportSettings={wrap:e.exportSettings.wrap,template:e.exportSettings.template}}else{r.path=e.name;r.sortable=false;r.filterable=false}return r},_bColumnHasPropertyWithDraftIndicator:function(e){return!!(e.formatOptions&&e.formatOptions.hasDraftIndicator||e.formatOptions&&e.formatOptions.fieldGroupDraftIndicatorPropertyPath)},_updateDraftIndicatorModel:function(e,t){var a=e.getColumns();var n=e.getBindingContext("internal");var r=n&&n.getPath();if(a&&n){for(var i in a){if(this._bColumnHasPropertyWithDraftIndicator(t)&&t.name===a[i].getDataProperty()){if(n.getProperty(r+I)===undefined){n.setProperty(r+I,t.name);break}}}}},_fetchPropertiesForEntity:function(t,a,n,r,o){var l=this;var s=u.getEntitySetPath(a);var c=[];var d=i.getFilterRestrictionsByPath(s,n);var f=d[x.NON_FILTERABLE_PROPERTIES];return Promise.resolve(this.getColumnsFor(t)).then(function(e){if(e){var a;e.forEach(function(e){l._updateDraftIndicatorModel(t,e);switch(e.type){case"Annotation":a=l._fetchPropertyInfo(n,e,t,r,o);if(a&&f.indexOf(a.name)===-1){a.maxConditions=p.isMultiValue(a)?-1:1}break;case"Slot":case"Default":a=l._fetchCustomPropertyInfo(e,t,r);break;default:throw new Error("unhandled switch case ".concat(e.type))}c.push(a)})}}).then(function(){c=l._updatePropertyInfo(t,c)}).catch(function(t){e.error("An error occurs while updating fetched properties: ".concat(t))}).then(function(){return c})},_getCachedOrFetchPropertiesForEntity:function(e,t,a,n,r){var i=E(e,r);if(i){return Promise.resolve(i)}return this._fetchPropertiesForEntity(e,t,a,n,r).then(function(t){S(e,t,r);return t})},_setTableNoDataText:function(t,a){var n="";var r=h.getAllFilterInfo(t),o=a.path.startsWith("/")?a.path.substr(1):a.path;var l=function(){if(t.data("hiddenFilters")||t.data("quickFilterKey")){return"M_TABLE_AND_CHART_NO_DATA_TEXT_MULTI_VIEW"}else{return"T_TABLE_AND_CHART_NO_DATA_TEXT_WITH_FILTER"}};var s=t.getFilter();if(s&&!/BasicSearch$/.test(s)){if(r.search||r.filters&&r.filters.length){n=l()}else{n="T_TABLE_AND_CHART_NO_DATA_TEXT"}}else if(r.search||r.filters&&r.filters.length){n=l()}else{n="M_TABLE_AND_CHART_NO_FILTERS_NO_DATA_TEXT"}return t.getModel("sap.fe.i18n").getResourceBundle().then(function(e){t.setNoData(i.getTranslatedText(n,e,null,o))}).catch(function(t){e.error(t)})},handleTableDataReceived:function(e,t){var a=e&&e.getRowBinding(),n=t&&t.getProperty("dataReceivedAttached");if(t&&!n){a.attachDataReceived(function(){m.handleTableDeleteEnablementForSideEffects(e,t);t.setProperty("selectedContexts",[]);var a=e.getSelectedContexts();t.setProperty("selectedContexts",a);t.setProperty("numberOfSelectedContexts",a.length);var n=JSON.parse(d.parseCustomData(p.getCustomData(e,"operationAvailableMap")));r.setActionEnablement(t,n,a,"table");var i=e?e.getParent():null;if(i){i.setUpEmptyRows(e)}});t.setProperty("dataReceivedAttached",true)}},rebind:function(t,a){var n=t.getParent();var r=n===null||n===void 0?void 0:n.getProperty("bindingSuspended");n===null||n===void 0?void 0:n.setProperty("outDatedBinding",r);if(!r){h.clearSelection(t);P.rebind.apply(this,[t,a]);h.onTableBound(t);this._setTableNoDataText(t,a);return h.whenBound(t).then(this.handleTableDataReceived(t,t.getBindingContext("internal"))).catch(function(t){e.error("Error while waiting for the table to be bound",t)})}return Promise.resolve()},fetchProperties:function(e){var t=this;return p.fetchModel(e).then(function(a){if(!a){return[]}return t._getCachedOrFetchPropertiesForEntity(e,p.getCustomData(e,"entityType"),a.getMetaModel())})},preInit:function(e){return P.preInit.apply(this,[e]).then(function(){var t=e.getCreationRow();if(t){t.setBindingContext(null)}})},updateBindingInfo:function(e,t){P.updateBindingInfo.apply(this,[e,t]);this._internalUpdateBindingInfo(e,t);t.events.dataReceived=e.getParent().onInternalDataReceived.bind(e.getParent());t.events.dataRequested=e.getParent().onInternalDataRequested.bind(e.getParent());this._setTableNoDataText(e,t)},_manageSemanticTargets:function(e){var t=e.getRowBinding();if(t){t.attachEventOnce("dataRequested",function(){setTimeout(function(){var t=i.getTargetView(e);if(t){h.getSemanticTargetsFromTable(t.getController(),e)}},0)})}},updateBinding:function(t,n,r){var o=t.getParent();var l=o===null||o===void 0?void 0:o.getProperty("bindingSuspended");if(!l){var s=false;var u=i.getTargetView(t);var c=t.getBindingContext("internal");var d="pendingManualBindingUpdate";var p=c.getProperty(d);var f=t.getRowBinding();if(f){var g=f.getFilters("Application");s=a(n.filters,g[0])&&f.getQueryOptionsFromParameters().$search===n.parameters.$search&&!p&&u&&u.getViewData().converterType==="ListReport"}P.updateBinding.apply(this,[t,n,r]);t.fireEvent("bindingUpdated");if(s&&t.getFilter()&&r){f.requestRefresh(f.getGroupId()).finally(function(){c.setProperty(d,false)}).catch(function(t){e.error("Error while refreshing the table",t)});c.setProperty(d,true)}this._manageSemanticTargets(t)}o===null||o===void 0?void 0:o.setProperty("outDatedBinding",l)},_computeRowBindingInfoFromTemplate:function(e){var a=t(p.getCustomData(e,"rowsBindingInfo"));if(a.parameters.$$getKeepAliveContext){var n=p.getCustomData(e,"targetCollectionPath");var r=e.getModel("internal");var i=r.getObject("/keptAliveLists")||{};if(!i[n]){i[n]=e.getId();r.setProperty("/keptAliveLists",i)}else if(i[n]!==e.getId()){delete a.parameters.$$getKeepAliveContext}}return a},_internalUpdateBindingInfo:function(e,t){var a=e.getBindingContext("internal");Object.assign(t,this._computeRowBindingInfoFromTemplate(e));if(e.getRowBinding()){t.suspended=false}if(a){a.setProperty("dataReceivedAttached",false)}var n;var r=h.getAllFilterInfo(e);if(r.filters.length>0){n=new b({filters:r.filters,and:true})}if(r.bindingPath){t.path=r.bindingPath}var i=e.getDataStateIndicator();if(i&&i.isFiltering()){if(t.filters.length>0){n=new b({filters:t.filters.concat(r.filters),and:true});h.updateBindingInfo(t,r,n)}}else{h.updateBindingInfo(t,r,n)}},_templateCustomColumnFragment:function(e,t,a,n){var r=new C(e),i=new C({id:n}),o={bindingContexts:{this:i.createBindingContext("/"),column:r.createBindingContext("/")},models:{this:i,column:r}};return p.templateControlFragment("sap.fe.macros.table.CustomColumn",o,{view:t},a).then(function(e){r.destroy();return e})},_templateSlotColumnFragment:function(t,a,n,r){try{var i=new C(t),o=new C({id:r}),l={bindingContexts:{this:o.createBindingContext("/"),column:i.createBindingContext("/")},models:{this:o,column:i}};return Promise.resolve(p.templateControlFragment("sap.fe.macros.table.SlotColumn",l,{isXML:true})).then(function(a){if(!a){return Promise.resolve(null)}var r=a.getElementsByTagName("slot")[0],i=a.getElementsByTagName("mdcTable:template")[0];i.removeChild(r);if(t.template){var o=(new DOMParser).parseFromString(t.template,"text/xml");i.appendChild(o.firstElementChild)}else{e.error("Please provide content inside this Building Block Column: ".concat(t.header));return Promise.resolve(null)}return n.targets!=="jsControlTree"?a:y.load({type:"XML",definition:a})})}catch(e){return Promise.reject(e)}},_getExportFormat:function(e){switch(e){case"Edm.Date":return s.getExcelDatefromJSDate();case"Edm.DateTimeOffset":return s.getExcelDateTimefromJSDateTime();case"Edm.TimeOfDay":return s.getExcelTimefromJSTime();default:return undefined}},_getVHRelevantFields:function(e,t,a){var n=this;var r=[],i=e.getObject(t);if(i.$kind&&i.$kind==="Property"){i=e.getObject("".concat(t,"@com.sap.vocabularies.UI.v1.DataFieldDefault"));t="".concat(t,"@com.sap.vocabularies.UI.v1.DataFieldDefault")}switch(i.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":if(e.getObject("".concat(t,"/Target/$AnnotationPath")).includes("com.sap.vocabularies.UI.v1.FieldGroup")){e.getObject("".concat(t,"/Target/$AnnotationPath/Data")).forEach(function(a,i){r=r.concat(n._getVHRelevantFields(e,"".concat(t,"/Target/$AnnotationPath/Data/").concat(i)))})}break;case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":r.push(e.getObject("".concat(t,"/Value/$Path")));break;case"com.sap.vocabularies.UI.v1.DataFieldForAction":case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":break;default:if(t.indexOf(a)===0){r.push(t.substring(a.length+1));break}r.push(d.getNavigationPath(t,true));break}return r},_setDraftIndicatorOnVisibleColumn:function(e,t,a){var n=this;var r=e.getBindingContext("internal");if(!r){return}var i=r.getPath();var o=t.filter(function(e){return n._bColumnHasPropertyWithDraftIndicator(e)});var l=e.getColumns();var s,u,c,d;for(var p in l){u=l[p].getDataProperty();for(var f in o){d=o[f].name;if(u===d){c=true;break}if(a&&a.name===d){s=a.name}}if(c){r.setProperty(i+I,u);break}}if(!c&&s){r.setProperty(i+I,s)}},removeItem:function(e,t,a){var n=true;var r=a.modifier;var i=e&&r.getProperty(e,"dataProperty");if(i&&i.indexOf&&i.indexOf("InlineXML")!==-1){r.insertAggregation(t,"dependents",e);n=false}if(t.isA&&r.targets==="jsControlTree"){this._setDraftIndicatorStatus(r,t,this.getColumnsFor(t))}return Promise.resolve(n)},_getMetaModel:function(e){return e.appComponent&&e.appComponent.getModel().getMetaModel()},_setDraftIndicatorStatus:function(e,t,a,n){if(e.targets==="jsControlTree"){this._setDraftIndicatorOnVisibleColumn(t,a,n)}},_getGroupId:function(e){return e||undefined},_getDependent:function(e,t,a){if(t===a){return e}return undefined},_fnTemplateValueHelp:function(e,t,a){if(t&&!a){return e("sap.fe.macros.table.ValueHelp")}return Promise.resolve()},_getDisplayMode:function(e){var t;if(e!==undefined){e=typeof e==="boolean"?e:e==="true";t=e?"Display":"Editable";return{displaymode:e,columnEditMode:t}}return{displaymode:undefined,columnEditMode:undefined}},_insertAggregation:function(e,t,a){if(e){return t.insertAggregation(a,"dependents",e,0)}return undefined},addItem:function(t,a,n){try{var r=this;var o=r._getMetaModel(n),l=n.modifier,s=l.getId(a),u=a.isA?r.getColumnsFor(a):null;if(!u){return Promise.resolve(null)}var c=u.find(function(e){return e.name===t});if(!c){e.error("".concat(t," not found while adding column"));return Promise.resolve(null)}r._setDraftIndicatorStatus(l,a,u,c);if(c.type==="Default"){return Promise.resolve(r._templateCustomColumnFragment(c,n.view,l,s))}if(c.type==="Slot"){return Promise.resolve(r._templateSlotColumnFragment(c,n.view,l,s))}if(!o){return Promise.resolve(null)}return Promise.resolve(p.getCustomData(a,"metaPath",l)).then(function(u){return Promise.resolve(p.getCustomData(a,"entityType",l)).then(function(d){return Promise.resolve(p.getCustomData(a,"requestGroupId",l)).then(function(f){var g=r._getGroupId(f);var m=o.createBindingContext(u);return Promise.resolve(r._getCachedOrFetchPropertiesForEntity(a,d,o,n.appComponent)).then(function(d){var f=d.find(function(e){return e.name===t});var v=o.createBindingContext(f.metadataPath);var h=r._getVHRelevantFields(o,f.metadataPath,u);var y={sBindingPath:u,sValueHelpType:"TableValueHelp",oControl:a,oMetaModel:o,oModifier:l,oPropertyInfo:f};var P=function(t){try{var n=new C({id:s,requestGroupId:g}),i={bindingContexts:{this:n.createBindingContext("/"),dataField:v},models:{this:n,dataField:o,metaModel:o}};return Promise.resolve(_(function(){return T(function(){return Promise.resolve(p.templateControlFragment(t,i,{},l)).then(function(e){return Promise.resolve(r._insertAggregation(e,l,a))})},function(t){e.error("ValueHelp not loaded : ".concat(t.message));return null})},function(e,t){n.destroy();if(e)throw t;return t}))}catch(e){return Promise.reject(e)}};var b=function(e,n){var i="sap.fe.macros.table.Column";var d;var f;var g;var h;return Promise.all([p.getCustomData(a,"displayModePropertyBinding",l),p.getCustomData(a,"tableType",l),p.getCustomData(a,"onChange",l),p.getCustomData(a,"creationMode",l)]).then(function(e){d=e[0];f=e[1];g=e[2];h=e[3];var a=r._getDisplayMode(d);d=a.displaymode;var y=a.columnEditMode;var P=new C({readOnly:d,columnEditMode:y,tableType:f,onChange:g,id:s,navigationPropertyPath:t,columnInfo:c,collection:{sPath:u,oModel:o},creationMode:h}),b={bindingContexts:{entitySet:m,collection:m,dataField:v,this:P.createBindingContext("/"),column:P.createBindingContext("/columnInfo")},models:{this:P,entitySet:o,collection:o,dataField:o,metaModel:o,column:P}};return p.templateControlFragment(i,b,{view:n},l).finally(function(){P.destroy()})})};return Promise.resolve(Promise.all(h.map(function(e){try{var t=Object.assign({},y,{sPropertyName:e});return Promise.resolve(Promise.all([p.isValueHelpRequired(t),p.doesValueHelpExist(t)])).then(function(e){var t=e[0],a=e[1];return r._fnTemplateValueHelp(P,t,a)})}catch(e){return Promise.reject(e)}}))).then(function(){var e=n.view||i.getTargetView(a)||(n.appComponent?i.getCurrentPageView(n.appComponent):undefined);return b(f,e)})})})})})}catch(e){return Promise.reject(e)}},getFilterDelegate:function(){return Object.assign({},f,{addItem:function(e,t){if(e.indexOf("Property::")===0){e=e.replace("Property::","")}return f.addItem(e,t)}})},getTypeUtil:function(){return c},formatGroupHeader:function(e,t,a){var n,r;var i=E(e,null),o=i&&i.filter(function(e){return e.name===a})[0],s=(o===null||o===void 0?void 0:(n=o.typeConfig)===null||n===void 0?void 0:n.baseType)==="DateTime"||(o===null||o===void 0?void 0:(r=o.typeConfig)===null||r===void 0?void 0:r.baseType)==="Date";var u;if(o&&o.mode){switch(o.mode){case"Description":u=t.getProperty(o.descriptionProperty,s);break;case"DescriptionValue":u=l.formatWithBrackets(t.getProperty(o.descriptionProperty,s),t.getProperty(o.valueProperty,s));break;case"ValueDescription":u=l.formatWithBrackets(t.getProperty(o.valueProperty,s),t.getProperty(o.descriptionProperty,s));break}}else{u=t.getProperty(o.path,s)}return g.getText("M_TABLE_GROUP_HEADER_TITLE",[o.label,u])}})},false);
//# sourceMappingURL=TableDelegate.js.map