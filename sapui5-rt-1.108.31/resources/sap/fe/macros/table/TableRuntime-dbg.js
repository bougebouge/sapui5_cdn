/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/ActionRuntime", "sap/fe/core/CommonUtils", "sap/fe/core/library", "sap/fe/macros/field/FieldRuntime", "sap/fe/macros/table/TableHelper"], function (ActionRuntime, CommonUtils, FELibrary, FieldRuntime, TableHelper) {
  "use strict";

  var CreationMode = FELibrary.CreationMode;
  /**
   * Static class used by Table building block during runtime
   *
   * @private
   * @experimental This module is only for internal/experimental use!
   */
  var TableRuntime = {
    displayTableSettings: function (oEvent) {
      /*
      		 Temporary solution
      		 Wait for mdc Table to provide public api to either get button 'Settings' or fire event on this button
      		 */
      var oParent = oEvent.getSource().getParent(),
        oSettingsButton = sap.ui.getCore().byId("".concat(oParent.getId(), "-settings"));
      CommonUtils.fireButtonPress(oSettingsButton);
    },
    executeConditionalActionShortcut: function (sButtonMatcher, oSource) {
      // Get the button related to keyboard shortcut
      var oMdcTable = oSource.getParent();
      if (sButtonMatcher !== CreationMode.CreationRow) {
        var oButton = oMdcTable.getActions().reduce(function (aActionButtons, oActionToolbarAction) {
          return aActionButtons.concat(oActionToolbarAction.getAction());
        }, []).find(function (oActionButton) {
          return oActionButton.getId().endsWith(sButtonMatcher);
        });
        CommonUtils.fireButtonPress(oButton);
      } else {
        var oCreationRow = oMdcTable.getAggregation("creationRow");
        if (oCreationRow && oCreationRow.getApplyEnabled() && oCreationRow.getVisible()) {
          oCreationRow.fireApply();
        }
      }
    },
    setContexts: function (oTable, sDeletablePath, oDraft, sCollection, sNavigationAvailableMap, sActionsMultiselectDisabled, sUpdatablePath) {
      var aActionsMultiselectDisabled = sActionsMultiselectDisabled ? sActionsMultiselectDisabled.split(",") : [];
      var oActionOperationAvailableMap = JSON.parse(sCollection);
      var oNavigationAvailableMap = sNavigationAvailableMap && sNavigationAvailableMap !== "undefined" && JSON.parse(sNavigationAvailableMap);
      var aSelectedContexts = oTable.getSelectedContexts();
      var isDeletable = false;
      var aDeletableContexts = [];
      var bReadOnlyDraftEnabled = oTable.data("displayModePropertyBinding") === "true" && oDraft !== "undefined";
      var aUpdatableContexts = [];
      var aUnsavedContexts = [];
      var aLockedContexts = [];
      // oDynamicActions are bound actions that are available according to some property
      // in each item
      var oDynamicActions = {};
      var oIBN = {};
      var oLockedAndUnsavedContexts = {};
      var oModelObject;
      var oInternalModelContext = oTable.getBindingContext("internal");
      oLockedAndUnsavedContexts.aUnsavedContexts = [];
      oLockedAndUnsavedContexts.aLockedContexts = [];

      //do not consider empty rows as selected context
      aSelectedContexts = aSelectedContexts.filter(function (oContext) {
        return !oContext.isInactive();
      });
      oInternalModelContext.setProperty("", Object.assign(oInternalModelContext.getObject(), {
        selectedContexts: aSelectedContexts,
        numberOfSelectedContexts: aSelectedContexts.length,
        dynamicActions: oDynamicActions,
        ibn: oIBN,
        deleteEnabled: true,
        deletableContexts: [],
        unSavedContexts: [],
        lockedContexts: [],
        updatableContexts: [],
        semanticKeyHasDraftIndicator: oInternalModelContext.getProperty("semanticKeyHasDraftIndicator") ? oInternalModelContext.getProperty("semanticKeyHasDraftIndicator") : undefined
      }));
      for (var i = 0; i < aSelectedContexts.length; i++) {
        var oSelectedContext = aSelectedContexts[i];
        var oContextData = oSelectedContext.getObject();
        for (var key in oContextData) {
          if (key.indexOf("#") === 0) {
            var sActionPath = key;
            sActionPath = sActionPath.substring(1, sActionPath.length);
            oModelObject = oInternalModelContext.getObject();
            oModelObject.dynamicActions[sActionPath] = {
              enabled: true
            };
            oInternalModelContext.setProperty("", oModelObject);
          }
        }
        oModelObject = oInternalModelContext.getObject();
        if (sDeletablePath != "undefined") {
          if (oSelectedContext && oSelectedContext.getProperty(sDeletablePath)) {
            if (oDraft !== "undefined" && oContextData.IsActiveEntity === true && oContextData.HasDraftEntity === true) {
              oLockedAndUnsavedContexts = getUnsavedAndLockedContexts(oContextData, oSelectedContext);
            } else {
              aDeletableContexts.push(oSelectedContext);
              oLockedAndUnsavedContexts.isDeletable = true;
            }
          }
          oModelObject["deleteEnabled"] = oLockedAndUnsavedContexts.isDeletable;
        } else if (oDraft !== "undefined" && oContextData.IsActiveEntity === true && oContextData.HasDraftEntity === true) {
          oLockedAndUnsavedContexts = getUnsavedAndLockedContexts(oContextData, oSelectedContext);
        } else {
          aDeletableContexts.push(oSelectedContext);
        }

        // The updatable contexts with mass edit depend on the following:
        // 1. Update is dependendent on current entity property (sUpdatablePath).
        // 2. The table is read only and draft enabled(like LR), in this case only active contexts can be mass edited(not draft contexts).
        //    So, update depends on 'IsActiveEntity' value which needs to be checked.
        var bUpdatableByPath = sUpdatablePath.length === 0 || !!oSelectedContext.getProperty(sUpdatablePath);
        var bNotDraftInReadOnlyMode = !bReadOnlyDraftEnabled || oContextData.IsActiveEntity;
        if (bUpdatableByPath && bNotDraftInReadOnlyMode) {
          aUpdatableContexts.push(oSelectedContext);
        }
      }
      function getUnsavedAndLockedContexts(oContextData, oSelectedContext) {
        if (oContextData.DraftAdministrativeData.InProcessByUser) {
          aLockedContexts.push(oSelectedContext);
        } else {
          aUnsavedContexts.push(oSelectedContext);
          isDeletable = true;
        }
        return {
          aLockedContexts: aLockedContexts,
          aUnsavedContexts: aUnsavedContexts,
          isDeletable: isDeletable
        };
      }
      if (!oTable.data("enableAnalytics")) {
        TableHelper.setIBNEnablement(oInternalModelContext, oNavigationAvailableMap, aSelectedContexts);
      }
      if (aSelectedContexts.length > 1) {
        this.disableAction(aActionsMultiselectDisabled, oDynamicActions);
      }
      if (oModelObject) {
        oModelObject["deletableContexts"] = aDeletableContexts;
        oModelObject["updatableContexts"] = aUpdatableContexts;
        oModelObject["unSavedContexts"] = oLockedAndUnsavedContexts.aUnsavedContexts;
        oModelObject["lockedContexts"] = oLockedAndUnsavedContexts.aLockedContexts;
        oModelObject["controlId"] = oTable.getId();
        oInternalModelContext.setProperty("", oModelObject);
      }
      return ActionRuntime.setActionEnablement(oInternalModelContext, oActionOperationAvailableMap, aSelectedContexts, "table");
    },
    disableAction: function (aActionsMultiselectDisabled, oDynamicActions) {
      aActionsMultiselectDisabled.forEach(function (sAction) {
        oDynamicActions[sAction] = {
          bEnabled: false
        };
      });
    },
    onFieldChangeInCreationRow: function (oEvent, oCustomValidationFunction) {
      // CREATION ROW CASE
      var mField = FieldRuntime.getFieldStateOnChange(oEvent),
        oSourceField = mField.field,
        sFieldId = oSourceField.getId();
      var oInternalModelContext = oSourceField.getBindingContext("internal"),
        mFieldValidity = oInternalModelContext.getProperty("creationRowFieldValidity"),
        mNewFieldValidity = Object.assign({}, mFieldValidity);
      mNewFieldValidity[sFieldId] = mField.state;
      oInternalModelContext.setProperty("creationRowFieldValidity", mNewFieldValidity);

      // prepare Custom Validation
      if (oCustomValidationFunction) {
        var mCustomValidity = oInternalModelContext.getProperty("creationRowCustomValidity"),
          mNewCustomValidity = Object.assign({}, mCustomValidity);
        mNewCustomValidity[oSourceField.getBinding("value").getPath()] = {
          fieldId: oSourceField.getId()
        };
        oInternalModelContext.setProperty("creationRowCustomValidity", mNewCustomValidity);
        // Remove existing CustomValidation message
        var oMessageManager = sap.ui.getCore().getMessageManager();
        var sTarget = "".concat(oSourceField.getBindingContext().getPath(), "/").concat(oSourceField.getBindingPath("value"));
        oMessageManager.getMessageModel().getData().forEach(function (oMessage) {
          if (oMessage.target === sTarget) {
            oMessageManager.removeMessages(oMessage);
          }
        });
      }
    }
  };
  return TableRuntime;
}, false);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJDcmVhdGlvbk1vZGUiLCJGRUxpYnJhcnkiLCJUYWJsZVJ1bnRpbWUiLCJkaXNwbGF5VGFibGVTZXR0aW5ncyIsIm9FdmVudCIsIm9QYXJlbnQiLCJnZXRTb3VyY2UiLCJnZXRQYXJlbnQiLCJvU2V0dGluZ3NCdXR0b24iLCJzYXAiLCJ1aSIsImdldENvcmUiLCJieUlkIiwiZ2V0SWQiLCJDb21tb25VdGlscyIsImZpcmVCdXR0b25QcmVzcyIsImV4ZWN1dGVDb25kaXRpb25hbEFjdGlvblNob3J0Y3V0Iiwic0J1dHRvbk1hdGNoZXIiLCJvU291cmNlIiwib01kY1RhYmxlIiwiQ3JlYXRpb25Sb3ciLCJvQnV0dG9uIiwiZ2V0QWN0aW9ucyIsInJlZHVjZSIsImFBY3Rpb25CdXR0b25zIiwib0FjdGlvblRvb2xiYXJBY3Rpb24iLCJjb25jYXQiLCJnZXRBY3Rpb24iLCJmaW5kIiwib0FjdGlvbkJ1dHRvbiIsImVuZHNXaXRoIiwib0NyZWF0aW9uUm93IiwiZ2V0QWdncmVnYXRpb24iLCJnZXRBcHBseUVuYWJsZWQiLCJnZXRWaXNpYmxlIiwiZmlyZUFwcGx5Iiwic2V0Q29udGV4dHMiLCJvVGFibGUiLCJzRGVsZXRhYmxlUGF0aCIsIm9EcmFmdCIsInNDb2xsZWN0aW9uIiwic05hdmlnYXRpb25BdmFpbGFibGVNYXAiLCJzQWN0aW9uc011bHRpc2VsZWN0RGlzYWJsZWQiLCJzVXBkYXRhYmxlUGF0aCIsImFBY3Rpb25zTXVsdGlzZWxlY3REaXNhYmxlZCIsInNwbGl0Iiwib0FjdGlvbk9wZXJhdGlvbkF2YWlsYWJsZU1hcCIsIkpTT04iLCJwYXJzZSIsIm9OYXZpZ2F0aW9uQXZhaWxhYmxlTWFwIiwiYVNlbGVjdGVkQ29udGV4dHMiLCJnZXRTZWxlY3RlZENvbnRleHRzIiwiaXNEZWxldGFibGUiLCJhRGVsZXRhYmxlQ29udGV4dHMiLCJiUmVhZE9ubHlEcmFmdEVuYWJsZWQiLCJkYXRhIiwiYVVwZGF0YWJsZUNvbnRleHRzIiwiYVVuc2F2ZWRDb250ZXh0cyIsImFMb2NrZWRDb250ZXh0cyIsIm9EeW5hbWljQWN0aW9ucyIsIm9JQk4iLCJvTG9ja2VkQW5kVW5zYXZlZENvbnRleHRzIiwib01vZGVsT2JqZWN0Iiwib0ludGVybmFsTW9kZWxDb250ZXh0IiwiZ2V0QmluZGluZ0NvbnRleHQiLCJmaWx0ZXIiLCJvQ29udGV4dCIsImlzSW5hY3RpdmUiLCJzZXRQcm9wZXJ0eSIsIk9iamVjdCIsImFzc2lnbiIsImdldE9iamVjdCIsInNlbGVjdGVkQ29udGV4dHMiLCJudW1iZXJPZlNlbGVjdGVkQ29udGV4dHMiLCJsZW5ndGgiLCJkeW5hbWljQWN0aW9ucyIsImlibiIsImRlbGV0ZUVuYWJsZWQiLCJkZWxldGFibGVDb250ZXh0cyIsInVuU2F2ZWRDb250ZXh0cyIsImxvY2tlZENvbnRleHRzIiwidXBkYXRhYmxlQ29udGV4dHMiLCJzZW1hbnRpY0tleUhhc0RyYWZ0SW5kaWNhdG9yIiwiZ2V0UHJvcGVydHkiLCJ1bmRlZmluZWQiLCJpIiwib1NlbGVjdGVkQ29udGV4dCIsIm9Db250ZXh0RGF0YSIsImtleSIsImluZGV4T2YiLCJzQWN0aW9uUGF0aCIsInN1YnN0cmluZyIsImVuYWJsZWQiLCJJc0FjdGl2ZUVudGl0eSIsIkhhc0RyYWZ0RW50aXR5IiwiZ2V0VW5zYXZlZEFuZExvY2tlZENvbnRleHRzIiwicHVzaCIsImJVcGRhdGFibGVCeVBhdGgiLCJiTm90RHJhZnRJblJlYWRPbmx5TW9kZSIsIkRyYWZ0QWRtaW5pc3RyYXRpdmVEYXRhIiwiSW5Qcm9jZXNzQnlVc2VyIiwiVGFibGVIZWxwZXIiLCJzZXRJQk5FbmFibGVtZW50IiwiZGlzYWJsZUFjdGlvbiIsIkFjdGlvblJ1bnRpbWUiLCJzZXRBY3Rpb25FbmFibGVtZW50IiwiZm9yRWFjaCIsInNBY3Rpb24iLCJiRW5hYmxlZCIsIm9uRmllbGRDaGFuZ2VJbkNyZWF0aW9uUm93Iiwib0N1c3RvbVZhbGlkYXRpb25GdW5jdGlvbiIsIm1GaWVsZCIsIkZpZWxkUnVudGltZSIsImdldEZpZWxkU3RhdGVPbkNoYW5nZSIsIm9Tb3VyY2VGaWVsZCIsImZpZWxkIiwic0ZpZWxkSWQiLCJtRmllbGRWYWxpZGl0eSIsIm1OZXdGaWVsZFZhbGlkaXR5Iiwic3RhdGUiLCJtQ3VzdG9tVmFsaWRpdHkiLCJtTmV3Q3VzdG9tVmFsaWRpdHkiLCJnZXRCaW5kaW5nIiwiZ2V0UGF0aCIsImZpZWxkSWQiLCJvTWVzc2FnZU1hbmFnZXIiLCJnZXRNZXNzYWdlTWFuYWdlciIsInNUYXJnZXQiLCJnZXRCaW5kaW5nUGF0aCIsImdldE1lc3NhZ2VNb2RlbCIsImdldERhdGEiLCJvTWVzc2FnZSIsInRhcmdldCIsInJlbW92ZU1lc3NhZ2VzIl0sInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyJUYWJsZVJ1bnRpbWUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEFjdGlvblJ1bnRpbWUgZnJvbSBcInNhcC9mZS9jb3JlL0FjdGlvblJ1bnRpbWVcIjtcbmltcG9ydCBDb21tb25VdGlscyBmcm9tIFwic2FwL2ZlL2NvcmUvQ29tbW9uVXRpbHNcIjtcbmltcG9ydCBGRUxpYnJhcnkgZnJvbSBcInNhcC9mZS9jb3JlL2xpYnJhcnlcIjtcbmltcG9ydCBGaWVsZFJ1bnRpbWUgZnJvbSBcInNhcC9mZS9tYWNyb3MvZmllbGQvRmllbGRSdW50aW1lXCI7XG5pbXBvcnQgVGFibGVIZWxwZXIgZnJvbSBcInNhcC9mZS9tYWNyb3MvdGFibGUvVGFibGVIZWxwZXJcIjtcbmltcG9ydCB0eXBlIENvbnRleHQgZnJvbSBcInNhcC91aS9tb2RlbC9vZGF0YS92NC9Db250ZXh0XCI7XG5cbmNvbnN0IENyZWF0aW9uTW9kZSA9IEZFTGlicmFyeS5DcmVhdGlvbk1vZGU7XG4vKipcbiAqIFN0YXRpYyBjbGFzcyB1c2VkIGJ5IFRhYmxlIGJ1aWxkaW5nIGJsb2NrIGR1cmluZyBydW50aW1lXG4gKlxuICogQHByaXZhdGVcbiAqIEBleHBlcmltZW50YWwgVGhpcyBtb2R1bGUgaXMgb25seSBmb3IgaW50ZXJuYWwvZXhwZXJpbWVudGFsIHVzZSFcbiAqL1xuY29uc3QgVGFibGVSdW50aW1lID0ge1xuXHRkaXNwbGF5VGFibGVTZXR0aW5nczogZnVuY3Rpb24gKG9FdmVudDogYW55KSB7XG5cdFx0Lypcblx0XHRcdFx0IFRlbXBvcmFyeSBzb2x1dGlvblxuXHRcdFx0XHQgV2FpdCBmb3IgbWRjIFRhYmxlIHRvIHByb3ZpZGUgcHVibGljIGFwaSB0byBlaXRoZXIgZ2V0IGJ1dHRvbiAnU2V0dGluZ3MnIG9yIGZpcmUgZXZlbnQgb24gdGhpcyBidXR0b25cblx0XHRcdFx0ICovXG5cdFx0Y29uc3Qgb1BhcmVudCA9IG9FdmVudC5nZXRTb3VyY2UoKS5nZXRQYXJlbnQoKSxcblx0XHRcdG9TZXR0aW5nc0J1dHRvbiA9IHNhcC51aS5nZXRDb3JlKCkuYnlJZChgJHtvUGFyZW50LmdldElkKCl9LXNldHRpbmdzYCk7XG5cdFx0Q29tbW9uVXRpbHMuZmlyZUJ1dHRvblByZXNzKG9TZXR0aW5nc0J1dHRvbik7XG5cdH0sXG5cdGV4ZWN1dGVDb25kaXRpb25hbEFjdGlvblNob3J0Y3V0OiBmdW5jdGlvbiAoc0J1dHRvbk1hdGNoZXI6IGFueSwgb1NvdXJjZTogYW55KSB7XG5cdFx0Ly8gR2V0IHRoZSBidXR0b24gcmVsYXRlZCB0byBrZXlib2FyZCBzaG9ydGN1dFxuXHRcdGNvbnN0IG9NZGNUYWJsZSA9IG9Tb3VyY2UuZ2V0UGFyZW50KCk7XG5cdFx0aWYgKHNCdXR0b25NYXRjaGVyICE9PSBDcmVhdGlvbk1vZGUuQ3JlYXRpb25Sb3cpIHtcblx0XHRcdGNvbnN0IG9CdXR0b24gPSBvTWRjVGFibGVcblx0XHRcdFx0LmdldEFjdGlvbnMoKVxuXHRcdFx0XHQucmVkdWNlKGZ1bmN0aW9uIChhQWN0aW9uQnV0dG9uczogYW55LCBvQWN0aW9uVG9vbGJhckFjdGlvbjogYW55KSB7XG5cdFx0XHRcdFx0cmV0dXJuIGFBY3Rpb25CdXR0b25zLmNvbmNhdChvQWN0aW9uVG9vbGJhckFjdGlvbi5nZXRBY3Rpb24oKSk7XG5cdFx0XHRcdH0sIFtdKVxuXHRcdFx0XHQuZmluZChmdW5jdGlvbiAob0FjdGlvbkJ1dHRvbjogYW55KSB7XG5cdFx0XHRcdFx0cmV0dXJuIG9BY3Rpb25CdXR0b24uZ2V0SWQoKS5lbmRzV2l0aChzQnV0dG9uTWF0Y2hlcik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0Q29tbW9uVXRpbHMuZmlyZUJ1dHRvblByZXNzKG9CdXR0b24pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCBvQ3JlYXRpb25Sb3cgPSBvTWRjVGFibGUuZ2V0QWdncmVnYXRpb24oXCJjcmVhdGlvblJvd1wiKTtcblx0XHRcdGlmIChvQ3JlYXRpb25Sb3cgJiYgb0NyZWF0aW9uUm93LmdldEFwcGx5RW5hYmxlZCgpICYmIG9DcmVhdGlvblJvdy5nZXRWaXNpYmxlKCkpIHtcblx0XHRcdFx0b0NyZWF0aW9uUm93LmZpcmVBcHBseSgpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblx0c2V0Q29udGV4dHM6IGZ1bmN0aW9uIChcblx0XHRvVGFibGU6IGFueSxcblx0XHRzRGVsZXRhYmxlUGF0aDogYW55LFxuXHRcdG9EcmFmdDogYW55LFxuXHRcdHNDb2xsZWN0aW9uOiBhbnksXG5cdFx0c05hdmlnYXRpb25BdmFpbGFibGVNYXA6IGFueSxcblx0XHRzQWN0aW9uc011bHRpc2VsZWN0RGlzYWJsZWQ6IGFueSxcblx0XHRzVXBkYXRhYmxlUGF0aDogYW55XG5cdCkge1xuXHRcdGNvbnN0IGFBY3Rpb25zTXVsdGlzZWxlY3REaXNhYmxlZCA9IHNBY3Rpb25zTXVsdGlzZWxlY3REaXNhYmxlZCA/IHNBY3Rpb25zTXVsdGlzZWxlY3REaXNhYmxlZC5zcGxpdChcIixcIikgOiBbXTtcblx0XHRjb25zdCBvQWN0aW9uT3BlcmF0aW9uQXZhaWxhYmxlTWFwID0gSlNPTi5wYXJzZShzQ29sbGVjdGlvbik7XG5cdFx0Y29uc3Qgb05hdmlnYXRpb25BdmFpbGFibGVNYXAgPVxuXHRcdFx0c05hdmlnYXRpb25BdmFpbGFibGVNYXAgJiYgc05hdmlnYXRpb25BdmFpbGFibGVNYXAgIT09IFwidW5kZWZpbmVkXCIgJiYgSlNPTi5wYXJzZShzTmF2aWdhdGlvbkF2YWlsYWJsZU1hcCk7XG5cdFx0bGV0IGFTZWxlY3RlZENvbnRleHRzID0gb1RhYmxlLmdldFNlbGVjdGVkQ29udGV4dHMoKTtcblx0XHRsZXQgaXNEZWxldGFibGUgPSBmYWxzZTtcblx0XHRjb25zdCBhRGVsZXRhYmxlQ29udGV4dHMgPSBbXTtcblx0XHRjb25zdCBiUmVhZE9ubHlEcmFmdEVuYWJsZWQgPSBvVGFibGUuZGF0YShcImRpc3BsYXlNb2RlUHJvcGVydHlCaW5kaW5nXCIpID09PSBcInRydWVcIiAmJiBvRHJhZnQgIT09IFwidW5kZWZpbmVkXCI7XG5cdFx0Y29uc3QgYVVwZGF0YWJsZUNvbnRleHRzID0gW107XG5cdFx0Y29uc3QgYVVuc2F2ZWRDb250ZXh0czogYW55W10gPSBbXTtcblx0XHRjb25zdCBhTG9ja2VkQ29udGV4dHM6IGFueVtdID0gW107XG5cdFx0Ly8gb0R5bmFtaWNBY3Rpb25zIGFyZSBib3VuZCBhY3Rpb25zIHRoYXQgYXJlIGF2YWlsYWJsZSBhY2NvcmRpbmcgdG8gc29tZSBwcm9wZXJ0eVxuXHRcdC8vIGluIGVhY2ggaXRlbVxuXHRcdGNvbnN0IG9EeW5hbWljQWN0aW9ucyA9IHt9O1xuXHRcdGNvbnN0IG9JQk4gPSB7fTtcblx0XHRsZXQgb0xvY2tlZEFuZFVuc2F2ZWRDb250ZXh0czogYW55ID0ge307XG5cdFx0bGV0IG9Nb2RlbE9iamVjdDtcblx0XHRjb25zdCBvSW50ZXJuYWxNb2RlbENvbnRleHQgPSBvVGFibGUuZ2V0QmluZGluZ0NvbnRleHQoXCJpbnRlcm5hbFwiKTtcblxuXHRcdG9Mb2NrZWRBbmRVbnNhdmVkQ29udGV4dHMuYVVuc2F2ZWRDb250ZXh0cyA9IFtdO1xuXHRcdG9Mb2NrZWRBbmRVbnNhdmVkQ29udGV4dHMuYUxvY2tlZENvbnRleHRzID0gW107XG5cblx0XHQvL2RvIG5vdCBjb25zaWRlciBlbXB0eSByb3dzIGFzIHNlbGVjdGVkIGNvbnRleHRcblx0XHRhU2VsZWN0ZWRDb250ZXh0cyA9IGFTZWxlY3RlZENvbnRleHRzLmZpbHRlcihmdW5jdGlvbiAob0NvbnRleHQ6IENvbnRleHQpIHtcblx0XHRcdHJldHVybiAhb0NvbnRleHQuaXNJbmFjdGl2ZSgpO1xuXHRcdH0pO1xuXG5cdFx0b0ludGVybmFsTW9kZWxDb250ZXh0LnNldFByb3BlcnR5KFxuXHRcdFx0XCJcIixcblx0XHRcdE9iamVjdC5hc3NpZ24ob0ludGVybmFsTW9kZWxDb250ZXh0LmdldE9iamVjdCgpLCB7XG5cdFx0XHRcdHNlbGVjdGVkQ29udGV4dHM6IGFTZWxlY3RlZENvbnRleHRzLFxuXHRcdFx0XHRudW1iZXJPZlNlbGVjdGVkQ29udGV4dHM6IGFTZWxlY3RlZENvbnRleHRzLmxlbmd0aCxcblx0XHRcdFx0ZHluYW1pY0FjdGlvbnM6IG9EeW5hbWljQWN0aW9ucyxcblx0XHRcdFx0aWJuOiBvSUJOLFxuXHRcdFx0XHRkZWxldGVFbmFibGVkOiB0cnVlLFxuXHRcdFx0XHRkZWxldGFibGVDb250ZXh0czogW10sXG5cdFx0XHRcdHVuU2F2ZWRDb250ZXh0czogW10sXG5cdFx0XHRcdGxvY2tlZENvbnRleHRzOiBbXSxcblx0XHRcdFx0dXBkYXRhYmxlQ29udGV4dHM6IFtdLFxuXHRcdFx0XHRzZW1hbnRpY0tleUhhc0RyYWZ0SW5kaWNhdG9yOiBvSW50ZXJuYWxNb2RlbENvbnRleHQuZ2V0UHJvcGVydHkoXCJzZW1hbnRpY0tleUhhc0RyYWZ0SW5kaWNhdG9yXCIpXG5cdFx0XHRcdFx0PyBvSW50ZXJuYWxNb2RlbENvbnRleHQuZ2V0UHJvcGVydHkoXCJzZW1hbnRpY0tleUhhc0RyYWZ0SW5kaWNhdG9yXCIpXG5cdFx0XHRcdFx0OiB1bmRlZmluZWRcblx0XHRcdH0pXG5cdFx0KTtcblxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgYVNlbGVjdGVkQ29udGV4dHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdGNvbnN0IG9TZWxlY3RlZENvbnRleHQgPSBhU2VsZWN0ZWRDb250ZXh0c1tpXTtcblx0XHRcdGNvbnN0IG9Db250ZXh0RGF0YSA9IG9TZWxlY3RlZENvbnRleHQuZ2V0T2JqZWN0KCk7XG5cdFx0XHRmb3IgKGNvbnN0IGtleSBpbiBvQ29udGV4dERhdGEpIHtcblx0XHRcdFx0aWYgKGtleS5pbmRleE9mKFwiI1wiKSA9PT0gMCkge1xuXHRcdFx0XHRcdGxldCBzQWN0aW9uUGF0aCA9IGtleTtcblx0XHRcdFx0XHRzQWN0aW9uUGF0aCA9IHNBY3Rpb25QYXRoLnN1YnN0cmluZygxLCBzQWN0aW9uUGF0aC5sZW5ndGgpO1xuXHRcdFx0XHRcdG9Nb2RlbE9iamVjdCA9IG9JbnRlcm5hbE1vZGVsQ29udGV4dC5nZXRPYmplY3QoKTtcblx0XHRcdFx0XHRvTW9kZWxPYmplY3QuZHluYW1pY0FjdGlvbnNbc0FjdGlvblBhdGhdID0geyBlbmFibGVkOiB0cnVlIH07XG5cdFx0XHRcdFx0b0ludGVybmFsTW9kZWxDb250ZXh0LnNldFByb3BlcnR5KFwiXCIsIG9Nb2RlbE9iamVjdCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdG9Nb2RlbE9iamVjdCA9IG9JbnRlcm5hbE1vZGVsQ29udGV4dC5nZXRPYmplY3QoKTtcblx0XHRcdGlmIChzRGVsZXRhYmxlUGF0aCAhPSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRcdGlmIChvU2VsZWN0ZWRDb250ZXh0ICYmIG9TZWxlY3RlZENvbnRleHQuZ2V0UHJvcGVydHkoc0RlbGV0YWJsZVBhdGgpKSB7XG5cdFx0XHRcdFx0aWYgKG9EcmFmdCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBvQ29udGV4dERhdGEuSXNBY3RpdmVFbnRpdHkgPT09IHRydWUgJiYgb0NvbnRleHREYXRhLkhhc0RyYWZ0RW50aXR5ID09PSB0cnVlKSB7XG5cdFx0XHRcdFx0XHRvTG9ja2VkQW5kVW5zYXZlZENvbnRleHRzID0gZ2V0VW5zYXZlZEFuZExvY2tlZENvbnRleHRzKG9Db250ZXh0RGF0YSwgb1NlbGVjdGVkQ29udGV4dCk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGFEZWxldGFibGVDb250ZXh0cy5wdXNoKG9TZWxlY3RlZENvbnRleHQpO1xuXHRcdFx0XHRcdFx0b0xvY2tlZEFuZFVuc2F2ZWRDb250ZXh0cy5pc0RlbGV0YWJsZSA9IHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdG9Nb2RlbE9iamVjdFtcImRlbGV0ZUVuYWJsZWRcIl0gPSBvTG9ja2VkQW5kVW5zYXZlZENvbnRleHRzLmlzRGVsZXRhYmxlO1xuXHRcdFx0fSBlbHNlIGlmIChvRHJhZnQgIT09IFwidW5kZWZpbmVkXCIgJiYgb0NvbnRleHREYXRhLklzQWN0aXZlRW50aXR5ID09PSB0cnVlICYmIG9Db250ZXh0RGF0YS5IYXNEcmFmdEVudGl0eSA9PT0gdHJ1ZSkge1xuXHRcdFx0XHRvTG9ja2VkQW5kVW5zYXZlZENvbnRleHRzID0gZ2V0VW5zYXZlZEFuZExvY2tlZENvbnRleHRzKG9Db250ZXh0RGF0YSwgb1NlbGVjdGVkQ29udGV4dCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRhRGVsZXRhYmxlQ29udGV4dHMucHVzaChvU2VsZWN0ZWRDb250ZXh0KTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gVGhlIHVwZGF0YWJsZSBjb250ZXh0cyB3aXRoIG1hc3MgZWRpdCBkZXBlbmQgb24gdGhlIGZvbGxvd2luZzpcblx0XHRcdC8vIDEuIFVwZGF0ZSBpcyBkZXBlbmRlbmRlbnQgb24gY3VycmVudCBlbnRpdHkgcHJvcGVydHkgKHNVcGRhdGFibGVQYXRoKS5cblx0XHRcdC8vIDIuIFRoZSB0YWJsZSBpcyByZWFkIG9ubHkgYW5kIGRyYWZ0IGVuYWJsZWQobGlrZSBMUiksIGluIHRoaXMgY2FzZSBvbmx5IGFjdGl2ZSBjb250ZXh0cyBjYW4gYmUgbWFzcyBlZGl0ZWQobm90IGRyYWZ0IGNvbnRleHRzKS5cblx0XHRcdC8vICAgIFNvLCB1cGRhdGUgZGVwZW5kcyBvbiAnSXNBY3RpdmVFbnRpdHknIHZhbHVlIHdoaWNoIG5lZWRzIHRvIGJlIGNoZWNrZWQuXG5cdFx0XHRjb25zdCBiVXBkYXRhYmxlQnlQYXRoID0gc1VwZGF0YWJsZVBhdGgubGVuZ3RoID09PSAwIHx8ICEhb1NlbGVjdGVkQ29udGV4dC5nZXRQcm9wZXJ0eShzVXBkYXRhYmxlUGF0aCk7XG5cdFx0XHRjb25zdCBiTm90RHJhZnRJblJlYWRPbmx5TW9kZSA9ICFiUmVhZE9ubHlEcmFmdEVuYWJsZWQgfHwgb0NvbnRleHREYXRhLklzQWN0aXZlRW50aXR5O1xuXHRcdFx0aWYgKGJVcGRhdGFibGVCeVBhdGggJiYgYk5vdERyYWZ0SW5SZWFkT25seU1vZGUpIHtcblx0XHRcdFx0YVVwZGF0YWJsZUNvbnRleHRzLnB1c2gob1NlbGVjdGVkQ29udGV4dCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gZ2V0VW5zYXZlZEFuZExvY2tlZENvbnRleHRzKG9Db250ZXh0RGF0YTogYW55LCBvU2VsZWN0ZWRDb250ZXh0OiBhbnkpIHtcblx0XHRcdGlmIChvQ29udGV4dERhdGEuRHJhZnRBZG1pbmlzdHJhdGl2ZURhdGEuSW5Qcm9jZXNzQnlVc2VyKSB7XG5cdFx0XHRcdGFMb2NrZWRDb250ZXh0cy5wdXNoKG9TZWxlY3RlZENvbnRleHQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0YVVuc2F2ZWRDb250ZXh0cy5wdXNoKG9TZWxlY3RlZENvbnRleHQpO1xuXHRcdFx0XHRpc0RlbGV0YWJsZSA9IHRydWU7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRhTG9ja2VkQ29udGV4dHM6IGFMb2NrZWRDb250ZXh0cyxcblx0XHRcdFx0YVVuc2F2ZWRDb250ZXh0czogYVVuc2F2ZWRDb250ZXh0cyxcblx0XHRcdFx0aXNEZWxldGFibGU6IGlzRGVsZXRhYmxlXG5cdFx0XHR9O1xuXHRcdH1cblxuXHRcdGlmICghb1RhYmxlLmRhdGEoXCJlbmFibGVBbmFseXRpY3NcIikpIHtcblx0XHRcdFRhYmxlSGVscGVyLnNldElCTkVuYWJsZW1lbnQob0ludGVybmFsTW9kZWxDb250ZXh0LCBvTmF2aWdhdGlvbkF2YWlsYWJsZU1hcCwgYVNlbGVjdGVkQ29udGV4dHMpO1xuXHRcdH1cblxuXHRcdGlmIChhU2VsZWN0ZWRDb250ZXh0cy5sZW5ndGggPiAxKSB7XG5cdFx0XHR0aGlzLmRpc2FibGVBY3Rpb24oYUFjdGlvbnNNdWx0aXNlbGVjdERpc2FibGVkLCBvRHluYW1pY0FjdGlvbnMpO1xuXHRcdH1cblxuXHRcdGlmIChvTW9kZWxPYmplY3QpIHtcblx0XHRcdG9Nb2RlbE9iamVjdFtcImRlbGV0YWJsZUNvbnRleHRzXCJdID0gYURlbGV0YWJsZUNvbnRleHRzO1xuXHRcdFx0b01vZGVsT2JqZWN0W1widXBkYXRhYmxlQ29udGV4dHNcIl0gPSBhVXBkYXRhYmxlQ29udGV4dHM7XG5cdFx0XHRvTW9kZWxPYmplY3RbXCJ1blNhdmVkQ29udGV4dHNcIl0gPSBvTG9ja2VkQW5kVW5zYXZlZENvbnRleHRzLmFVbnNhdmVkQ29udGV4dHM7XG5cdFx0XHRvTW9kZWxPYmplY3RbXCJsb2NrZWRDb250ZXh0c1wiXSA9IG9Mb2NrZWRBbmRVbnNhdmVkQ29udGV4dHMuYUxvY2tlZENvbnRleHRzO1xuXHRcdFx0b01vZGVsT2JqZWN0W1wiY29udHJvbElkXCJdID0gb1RhYmxlLmdldElkKCk7XG5cdFx0XHRvSW50ZXJuYWxNb2RlbENvbnRleHQuc2V0UHJvcGVydHkoXCJcIiwgb01vZGVsT2JqZWN0KTtcblx0XHR9XG5cblx0XHRyZXR1cm4gQWN0aW9uUnVudGltZS5zZXRBY3Rpb25FbmFibGVtZW50KG9JbnRlcm5hbE1vZGVsQ29udGV4dCwgb0FjdGlvbk9wZXJhdGlvbkF2YWlsYWJsZU1hcCwgYVNlbGVjdGVkQ29udGV4dHMsIFwidGFibGVcIik7XG5cdH0sXG5cdGRpc2FibGVBY3Rpb246IGZ1bmN0aW9uIChhQWN0aW9uc011bHRpc2VsZWN0RGlzYWJsZWQ6IGFueSwgb0R5bmFtaWNBY3Rpb25zOiBhbnkpIHtcblx0XHRhQWN0aW9uc011bHRpc2VsZWN0RGlzYWJsZWQuZm9yRWFjaChmdW5jdGlvbiAoc0FjdGlvbjogYW55KSB7XG5cdFx0XHRvRHluYW1pY0FjdGlvbnNbc0FjdGlvbl0gPSB7IGJFbmFibGVkOiBmYWxzZSB9O1xuXHRcdH0pO1xuXHR9LFxuXHRvbkZpZWxkQ2hhbmdlSW5DcmVhdGlvblJvdzogZnVuY3Rpb24gKG9FdmVudDogYW55LCBvQ3VzdG9tVmFsaWRhdGlvbkZ1bmN0aW9uOiBhbnkpIHtcblx0XHQvLyBDUkVBVElPTiBST1cgQ0FTRVxuXHRcdGNvbnN0IG1GaWVsZCA9IEZpZWxkUnVudGltZS5nZXRGaWVsZFN0YXRlT25DaGFuZ2Uob0V2ZW50KSxcblx0XHRcdG9Tb3VyY2VGaWVsZCA9IG1GaWVsZC5maWVsZCxcblx0XHRcdHNGaWVsZElkID0gb1NvdXJjZUZpZWxkLmdldElkKCk7XG5cblx0XHRjb25zdCBvSW50ZXJuYWxNb2RlbENvbnRleHQgPSBvU291cmNlRmllbGQuZ2V0QmluZGluZ0NvbnRleHQoXCJpbnRlcm5hbFwiKSxcblx0XHRcdG1GaWVsZFZhbGlkaXR5ID0gb0ludGVybmFsTW9kZWxDb250ZXh0LmdldFByb3BlcnR5KFwiY3JlYXRpb25Sb3dGaWVsZFZhbGlkaXR5XCIpLFxuXHRcdFx0bU5ld0ZpZWxkVmFsaWRpdHkgPSBPYmplY3QuYXNzaWduKHt9LCBtRmllbGRWYWxpZGl0eSk7XG5cblx0XHRtTmV3RmllbGRWYWxpZGl0eVtzRmllbGRJZF0gPSBtRmllbGQuc3RhdGU7XG5cdFx0b0ludGVybmFsTW9kZWxDb250ZXh0LnNldFByb3BlcnR5KFwiY3JlYXRpb25Sb3dGaWVsZFZhbGlkaXR5XCIsIG1OZXdGaWVsZFZhbGlkaXR5KTtcblxuXHRcdC8vIHByZXBhcmUgQ3VzdG9tIFZhbGlkYXRpb25cblx0XHRpZiAob0N1c3RvbVZhbGlkYXRpb25GdW5jdGlvbikge1xuXHRcdFx0Y29uc3QgbUN1c3RvbVZhbGlkaXR5ID0gb0ludGVybmFsTW9kZWxDb250ZXh0LmdldFByb3BlcnR5KFwiY3JlYXRpb25Sb3dDdXN0b21WYWxpZGl0eVwiKSxcblx0XHRcdFx0bU5ld0N1c3RvbVZhbGlkaXR5ID0gT2JqZWN0LmFzc2lnbih7fSwgbUN1c3RvbVZhbGlkaXR5KTtcblx0XHRcdG1OZXdDdXN0b21WYWxpZGl0eVtvU291cmNlRmllbGQuZ2V0QmluZGluZyhcInZhbHVlXCIpLmdldFBhdGgoKV0gPSB7XG5cdFx0XHRcdGZpZWxkSWQ6IG9Tb3VyY2VGaWVsZC5nZXRJZCgpXG5cdFx0XHR9O1xuXHRcdFx0b0ludGVybmFsTW9kZWxDb250ZXh0LnNldFByb3BlcnR5KFwiY3JlYXRpb25Sb3dDdXN0b21WYWxpZGl0eVwiLCBtTmV3Q3VzdG9tVmFsaWRpdHkpO1xuXHRcdFx0Ly8gUmVtb3ZlIGV4aXN0aW5nIEN1c3RvbVZhbGlkYXRpb24gbWVzc2FnZVxuXHRcdFx0Y29uc3Qgb01lc3NhZ2VNYW5hZ2VyID0gc2FwLnVpLmdldENvcmUoKS5nZXRNZXNzYWdlTWFuYWdlcigpO1xuXHRcdFx0Y29uc3Qgc1RhcmdldCA9IGAke29Tb3VyY2VGaWVsZC5nZXRCaW5kaW5nQ29udGV4dCgpLmdldFBhdGgoKX0vJHtvU291cmNlRmllbGQuZ2V0QmluZGluZ1BhdGgoXCJ2YWx1ZVwiKX1gO1xuXHRcdFx0b01lc3NhZ2VNYW5hZ2VyXG5cdFx0XHRcdC5nZXRNZXNzYWdlTW9kZWwoKVxuXHRcdFx0XHQuZ2V0RGF0YSgpXG5cdFx0XHRcdC5mb3JFYWNoKGZ1bmN0aW9uIChvTWVzc2FnZTogYW55KSB7XG5cdFx0XHRcdFx0aWYgKG9NZXNzYWdlLnRhcmdldCA9PT0gc1RhcmdldCkge1xuXHRcdFx0XHRcdFx0b01lc3NhZ2VNYW5hZ2VyLnJlbW92ZU1lc3NhZ2VzKG9NZXNzYWdlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdH1cblx0fVxufTtcblxuZXhwb3J0IGRlZmF1bHQgVGFibGVSdW50aW1lO1xuIl0sIm1hcHBpbmdzIjoiO0FBQUE7QUFBQTtBQUFBOzs7O0VBT0EsSUFBTUEsWUFBWSxHQUFHQyxTQUFTLENBQUNELFlBQVk7RUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0VBQ0EsSUFBTUUsWUFB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