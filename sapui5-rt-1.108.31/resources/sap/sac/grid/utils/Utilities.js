/*
 * SAPUI5
  (c) Copyright 2009-2020 SAP SE. All rights reserved
 */
sap.ui.define(["sap/sac/grid/Format","sap/sac/grid/utils/ModelHelper","sap/ui/core/theming/Parameters"],function(e,t,a){"use strict";var r=function(){var r=this;r.cellTypeMapping=function(e,a){var r;switch(e){case"Title":r="RowDimHeader";break;case"Header":r="RowDimMember";break;case"Result":case"Standard":r=a?"ColDimHeader":"ColDimMember";break;default:r=a?"ColDimHeader":"ColDimMember"}return t.fetchSACTableCellTypeEnum(r)};function o(e){var t=e.displayText;var a=document.createElement("canvas");var r=a.getContext("2d");if(e.isBold){r.font="bold 16px arial"}else{r.font="16px arial"}return r.measureText(t)}function n(e){var t=e.width;if(e.actualBoundingBoxLeft!==undefined&&e.actualBoundingBoxRight!==undefined){t=Math.abs(e.actualBoundingBoxLeft)+Math.abs(e.actualBoundingBoxRight)}return Math.ceil(t)}r.calculateColumnWidth=function(e){var t=o(e);return n(t)+e.hierarchyPaddingLeft};r.decideWidgetDimensions=function(e,t,a){var r=0,o=0;var n=e._isExcelStyle();var i=t.columnSettings&&t.columnSettings.length;var l=t.columnSettings;r=this.calculateTotalWidth(i,l,n);var s=t.rows&&t.rows.length;var c=e._completeRowHeight();o=this.calculateTotalHeight(s,c,n);var u=this.getAnchorDimensions(e,a);var d=this.getReactTableComponentOfGrid(e);if(d){jQuery(d).css("height",u.anchorHeight)}t.widgetWidth=u.anchorWidth;t.widgetHeight=u.anchorHeight;t.totalHeight=o;t.totalWidth=r};r.getAnchorDimensions=function(e,t){var a=e.AnchorElement?e.AnchorElement:e;var r,o;if(a&&a.getDomRef){var n=jQuery(a.getDomRef());r=n.width();o=n.height()}var i=e.AnchorDimensions?e.AnchorDimensions:{anchorWidth:0,anchorHeight:0};if(!t){o=i.anchorHeight>o?i.anchorHeight:o}e.AnchorDimensions={anchorWidth:r,anchorHeight:o};return e.AnchorDimensions};r.calculateTotalHeight=function(e,t,a){if(a){return e*(t+1)}else{return e*t}};r.calculateTotalWidth=function(e,t,a){var r=0;t.forEach(function(e){r=r+e.width});if(a){return r+e*1}else{return r}};r.updateTableData=function(e,t){if(e.mSacTable){var a=function(){document.getElementById(e.getId()).appendChild(e.reactTableContainer);e.mSacTable.reapplyScrollPosition();var t=e.AnchorDimensions;var a=r.getReactTableComponentOfGrid(e);if(a&&t){jQuery(a).css("height",t.anchorHeight)}};var o=t?t:e.mSacTable.cachedData;e.mSacTable.updateTableData(o,a)}};r.getDrillState=function(e){var t;if(e=="sap-icon://slim-arrow-down"||e=="sap-icon://slim-arrow-up"){t="Expanded"}else if(e=="sap-icon://slim-arrow-right"){t="Collapsed"}return t};r.getHierarchyInfo=function(a,r,o,n,i,l){var s=r.getRow();var c=r.getColumn();var u=r.getDisplayValue();var d=0;var h=r.data();var f=t.fetchCellHierarchyProperties(s,c,u);var g=r.getIcon();var m=this.getDrillState(g);var v=r.getDisplayLevel();f["expanded"]=m==="Expanded"?true:false;f["showDrillIcon"]=typeof g!="undefined"&&g!=""?true:false;f["level"]=v;f["isInATotalsContext"]=f["showDrillIcon"];if(f["showDrillIcon"]&&s>=i){f["isInATotalsContext"]=true;f["showStyleLinesForDataLevel"]=true}else{for(d=0;d<n;d++){if(o[s][d]&&o[s][d].isInATotalsContext&&!o[s][d].isOverallResults){f["isInATotalsContext"]=true;f["level"]=o[s][d].level;f["showStyleLinesForDataLevel"]=true;break}}}f["hierarchyPaddingLeft"]=v===0?8:2*v*8;f["isInHierarchy"]=v===0?false:true;if(a==e.BusinessStyle){var C=h["cellDimension"]=="NonMeasureStructure";if(C){f["isInATotalsContext"]=true}}var p=h["cellMember"];if(p&&(p.toLowerCase()=="total"||p=="!SUMME")){f["isInATotalsContext"]=true;f["isOverallResults"]=true;if(s<i){l["columns"].push(c)}else{l["rows"].push(s)}}else{f["isOverallResults"]=l["columns"].includes(c)||l["rows"].includes(s);f["isInATotalsContext"]=f["isInATotalsContext"]?f["isInATotalsContext"]:f["isOverallResults"]}return f};r.fillMissingIndexes=function(e,r){var o=e._getFormat();var n=e.getFixedRows();var i=a.get("sapUiListHeaderBackground");for(var l in r){var s=r[l];for(var c=0;c<e.columnCount;c++){if(s[c]==undefined){s[c]=t.getEmptyCellValues(parseInt(l),c,o,n,i)}}}};r.getRowCount=function(e){if(e.rowCount){return e.rowCount}else{var t=e.getFixedRows();var a=e.getVirtualRows();var r=e.getRowLimit();return t+a<r?t+a:r}};r.getMaxRows=function(e){var t=e.getFixedRows();var a=e.getVirtualRows();return t+a};r.getColumnCount=function(e){if(e.columnCount){return e.columnCount}else{var t=e.getFixedColumns();var a=e.getVirtualColumns();var r=e.getColumLimit();return t+a<r?t+a:r}};r.getMaxColumns=function(e){var t=e.getFixedColumns();var a=e.getVirtualColumns();return t+a};r.showNoDataInSacTable=function(e,a){var r=t.getTableModelForNoData(e,a.getId());this.storePropertiesToControl(a,false,0,0,{});this.updateTableData(a,r);this.addRemoveCssClassToReactTable(true,"noDataInTable",a)};r.addRemoveCssClassToReactTable=function(e,t,a){var r=this.getReactTableComponentOfGrid(a);if(e&&r){r.classList.add(t)}else if(r){r.classList.remove(t)}};r.storePropertiesToControl=function(e,t,a,r,o){e.reversedHierarchy=t;e.columnCount=a+1;e.rowCount=r+1;e.gridCells=o};r.addRowsAndColumnSettingsToTableModel=function(e,t,a){var r=e.getRowHeight();var o=e.getFixedRows();if(e.mergeNewDataWithExisitngData){var n=t.rows;var l=this.formTableDataRowsArray(a,r,o);var s=l.splice(0,o);Array.prototype.splice.apply(n,[0,o].concat(s));var c=l[0].row;n.splice(c);t.rows=n.concat(l)}else{t.rows=this.formTableDataRowsArray(a,r,o)}i(t.rows);var u=this.getColumnCount(e);var d=e.getFixedColumns();t.columnSettings=this.formTableDataColumnSettingsArray(t.rows,u,d)};r.formTableDataRowsArray=function(e,t,a){return Object.keys(e).map(function(r,o){return{row:parseInt(r),height:t,cells:e[r],fixed:parseInt(r)<a}})};r.formTableDataColumnSettingsArray=function(e,t,a){return Array.from(Array(t).keys()).map(function(t){return{column:t,minWidth:150,width:e[0].cells[t]?e[0].cells[t].ColumnWidth:150,id:t.toString(),fixed:t<a,hasWrapCell:false,emptyColumn:false}})};function i(e){var a=e[0].cells;for(var r=1;r<e.length;r++){var o=e[r].cells;for(var n=0;n<o.length;n++){var i=o[n];if(!a[n]){a[n]=t.getEmptyCellValues(0,n);a[n].ColumnWidth=150}if(!i.ColumnWidth||i.ColumnWidth>a[n].ColumnWidth){a[n].ColumnWidth=i.ColumnWidth}}}}r.addDataRegionPropertiesToTableModel=function(e,t){t.reversedHierarchy=e.reversedHierarchy;t.dataRegionEndCol=t.columnSettings.length-1;t.dataRegionEndRow=t.rows.length-1;t.lastRowIndex=t.rows.length-1;t.dataRegionStartCol=0;t.dataRegionStartRow=0;t.dataRegionCornerCol=e.getFixedColumns();t.dataRegionCornerRow=e.getFixedRows();t.freezeEndRow=e.getFixedRows()-1;t.freezeEndCol=e.getFixedColumns()-1};r.getReactTableComponentOfGrid=function(e){var t;if(e){var a=e.getDomRef()&&e.getDomRef().getElementsByClassName("reactTableComponent");if(a&&a.length>0){t=a[0]}}return t};r.extractUsefulInfoFromCell=function(e){var t={};t.cellCustomata=jQuery.extend(true,{},e.data());t=Object.assign(t,e.mProperties);t.data=function(e){if(e){return t.cellCustomata[e]}else{return t.cellCustomata}};t.getCellType=function(){return t.cellType};return jQuery.extend(true,{},t)};r.nextBatchDataFetchNeeded=function(e,t){var a=false;var r=e.getFixedRows();var o=e.rowCount-r;var n=o;var i=e._completeRowHeight();var l=Math.ceil(t/i);var s=e.AnchorDimensions&&e.AnchorDimensions.anchorHeight;var c=Math.ceil(s/i);var u=3*c;if(l>n-u){a=true}return a};r.isScrollDown=function(e){var t=e.oldScrollPosition?e.oldScrollPosition:{scrollTop:0,scrollLeft:0};var a=e.mSacTable.scrollPosition?e.mSacTable.scrollPosition:{scrollTop:0,scrollLeft:0};if(t.scrollTop<a.scrollTop){e.oldScrollPosition=e.mSacTable.scrollPosition;return true}e.oldScrollPosition=e.mSacTable.scrollPosition;return false}};return new r});
//# sourceMappingURL=Utilities.js.map