(()=>{"use strict";var e,t={497:(e,t,n)=>{n.r(t),n.d(t,{ReactTable:()=>o});var o=n(166).ReactTable},166:(e,t,n)=>{n.r(t),n.d(t,{ReactTable:()=>Wi});var o,r,i,l,a,s,c,d,h,p,u,f,g,C,v,b,y,m,R,w,S,T,O,D,E,I,A,H,L=n(18),x=n(156),P=n(610),k=n(991),_=n(294),z=n(935),M=n(349),N=n(255),Z=n(70),B=n(608);function j(e){return[v.ColDimMember,v.ColDimHeader,v.AttributeColDimHeader,v.AttributeColDimMember,v.NewLineOnColumn].includes(e)}function W(e){return j(e)||[v.Header,v.AttributeRowDimHeader,v.AttributeRowDimMember,v.RowDimMember,v.RowDimHeader,v.NewLineOnRow].includes(e)}function F(e){return[v.Threshold,v.DataLocking,v.Unbooked,v.Value,v.Comment,v.Chart].includes(e)}function U(e){return V(e)||K(e)||G(e)}function G(e){return e===v.CoordinateCorner}function V(e){return[v.RowCoordinate,v.RowCoordinateSelectedDesignMode,v.RowCoordinateSelectedViewMode].includes(e)}function K(e){return[v.ColumnCoordinate,v.ColumnCoordinateSelectedDesignMode,v.ColumnCoordinateSelectedViewMode].includes(e)}!function(e){e[e.hatching1=1]="hatching1",e[e.hatching2=2]="hatching2",e[e.hatching3=3]="hatching3",e[e.hatching4=4]="hatching4",e[e.hatching5=5]="hatching5",e[e.hatching6=6]="hatching6",e[e.hatching7=7]="hatching7",e[e.hatching8=8]="hatching8",e[e.transparentFill=9]="transparentFill",e[e.solid=10]="solid",e[e.backgroundImage=11]="backgroundImage",e[e.whiteFill=12]="whiteFill"}(o||(o={})),function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.TopBottom=2]="TopBottom",e[e.Left=3]="Left",e[e.Right=4]="Right",e[e.LeftRight=5]="LeftRight",e[e.All=6]="All",e[e.None=7]="None"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Solid=1]="Solid",e[e.Dashed=2]="Dashed",e[e.Dotted=3]="Dotted"}(i||(i={})),function(e){e[e.None=0]="None",e[e.Simple=1]="Simple",e[e.Decoration=2]="Decoration",e[e.Blank=3]="Blank"}(l||(l={})),function(e){e[e.Top=0]="Top",e[e.Middle=1]="Middle",e[e.Bottom=2]="Bottom"}(a||(a={})),function(e){e[e.Left=-1]="Left",e[e.Center=0]="Center",e[e.Right=1]="Right"}(s||(s={})),function(e){e[e.Widget=0]="Widget",e[e.ImageCell=1]="ImageCell",e[e.TitleRegion=2]="TitleRegion",e[e.HeaderRegion=3]="HeaderRegion",e[e.DatacellRegion=4]="DatacellRegion",e[e.Dimension=5]="Dimension",e[e.DimensionMember=6]="DimensionMember",e[e.DataCell=7]="DataCell",e[e.CustomCell=8]="CustomCell",e[e.CellChart=9]="CellChart",e[e.HeaderCell=10]="HeaderCell",e[e.Title=11]="Title",e[e.Subtitle=12]="Subtitle",e[e.Row=13]="Row",e[e.Column=14]="Column",e[e.Attribute=15]="Attribute",e[e.MultiCell=17]="MultiCell",e[e.MultiRegion=18]="MultiRegion",e[e.AllCells=19]="AllCells"}(c||(c={})),function(e){e.Title="title",e.Subtitle="subtitle"}(d||(d={})),function(e){e[e.None=0]="None",e[e.Column=1]="Column",e[e.Row=2]="Row",e[e.Title=3]="Title"}(h||(h={})),function(e){e[e.Column=0]="Column",e[e.Row=1]="Row"}(p||(p={})),function(e){e[e.unset=0]="unset",e[e.horizontal=1]="horizontal",e[e.vertical=2]="vertical"}(u||(u={})),function(e){e.Horizontal="horizontal",e.Vertical="vertical"}(f||(f={})),function(e){e[e.None=0]="None",e[e.Self=1]="Self",e[e.Child=2]="Child"}(g||(g={})),(H=C||(C={})).Box="box",H.Rows="rows",H.Columns="columns",H.Region="region",H.All="all",H.Mixed="mixed",(A=v||(v={}))[A.Value=0]="Value",A[A.Header=1]="Header",A[A.Input=2]="Input",A[A.Chart=3]="Chart",A[A.MemberSelector=4]="MemberSelector",A[A.Unbooked=5]="Unbooked",A[A.Threshold=6]="Threshold",A[A.DataLocking=7]="DataLocking",A[A.Validation=8]="Validation",A[A.Marquee=9]="Marquee",A[A.ColumnCoordinate=10]="ColumnCoordinate",A[A.RowCoordinate=11]="RowCoordinate",A[A.Attribute=12]="Attribute",A[A.Empty=13]="Empty",A[A.RowDimHeader=14]="RowDimHeader",A[A.ColDimHeader=15]="ColDimHeader",A[A.ColDimMember=16]="ColDimMember",A[A.RowDimMember=17]="RowDimMember",A[A.AttributeRowDimHeader=18]="AttributeRowDimHeader",A[A.AttributeColDimHeader=19]="AttributeColDimHeader",A[A.AttributeRowDimMember=20]="AttributeRowDimMember",A[A.AttributeColDimMember=21]="AttributeColDimMember",A[A.Title=22]="Title",A[A.Custom=23]="Custom",A[A.CoordinateCorner=24]="CoordinateCorner",A[A.Comment=25]="Comment",A[A.ColumnCoordinateSelectedDesignMode=26]="ColumnCoordinateSelectedDesignMode",A[A.RowCoordinateSelectedDesignMode=27]="RowCoordinateSelectedDesignMode",A[A.ColumnCoordinateSelectedViewMode=28]="ColumnCoordinateSelectedViewMode",A[A.RowCoordinateSelectedViewMode=29]="RowCoordinateSelectedViewMode",A[A.MergedDummyCell=30]="MergedDummyCell",A[A.Image=31]="Image",A[A.NewLineOnRow=32]="NewLineOnRow",A[A.NewLineOnColumn=33]="NewLineOnColumn",A[A.EmptyAxisRowHeader=34]="EmptyAxisRowHeader",A[A.EmptyAxisColumnHeader=35]="EmptyAxisColumnHeader",function(e){e.Top="Top",e.Bottom="Bottom",e.Left="Left",e.Right="Right"}(b||(b={})),function(e){e.Good="good",e.Warning="warning",e.Alert="alert",e.Diamond="diamond"}(y||(y={})),function(e){e.Locked="locked",e.Loading="loading",e.Mixed="mixed",e.Unknown="unknown",e.NoIcon="noIcon"}(m||(m={})),function(e){e.Invalid="INVALID",e.Valid="VALID",e.Unknown="UNDEFINED"}(R||(R={})),function(e){e[e.Percent=50]="Percent",e[e.Value=100]="Value",e[e.Text=200]="Text"}(w||(w={})),function(e){e.Bar="bar",e.VarianceBar="varianceBar",e.VariancePin="pin"}(S||(S={})),function(e){e.childCommentTooltip="COMM_HOLLOW_TOOLTIP"}(T||(T={})),function(e){e[e.Selection=0]="Selection",e[e.DoubleSelection=1]="DoubleSelection",e[e.AffectedCells=2]="AffectedCells"}(O||(O={})),function(e){e[e.Compact=0]="Compact",e[e.Condensed=1]="Condensed",e[e.Cozy=2]="Cozy",e[e.Custom=3]="Custom",e[e.SuperCondensed=4]="SuperCondensed"}(D||(D={})),function(e){e.Actual="AC",e.Budget="BU",e.Planning="PL",e.Forecast="FC",e.RollingForecast="RF",e.None="none"}(E||(E={})),function(e){e[e.None=0]="None",e[e.Default=1]="Default",e[e.SingleCell=2]="SingleCell",e[e.SingleRowCol=3]="SingleRowCol",e[e.MultiRowCol=4]="MultiRowCol"}(I||(I={}));var X={TABLE_COMPONENT_CLASS:"reactTableComponent",COORDINATE_CELL_SIZE:30,CELL_PADDING_LEFT:8,CELL_PADDING_RIGHT:8,CELL_PADDING_TOP:2,CELL_PADDING_BOTTOM:2,CELLTEXT_PADDING_HORIZONTAL:2,GRID_BORDER_SIZE:1,HIERARCHY_LEVEL_PADDING_TOP:10,HIERARCHY_LEVEL_PADDING_TOP_DEFAULT:5,HIERARCHY_LEVEL_PADDING_LEFT:8,DRILL_ICON_PADDING_LEFT:16,ICON_HEIGHT:16,ICON_HEIGHT_MOBILE:21,CUSTOM_ICON_WIDTH:16,MAX_NUM_CUSTOM_ICONS:2,SCROLLBAR_SIZE:12,DUMMY_DIMENSION:"DummyDimension",TEXT_WIDTH_CALC_ERROR_MARGIN:4,TEXT_HEIGHT_CALC_ERROR_MARGIN:3,FONTSIZE_TO_LINEHEIGHT_FACTOR:1.2,TOO_MANY_COLUMNS_WARNING:15,LOW_ENOUGH_NUMBER_OF_COLUMNS_TO_RENDER_FAST_ON_MOBILE:15,NEW_LINE_WRAPPER:"unbookedCombinationsControlWrapper",TITLE_TOKENCONTAINER_HEIGHT:28,TITLE_TOKENSEPARATOR_HEIGHT:20,TITLE_HEIGHT:52,TITLE_PADDING_VERTICAL:8,TITLE_PADDING_HORIZONTAL:10,TITLE_TOKEN_WRAP_MARGIN:4,CELL_CLASSNAME:"tableCell",RESPONSIVE_EMPTY_COLUMN_WIDTH:100,DEFAULT_CELL_IMG_HEIGHT:80,RESPONSIVE_CHART_WIDTH:50,DATA_LOCK_ICON_WIDTH:12,VALIDATION_WARNING_ICON_WIDTH:12,THRESHOLD_ICON_WIDTH:16},Y={MIN_HEIGHT:X.CELL_PADDING_TOP+X.CELL_PADDING_BOTTOM,MAX_HEIGHT:200,PADDING_COMPACT:8,PADDING_SUPER_CONDENSED:2,PADDING_CONDENSED:4,PADDING_COZY:14},J="title",Q="titleWrapper",$={BAR_CHART_BAR:"barChartBar",VARIANCEPIN_CHART_BAR:"variancePinChartBar",SCROLLBAR_CONTAINER:"scrollbarContainer",SCROLLBAR_HORIZONTAL:"horizontal",SCROLLBAR_VERTICAL:"vertical",ROW:"tableDivRow",EMPTY_AXIS_HEADER:"emptyAxisHeaderCell",ICON:"icon"},q={FONT_SIZE:13,FONT_FAMILY:"'72'",FONT_FAMILY_FALLBACK:", Arial, Helvetica, sans-serif",FONT_SIZE_TITLE:16,FONT_SIZE_SUBTITLE:12,FONT_OVERRIDE_SCALE:100,FONT_COLOR:'"grey"'};function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ne=te(te({},q),{},{BORDER_PADDING:8}),oe=te(te({},X),{},{MINIMUM_COLUMN_SIZE:2,NO_CONTENT_COLUMN_SIZE:X.CELL_PADDING_LEFT+X.CELL_PADDING_RIGHT,COORDINATE_ROW_NAME:"coordinateRow",COORDINATE_COL_NAME:"coordinateCol",COORDINATE_ROW_HEADER_CLASSNAME:"coordinateHeaderRow",COORDINATE_COL_HEADER_CLASSNAME:"coordinateHeaderColumn",AUTO_SCROLL_STEP_PLUS:20,AUTO_SCROLL_STEP_MINUS:10,AUTO_SCROLL_BUFFER:50,VARIANCE_PIN_SIZE:8,VARIANCE_PIN_BAR_HEIGHT:4,BAR_CHART_VERTICAL_PADDING_PERCENT:20,BAR_CHART_HORIZONTAL_PADDING_PERCENT:10,CELL_CHART_TEXT_SHIFT_HORIZONTAL_BAR:"0.35em",CELL_CHART_TEXT_SHIFT_VERTICAL_BAR:"1em",PADDING_FOR_IN_CELL_CHARTS_HEIGHT:2,PADDING_FOR_IN_CELL_CHARTS_WIDTH:8,IN_CELL_CHART_TEXT_PADDING:5,AXIS_SIZE_IN_CELL_CHARTS:2,TITLE_BORDER_WIDTH:1,TITLE_BORDER_COLOR:"rgb(230, 231, 232)",SELECTION_BORDER_COLOR:"#3b6f9a",SELECTION_BORDER_COLOR_DESIGN:"#d85a0c",SELECTION_REFERENCE_COLOR:"rgba(169, 198, 222, 0.35)",BUFFER_LIMIT_VERTICAL:1,CONTENT_LIMIT_VERTICAL:3,BUFFER_LIMIT_HORIZONTAL:.1,CONTENT_LIMIT_HORIZONTAL:1.2,FREEZE_LINE_OFFSET:1,IMG_CELL_PADDING_TOP:4,IMG_CELL_PADDING_BOTTOM:4,SHOW_GRID_CLASS:"showGrid",MAX_SCROLL_STEP:150,RESIZE_INFO_HEIGHT:22,TABLE_ROOT_ID_PREFIX:"sacGridTableRoot",SCROLL_LIMIT_VERTICAL:.9,SCROLL_LIMIT_HORIZONTAL:.5}),re=te({},Y),ie=function(){return null},le=te(te({},{DRAG_DATA_KEY:"sac-grid-drag-data",DRAG_DATA_SEPARATOR:"--",EMPTY_AXIS_COLUMN_ICON:"emptyAxisColumnSwapIcon",EMPTY_AXIS_ROW_ICON:"emptyAxisRowSwapIcon"}),{},{SOURCE_CELL_PREFIX:"sac-grid-source-cell",DRAG_HANDLE_CLASS:"sacGridCellDragHandle",DROP_AREA_CLASS:"sacGridCellDropArea",DROP_AREA_LEFT_CLASS:"sacGridCellDropAreaLeft",DROP_AREA_RIGHT_CLASS:"sacGridCellDropAreaRight",DROP_AREA_FOCUS_CLASS:"dropAreaFocused",SHOW_DROP_AREAS_CLASS:"showDropAreas",DRAG_IN_PROCESS_CLASS:"draggingInProcess",DROP_AREA_ROWS:"sacGridRowsDropAreas",DROP_AREA_COLUMNS:"sacGridColumnsDropAreas",EMPTY_AXIS_DROP_AREA_CLASS:"emptyAxisDropArea"});function ae(e){return"".concat(e,"px")}var se=n(379),ce=n.n(se),de=n(16);ce()(de.Z,{insert:"head",singleton:!1}),de.Z.locals;var he=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"render",value:function(){return _.createElement(_.Fragment,null,this.props.vertical&&_.createElement("div",{className:"freezeLine verticalFreezeLine",style:{height:ae(this.props.containerHeight),left:ae(this.props.left-oe.FREEZE_LINE_OFFSET)}}),this.props.horizontal&&_.createElement("div",{className:"freezeLine horizontalFreezeLine",style:{width:ae(this.props.containerWidth),top:ae(this.props.top-oe.FREEZE_LINE_OFFSET)}}))}}]),r}(_.PureComponent);function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var fe=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"render",value:function(){var e=this.props.preContent?{top:this.props.coordinateOffset}:{bottom:0},t=this.props.preContent?"20px":"30px",n=this.props.preContent?0:"10px";return _.createElement("div",{ref:this.props.innerRef,className:"loadingArea loadingAreaHorizontal ".concat(this.props.name),style:ue(ue({},e),{},{width:"calc(100% - ".concat(this.props.coordinateOffset,"px)"),height:t,right:0})},_.createElement("div",{className:"loadingIndicatorGif",style:{background:"url('".concat(this.props.pathToLoadingGif||"","') center center / 30px 12px no-repeat"),bottom:n,left:"calc(50% - 20px)"}}))}}]),r}(_.PureComponent);function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ve=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"render",value:function(){var e=this.props.preContent?{left:this.props.coordinateOffset}:{right:0},t=this.props.preContent?"20px":"30px",n=this.props.preContent?"-10px":"2px";return _.createElement("div",{ref:this.props.innerRef,className:"loadingArea loadingAreaVertical ".concat(this.props.name),style:Ce(Ce({},e),{},{width:t,height:"calc(100% - ".concat(this.props.coordinateOffset,"px)"),bottom:0})},_.createElement("div",{className:"loadingIndicatorGif",style:{background:"url('".concat(this.props.pathToLoadingGif||"","') center center / 30px 12px no-repeat"),bottom:"calc(50% - 20px)",transform:"rotate(90deg)",right:n}}))}}]),r}(_.PureComponent);var be="data-start",ye=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(e){var t;return(0,P.Z)(this,r),(t=o.call(this,e)).boundHandleMouseDown=t.handleMouseDown.bind((0,M.Z)(t)),t.boundHandleMouseMove=t.handleMouseMove.bind((0,M.Z)(t)),t.boundHandleMouseUp=t.handleMouseUp.bind((0,M.Z)(t)),t.boundHandleContextMenu=t.handleContextMenu.bind((0,M.Z)(t)),t.refResizerIndicator=_.createRef(),t.refSizeInfo=_.createRef(),t}return(0,k.Z)(r,[{key:"handleMouseDown",value:function(e){0===e.button&&(e.stopPropagation(),e.preventDefault(),this.refResizerIndicator.current&&this.refSizeInfo.current&&(this.props.onResizeStart(e,this.refResizerIndicator.current,this.refSizeInfo.current),this.refResizerIndicator.current.style.display="block"),document.addEventListener("mousemove",this.boundHandleMouseMove),document.addEventListener("mouseup",this.boundHandleMouseUp))}},{key:"handleMouseMove",value:function(e){this.refResizerIndicator.current&&this.refSizeInfo.current&&this.props.onResizing(e,this.refResizerIndicator.current,this.refSizeInfo.current)}},{key:"handleMouseUp",value:function(){this.refResizerIndicator.current&&(this.refResizerIndicator.current.style.display="none",this.refResizerIndicator.current.removeAttribute(be)),document.removeEventListener("mousemove",this.boundHandleMouseMove),document.removeEventListener("mouseup",this.boundHandleMouseUp),this.props.onResizeEnd()}},{key:"handleContextMenu",value:function(e){e.nativeEvent.preventDefault()}},{key:"render",value:function(){return _.createElement(_.Fragment,null,_.createElement("div",{ref:this.props.refResizer,className:this.props.resizerCssClassName,onMouseDown:this.boundHandleMouseDown,onDoubleClick:this.props.onResizerDoubeClick,onContextMenu:this.boundHandleContextMenu}),_.createElement("div",{ref:this.refResizerIndicator,className:this.props.resizeIndicatorCssClassName},_.createElement("div",{ref:this.refSizeInfo,className:"resizeInfo"})))}}]),r}(_.Component);var me=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(e){var t;return(0,P.Z)(this,r),(t=o.call(this,e)).boundHandleResizeStart=t.handleResizeStart.bind((0,M.Z)(t)),t.boundHandleResizeColumn=t.handleResizeColumn.bind((0,M.Z)(t)),t.boundHandleResizeEnd=t.handleResizeEnd.bind((0,M.Z)(t)),t}return(0,k.Z)(r,[{key:"handleResizeStart",value:function(e,t,n){n.textContent=ae(this.props.resizingInfo.width),t.style.left=ae(this.props.resizingInfo.left+this.props.resizingInfo.width-this.props.resizingInfo.scrollOffsetLeft),t.setAttribute(be,"".concat(e.clientX)),this.props.onColumnResizeStart()}},{key:"handleResizeColumn",value:function(e,t,n){var o=this.props.resizingInfo.col,r=t.getAttribute(be);if(r){var i=this.props.columnSettings[o].width+(e.clientX-parseInt(r,10));i<oe.MINIMUM_COLUMN_SIZE||(t.style.left=ae(this.props.resizingInfo.left+i-this.props.resizingInfo.scrollOffsetLeft),this.props.resizingInfo.newWidth=i,n.textContent=ae(i))}}},{key:"handleResizeEnd",value:function(){this.props.onNewColumnWidth(this.props.resizingInfo.newWidth),this.props.onColumnResizeEnd()}},{key:"render",value:function(){return _.createElement(ye,{resizerCssClassName:"columnResizer",resizeIndicatorCssClassName:"columnResizeIndicator",resizingInfo:this.props.resizingInfo,refResizer:this.props.refColumnResizer,onResizerDoubeClick:this.props.onColumnResizerDoubeClick,onResizeStart:this.boundHandleResizeStart,onResizing:this.boundHandleResizeColumn,onResizeEnd:this.boundHandleResizeEnd})}}]),r}(_.Component);function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function we(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function Se(e,t,n){var o=[];if(n.includes(e)){var r,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return we(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?we(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(a)throw i}}}}(n);try{for(i.s();!(r=i.n()).done;){var l=r.value;o.push({index:l,size:t})}}catch(e){i.e(e)}finally{i.f()}}else o.push({index:e,size:t});return o}function Te(e,t,n){var o,r={row:e.row,col:e.col},i=t.rows,l=t.columnSettings,a=null===(o=i[e.row])||void 0===o?void 0:o.cells[e.col];if(a&&a.merged){if(a.merged.rows)for(var s=e.row+a.merged.rows,c=0,d=e.row;d<=s&&c<=e.event.offsetY;d++)c+=i[d].height+n,r.row=d;if(a.merged.columns)for(var h=e.col+a.merged.columns,p=0,u=e.col;u<=h&&p<=e.event.offsetX;u++)p+=l[u].width,r.col=u}return r}var Oe=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(e){var t;return(0,P.Z)(this,r),(t=o.call(this,e)).boundHandleResizeStart=t.handleResizeStart.bind((0,M.Z)(t)),t.boundHandleResizeRow=t.handleResizeRow.bind((0,M.Z)(t)),t.boundHandleResizeEnd=t.handleResizeEnd.bind((0,M.Z)(t)),t}return(0,k.Z)(r,[{key:"handleResizeStart",value:function(e,t,n){n.textContent=ae(this.props.resizingInfo.height),t.style.top=ae(this.props.resizingInfo.top+this.props.resizingInfo.height+this.props.notRenderedHeightTop-this.props.resizingInfo.scrollOffsetTop),t.setAttribute(be,"".concat(e.clientY)),this.props.onRowResizeStart()}},{key:"handleResizeRow",value:function(e,t,n){var o=this.props.resizingInfo.row,r=t.getAttribute(be);if(r){var i=this.props.rows[o].height+this.props.borderSize+(e.clientY-parseInt(r,10));i<re.MIN_HEIGHT||i>this.props.tableContainerHeight||(t.style.top=ae(this.props.resizingInfo.top+i+this.props.notRenderedHeightTop-this.props.resizingInfo.scrollOffsetTop),this.props.resizingInfo.newHeight=i,n.textContent=ae(i))}}},{key:"handleResizeEnd",value:function(){this.props.onNewRowHeight(this.props.resizingInfo.newHeight),this.props.onRowResizeEnd()}},{key:"render",value:function(){return _.createElement(ye,{resizerCssClassName:"rowResizer",resizeIndicatorCssClassName:"rowResizeIndicator",resizingInfo:this.props.resizingInfo,refResizer:this.props.refRowResizer,onResizerDoubeClick:ie,onResizeStart:this.boundHandleResizeStart,onResizing:this.boundHandleResizeRow,onResizeEnd:this.boundHandleResizeEnd})}}]),r}(_.Component);function De(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ee(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(a)throw i}}}}function Ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function Ie(e,t){return Ae(e)-t}function Ae(e){return e.widgetHeight-Le(e.title)}function He(e,t){return e-t}function Le(e){return e?e.titleStyle.height:0}function xe(e){return e?"100%":(t=oe.SCROLLBAR_SIZE,"calc(100% - ".concat(t,"px)"));var t}function Pe(e){return{verticalScrollbarWidth:e?0:oe.SCROLLBAR_SIZE,isVerticalScrollbarVisible:!e,horizontalScrollbarHeight:e?0:oe.SCROLLBAR_SIZE,isHorizontalScrollbarVisible:!e}}function ke(e){return _e(e,{scrollTop:0,scrollLeft:0,notRenderedWidthToTheLeft:0,notRenderedHeightOnTop:0,columnIndices:{startColumnIndex:0,endColumnIndex:void 0},allRowsProcessed:!1,allColumnsProcessed:!1,isPaginatedTable:!0})}function _e(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scrollTop:0,scrollLeft:0,notRenderedWidthToTheLeft:0,notRenderedHeightOnTop:0,columnIndices:{startColumnIndex:0,endColumnIndex:void 0},allRowsProcessed:!1,allColumnsProcessed:!1,isPaginatedTable:!0},n=e.showGrid?oe.GRID_BORDER_SIZE:0,o=e.showCoordinateHeader?oe.COORDINATE_CELL_SIZE:0,r=Le(e.title),i=e.mobile||!1,l=Pe(i),a=l.horizontalScrollbarHeight,s=l.verticalScrollbarWidth,c=o+t.notRenderedWidthToTheLeft,d=0,h=t.columnIndices,p=h.startColumnIndex,u=h.endColumnIndex,f=void 0!==u?u:e.columnSettings.length-1,g=void 0!==e.freezeEndCol?e.freezeEndCol:-1,C=0;C<=f;C++){var v=C<=g||C>=p;c+=v?e.columnSettings[C].width:0,d+=e.columnSettings[C].fixed?e.columnSettings[C].width:0}for(var b=He(e.widgetWidth,s),y=Ie(e,a),m=0,R=0,w=e.rows.length,S=0,T=0;T<w;T++)m+=e.rows[T]?e.rows[T].height+n:0,e.rows[T]&&S++,R+=e.rows[T]&&e.rows[T].fixed?e.rows[T].height+n:0;var O=Ne(m,S,e.totalNumberOfRows||S,o),D=m+o+t.notRenderedHeightOnTop,E=d+o,I=R+o,A=e.totalHeight+o,H=t.allRowsProcessed?A:Math.max(O,A),L=t.isPaginatedTable?D:H,x=e.totalWidth+o,P=x,k=P,_=xe(i),z=xe(i);void 0!==e.freezeEndCol&&(_=ae(E),k=E),void 0!==e.freezeEndRow&&(z=ae(I+n));var M={width:_,height:z,htmlTableWidth:k},N={width:_,height:ae(y-I),htmlTableWidth:k},Z={width:ae(b-E),height:z,htmlTableWidth:P-E},B={width:ae(b-E),height:ae(y-I),htmlTableWidth:P-E},j=Math.max(D-y,0),W=ze(D,y,t.scrollTop),F=ze(c,b,t.scrollLeft),U=Me(t.notRenderedHeightOnTop,t.scrollTop),G=Me(t.notRenderedWidthToTheLeft,t.scrollLeft);return{tableContentWidth:c,tableContentHeight:D,topLeftSection:M,bottomLeftSection:N,topRightSection:Z,bottomRightSection:B,borderSize:n,coordinateOffset:o,freezeHeight:I,freezeWidth:E,tableContainerWidth:b,tableContainerHeight:y,titleHeight:r,maxScrollTop:j,horizontalScrollbarHeight:a,columnIndices:t.columnIndices,prefetchedHeightBelowTable:W,prefetchedHeightAboveTable:U,prefetchedWidthOnTheRightOfTable:F,prefetchedWidthOnTheLeftOfTable:G,notRenderedHeightTop:t.notRenderedHeightOnTop,notRenderedHeightBelow:Math.max(H-D,0),notRenderedWidthOnTheLeft:t.notRenderedWidthToTheLeft,htmlTableWrapperHeight:L,htmlTableWrapperWidth:P,allRowsProcessed:t.allRowsProcessed}}function ze(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.max(e-t-n,0)}function Me(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.max(t-e,0)}function Ne(e,t,n,o){var r=e/t;return Math.round(r*n)+o}var Ze=function(){function e(t,n){(0,P.Z)(this,e),this.setScrollTop=t,this.setScrollLeft=n}return(0,k.Z)(e,[{key:"autoScrollTable",value:function(e,t,n,o,r){if(null===e.target.closest(".".concat(oe.COORDINATE_COL_HEADER_CLASSNAME))){var i=((null==(a=(l=e.target).offsetParent)?void 0:a.offsetTop)||0)+l.offsetTop;this.setScrollTop(this.getAutoScrollTop(r,t,i,e))}var l,a;if(null===e.target.closest(".".concat(oe.COORDINATE_ROW_HEADER_CLASSNAME))){var s=function(e){var t=e.offsetParent;return((null==t?void 0:t.offsetLeft)||0)+e.offsetLeft}(e.target);this.setScrollLeft(this.getAutoScrollLeft(o,n,s,e))}}},{key:"getAutoScrollLeft",value:function(e,t,n,o){var r=t;return o.event.offsetX+n-r>e-oe.AUTO_SCROLL_BUFFER&&(r+=oe.AUTO_SCROLL_STEP_PLUS),r+oe.AUTO_SCROLL_BUFFER>n&&(r-=oe.AUTO_SCROLL_STEP_MINUS),r}},{key:"getAutoScrollTop",value:function(e,t,n,o){var r=t;return o.event.offsetY+n-r>e-oe.AUTO_SCROLL_BUFFER&&(r+=oe.AUTO_SCROLL_STEP_PLUS),r+oe.AUTO_SCROLL_BUFFER>n&&(r-=oe.AUTO_SCROLL_STEP_MINUS),r}}]),e}(),Be=n(24);ce()(Be.Z,{insert:"head",singleton:!1}),Be.Z.locals;var je=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"render",value:function(){return _.createElement("div",{className:[$.SCROLLBAR_CONTAINER,this.props.cssClass].join(" ").trim(),ref:this.props.scrollContainerRef,onScroll:this.props.onScroll},_.createElement("div",{className:"scrollableSize",style:this.props.scrollableSizeStyle}))}}]),r}(_.PureComponent);function We(e,t){return e>t}var Fe,Ue=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"onScroll",value:function(e){this.props.onScrollLeftChanged(e.currentTarget.scrollLeft)}},{key:"render",value:function(){if(!We(this.props.totalScrollableColumnWidth,this.props.containerWidth))return null;var e={width:this.props.totalScrollableColumnWidth};return _.createElement(je,{scrollableSizeStyle:e,cssClass:$.SCROLLBAR_HORIZONTAL,scrollContainerRef:this.props.scrollContainerRef,onScroll:this.onScroll.bind(this)})}}]),r}(_.PureComponent),Ge=function(){function e(){(0,P.Z)(this,e),(0,x.Z)(this,"lastDeltaX",new Ve(3))}return(0,k.Z)(e,[{key:"isHorizontalScroll",value:function(e){var t=!!e;return!t&&this.lastDeltaX.zeroes()<=3&&(t=!!this.lastDeltaX.lastValue()),this.lastDeltaX.add(e),t}}]),e}(),Ve=function(){function e(t){(0,P.Z)(this,e),this.sizeLimit=t,this.content=[]}return(0,k.Z)(e,[{key:"add",value:function(e){this.content.unshift(e),this.content.length>this.sizeLimit&&(this.content.length=this.sizeLimit)}},{key:"zeroes",value:function(){return this.content.filter((function(e){return 0===e})).length}},{key:"lastValue",value:function(){return this.content[this.content.length-1]}}]),e}();function Ke(e,t,n,o){if(function(e,t){return e<t}(e,n))return e;var r=e+t;return r>n+o?r-o:void 0}function Xe(e,t,n,o){return e&&n-o>=t||!e&&o-n>=t}function Ye(e){var t=Math.abs(e||0);return e?t<oe.MAX_SCROLL_STEP?e:e/t*oe.MAX_SCROLL_STEP:0}function Je(e){window.requestAnimationFrame((function(){window.requestAnimationFrame(e)}))}!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Down=2]="Down",e[e.Up=3]="Up",e[e.FirstRow=4]="FirstRow",e[e.FirstCol=5]="FirstCol",e[e.LastRow=6]="LastRow",e[e.LastCol=7]="LastCol",e[e.FirstCell=8]="FirstCell",e[e.LastCell=9]="LastCell",e[e.PageDown=10]="PageDown",e[e.PageUp=11]="PageUp",e[e.DownAndFirstCol=12]="DownAndFirstCol",e[e.UpAndLastCol=13]="UpAndLastCol"}(Fe||(Fe={}));var Qe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_.createRef(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_.createRef(),o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_.createRef(),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:_.createRef(),i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:_.createRef(),l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:_.createRef(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;(0,P.Z)(this,e),this.freezeSectionTopLeftRef=t,this.freezeSectionBotLeftRef=n,this.freezeSectionTopRightRef=o,this.freezeSectionBotRightRef=r,this.horizontalScrollbarContainerRef=i,this.verticalScrollbarContainerRef=l,this.boundContainerWheel=this.handleContainerWheel.bind(this),this.boundSyncVerticalScrollPosition=this.syncVerticalScrollPosition.bind(this),this.boundSyncHorizontalScrollPosition=this.syncHorizontalScrollPosition.bind(this),this.currentScrollTop=a,this.currentScrollLeft=s}return(0,k.Z)(e,[{key:"handleContainerWheel",value:function(e){var t=Ye(e.deltaY),n=Ye(e.deltaX);this.currentScrollTop+=t,this.currentScrollLeft+=n,this.currentScrollTop=Math.max(0,this.currentScrollTop),this.currentScrollLeft=Math.max(0,this.currentScrollLeft),this.updateScrollPosition()}},{key:"updateScrollPosition",value:function(){this.setBoundedScrollTopOnRef(this.verticalScrollbarContainerRef),this.setBoundedScrollLeftOnRef(this.horizontalScrollbarContainerRef),this.syncVerticalScrollPosition(this.currentScrollTop),this.syncHorizontalScrollPosition(this.currentScrollLeft)}},{key:"syncVerticalScrollPosition",value:function(e){this.currentScrollTop=e,this.setScrollTopOnRef(this.freezeSectionBotLeftRef),this.setScrollTopOnRef(this.freezeSectionBotRightRef),this.freezeSectionTopLeftRef.current&&(this.freezeSectionBotLeftRef.current||(this.setScrollTopOnRef(this.freezeSectionTopLeftRef),this.freezeSectionTopRightRef.current&&this.setScrollTopOnRef(this.freezeSectionTopRightRef)))}},{key:"syncHorizontalScrollPosition",value:function(e){this.currentScrollLeft=e,this.setScrollLeftOnRef(this.freezeSectionTopRightRef),this.setScrollLeftOnRef(this.freezeSectionBotRightRef),this.freezeSectionTopLeftRef.current&&(this.freezeSectionTopRightRef.current||(this.setScrollLeftOnRef(this.freezeSectionTopLeftRef),this.freezeSectionBotLeftRef.current&&this.setScrollLeftOnRef(this.freezeSectionBotLeftRef)))}},{key:"setScrollTopOnRef",value:function(e){e.current&&(e.current.scrollTop=this.currentScrollTop)}},{key:"setBoundedScrollTopOnRef",value:function(e){e.current?(e.current.scrollTop=this.currentScrollTop,this.currentScrollTop=e.current.scrollTop):this.currentScrollTop=0}},{key:"setScrollLeftOnRef",value:function(e){e.current&&(e.current.scrollLeft=this.currentScrollLeft)}},{key:"setBoundedScrollLeftOnRef",value:function(e){e.current?(e.current.scrollLeft=this.currentScrollLeft,this.currentScrollLeft=e.current.scrollLeft):this.currentScrollLeft=0}},{key:"getScrollTop",value:function(){return this.currentScrollTop}},{key:"getScrollLeft",value:function(){return this.currentScrollLeft}},{key:"setScrollLeft",value:function(e){this.currentScrollLeft=Math.max(0,e),this.updateScrollPosition()}},{key:"setScrollTop",value:function(e){this.currentScrollTop=Math.max(0,e),this.updateScrollPosition()}},{key:"isScrolledToTop",value:function(){return 0===this.currentScrollTop}}]),e}();var $e=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"updateScrollPosition",value:function(){this.syncVerticalScrollPosition(this.currentScrollTop),this.syncHorizontalScrollPosition(this.currentScrollLeft)}}]),r}(Qe),qe=function(){function e(t,n,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;(0,P.Z)(this,e),(0,x.Z)(this,"lastScrollTop",0),(0,x.Z)(this,"lastScrollLeft",0),(0,x.Z)(this,"lastScrollUpdateVertical",0),(0,x.Z)(this,"lastScrollUpdateHorizontal",0),this.lastScrollTop=r,this.lastScrollLeft=i,this.lastScrollUpdateHorizontal=t.scrollLeft,this.lastScrollUpdateVertical=t.scrollTop,this.onInternalReloadLimitReachedHandler=n,this.onStoreScrollPosition=o}return(0,k.Z)(e,[{key:"getLastScrollTop",value:function(){return this.lastScrollTop}},{key:"getLastScrollLeft",value:function(){return this.lastScrollLeft}},{key:"getLastScrollUpdateVertical",value:function(){return this.lastScrollUpdateVertical}},{key:"getLastScrollUpdateHorizontal",value:function(){return this.lastScrollUpdateHorizontal}},{key:"getScrollLimitVertical",value:function(e,t,n){var o=n||oe.SCROLL_LIMIT_VERTICAL;return(e?t.prefetchedHeightBelowTable:t.prefetchedHeightAboveTable)*o}},{key:"getScrollLimitHorizontal",value:function(e,t,n){var o=n||oe.SCROLL_LIMIT_HORIZONTAL;return(e?t.prefetchedWidthOnTheRightOfTable:t.prefetchedWidthOnTheLeftOfTable)*o}},{key:"dispatchInternalReloadLimitReached",value:function(e){var t=this,n=e.scrollTop,o=e.scrollLeft,r=e.scrollLimitVertical,i=e.scrollLimitHorizontal,l=e.tableSizes,a=this.lastScrollTop!==n,s=this.lastScrollLeft!==o;if(a||s){if(a){var c=this.lastScrollTop<n,d=this.getScrollLimitVertical(c,l,r);this.lastScrollTop=n,Xe(c,d,n,this.lastScrollUpdateVertical)&&(this.lastScrollUpdateVertical=n,Je((function(){t.onInternalReloadLimitReachedHandler.onInternalReloadLimitReachedVertically(n,c)}))),c||0!==l.notRenderedHeightTop||(this.lastScrollUpdateVertical=0)}if(s){var h=this.lastScrollLeft<o,p=this.getScrollLimitHorizontal(h,l,i);this.lastScrollLeft=o,Xe(h,p,o,this.lastScrollUpdateHorizontal)&&(this.lastScrollUpdateHorizontal=o,Je((function(){t.onInternalReloadLimitReachedHandler.onInternalReloadLimitReachedHorizontally(o,h)})))}0===o&&(this.lastScrollUpdateHorizontal=0),this.onStoreScrollPosition({scrollLeft:o,scrollTop:n})}}}]),e}();var et,tt=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"onScroll",value:function(e){this.props.onScrollTopChanged(e.currentTarget.scrollTop)}},{key:"render",value:function(){if(!We(this.props.totalScrollableRowHeight,this.props.containerHeight))return null;var e={height:this.props.totalScrollableRowHeight};return _.createElement(je,{scrollableSizeStyle:e,cssClass:$.SCROLLBAR_VERTICAL,scrollContainerRef:this.props.scrollContainerRef,onScroll:this.onScroll.bind(this)})}}]),r}(_.PureComponent);function nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ot(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nt(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rt(e,t,n){var o=n[e]&&n[e].cells[t];if(!o)return{startCol:t,endCol:t,startRow:e,endRow:e};if(o.cellType===v.MergedDummyCell&&o.merged&&void 0!==o.merged.originalColumn&&void 0!==o.merged.originalRow){var r=n[o.merged.originalRow];o=r&&r.cells[o.merged.originalColumn]}return o&&o.merged?{startCol:o.column,endCol:o.column+(o.merged.columns?o.merged.columns:0),startRow:o.row,endRow:o.row+(o.merged.rows?o.merged.rows:0)}:{startCol:t,endCol:t,startRow:e,endRow:e}}function it(e,t,n,o){return e.cellType===v.MergedDummyCell&&e.merged&&void 0!==e.merged.originalRow&&void 0!==e.merged.originalColumn?(t.mergedStartRow=Math.min(t.mergedStartRow||0,e.merged.originalRow),t.mergedStartCol=Math.min(t.mergedStartCol||0,e.merged.originalColumn)):e.merged&&(e.merged.rows&&(t.endRow=Math.max(t.endRow,n+e.merged.rows)),e.merged.columns&&(t.endCol=Math.max(t.endCol,o+e.merged.columns))),t}function lt(e,t){if([C.Rows,C.Columns,C.All].includes(e.selectionType))return e;var n=!0,o=!0,r=ot({},e);r.mergedStartCol=r.startCol,r.mergedStartRow=r.startRow;var i,l,a,s,c=r;c.mergedStartRow>c.endRow&&(c.mergedStartRow=e.endRow,c.endRow=e.startRow,n=!1),c.mergedStartCol>c.endCol&&(c.mergedStartCol=e.endCol,c.endCol=e.startCol,o=!1);var d=0;do{i=c.mergedStartRow,l=c.endRow,a=c.mergedStartCol,s=c.endCol,d=0;for(var h=c.mergedStartRow;h<=c.endRow;h++){var p=t[h];if(p)for(var u=c.mergedStartCol;u<=c.endCol;u++){var f=p.cells[u];f&&(f.cellType!==v.MergedDummyCell&&d++,c=it(f,c,h,u))}}}while(i!==c.mergedStartRow||l!==c.endRow||a!==c.mergedStartCol||s!==c.endCol);1===d&&(c.endRow=c.mergedStartRow,c.endCol=c.mergedStartCol),n||(c.mergedStartRow=l,c.endRow=i),o||(c.mergedStartCol=s,c.endCol=a);var g=c;return g.mergedStartCol===e.startCol&&delete g.mergedStartCol,g.mergedStartRow===e.startRow&&delete g.mergedStartRow,g}function at(e,t,n){(function(e,t){for(var n=[],o=function(o){var r=e[o];if(r){var i=r.cells.reduce((function(e,n){return function(e,t,n){if(!e.merged)return!1;if(e.merged.rows){var o=t,r=e.merged.rows+t;if(o<=n&&r>=n)return!0}return!1}(n,o,t)&&e.push(n),e}),[]);n=n.concat(i)}},r=t;r>=0;r--)o(r);return n})(e,n).forEach((function(n){!function(e,t,n){var o,r=e[t.row];null!==(o=t.merged)&&void 0!==o&&o.rows&&r&&(r.cells=(0,L.Z)(r.cells),r.cells[t.column]=ot(ot({},r.cells[t.column]),{},{merged:ot(ot({},r.cells[t.column].merged),{},{heightAfterRowResized:st(e,n,t.row,t.row+t.merged.rows)})}))}(e,n,t)}))}function st(e,t,n,o){for(var r=0,i=n;i<=o;i++){var l=e[i];l&&(r+=l.height+t)}return r}function ct(e,t){var n=dt(e,t);null!==n&&n.focus({preventScroll:!0})}function dt(e,t){var n=rt(t.startRow,t.startCol,e.rows);return document.querySelector(".table".concat(e.id," [data-tablecol='").concat(n.startCol,"'][data-tablerow='").concat(n.startRow,"']"))}function ht(e){return"A"===e.target.tagName.toUpperCase()}!function(e){e[e.A=65]="A",e[e.ALT=18]="ALT",e[e.ARROW_DOWN=40]="ARROW_DOWN",e[e.ARROW_LEFT=37]="ARROW_LEFT",e[e.ARROW_RIGHT=39]="ARROW_RIGHT",e[e.ARROW_UP=38]="ARROW_UP",e[e.B=66]="B",e[e.BACKSLASH=226]="BACKSLASH",e[e.BACKSPACE=8]="BACKSPACE",e[e.BREAK=19]="BREAK",e[e.C=67]="C",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.CMD_LEFT=91]="CMD_LEFT",e[e.CMD_RIGHT=93]="CMD_RIGHT",e[e.COMMA=188]="COMMA",e[e.CONTEXT_MENU=93]="CONTEXT_MENU",e[e.CONTROL=17]="CONTROL",e[e.D=68]="D",e[e.DELETE=46]="DELETE",e[e.DIGIT_0=48]="DIGIT_0",e[e.DIGIT_1=49]="DIGIT_1",e[e.DIGIT_2=50]="DIGIT_2",e[e.DIGIT_3=51]="DIGIT_3",e[e.DIGIT_4=52]="DIGIT_4",e[e.DIGIT_5=53]="DIGIT_5",e[e.DIGIT_6=54]="DIGIT_6",e[e.DIGIT_7=55]="DIGIT_7",e[e.DIGIT_8=56]="DIGIT_8",e[e.DIGIT_9=57]="DIGIT_9",e[e.DOT=190]="DOT",e[e.E=69]="E",e[e.END=35]="END",e[e.ENTER=13]="ENTER",e[e.EQUALS=221]="EQUALS",e[e.ESCAPE=27]="ESCAPE",e[e.F=70]="F",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.G=71]="G",e[e.GREAT_ACCENT=220]="GREAT_ACCENT",e[e.H=72]="H",e[e.HOME=36]="HOME",e[e.I=73]="I",e[e.INSERT=45]="INSERT",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.MINUS=219]="MINUS",e[e.N=78]="N",e[e.NUMPAD_0=96]="NUMPAD_0",e[e.NUMPAD_1=97]="NUMPAD_1",e[e.NUMPAD_2=98]="NUMPAD_2",e[e.NUMPAD_3=99]="NUMPAD_3",e[e.NUMPAD_4=100]="NUMPAD_4",e[e.NUMPAD_5=101]="NUMPAD_5",e[e.NUMPAD_6=102]="NUMPAD_6",e[e.NUMPAD_7=103]="NUMPAD_7",e[e.NUMPAD_8=104]="NUMPAD_8",e[e.NUMPAD_9=105]="NUMPAD_9",e[e.NUMPAD_ASTERISK=106]="NUMPAD_ASTERISK",e[e.NUMPAD_COMMA=110]="NUMPAD_COMMA",e[e.NUMPAD_MINUS=109]="NUMPAD_MINUS",e[e.NUMPAD_PLUS=107]="NUMPAD_PLUS",e[e.NUMPAD_SLASH=111]="NUMPAD_SLASH",e[e.NUM_LOCK=144]="NUM_LOCK",e[e.O=79]="O",e[e.OPEN_BRACKET=186]="OPEN_BRACKET",e[e.P=80]="P",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.PAGE_UP=33]="PAGE_UP",e[e.PIPE=191]="PIPE",e[e.PLUS=187]="PLUS",e[e.PRINT=44]="PRINT",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.SEMICOLON=192]="SEMICOLON",e[e.SHIFT=16]="SHIFT",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE",e[e.SLASH=189]="SLASH",e[e.SLEEP=95]="SLEEP",e[e.SPACE=32]="SPACE",e[e.T=84]="T",e[e.TAB=9]="TAB",e[e.TURN_OFF=94]="TURN_OFF",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.WINDOWS=91]="WINDOWS",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z"}(et||(et={}));var pt=[et.B,et.U,et.I];function ut(e){return e.ctrlKey||e.metaKey}function ft(e){return e[0]}function gt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ct(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ct(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(a)throw i}}}}function Ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function vt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vt(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function yt(e){return[c.HeaderRegion,c.DatacellRegion,c.CellChart].includes(e)}function mt(e){return[c.HeaderRegion,c.Dimension,c.DimensionMember,c.HeaderCell,c.Attribute].includes(e)}function Rt(e){return[c.DatacellRegion,c.DataCell,c.CellChart].includes(e)}function wt(e){return[c.Dimension,c.DimensionMember,c.MultiRegion].includes(e)}function St(e){return[c.TitleRegion,c.Title,c.Subtitle].includes(e)}function Tt(e,t){return yt(e)||function(e,t){var n=wt(e),o=t===c.Dimension,r=e===c.DimensionMember;return n&&!o&&!r}(e,t)}function Ot(e,t,n){return Et(e)&&-1===t&&n!==e.endCol}function Dt(e,t,n){return It(e)&&-1===n&&t!==e.endRow}function Et(e){return e.selectionType===C.Columns}function It(e){return e.selectionType===C.Rows}function At(e,t,n){if(e.selectionType===C.All)return!0;if(-1===t)return e.startRow>=n&&e.endRow<=n||e.startRow<=n&&e.endRow>=n;if(-1===n)return e.startCol>=t&&e.endCol<=t||e.startCol<=t&&e.endCol>=t;var o=!1,r=!1,i=e.startCol<=t,l=e.startCol>=t,a=e.endCol>=t,s=e.endCol<=t,c=e.startRow<=n,d=e.startRow>=n,h=e.endRow>=n,p=e.endRow<=n;if(e.selectionType===C.Region&&void 0!==e.cornerCol&&void 0!==e.cornerRow){var u=function(e,t){return void 0!==e.cornerRow&&t<=e.cornerRow&&t>=e.startRow}(e,n),f=function(e,t){return void 0!==e.cornerCol&&t<=e.cornerCol&&t>=e.startCol}(e,t);o=i&&a&&u||i&&e.cornerCol>=t&&f,r=c&&h&&f||c&&e.cornerRow>=n&&u}else o=i&&a||l&&s,r=c&&h||d&&p;return o&&r}function Ht(e){return function(e){return[v.ColDimMember,v.RowDimMember,v.AttributeColDimMember,v.AttributeRowDimMember,v.NewLineOnRow,v.NewLineOnColumn].includes(e)}(e)?c.DimensionMember:V(e)?c.Row:K(e)?c.Column:G(e)?c.AllCells:c.DataCell}function Lt(e,t,n){if(!t.originalSelectionArea||n!==u.horizontal&&n!==u.vertical)return e;var o,r,i,l,a,s,c,d,h,p,f=Pt(t.originalSelectionArea,n);return n===u.horizontal?(!f&&t.newCol<=t.originalSelectionArea.startCol||f&&t.newCol>=t.originalSelectionArea.startCol?e.selectionArea.startCol=t.newCol:(!f&&t.newCol>=t.originalSelectionArea.endCol||f&&t.newCol<=t.originalSelectionArea.endCol)&&(e.selectionArea.endCol=t.newCol),e.selectionArea.isReverseDraggingHorizontal=xt(t,n)):n===u.vertical&&(!f&&t.newRow<=t.originalSelectionArea.startRow||f&&t.newRow>=t.originalSelectionArea.startRow?e.selectionArea.startRow=t.newRow:(!f&&t.newRow>=t.originalSelectionArea.endRow||f&&t.newRow<=t.originalSelectionArea.endRow)&&(e.selectionArea.endRow=t.newRow),e.selectionArea.isReverseDraggingVertical=xt(t,n)),e.selectionArea.hideFirstSelectedCellBackground=(o=e.selectionArea,r=t.originalSelectionArea,i=Pt(r,u.horizontal),l=Pt(r,u.vertical),a=_t(r,u.horizontal),s=_t(r,u.vertical),c=i&&a&&o.startCol>r.startCol,d=!i&&a&&o.startCol<r.startCol,h=l&&s&&o.startRow>r.startRow,p=!l&&s&&o.startRow<r.startRow,!!(d||c||p||h)),e}function xt(e,t){if(!e.originalSelectionArea)return!1;var n=Pt(e.originalSelectionArea,u.horizontal)?e.newCol>e.originalSelectionArea.startCol:e.newCol<e.originalSelectionArea.startCol;if(t===u.horizontal)return n;var o=Pt(e.originalSelectionArea,u.vertical)?e.newRow>e.originalSelectionArea.startRow:e.newRow<e.originalSelectionArea.startRow;return t===u.vertical?o:n||o}function Pt(e,t){var n=e.startCol>e.endCol;if(t===u.horizontal)return n;var o=e.startRow>e.endRow;return t===u.vertical?o:n||o}function kt(e,t){if(!e.originalSelectionArea)return!1;var n=Pt(e.originalSelectionArea,t);return t===u.vertical?n?e.newRow<=e.originalSelectionArea.startRow&&e.newRow>=e.originalSelectionArea.endRow:e.newRow>=e.originalSelectionArea.startRow&&e.newRow<=e.originalSelectionArea.endRow:n?e.newCol<=e.originalSelectionArea.startCol&&e.newCol>=e.originalSelectionArea.endCol:e.newCol>=e.originalSelectionArea.startCol&&e.newCol<=e.originalSelectionArea.endCol}function _t(e,t){var n=e.startCol!==e.endCol;if(t===u.horizontal)return n;var o=e.startRow!==e.endRow;return t===u.vertical?o:n||o}function zt(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=ft(e.selectedRegions);t.onSelectedCellChanged&&o?t.onSelectedCellChanged(o.startRow,o.startCol):t.onSelectedCellChanged&&t.onSelectedCellChanged(null,null),t.onSelectedRegionChanged&&t.onSelectedRegionChanged(e.selectedRegions,e.selectionContextType,n)}function Mt(e){for(var t=[],n=Math.min(e.startCol,e.endCol),o=Math.max(e.startCol,e.endCol),r=n;r<=o;r++)t.push(r);return t}function Nt(e){for(var t=[],n=Math.min(e.startRow,e.endRow),o=Math.max(e.startRow,e.endRow),r=n;r<=o;r++)t.push(r);return t}function Zt(e){var t=c.Widget;if(e.selectedRegions>1)return c.MultiCell;if(1===e.selectedRegions)switch(e.cellType){case v.Value:case v.Input:case v.Unbooked:case v.Threshold:case v.DataLocking:case v.Validation:case v.Chart:t=c.DataCell;break;case v.Custom:case v.Empty:t=c.CustomCell;break;case v.Header:case v.AttributeRowDimHeader:case v.AttributeColDimHeader:case v.MemberSelector:case v.RowDimHeader:case v.ColDimHeader:t=c.HeaderCell;break;case v.Attribute:t=c.Attribute;break;case v.ColDimMember:case v.RowDimMember:case v.AttributeRowDimMember:case v.AttributeColDimMember:t=c.DimensionMember;break;default:t=c.MultiCell}return t}function Bt(){return{startRow:0,startCol:0,endRow:0,endCol:0,selectionType:C.Box}}function jt(e,t,n,o){var r=bt(bt({},e.selection),{},{selectedRegions:[].concat((0,L.Z)(e.selection.selectedRegions),[n])});return o&&(r.selectionContextType=c.MultiRegion),zt(r,t),bt(bt({},e),{},{selection:r})}function Wt(e){var t=e.selectedRegions.length;return t>0?e.selectedRegions[t-1]:Bt()}var Ft={selectionArea:void 0,clearSelection:!1,scrollDirection:void 0,isKeyEvent:!1};function Ut(e,t,n){var o=e.rows[t],r=o&&o.cells[n];if(r&&e.editMode&&r.cellType===v.Chart&&e.cellChartData&&r.cellChart){var i=e.cellChartData[r.cellChart.memberId];return{isKeyEvent:!1,selectionArea:{startCol:i.startCol,endCol:i.endCol,startRow:i.startRow,endRow:i.endRow,selectionType:C.Box,isCellChartSelection:!0,inCellChartContext:r.cellChart.context},context:c.CellChart,singleSelection:!0}}return Ft}function Gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gt(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Kt(e,t){var n={hoverContextType:c.DataCell,doubleOverlay:!1};return void 0!==e.col&&e.col>=0?n={hoverContextType:c.Column,doubleOverlay:!1,column:e.col}:void 0!==e.row&&e.row>=0&&(n={hoverContextType:c.Row,doubleOverlay:!1,row:e.row}),Vt(Vt({},t),{},{hover:n})}function Xt(e,t){for(var n=[],o=0,r=t;r>=0;)o=r%26,n=n.concat(String.fromCharCode("A".charCodeAt(0)+o)),r=Math.floor(r/26)-1;return"".concat(n.reverse().join("")).concat(e+1)}function Yt(e,t){var n=Boolean(document&&document.activeElement&&null!==document.activeElement.closest("#".concat(t))),o=Boolean(document&&document.activeElement===document.body)&&e;return n||o}function Jt(e){return void 0===e||e}function Qt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function $t(e,t,n){return!(!e||null!==e.closest("#".concat(t.id))||n&&n())&&qt(e,t.idsToIgnore,"#")&&qt(e,t.classesToIgnore,".")}function qt(e,t,n){var o=!0;if(t){var r,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Qt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(a)throw i}}}}(t);try{for(i.s();!(r=i.n()).done;){var l=r.value;o=o&&null===e.closest("".concat(n).concat(l))}}catch(e){i.e(e)}finally{i.f()}}return o}var en=n(484);function tn(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e!=e&&t!=t)return!0;if((0,en.Z)(e)===(0,en.Z)(t)&&nn(e)&&nn(t)){if(on(e)){if(!on(t))return!1;var n=e.length;if(n!==t.length)return!1;for(var o=0;o<n;o++)if(!tn(e[o],t[o]))return!1;return!0}if(on(t))return!1;var r,i,l={};for(r in e)if(e.hasOwnProperty(r)){if(rn(e[r]))continue;if(!tn(e[r],t[r]))return!1;l[r]=!0}for(i in t)if(t.hasOwnProperty(i)){if(rn(t[i]))continue;if(!l.hasOwnProperty(i)&&void 0!==t[i])return!1}return!0}return!1}function nn(e){return"object"===(0,en.Z)(e)}function on(e){return"[object Array]"===Object.prototype.toString.apply(e)}function rn(e){return"function"==typeof e}var ln=n(122),an="topBorder",sn="bottomBorder",cn="border";var dn=function(e){(0,N.Z)(a,e);var t,n,l=(t=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function a(){return(0,P.Z)(this,a),l.apply(this,arguments)}return(0,k.Z)(a,[{key:"shouldComponentUpdate",value:function(e){return!tn(e.lines,this.props.lines)}},{key:"getLine",value:function(e,t){var n=function(e,t){var n,l=e.padding&&e.padding.left||0,a=e.padding&&e.padding.right||0,s=e.pattern?e.pattern.borderColor:e.color,c=function(e){switch(e){case i.Solid:return"solid";case i.Dashed:return"dashed";case i.Dotted:return"dotted";default:return"none"}}(e.style),d=Number(e.position),h=function(e,t){return[r.Top,r.TopBottom].includes(e)&&t===b.Top?b.Top:null}(d,t),p=function(e,t){return[r.Bottom,r.TopBottom].includes(e)&&t===b.Bottom?b.Bottom:null}(d,t),u={position:"absolute",boxSizing:"border-box",left:"".concat(l,"px"),width:"calc(100% - ".concat(l+a,"px)")};switch(t){case h:u.top="0px",u.borderTop="".concat(e.size,"px ").concat(c," ").concat(e.color);break;case p:u.bottom="0px",u.borderBottom="".concat(e.size,"px ").concat(c," ").concat(e.color);break;default:return}return e.pattern&&(delete u.backgroundColor,delete u.borderTop,delete u.borderBottom,u.border="1px solid ".concat(s),u.height="".concat(e.pattern.width+2,"px"),n=e.pattern.style,[o.solid,o.whiteFill].includes(n)?u.backgroundColor=e.pattern.color:e.pattern.style!==o.transparentFill&&(u.backgroundImage=e.pattern.background)),u}(t,e),l=function(e){return e===b.Bottom?sn:e===b.Top?an:void 0}(e);return n?_.createElement("div",{className:"".concat(cn," ").concat(l),style:n}):null}},{key:"render",value:function(){var e={};this.props.lines.forEach((function(t){if(t.style!==i.None)switch(t.position){case r.Top:e[r.Top]=t;break;case r.Bottom:e[r.Bottom]=t;break;case r.TopBottom:e[r.Top]=t,e[r.Bottom]=t}}));var t=e[r.Top],n=e[r.Bottom];return _.createElement(_.Fragment,null,void 0!==t&&this.getLine(b.Top,t),void 0!==n&&this.getLine(b.Bottom,n))}}]),a}(_.Component);var hn=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"render",value:function(){var e=this.props.borderType===b.Top?an:sn;return _.createElement("div",{style:{width:"calc(100% - ".concat(ne.BORDER_PADDING,"px)")},className:"".concat("defaultBorderStyle"," ").concat(cn," ").concat(e)})}}]),r}(_.PureComponent);function pn(e){var t;switch(null==e||null===(t=e.alignment)||void 0===t?void 0:t.vertical){case a.Top:return{verticalAlign:"top",alignItems:"flex-start"};case a.Middle:return{verticalAlign:"middle",alignItems:"center"};case a.Bottom:return{verticalAlign:"bottom",alignItems:"flex-end"};default:return}}function un(e){var t;switch(null==e||null===(t=e.alignment)||void 0===t?void 0:t.horizontal){case s.Left:return{textAlign:"left",justifyContent:"flex-start"};case s.Center:return{textAlign:"center",justifyContent:"center"};case s.Right:return{textAlign:"right",justifyContent:"flex-end"};default:return}}function fn(e,t){return{paddingLeft:e||oe.CELL_PADDING_LEFT,paddingTop:t||oe.CELL_PADDING_TOP}}function gn(e,t){if(t&&t.wrap)return{whiteSpace:"pre-line",wordWrap:e===v.Comment?"break-word":"normal"}}function Cn(e){if(function(e){return!(e.isInHierarchy&&(e.cellType===v.RowDimMember||e.cellType===v.AttributeRowDimMember)||v.Chart===e.cellType)}(e))return un(e.style)}function vn(e){return!(e.isInHierarchy&&(e.cellType===v.ColDimMember||e.cellType===v.AttributeColDimMember)||v.Chart===e.cellType)}function bn(e){if(e.styleUpdatedByUser)return vn(e)?pn(e.style):void 0}function yn(e,t,n){var o=e.size?e.size:void 0;o&&t&&(o=o*(n===d.Title?t.title||t.alltext||ne.FONT_OVERRIDE_SCALE:n===d.Subtitle?t.subtitle||t.alltext||ne.FONT_OVERRIDE_SCALE:t.alltext||ne.FONT_OVERRIDE_SCALE)/100);var r=o?Math.round(o*oe.FONTSIZE_TO_LINEHEIGHT_FACTOR):void 0;return{fontSize:o,lineHeight:r?"".concat(r,"px"):void 0,fontWeight:void 0===e.bold?void 0:e.bold?"bold":"normal",color:e.color?e.color:void 0,fill:e.color?e.color:void 0,fontFamily:e.family?e.family:void 0,fontStyle:void 0===e.italic?void 0:e.italic?"italic":"normal",textDecoration:"".concat(e.underline?"underline":""," ").concat(e.strikethrough?"line-through":"")}}function mn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mn(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var wn="dimensionMember",Sn="headerCell",Tn="rowDimMember",On="colDimMember";function Dn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"".concat(wn," ").concat(e?"cellInHierarchy ":"").concat(t)}function En(e,t){var n=ne.FONT_SIZE;e.style&&e.style.font&&e.style.font.size&&(n=yn(e.style.font,t).fontSize);var o,r=0;return((o=e.dataLocking)&&o.type!==m.NoIcon||e.validation||e.style&&e.style.thresholdIconType)&&(r=oe.ICON_HEIGHT),Math.max(r,Number(n))}function In(e){return e<=oe.CELL_PADDING_RIGHT+oe.CELL_PADDING_LEFT}function An(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0",o={overflow:"hidden",paddingTop:0,maxHeight:0};if(e===re.MIN_HEIGHT)return o;var r="number"==typeof n?n:Number.parseInt(n,10),i=e-r-t;if(i<0){var l=e-r>0;return o.paddingTop=l?r:e,o.maxHeight=l?e-r:0,o}return o.paddingTop=r,o.maxHeight=e,o}function Hn(e){var t=e.cell,n=t.formatted,o=t.cellType,r=e.width;return!!U(o)||""!==n&&r>oe.NO_CONTENT_COLUMN_SIZE}function Ln(e){var t;return!(null!==(t=e.style)&&void 0!==t&&t.thresholdFillColor)}function xn(e){return Rn(Rn(Rn(Rn(Rn(Rn(Rn({},(r={},null!==(n=(t=e.cell).cellIconsLeft)&&void 0!==n&&n.length&&(r.paddingLeft=oe.CELLTEXT_PADDING_HORIZONTAL),null!==(o=t.cellIconsRight)&&void 0!==o&&o.length&&(r.paddingRight=oe.CELLTEXT_PADDING_HORIZONTAL),r)),function(e,t){var n,o=(null===(n=e.style)||void 0===n?void 0:n.font)&&yn(e.style.font,t);return"number"==typeof(null==o?void 0:o.lineHeight)&&(o.lineHeight=ae(o.lineHeight)),o}(e.cell,e.fontOverride)),un(e.cell.style)),pn(e.cell.style)),function(e,t){var n;return null!==(n=e.style)&&void 0!==n&&n.wrap?function(e,t){return{maxHeight:"".concat(e,"px"),height:"".concat(e,"px"),whiteSpace:"pre-line",wordWrap:t===v.Comment?"break-word":"normal"}}(t,e.cellType):void 0}(e.cell,e.height)),{flexWrap:"wrap"}),{},{height:ae(e.lineHeight)});var t,n,o,r}function Pn(e){var t,n,o=vn(e)?{vertical:null===(t=e.style)||void 0===t||null===(n=t.alignment)||void 0===n?void 0:n.vertical}:void 0;return Rn(Rn({},e),{},{formatted:"",commentType:void 0,style:Rn(Rn({},e.style),{},{font:void 0,alignment:o,wrap:void 0})})}var kn=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(e){var t;return(0,P.Z)(this,r),(t=o.call(this,e)).cellValueRef=_.createRef(),t.boundHandleDoubleClick=t.handleDoubleClick.bind((0,M.Z)(t)),t.boundHandleCellMouseDown=t.handleCellMouseDown.bind((0,M.Z)(t)),t.boundHandleCellMouseEnter=t.handleCellMouseEnter.bind((0,M.Z)(t)),t.boundHandleCellMouseUp=t.handleCellMouseUp.bind((0,M.Z)(t)),t.boundHandleCellMouseOver=t.handleCellMouseOver.bind((0,M.Z)(t)),t.boundHandleCellMouseLeave=t.handleCellMouseLeave.bind((0,M.Z)(t)),t.boundHandleShowColOverlay=t.handleShowColOverlay.bind((0,M.Z)(t)),t.boundHandleShowRowOverlay=t.handleShowRowOverlay.bind((0,M.Z)(t)),t.boundHandleColSelection=t.handleColSelection.bind((0,M.Z)(t)),t.boundHandleRowSelection=t.handleRowSelection.bind((0,M.Z)(t)),t.boundHandleContextMenu=t.handleContextMenu.bind((0,M.Z)(t)),t}return(0,k.Z)(r,[{key:"shouldComponentUpdate",value:function(e){return!!this.props.children||!(this.props.firstInRow===e.firstInRow&&this.props.firstInCol===e.firstInCol&&this.props.mobile===e.mobile&&this.props.width===e.width&&this.props.height===e.height&&this.props.left===e.left&&this.props.extraClass===e.extraClass&&this.props.showRowColumnHover===e.showRowColumnHover&&tn(e.style,this.props.style)&&tn(e.cell,this.props.cell))}},{key:"componentDidMount",value:function(){var e;null===(e=this.cellValueRef.current)||void 0===e||e.setAttribute("editable","".concat(this.props.cell.editable&&!this.props.cell.locked))}},{key:"componentDidUpdate",value:function(){var e;null===(e=this.cellValueRef.current)||void 0===e||e.setAttribute("editable","".concat(this.props.cell.editable&&!this.props.cell.locked))}},{key:"handleDoubleClick",value:function(e){var t=e.target,n={col:this.props.cell.column,row:this.props.cell.row,target:t};this.props.handler.onCellEdit(n,!1)}},{key:"handleCellMouseDown",value:function(e){var t={col:this.props.cell.column,row:this.props.cell.row,event:e.nativeEvent,cellType:this.props.cell.cellType,context:this.props.cell.context,target:e.target,cellHyperlinkId:"cellHyperlink".concat(this.props.cell.id),selectedCell:Xt(this.props.cell.row,this.props.cell.column)};this.props.handler.onCellMouseDown(t)}},{key:"handleCellMouseEnter",value:function(e){var t={col:this.props.cell.column,row:this.props.cell.row,event:e.nativeEvent,cellType:this.props.cell.cellType,context:this.props.cell.context};this.props.handler.onCellMouseEnter(t)}},{key:"handleCellMouseUp",value:function(e){var t={col:this.props.cell.column,row:this.props.cell.row,event:e.nativeEvent,cellType:this.props.cell.cellType,context:this.props.cell.context};this.props.handler.onCellMouseUp(t)}},{key:"handleCellMouseOver",value:function(e){var t=e.target.closest(".tableCell"),n={col:this.props.cell.column,row:this.props.cell.row,target:t,boundingClientRect:null==t?void 0:t.getBoundingClientRect(),event:e.nativeEvent,getParameters:function(){return this},hoveredCell:Xt(this.props.cell.row,this.props.cell.column)};this.props.handler.onCellMouseOver(n)}},{key:"handleCellMouseLeave",value:function(e){this.props.handler.onCellMouseLeave&&this.props.handler.onCellMouseLeave(e),this.props.handler.onHideOverlay()}},{key:"handleContextMenu",value:function(e){this.props.handler.onContextMenu({row:this.props.cell.row,col:this.props.cell.column,targetDescription:Xt(this.props.cell.row,this.props.cell.column),event:e.nativeEvent,isTitle:!1})}},{key:"handleShowRowOverlay",value:function(e){var t=this.createRowOverlayEvent(e);this.props.handler.onShowRowColOverlay(t)}},{key:"handleShowColOverlay",value:function(e){var t=this.createColOverlayEvent(e);this.props.handler.onShowRowColOverlay(t)}},{key:"handleColSelection",value:function(e){var t=this.createColOverlayEvent(e);this.props.handler.onOverlayClick(t)}},{key:"handleRowSelection",value:function(e){var t=this.createRowOverlayEvent(e);this.props.handler.onOverlayClick(t)}},{key:"createRowOverlayEvent",value:function(e){return{row:function(e,t,n){if(void 0===t)return-1;if(!e)return t;for(var o=t,r=0,i=0;i<=e.length;i++)if(o=t+i,(r+=e[i])>=n)return o;return o}(this.props.mergeCellRowHeights,this.props.cell.row,e.nativeEvent.offsetY),event:e.nativeEvent}}},{key:"createColOverlayEvent",value:function(e){return{col:function(e,t,n){if(void 0===t)return-1;if(!e)return t;for(var o=t,r=0,i=0;i<=e.length;i++)if(o=t+i,(r+=e[i])>=n)return o;return o}(this.props.mergeCellColumnWidths,this.props.cell.column,e.nativeEvent.offsetX),event:e.nativeEvent}}},{key:"render",value:function(){var e,t=null!==(e=this.props.featureToggles)&&void 0!==e&&e.accessibilityKeyboardSupport?-1:void 0,n=this.props.style||{};n.width=this.props.width,n.height=this.props.height,n.left=this.props.left;var o=!this.props.cell.merged&&this.boundHandleShowRowOverlay||void 0,r=this.props.cell.merged&&this.boundHandleShowRowOverlay||void 0,i=!this.props.cell.merged&&this.boundHandleShowColOverlay||void 0,l=this.props.cell.merged&&this.boundHandleShowColOverlay||void 0,a=this.props.showRowColumnHover&&!this.props.mobile,s=this.props.defaultTooltipText||this.props.cell.formatted;return _.createElement("div",{"data-tablerow":this.props.cell.row,"data-tablecol":this.props.cell.column,onDoubleClick:this.boundHandleDoubleClick,onMouseDown:this.boundHandleCellMouseDown,onMouseEnter:this.boundHandleCellMouseEnter,onMouseUp:this.boundHandleCellMouseUp,onMouseMove:this.boundHandleCellMouseOver,onMouseLeave:this.boundHandleCellMouseLeave,onContextMenu:this.boundHandleContextMenu,className:"".concat(oe.CELL_CLASSNAME," cell").concat(this.props.cell.id," ").concat(this.props.extraClass),style:n,ref:this.cellValueRef,title:s,tabIndex:t,role:this.props.ariaRole,"aria-label":this.props.ariaLabel,"aria-describedby":this.props.ariaDescribedBy},this.props.children,a&&this.props.firstInCol&&_.createElement("div",{className:"colSelection",onMouseOver:i,onMouseMove:l,onMouseOut:this.props.handler.onHideOverlay,onClick:this.boundHandleColSelection}),a&&this.props.firstInRow&&_.createElement("div",{className:"rowSelection",onMouseOver:o,onMouseMove:r,onMouseOut:this.props.handler.onHideOverlay,onClick:this.boundHandleRowSelection}))}}]),r}(_.Component);var _n=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"getTitle",value:function(){return this.props.commentType===g.Child?this.props.getTranslatedText?this.props.getTranslatedText(T.childCommentTooltip):void 0:this.props.formattedCellValue}},{key:"render",value:function(){return _.createElement("span",{className:"icon ".concat(this.props.commentType===g.Self?"comment":"childComment"),title:this.getTitle()})}}]),r}(_.PureComponent);var zn=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"render",value:function(){return _.createElement("a",{id:"cellHyperlink".concat(this.props.linkId),className:"tableCellHyperlink",title:this.props.linkText},this.props.linkText)}}]),r}(_.PureComponent);function Mn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Nn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mn(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Zn=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(e){var t;return(0,P.Z)(this,r),(t=o.call(this,e)).boundHandleDoubleClick=t.handleDoubleClick.bind((0,M.Z)(t)),t.boundHandleCellMouseDown=t.handleCellMouseDown.bind((0,M.Z)(t)),t.boundHandleCellMouseEnter=t.handleCellMouseEnter.bind((0,M.Z)(t)),t}return(0,k.Z)(r,[{key:"shouldComponentUpdate",value:function(e){return!!this.props.children||!(this.props.showGrid===e.showGrid&&this.props.firstInRow===e.firstInRow&&this.props.firstInCol===e.firstInCol&&this.props.extraClass===e.extraClass&&this.props.mobile===e.mobile&&this.props.lineHeight===e.lineHeight&&this.props.width===e.width&&this.props.height===e.height&&this.props.left===e.left&&this.props.showRowColumnHover===e.showRowColumnHover&&tn(e.cell,this.props.cell)&&tn(e.fontOverride,this.props.fontOverride)&&tn(e.featureToggles,this.props.featureToggles))}},{key:"handleDoubleClick",value:function(e){U(this.props.cell.cellType)||this.props.handler.onCellEdit(e,!1)}},{key:"handleCellMouseDown",value:function(e){var t=Nn(Nn({},e),{},{chartDimension:this.props.cell.cellChart&&this.props.cell.cellChart.memberId,chartContext:this.props.cell.cellChart&&this.props.cell.cellChart.context});this.props.handler.onCellMouseDown(t)}},{key:"handleCellMouseEnter",value:function(e){var t=Nn(Nn({},e),{},{chartDimension:this.props.cell.cellChart&&this.props.cell.cellChart.memberId,chartContext:this.props.cell.cellChart&&this.props.cell.cellChart.context});this.props.handler.onCellMouseEnter(t)}},{key:"getDefaultTemplateBorder",value:function(e){var t=this.props.cell,n=t.id,o=t.cellType,r=t.category,i="cell_".concat(n,"_").concat(e,"Line");if(e===b.Top&&(o===v.RowDimHeader||o===v.AttributeRowDimHeader))return _.createElement(hn,{key:i,borderType:b.Top});var l=!function(e){return j(e)||[v.Header,v.RowDimHeader,v.AttributeRowDimHeader].includes(e)}(o)&&!function(e){return[v.EmptyAxisRowHeader,v.EmptyAxisColumnHeader].includes(e)}(o);return e===b.Bottom&&(l||r)?_.createElement(hn,{key:i,borderType:b.Bottom}):null}},{key:"getCellStyle",value:function(){var e={},t=this.props.cell.style;if(t){var n=function(e){var t,n,o;if(!e.reference)return null!==(t=null===(n=e.style)||void 0===n?void 0:n.thresholdFillColor)&&void 0!==t?t:null===(o=e.style)||void 0===o?void 0:o.fillColor}(this.props.cell);e=Nn(Nn({},t.font&&yn(t.font,this.props.fontOverride)),{},{backgroundColor:n},bn(this.props.cell))}return!this.props.cell.isInHierarchy&&this.props.cell.row>=0&&this.props.cell.column>=0&&(e=Nn(Nn(Nn({},e),Cn(this.props.cell)),gn(this.props.cell.cellType,this.props.cell.style))),e}},{key:"renderValue",value:function(){return this.props.cell.showHyperlink?this.renderHyperlink():this.props.cell.formatted}},{key:"renderIcons",value:function(){var e=this.renderDataLockingIcon(),t=this.renderThreshold(),n=this.renderValidationWarningIcon();return e||t||n?_.createElement(_.Fragment,null,e,n,t):null}},{key:"renderNonHierarchyCellValue",value:function(){var e,t=En(this.props.cell,this.props.fontOverride),n=function(e,t){return e<t}(this.props.lineHeight,t)||In(this.props.width),o=Nn(Nn({},An(this.props.lineHeight,t)),Cn(this.props.cell));return n||null!==(e=this.props.cell.style)&&void 0!==e&&e.wrap?_.createElement("div",{className:"cutOffContent showEllipsis",style:o,key:"nonHierarchyCellValue"},this.renderIconsAndValue()):this.renderIconsAndValue()}},{key:"renderIconsAndValue",value:function(){var e=this.renderIcons();return _.createElement(_.Fragment,null,e,_.createElement("span",{className:"cellValue showEllipsis"},this.renderValue()))}},{key:"renderHyperlink",value:function(){return _.createElement(zn,{linkId:this.props.cell.id,linkText:this.props.cell.formatted})}},{key:"renderThreshold",value:function(){return this.props.cell.cellType!==v.Chart&&this.props.cell.style&&this.props.cell.style.thresholdIconType?_.createElement("span",{className:"icon nextToCellValue thresholdIcon ".concat(this.props.cell.style.thresholdIconType),style:{color:this.props.cell.style.thresholdColor?this.props.cell.style.thresholdColor:void 0}}):null}},{key:"renderDataLockingIcon",value:function(){return this.props.cell.cellType!==v.Chart&&this.props.cell.dataLocking&&this.props.cell.dataLocking.type!==m.NoIcon?_.createElement("span",{className:"icon nextToCellValue dataLocking ".concat(this.props.cell.dataLocking.type),title:"".concat(this.props.cell.dataLocking.tooltip)}):null}},{key:"renderValidationWarningIcon",value:function(){return this.props.cell.cellType!==v.Chart&&this.props.cell.validation?_.createElement("span",{className:"icon nextToCellValue validationWarning ".concat(this.props.cell.validation.type),title:"".concat(this.props.cell.validation.tooltip)}):null}},{key:"renderLines",value:function(){var e;return this.props.cell.styleUpdatedByUser?null!==(e=this.props.cell.style)&&void 0!==e&&e.lines?_.createElement(dn,{lines:this.props.cell.style.lines}):null:_.createElement(_.Fragment,null,this.getDefaultTemplateBorder(b.Top),this.getDefaultTemplateBorder(b.Bottom))}},{key:"renderChildren",value:function(){return this.props.children}},{key:"render",value:function(){var e,t,n,o,r,i=Hn(this.props),l=this.props.cell.styleUpdatedByUser?this.getCellStyle():{},a=Nn(Nn({},this.props.handler),{},{onCellEdit:this.boundHandleDoubleClick,onCellMouseDown:this.boundHandleCellMouseDown,onCellMouseEnter:this.boundHandleCellMouseEnter}),s=function(e,t){var n;if(e)switch(t){case v.RowDimHeader:case v.RowDimMember:case v.EmptyAxisRowHeader:n="rowheader";break;case v.ColDimHeader:case v.ColDimMember:case v.EmptyAxisColumnHeader:n="columnheader";break;default:n="gridcell"}return n}(null===(e=this.props.featureToggles)||void 0===e?void 0:e.accessibilityScreenReaderSupport,this.props.cell.cellType);return _.createElement(kn,(0,ln.Z)({},this.props,{handler:a,style:l,extraClass:"".concat((n={cell:this.props.cell,width:this.props.width,extraClass:this.props.extraClass},r="tableDivCell",r+=" ".concat(function(e){var t="";if(W(e)&&(t+=" headerCell"),e!==v.RowDimHeader&&e!==v.AttributeRowDimHeader||(t+=" rowDimHeader"),e===v.AttributeRowDimHeader&&(t+=" attributeRowDimHeader"),e!==v.ColDimHeader&&e!==v.AttributeColDimHeader||(t+=" colDimHeader"),e===v.AttributeColDimHeader&&(t+=" attributeColDimHeader"),U(e)){switch(t+=" coordinateHeader",e){case v.ColumnCoordinate:case v.ColumnCoordinateSelectedDesignMode:case v.ColumnCoordinateSelectedViewMode:t+=" ".concat(oe.COORDINATE_COL_HEADER_CLASSNAME);break;case v.RowCoordinate:case v.RowCoordinateSelectedDesignMode:case v.RowCoordinateSelectedViewMode:t+=" ".concat(oe.COORDINATE_ROW_HEADER_CLASSNAME);break;case v.CoordinateCorner:t+=" coordinateCorner icon selectAllCellsIcon"}switch(e){case v.ColumnCoordinateSelectedDesignMode:case v.RowCoordinateSelectedDesignMode:t+=" coordinateHeaderSelectedDesign";break;case v.ColumnCoordinateSelectedViewMode:case v.RowCoordinateSelectedViewMode:t+=" coordinateHeaderSelectedView"}}return F(e)&&(t+=" dataCell"),e===v.Comment&&(t+=" commentCell"),e===v.Chart&&(t+=" chartCell"),t}(n.cell.cellType)),n.cell.locked&&(r+=" locked"),!n.cell.editable&&(F(n.cell.cellType)&&n.cell.cellType!==v.Comment||n.cell.cellType===v.Custom)&&(r+=" readOnly"),n.cell.referenceToLockedCell&&(r+=" referenceToLockedCell"),n.cell.reference&&(r+=" referencedCell"),n.cell.modified&&Ln(n.cell)&&(r+=" modified"),n.cell.modifiedMDE&&Ln(n.cell)&&(r+=" modifiedMDE"),n.cell.category&&(r+=" Category".concat(n.cell.category)),n.cell.isInATotalsContext&&(r+=" totals"),n.extraClass&&(r+=" ".concat(n.extraClass)),null!==(o=n.cell.style)&&void 0!==o&&o.wrap&&(r+=" cellIsWrapped"),In(n.width)&&(r+=" noHorizontalPadding"),r)),ariaRole:s,ariaLabel:this.props.ariaLabel,ariaDescribedBy:this.props.ariaDescribedBy}),this.renderLines(),void 0!==this.props.cell.commentType&&void 0!==(t=this.props.cell.commentType)&&t!==g.None&&_.createElement(_n,{commentType:this.props.cell.commentType,formattedCellValue:this.props.cell.formatted,getTranslatedText:this.props.handler.getTranslatedText}),this.props.width>oe.NO_CONTENT_COLUMN_SIZE&&this.renderChildren(),i&&!this.props.cell.isInHierarchy&&this.renderNonHierarchyCellValue())}}]),r}(_.Component);function Bn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function jn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bn(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Wn=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"renderHierarchyCellValue",value:function(){var e,t;if(this.props.cell.style&&this.props.cell.style.wrap)return this.renderWrappedHierarchyCellValue();var n=En(this.props.cell,this.props.fontOverride),o=(null===(e=this.props.cell.style)||void 0===e?void 0:e.font)&&yn(this.props.cell.style.font,this.props.fontOverride),r=jn(jn(jn(jn({},this.props.hierarchyStyle),Cn(this.props.cell)),An(this.props.lineHeight,n,null===(t=this.props.hierarchyStyle)||void 0===t?void 0:t.paddingTop)),o);return _.createElement("div",{className:"textOverflow cutOffContent showEllipsis",title:this.props.textValue,style:r,key:"hierarchyCellValue"},this.renderHierarchyValue())}},{key:"renderWrappedHierarchyCellValue",value:function(){var e,t,n,o=En(this.props.cell,this.props.fontOverride),r=jn({},An(this.props.lineHeight,o,null===(e=this.props.hierarchyStyle)||void 0===e?void 0:e.paddingTop)),i=ae(Math.max(0,this.props.lineHeight-Number(r.paddingTop))),l=(null===(t=this.props.hierarchyStyle)||void 0===t?void 0:t.paddingLeft)||oe.CELL_PADDING_LEFT,a=(this.props.showGrid?oe.GRID_BORDER_SIZE:0)+(this.props.showGrid&&this.props.firstInRow?oe.GRID_BORDER_SIZE:0),s=this.props.width-Number(l)-oe.CELL_PADDING_RIGHT-a,c=(null===(n=this.props.cell.style)||void 0===n?void 0:n.font)&&yn(this.props.cell.style.font,this.props.fontOverride),d=jn(jn(jn(jn({paddingLeft:l},this.props.hierarchyStyle),r),Cn(this.props.cell)),{},{height:i,maxWidth:s,width:s},c),h={display:"table",height:i,maxWidth:s,width:s},p=jn(jn(jn({display:"table-cell"},bn(this.props.cell)),gn(this.props.cell.cellType,this.props.cell.style)),{},{maxWidth:s,width:s});return _.createElement("div",{className:"hierarchyCellOuterDiv",style:d},_.createElement("div",{className:"hierarchyCellInnerDiv",style:h},_.createElement("div",{className:"textOverflow",title:this.props.textValue,style:p},this.renderHierarchyValue())))}},{key:"renderHierarchyValue",value:function(){var e=this.props.cell.cellType===v.RowDimMember?"div":"span";return _.createElement(_.Fragment,null,this.props.children,this.props.cell.showHyperlink?_.createElement(zn,{linkId:this.props.cell.id,linkText:this.props.textValue}):_.createElement(e,{className:"showEllipsis"},this.props.textValue))}},{key:"render",value:function(){return this.renderHierarchyCellValue()}}]),r}(_.PureComponent);function Fn(e,t){return Gn("row-".concat(e,"-").concat(t))}function Un(e,t){return Gn("column-setting-".concat(e,"-").concat(t))}function Gn(e){return function(e){var t=0;if(!e)return"";for(var n=0;n<e.length;++n)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t<0?"".concat("-".charCodeAt(0).toString(16)).concat((-1*t).toString(16)):"".concat(t.toString(16))}(e)}function Vn(e){return e.versionEdited?"".concat(e.formatted," *"):e.formatted}function Kn(e,t,n){return{id:(o=e,r=t,i=n,Gn("empty-cell-".concat(o,"-").concat(r,"-").concat(i))),row:e,column:t,formatted:"",plain:"",context:{dimensions:[],originalDimension:""},editable:!0,isInHierarchy:!1,cellType:v.Empty,style:{},styleUpdatedByUser:!0};var o,r,i}var Xn=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"render",value:function(){return _.createElement("div",{id:"".concat(X.NEW_LINE_WRAPPER)})}}]),r}(_.PureComponent);function Yn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Jn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yn(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Qn=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"getExtraClass",value:function(e){return"".concat("newLine"," ").concat(this.getClassesBasedOnCellType()," ").concat(Dn(this.props.cell.isInHierarchy,this.props.extraClass)).concat(e?" editing":"")}},{key:"getClassesBasedOnCellType",value:function(){var e=[Sn];return this.props.cell.cellType===v.NewLineOnRow&&e.push(Tn),this.props.cell.cellType===v.NewLineOnColumn&&e.push(On),e.join(" ")}},{key:"isActiveMemberCell",value:function(){return!(!this.props.activeNewLineMemberCell||this.props.activeNewLineMemberCell.row!==this.props.cell.row||this.props.activeNewLineMemberCell.col!==this.props.cell.column)}},{key:"render",value:function(){var e=this.isActiveMemberCell(),t=Hn(this.props),n=Vn(this.props.cell);return _.createElement(Zn,(0,ln.Z)({},this.props,{cell:Jn(Jn({},this.props.cell),{},{formatted:n}),extraClass:this.getExtraClass(e)}),this.props.cell.isInHierarchy&&t&&_.createElement(Wn,{textValue:n,cell:this.props.cell,lineHeight:this.props.lineHeight,showGrid:this.props.showGrid,fontOverride:this.props.fontOverride,hierarchyStyle:fn(this.props.cell.hierarchyPaddingLeft,this.props.cell.hierarchyPaddingTop),firstInRow:this.props.firstInRow,width:this.props.width}),e&&_.createElement(Xn,null))}}]),r}(_.Component),$n=function(){function e(t){(0,P.Z)(this,e),this.labelArray=[],this.cell=t}return(0,k.Z)(e,[{key:"addDefaultAttributes",value:function(){return this.labelArray.push(this.cell.locked?"locked cell":""),this.labelArray.push(this.cell.dataLocking&&this.cell.dataLocking.type!==m.NoIcon?"data locking: ".concat(this.cell.dataLocking.type.toString()):""),this.labelArray.push(this.cell.editable?"cell is editable":""),this}},{key:"addCellValueAttribute",value:function(){return this.labelArray.push(this.cell.formatted),this}},{key:"addCellTypeAttribute",value:function(){return this.labelArray.push("".concat(v[this.cell.cellType].toString()," cell")),this}},{key:"addCustomAttribute",value:function(e){return this.labelArray.push(e),this}},{key:"get",value:function(){var e=this.labelArray.filter(String).join(", ");return e.length>0?e:void 0}}]),e}();function qn(e,t){if(e){var n=new $n(t);switch(t.cellType){case v.Value:n.addCellValueAttribute().addDefaultAttributes();break;case v.Empty:n.addCellTypeAttribute().addDefaultAttributes();break;case v.Custom:!function(e,t){var n,o,r=null===(n=t.merged)||void 0===n?void 0:n.columns,i=null===(o=t.merged)||void 0===o?void 0:o.rows,l="";i&&r?l="Merged over ".concat(r+1," columns and ").concat(i+1," rows"):i&&!r?l="Merged over ".concat(i+1," rows"):!i&&r&&(l="Merged over ".concat(r+1," columns")),e.addCellTypeAttribute().addCustomAttribute(l).addCellValueAttribute().addDefaultAttributes()}(n,t);break;case v.Marquee:case v.ColumnCoordinate:case v.Title:case v.CoordinateCorner:case v.ColumnCoordinateSelectedDesignMode:case v.RowCoordinateSelectedDesignMode:case v.ColumnCoordinateSelectedViewMode:case v.RowCoordinateSelectedViewMode:case v.MergedDummyCell:break;default:n.addCellTypeAttribute().addCellValueAttribute().addDefaultAttributes()}return n.get()}}function eo(e,t){var n;if(e){var o=null===(n=t.cellChart)||void 0===n?void 0:n.chartType,r="".concat(null==o?void 0:o.charAt(0)),i="".concat(null==o?void 0:o.slice(1)),l="".concat(r.toUpperCase()).concat(i);return new $n(t).addCustomAttribute(o?"".concat(l," chart cell"):"Chart cell").addCellValueAttribute().addDefaultAttributes().get()}}function to(e,t){if(e)return new $n(t).addCellTypeAttribute().addDefaultAttributes().get()}function no(e){if(e)return"Empty"}function oo(e,t,n){var o="";return n&&n["".concat(e,"-").concat(t)]&&(o="".concat(n["".concat(e,"-").concat(t)].style.join(" "))),o}function ro(e,t,n){return{widthBarFilled:"".concat(100-2*oe.BAR_CHART_VERTICAL_PADDING_PERCENT,"%"),widthLine:"100%",heightLine:oe.AXIS_SIZE_IN_CELL_CHARTS,xBar:"".concat(oe.BAR_CHART_VERTICAL_PADDING_PERCENT,"%"),xLine:0,xPin:n/2-oe.VARIANCE_PIN_SIZE/2,xText:"50%",textAnchor:"start",value:t,plain:e}}function io(e,t,n){return{heightBarFilled:"".concat(100-2*oe.BAR_CHART_HORIZONTAL_PADDING_PERCENT,"%"),widthLine:oe.AXIS_SIZE_IN_CELL_CHARTS,heightLine:"100%",yBar:"".concat(oe.BAR_CHART_HORIZONTAL_PADDING_PERCENT,"%"),yLine:0,yPin:n/2-oe.VARIANCE_PIN_SIZE/2,yText:"50%",textAnchor:"start",value:t,plain:e}}function lo(e){return e?e+oe.IN_CELL_CHART_TEXT_PADDING:0}function ao(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e-oe.AXIS_SIZE_IN_CELL_CHARTS-t}function so(e,t){return Math.max(e-t,0)}function co(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ho(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?co(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):co(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function po(e){return e===f.Horizontal?oe.CELL_CHART_TEXT_SHIFT_HORIZONTAL_BAR:oe.CELL_CHART_TEXT_SHIFT_VERTICAL_BAR}var uo=oe.AXIS_SIZE_IN_CELL_CHARTS/2;function fo(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=go(e),l=i.chartMinValue,a=i.chartMaxValue,s=i.isNegativeOnly,c=i.isPositiveOnly,d=c?uo:0,h=s?uo:0,p=r/2,u=t-d-h-r,f=lo(o),g=s||c?1:2,C=so(u,f*g),v=0===C,b=v?u:C,y=v?0:f,m=Math.abs(l)+Math.abs(a)||1,R=b/m,w=So(R*Math.abs(n)),S=s?0:y,T=So(R*a)+S+p+h,O=wo(T-uo),D=n<0?yo(T):bo(T,w),E=n<0||0===n&&s?mo(T,w,p):Ro(T,w,y,p),I=v?"0px":E,A=n<0?vo(T,w,v?0:p):Co(T,w,p);return{xBar:To(oe.BAR_CHART_VERTICAL_PADDING_PERCENT),yBar:ae(D),heightBarFilled:wo(w-uo),xLine:"0px",yLine:ae(O),heightLine:oe.AXIS_SIZE_IN_CELL_CHARTS,xText:"50%",yText:I,hideValue:v,textAnchor:"middle",xPin:"".concat(e.columnWidth/2-oe.VARIANCE_PIN_SIZE/2,"px"),yPin:A}}function go(e){var t=e.minValue,n=e.maxValue,o={chartMinValue:t,chartMaxValue:n,isPositiveOnly:0===t,isNegativeOnly:0!==t&&0===n};return t<0&&n<0?(o.chartMaxValue=0,o.chartMinValue=t,o.isNegativeOnly=!0):t>0&&n>0&&(o.chartMaxValue=n,o.chartMinValue=0,o.isPositiveOnly=!0),o}function Co(e,t,n){return ae(e-t-n)}function vo(e,t,n){return ae(e+t-n)}function bo(e,t){return e-t}function yo(e){return e+uo}function mo(e,t,n){return ae(e+t+oe.IN_CELL_CHART_TEXT_PADDING+n)}function Ro(e,t,n,o){return ae(wo(e-wo(t-uo)-uo-n-o))}function wo(e){return Math.max(e,0)}function So(e){return Math.floor(e)}function To(e){return"".concat(e,"%")}var Oo=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(e){return(0,P.Z)(this,r),o.call(this,e)}return(0,k.Z)(r,[{key:"shouldComponentUpdate",value:function(e){return!(this.props.height===e.height&&this.props.width===e.width&&this.props.color===e.color&&tn(e.chartCell,this.props.chartCell)&&tn(e.values,this.props.values)&&tn(e.style,this.props.style))}},{key:"render",value:function(){return this.props.values.value?_.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:this.props.width,height:this.props.height,shapeRendering:"crispedges",style:{verticalAlign:"middle"}},_.createElement("rect",{className:$.BAR_CHART_BAR,width:this.props.values.widthBarFilled,height:this.props.values.heightBarFilled,fill:this.props.color,x:this.props.values.xBar,y:this.props.values.yBar}),_.createElement("rect",{className:"barChartAxis",width:this.props.values.widthLine,height:this.props.values.heightLine,x:this.props.values.xLine,y:this.props.values.yLine,fill:this.props.chartCell.lineColor}),_.createElement("text",(0,ln.Z)({},this.props.style,{className:"barChartText",y:this.props.values.yText,x:this.props.values.xText,textAnchor:this.props.values.textAnchor,dy:po(this.props.chartCell.orientation)}),this.props.chartCell.showValue?this.props.values.value:"")):null}}]),r}(_.Component);var Do=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"shouldComponentUpdate",value:function(e){return!(this.props.height===e.height&&this.props.width===e.width&&this.props.color===e.color&&tn(e.style,this.props.style)&&tn(e.chartCell,this.props.chartCell)&&tn(e.values,this.props.values))}},{key:"renderBar",value:function(){return this.props.chartCell.orientation===f.Vertical?_.createElement("rect",{className:$.VARIANCEPIN_CHART_BAR,width:oe.VARIANCE_PIN_BAR_HEIGHT,height:this.props.values.heightBarFilled,fill:this.props.color,x:this.props.width/2-oe.VARIANCE_PIN_BAR_HEIGHT/2,y:this.props.values.yBar}):_.createElement("rect",{className:$.VARIANCEPIN_CHART_BAR,width:this.props.values.widthBarFilled,height:oe.VARIANCE_PIN_BAR_HEIGHT,fill:this.props.color,x:this.props.values.xBar,y:this.props.height/2-oe.VARIANCE_PIN_BAR_HEIGHT/2})}},{key:"render",value:function(){return this.props.values.value?_.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:this.props.width,height:this.props.height,shapeRendering:"crispedges",style:{verticalAlign:"middle"}},_.createElement("rect",{width:oe.VARIANCE_PIN_SIZE,height:oe.VARIANCE_PIN_SIZE,x:this.props.values.xPin,y:this.props.values.yPin,fill:"black"}),this.renderBar(),_.createElement("rect",{width:this.props.values.widthLine,height:this.props.values.heightLine,x:this.props.values.xLine,y:this.props.values.yLine,fill:this.props.chartCell.lineColor}),_.createElement("text",(0,ln.Z)({},this.props.style,{y:this.props.values.yText,x:this.props.values.xText,textAnchor:this.props.values.textAnchor,dy:po(this.props.chartCell.orientation)}),this.props.chartCell.showValue?this.props.values.value:"")):null}}]),r}(_.Component);function Eo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Io(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Eo(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Eo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ao=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(e){return(0,P.Z)(this,r),o.call(this,e)}return(0,k.Z)(r,[{key:"shouldComponentUpdate",value:function(e){return!(this.props.showGrid===e.showGrid&&this.props.firstInRow===e.firstInRow&&this.props.firstInCol===e.firstInCol&&this.props.extraClass===e.extraClass&&this.props.minValue===e.minValue&&this.props.maxValue===e.maxValue&&this.props.maxTextWidth===e.maxTextWidth&&this.props.maxTextHeight===e.maxTextHeight&&this.props.barHeight===e.barHeight&&this.props.columnWidth===e.columnWidth&&this.props.mobile===e.mobile&&this.props.lineHeight===e.lineHeight&&this.props.width===e.width&&this.props.height===e.height&&this.props.left===e.left&&this.props.showRowColumnHover===e.showRowColumnHover&&tn(e.cell,this.props.cell)&&tn(e.fontOverride,this.props.fontOverride)&&tn(e.columns,this.props.columns))}},{key:"renderChartByType",value:function(e){var t=this.props.cell.cellChart;if(t&&e){var n=t.barColor;this.props.cell.style&&this.props.cell.style.thresholdColor&&(n=this.props.cell.style.thresholdColor);var o=!!t.showValue&&!e.hideValue,r={chartCell:Io(Io({},t),{},{showValue:o}),values:e,style:o?this.getTextStyle():void 0,height:this.props.barHeight,width:this.props.columnWidth,color:n};switch(t.chartType){case S.VariancePin:return _.createElement(Do,r);case S.VarianceBar:case S.Bar:default:return _.createElement(Oo,r)}}return null}},{key:"render",value:function(){return _.createElement(Zn,(0,ln.Z)({},this.props,{cell:Io(Io({},this.props.cell),{},{formatted:""})}),this.props.barHeight>0&&this.props.columnWidth>0&&this.renderChartByType(this.getChartCellValues()))}},{key:"getChartCellValues",value:function(){var e=Number(this.props.cell.plain);if(this.props.cell.cellChart&&!isNaN(e)){var t=this.props.cell.cellChart.chartType===S.VariancePin?oe.VARIANCE_PIN_SIZE/2:0,n=this.props.cell.cellChart.orientation===f.Horizontal?this.props.columnWidth:this.props.barHeight,o=0;return this.props.cell.cellChart.showValue&&(o=this.props.cell.cellChart.orientation===f.Horizontal?this.props.maxTextWidth:this.props.maxTextHeight),this.props.minValue>=0?this.calculatePositiveOnlyValues(this.props.cell.cellChart,e,t,n,o):this.props.maxValue>0?function(e,t,n,o,r,i){switch(t.orientation){case f.Horizontal:var l,a,s,c,d=ao(r,o),h=lo(i),p=so(d,2*h),u=0===p,g=u?2:h,C=(u?d:p)/(Math.abs(e.minValue)+Math.abs(e.maxValue)),v=C*Math.abs(n),b=C*Math.abs(e.minValue)+g-oe.AXIS_SIZE_IN_CELL_CHARTS/2;return n<0?(a=(l=b-v)-oe.VARIANCE_PIN_SIZE/2,s=l-o-oe.IN_CELL_CHART_TEXT_PADDING,c="end"):(a=(l=b+oe.AXIS_SIZE_IN_CELL_CHARTS)+v-oe.VARIANCE_PIN_SIZE/2,s=l+v+o+oe.IN_CELL_CHART_TEXT_PADDING,c="start"),ho(ho({},io(n,e.cell.formatted,e.barHeight)),{},{widthBarFilled:v,xBar:l,xText:s,xLine:b,xPin:a,textAnchor:c,hideValue:u});case f.Vertical:default:return ho(ho({},ro(n,e.cell.formatted,e.columnWidth)),fo(e,r,n,i,o))}}(this.props,this.props.cell.cellChart,e,t,n,o):this.calculateNegativeOnlyValues(this.props.cell.cellChart,e,t,n,o)}}},{key:"calculatePositiveOnlyValues",value:function(e,t,n,o,r){switch(e.orientation){case f.Horizontal:var i=ao(o,n),l=so(i,lo(r)),a=0===l,s=a?i:l,c=0!==this.props.maxValue?s*t/this.props.maxValue:0;return Io(Io({},io(t,this.props.cell.formatted,this.props.barHeight)),{},{widthBarFilled:c,xBar:oe.AXIS_SIZE_IN_CELL_CHARTS,xText:oe.AXIS_SIZE_IN_CELL_CHARTS+c+n+oe.IN_CELL_CHART_TEXT_PADDING,xLine:0,xPin:oe.AXIS_SIZE_IN_CELL_CHARTS+c-oe.VARIANCE_PIN_SIZE/2,hideValue:a});case f.Vertical:default:return Io(Io({},ro(t,this.props.cell.formatted,this.props.columnWidth)),fo(this.props,o,t,r,n))}}},{key:"calculateNegativeOnlyValues",value:function(e,t,n,o,r){switch(e.orientation){case f.Horizontal:var i=ao(o,n),l=so(i,lo(r)),a=0===l,s=(a?i:l)*t/this.props.minValue;return Io(Io({},io(t,this.props.cell.formatted,this.props.barHeight)),{},{widthBarFilled:s,xBar:this.props.columnWidth-oe.AXIS_SIZE_IN_CELL_CHARTS-s,xText:this.props.columnWidth-oe.AXIS_SIZE_IN_CELL_CHARTS-s-n-oe.IN_CELL_CHART_TEXT_PADDING,xLine:this.props.columnWidth-oe.AXIS_SIZE_IN_CELL_CHARTS,xPin:this.props.columnWidth-oe.AXIS_SIZE_IN_CELL_CHARTS-s-oe.VARIANCE_PIN_SIZE/2,textAnchor:"end",hideValue:a});case f.Vertical:default:return Io(Io({},ro(t,this.props.cell.formatted,this.props.columnWidth)),fo(this.props,o,t,r,n))}}},{key:"getTextStyle",value:function(){if(this.props.cell.style&&this.props.cell.style.font){var e=yn(this.props.cell.style.font,this.props.fontOverride);return{fontFamily:e.fontFamily,fontSize:e.fontSize,fill:e.color,fontWeight:e.fontWeight,fontStyle:e.fontStyle,textDecoration:e.textDecoration}}return{fontFamily:ne.FONT_FAMILY,fontSize:ne.FONT_SIZE,fill:ne.FONT_COLOR,fontWeight:void 0,fontStyle:void 0,textDecoration:void 0}}}]),r}(_.Component);function Ho(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Lo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ho(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ho(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xo(e){e.classList.add(le.DROP_AREA_FOCUS_CLASS)}function Po(e){e.classList.remove(le.DROP_AREA_FOCUS_CLASS)}function ko(e){null==e||e.classList.add(le.DRAG_IN_PROCESS_CLASS)}function _o(e){null==e||e.classList.remove(le.DRAG_IN_PROCESS_CLASS)}function zo(e){return e.closest(".tableContainer")}function Mo(e,t,n){var o,r,i={targetRow:t,targetCol:n,placedBeforeCell:e.target.classList.contains(le.DROP_AREA_LEFT_CLASS)},l=(o=e.dataTransfer.getData(le.DRAG_DATA_KEY),r=o.split(le.DRAG_DATA_SEPARATOR),{sourceRow:parseInt(r[0],10),sourceCol:parseInt(r[1],10)}),a=l.sourceRow,s=l.sourceCol;return Lo(Lo({},i),{},{sourceRow:a,sourceCol:s})}var No,Zo=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(e){var t;return(0,P.Z)(this,r),(t=o.call(this,e)).boundHandleIconClicked=t.handleIconClicked.bind((0,M.Z)(t)),t.boundHandleIconMouseDown=t.handleIconMouseDown.bind((0,M.Z)(t)),t}return(0,k.Z)(r,[{key:"getDataAttributes",value:function(e){var t={};return Object.keys(e.dataAttributes).forEach((function(n){n.startsWith("data-")?t[n]=e.dataAttributes[n]:t["data-".concat(n)]=e.dataAttributes[n]})),t}},{key:"handleIconClicked",value:function(e){e.stopPropagation();var t={row:this.props.row,col:this.props.column,className:this.props.icon.className,dataAttributes:this.props.icon.dataAttributes,iconCharCode:this.props.icon.iconCharCode};this.props.onIconClicked(t)}},{key:"handleIconMouseDown",value:function(e){var t;null!==(t=this.props.featureToggles)&&void 0!==t&&t.accessibilityKeyboardSupport&&e.preventDefault(),0===e.button&&e.stopPropagation()}},{key:"render",value:function(){return _.createElement("div",(0,ln.Z)({style:this.props.icon.style,className:"".concat("sacGridCellIcon"," ").concat(this.props.icon.className," ").concat(this.props.extraClass?this.props.extraClass:"")},this.getDataAttributes(this.props.icon),{onMouseDown:this.boundHandleIconMouseDown,onClick:this.boundHandleIconClicked}),this.props.icon.iconCharCode&&"".concat(String.fromCharCode(this.props.icon.iconCharCode)))}}]),r}(_.PureComponent);function Bo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function jo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bo(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wo(e,t,n,o,r){var i=e===No.Left?t.cellIconsLeft:t.cellIconsRight;i=i||[];for(var l=Math.min(i.length,oe.MAX_NUM_CUSTOM_ICONS),a=[],s=0;s<l;s++){var c=i[s];void 0!==r&&(c.style=jo({marginTop:r},c.style)),a.push(_.createElement(Zo,{key:"cellIcon".concat(t.id).concat(s),row:t.row,column:t.column,icon:c,onIconClicked:n,featureToggles:o,extraClass:"".concat(e===No.Right&&0===s?"sacGridCellIconRightFirst":"")}))}return a}!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(No||(No={}));var Fo=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"render",value:function(){return _.createElement("div",{className:"cellValue",style:this.props.textStyle},_.createElement("span",{style:{textOverflow:"ellipsis",overflow:"hidden"}},this.props.children))}}]),r}(_.PureComponent);var Uo=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(e){var t;return(0,P.Z)(this,r),(t=o.call(this,e)).dragHandleRef=_.createRef(),t.boundOnDragStartHandle=t.onDragStartHandle.bind((0,M.Z)(t)),t.boundOnDragEndHandle=t.onDragEndHandle.bind((0,M.Z)(t)),t.boundOnDropDropArea=t.onDropDropArea.bind((0,M.Z)(t)),t.boundOnDragOverDropArea=t.onDragOverDropArea.bind((0,M.Z)(t)),t.boundOnDragLeaveDropArea=t.onDragLeaveDropArea.bind((0,M.Z)(t)),t.boundOnStopPropagation=t.stopPropagationForEvent.bind((0,M.Z)(t)),t}return(0,k.Z)(r,[{key:"componentDidMount",value:function(){var e;null===(e=this.dragHandleRef.current)||void 0===e||e.addEventListener("mousedown",this.boundOnStopPropagation,!0)}},{key:"getDataTransferKeyForCell",value:function(){return"".concat(le.SOURCE_CELL_PREFIX).concat(this.props.row,"-").concat(this.props.column)}},{key:"onDragStartHandle",value:function(e){if(ko(zo(e.target)),e.dataTransfer){e.dataTransfer.effectAllowed="move";var t=e.target;t.parentElement&&e.dataTransfer.setDragImage(t.parentElement,e.nativeEvent.offsetX,e.nativeEvent.offsetY),e.dataTransfer.setData(le.DRAG_DATA_KEY,"".concat(this.props.row).concat(le.DRAG_DATA_SEPARATOR).concat(this.props.column)),e.dataTransfer.setData(this.getDataTransferKeyForCell(),"")}}},{key:"onDragEndHandle",value:function(e){_o(zo(e.target))}},{key:"onDropDropArea",value:function(e){var t=e.target;_o(zo(t)),Po(t),this.isValidEventAndNotSourceCell(e.dataTransfer)&&this.props.onCellDropped(Mo(e,this.props.row,this.props.column))}},{key:"onDragOverDropArea",value:function(e){if(this.isValidEventAndNotSourceCell(e.dataTransfer)){var t=e.target;e.preventDefault(),xo(t)}}},{key:"onDragLeaveDropArea",value:function(e){Po(e.target)}},{key:"stopPropagationForEvent",value:function(e){e.stopPropagation()}},{key:"isValidEventAndNotSourceCell",value:function(e){return!e.types.includes(this.getDataTransferKeyForCell())}},{key:"render",value:function(){return _.createElement(_.Fragment,null,_.createElement("div",{className:le.DRAG_HANDLE_CLASS,draggable:!0,onDragStart:this.boundOnDragStartHandle,onDragEnd:this.boundOnDragEndHandle,onClick:this.boundOnStopPropagation,ref:this.dragHandleRef},"  "),_.createElement("div",{className:"".concat(le.DROP_AREA_CLASS," ").concat(le.DROP_AREA_LEFT_CLASS," ").concat(this.props.dropAreaClassName),onDrop:this.boundOnDropDropArea,onDragOver:this.boundOnDragOverDropArea,onDragLeave:this.boundOnDragLeaveDropArea}),_.createElement("div",{className:"".concat(le.DROP_AREA_CLASS," ").concat(le.DROP_AREA_RIGHT_CLASS," ").concat(this.props.dropAreaClassName),onDrop:this.boundOnDropDropArea,onDragOver:this.boundOnDragOverDropArea,onDragLeave:this.boundOnDragLeaveDropArea}))}}]),r}(_.PureComponent);var Go=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"render",value:function(){return _.createElement(Zn,(0,ln.Z)({},this.props,{extraClass:"".concat(this.props.extraClass," cellWithIcons"),cell:Pn(this.props.cell)}),Wo(No.Left,this.props.cell,this.props.onIconClicked,this.props.featureToggles),_.createElement(Fo,{textStyle:xn(this.props)},this.props.cell.formatted),Wo(No.Right,this.props.cell,this.props.onIconClicked,this.props.featureToggles),this.props.cell.draggable&&_.createElement(Uo,{row:this.props.cell.row,column:this.props.cell.column,onCellDropped:this.props.onCellDropped,dropAreaClassName:(e=this.props.cell.cellType,function(e){return[v.ColDimHeader,v.AttributeColDimHeader].includes(e)}(e)?le.DROP_AREA_COLUMNS:le.DROP_AREA_ROWS)}));var e}}]),r}(_.Component);var Vo=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(e){var t;return(0,P.Z)(this,r),(t=o.call(this,e)).boundHandleDrillIconClicked=t.handleDrillIconClicked.bind((0,M.Z)(t)),t.boundHandleDrillIconMouseDown=t.handleDrillIconMouseDown.bind((0,M.Z)(t)),t}return(0,k.Z)(r,[{key:"shouldComponentUpdate",value:function(e){return!(this.props.showGrid===e.showGrid&&this.props.firstInRow===e.firstInRow&&this.props.firstInCol===e.firstInCol&&this.props.extraClass===e.extraClass&&this.props.reversedHierarchy===e.reversedHierarchy&&this.props.mobile===e.mobile&&this.props.lineHeight===e.lineHeight&&this.props.width===e.width&&this.props.height===e.height&&this.props.left===e.left&&this.props.showRowColumnHover===e.showRowColumnHover&&tn(e.cell,this.props.cell)&&tn(e.fontOverride,this.props.fontOverride)&&tn(e.featureToggles,this.props.featureToggles))}},{key:"getIconClass",value:function(){var e="icon ".concat(this.props.mobile?"hierarchyIconMobile":"hierarchyIcon"," ");return this.props.cell.expanded?this.props.reversedHierarchy&&!j(this.props.cell.cellType)?e+="expandedAboveIcon":e+="expandedBelowIcon":e+="collapsedIcon",this.props.cell.cellType===v.RowDimMember&&(e+=" floatingIcon"),e}},{key:"handleDrillIconClicked",value:function(e){e.stopPropagation();var t=e.currentTarget.closest(".tableCell"),n=t?{target:t,row:this.props.cell.row,col:this.props.cell.column,td:t,event:e.nativeEvent,selectedCell:Xt(this.props.cell.row,this.props.cell.column)}:{};this.props.onDrillIconClicked(n)}},{key:"handleDrillIconMouseDown",value:function(e){var t;null!==(t=this.props.featureToggles)&&void 0!==t&&t.accessibilityKeyboardSupport&&e.preventDefault(),0===e.button&&e.stopPropagation()}},{key:"getClassesBasedOnCellType",value:function(){var e=[Sn];return this.props.cell.cellType===v.RowDimMember&&e.push(Tn),this.props.cell.cellType===v.ColDimMember&&e.push(On),this.props.cell.cellType===v.AttributeColDimMember&&e.push("".concat(On," ").concat("attributeColDimMember")),this.props.cell.cellType===v.AttributeRowDimMember&&e.push("".concat(Tn," ").concat("attributeRowDimMember")),e.join(" ")}},{key:"getExtraClass",value:function(){return"".concat(this.getClassesBasedOnCellType()," ").concat(Dn(this.props.cell.isInHierarchy,this.props.extraClass)," ").concat(this.props.cell.showDrillIcon?"showDrillIcon":""," cellWithIcons")}},{key:"getAvailableWidthWithIcons",value:function(){var e=this.props.cell.cellIconsLeft?Math.max(this.props.cell.cellIconsLeft.length,oe.MAX_NUM_CUSTOM_ICONS)*oe.CUSTOM_ICON_WIDTH:0,t=this.props.cell.cellIconsRight?Math.max(this.props.cell.cellIconsRight.length,oe.MAX_NUM_CUSTOM_ICONS)*oe.CUSTOM_ICON_WIDTH:0;return this.props.width-e-t}},{key:"render",value:function(){var e=Vn(this.props.cell),t=Hn(this.props),n=fn(this.props.cell.hierarchyPaddingLeft,this.props.cell.hierarchyPaddingTop),o=n.paddingLeft,r=n.paddingTop;return _.createElement(Zn,(0,ln.Z)({},this.props,{cell:Pn(this.props.cell),extraClass:this.getExtraClass(),defaultTooltipText:e}),Wo(No.Left,this.props.cell,this.props.onIconClicked,this.props.featureToggles,r),t&&this.props.cell.isInHierarchy&&_.createElement(Wn,{cell:this.props.cell,lineHeight:this.props.lineHeight,showGrid:this.props.showGrid,fontOverride:this.props.fontOverride,hierarchyStyle:{paddingLeft:o,paddingTop:r},firstInRow:this.props.firstInRow,width:this.getAvailableWidthWithIcons(),textValue:e},this.props.cell.showDrillIcon&&_.createElement("span",{style:{color:this.props.cell.drillIconColor},className:this.getIconClass(),onMouseDown:this.boundHandleDrillIconMouseDown,onClick:this.boundHandleDrillIconClicked})),t&&!this.props.cell.isInHierarchy&&_.createElement(Fo,{textStyle:xn(this.props)},this.props.cell.showHyperlink&&_.createElement(zn,{linkId:this.props.cell.id,linkText:e}),!this.props.cell.showHyperlink&&e),Wo(No.Right,this.props.cell,this.props.onIconClicked,this.props.featureToggles,r))}}]),r}(_.Component);function Ko(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Xo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ko(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ko(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Yo=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(e){var t;return(0,P.Z)(this,r),(t=o.call(this,e)).dropAreaRef=_.createRef(),t.boundOnDropDropArea=t.onDropDropArea.bind((0,M.Z)(t),t.dropAreaRef),t.boundOnDragOverDropArea=t.onDragOverDropArea.bind((0,M.Z)(t),t.dropAreaRef),t.boundOnDragLeaveDropArea=t.onDragLeaveDropArea.bind((0,M.Z)(t),t.dropAreaRef),t}return(0,k.Z)(r,[{key:"onDropDropArea",value:function(e,t){this.props.onCellDropped(Mo(t,this.props.cell.row,this.props.cell.column)),this.onDragLeaveDropArea(e)}},{key:"onDragOverDropArea",value:function(e,t){t.preventDefault(),e.current&&xo(e.current)}},{key:"onDragLeaveDropArea",value:function(e){e.current&&Po(e.current)}},{key:"render",value:function(){var e=this.props.cell.cellType===v.EmptyAxisRowHeader?le.EMPTY_AXIS_ROW_ICON:le.EMPTY_AXIS_COLUMN_ICON;return _.createElement(Zn,(0,ln.Z)({},this.props,{extraClass:"".concat(this.props.extraClass," ").concat($.EMPTY_AXIS_HEADER),cell:Xo(Xo({},this.props.cell),{},{formatted:""})}),_.createElement("div",{ref:this.dropAreaRef,className:le.EMPTY_AXIS_DROP_AREA_CLASS,onDrop:this.boundOnDropDropArea,onDragOver:this.boundOnDragOverDropArea,onDragLeave:this.boundOnDragLeaveDropArea},_.createElement("span",{className:"".concat($.ICON," ").concat(e)})))}}]),r}(_.Component),Jo=n(137),Qo=n(757),$o=n.n(Qo);function qo(){return(qo=(0,Jo.Z)($o().mark((function e(t){var n,o=arguments;return $o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:er,e.abrupt("return",new Promise((function(e,o){n(e,o,t)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function er(e,t,n){var o=new Image;o.onload=e,o.onerror=t,o.src=n}function tr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function nr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tr(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var or=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"getImageCellStyle",value:function(){var e,t,n={},o=null===(e=this.props.cell.style)||void 0===e||null===(t=e.alignment)||void 0===t?void 0:t.horizontal;switch(n.position="absolute",n.top=oe.IMG_CELL_PADDING_TOP,o){case s.Left:n.left=0;break;case s.Right:n.right=0;break;default:n.left="50%",n.transform="translate(-50%)"}return n}},{key:"loadImageAndRegisterLoading",value:function(){this.props.registerImageLoading(function(e){return qo.apply(this,arguments)}(this.props.cell.formatted))}},{key:"render",value:function(){var e=this.props.cell.styleUpdatedByUser,t=e?this.getImageCellStyle():{},n=e?"":"centerImageHorizontal";return this.loadImageAndRegisterLoading(),_.createElement(Zn,(0,ln.Z)({},this.props,{cell:nr(nr({},this.props.cell),{},{formatted:""}),extraClass:this.props.extraClass}),this.props.cell.formatted&&_.createElement("img",{src:this.props.cell.formatted,height:this.props.lineHeight-(oe.IMG_CELL_PADDING_TOP+oe.IMG_CELL_PADDING_BOTTOM),className:n,style:t}))}}]),r}(_.Component);function rr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ir(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rr(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var lr=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(e){return(0,P.Z)(this,r),o.call(this,e)}return(0,k.Z)(r,[{key:"shouldComponentUpdate",value:function(e){return!(this.props.showGrid===e.showGrid&&this.props.firstInRow===e.firstInRow&&this.props.firstInCol===e.firstInCol&&this.props.extraClass===e.extraClass&&this.props.mobile===e.mobile&&this.props.lineHeight===e.lineHeight&&this.props.width===e.width&&this.props.height===e.height&&this.props.left===e.left&&this.props.showRowColumnHover===e.showRowColumnHover&&tn(e.cell,this.props.cell)&&tn(e.fontOverride,this.props.fontOverride)&&tn(e.featureToggles,this.props.featureToggles))}},{key:"render",value:function(){return _.createElement(Zn,(0,ln.Z)({},this.props,{cell:ir(ir({},this.props.cell),{},{formatted:" "}),extraClass:"unbooked ".concat(this.props.extraClass||"")}),_.createElement("svg",{width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg",version:"1.1"},!!this.props.cell.formatted&&_.createElement("title",null,this.props.cell.formatted),_.createElement("line",{x1:"0",y1:"100%",x2:"100%",y2:"0"})))}}]),r}(_.Component);var ar=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"getCellsToRender",value:function(){var e,t,n,o,r,i,l=[],a=this.props.startCol||0,s=void 0!==this.props.endCol?Math.min(this.props.endCol,this.props.cells.length-1):this.props.cells.length-1,c=this.props.showGrid?oe.GRID_BORDER_SIZE:0,d=Math.max(this.props.height-c,0),h=Math.max(d-oe.CELL_PADDING_TOP-oe.CELL_PADDING_BOTTOM,0),p=!!this.props.showGrid,u=this.props.notRenderedWidthOnTheLeft;if(this.props.showRowNumberCoordinateHeader){var f=v.RowCoordinate;this.props.selectedHeader&&(f=this.props.designMode?v.RowCoordinateSelectedDesignMode:v.RowCoordinateSelectedViewMode);var g={id:"coordinateHeader-".concat(this.props.row+1),context:{dimensions:[],originalDimension:""},row:this.props.row,column:-1,formatted:"".concat(this.props.row+1),cellType:f,editable:!1,isInHierarchy:!1,plain:"",styleUpdatedByUser:!0};l.push(_.createElement(Zn,{key:g.id,cell:g,showGrid:p,showRowColumnHover:!1,width:oe.COORDINATE_CELL_SIZE,height:this.props.height,left:u,fontOverride:this.props.fontOverride,mobile:this.props.mobile,handler:this.props.handler,lineHeight:h,featureToggles:this.props.featureToggles})),u+=oe.COORDINATE_CELL_SIZE}for(;a<=s;a++){var C=this.props.cells[a];if(C.cellType!==v.MergedDummyCell){var b=0===a,y=oo(C.column,C.row,this.props.formulaCellStyleMap),m=-1===C.column,R=m&&-1===C.row,w=C.merged,S=C.column,T=C.row,O=this.props.columnSettings[S]?this.props.columnSettings[S].width:X.RESPONSIVE_EMPTY_COLUMN_WIDTH,D=m?oe.COORDINATE_CELL_SIZE:O,E=this.props.height,I=void 0,A=void 0;if(w){if(w.columns){I=this.props.columnSettings.slice(S,S+w.columns).map((function(e){return e.width}));var H=S+1;D+=this.props.columnSettings.slice(H,H+w.columns).reduce((function(e,t){return e+t.width}),0)}w.rows&&(E=w.heightAfterRowResized?w.heightAfterRowResized:this.props.getMergedRowHeight(T,T+w.rows),A=this.props.getHeightsOfMergedCell(T,T+1+w.rows))}switch(C.cellType){case v.ColDimMember:case v.RowDimMember:case v.AttributeColDimMember:case v.AttributeRowDimMember:l.push(_.createElement(Vo,{key:C.id,cell:C,showGrid:p,firstInRow:b,width:D,height:E,left:u,firstInCol:this.props.firstRow,reversedHierarchy:this.props.reversedHierarchy,fontOverride:this.props.fontOverride,mobile:this.props.mobile,onDrillIconClicked:this.props.handler.onDrillIconClicked,handler:this.props.handler,extraClass:y,lineHeight:h,featureToggles:this.props.featureToggles,showRowColumnHover:this.props.showRowColumnHover,onIconClicked:this.props.handler.onCellIconClicked}));break;case v.Unbooked:l.push(_.createElement(lr,{key:C.id,cell:C,showGrid:p,firstInRow:b,width:D,height:E,left:u,firstInCol:this.props.firstRow,fontOverride:this.props.fontOverride,mobile:this.props.mobile,handler:this.props.handler,extraClass:y,lineHeight:h,featureToggles:this.props.featureToggles,showRowColumnHover:this.props.showRowColumnHover,ariaLabel:to(null===(e=this.props.featureToggles)||void 0===e?void 0:e.accessibilityScreenReaderSupport,C)}));break;case v.Chart:var L=this.props.cellChartData&&C.cellChart&&this.props.cellChartData[C.cellChart.memberId]||{min:0,max:0,maxTextHeight:0,maxTextWidth:0,columns:[]};l.push(_.createElement(Ao,{key:C.id,cell:C,showGrid:p,firstInRow:b,width:D,height:E,left:u,firstInCol:this.props.firstRow,fontOverride:this.props.fontOverride,extraClass:y,mobile:this.props.mobile,handler:this.props.handler,minValue:L.min||0,maxValue:L.max||0,maxTextWidth:L.maxTextWidth||0,maxTextHeight:L.maxTextHeight||0,columns:L.columns,barHeight:(this.props.showGrid?this.props.height-oe.GRID_BORDER_SIZE:this.props.height)-oe.CELL_PADDING_BOTTOM-oe.CELL_PADDING_TOP-oe.PADDING_FOR_IN_CELL_CHARTS_HEIGHT,columnWidth:this.props.columnSettings[C.column].width-oe.CELL_PADDING_LEFT-oe.CELL_PADDING_RIGHT-oe.PADDING_FOR_IN_CELL_CHARTS_WIDTH,lineHeight:h,featureToggles:this.props.featureToggles,showRowColumnHover:this.props.showRowColumnHover,ariaLabel:eo(null===(t=this.props.featureToggles)||void 0===t?void 0:t.accessibilityScreenReaderSupport,C)}));break;case v.Image:l.push(_.createElement(or,{key:C.id,cell:C,width:D,height:E,left:u,showGrid:p,firstInRow:b,firstInCol:this.props.firstRow,fontOverride:this.props.fontOverride,handler:this.props.handler,extraClass:y,lineHeight:d,featureToggles:this.props.featureToggles,registerImageLoading:this.props.handler.registerImageLoading,showRowColumnHover:this.props.showRowColumnHover,ariaLabel:to(null===(n=this.props.featureToggles)||void 0===n?void 0:n.accessibilityScreenReaderSupport,C)}));break;case v.NewLineOnRow:case v.NewLineOnColumn:l.push(_.createElement(Qn,{key:C.id,cell:C,showGrid:p,firstInRow:b,width:D,height:E,left:u,firstInCol:this.props.firstRow,fontOverride:this.props.fontOverride,handler:this.props.handler,lineHeight:h,activeNewLineMemberCell:this.props.activeNewLineMemberCell,featureToggles:this.props.featureToggles,showRowColumnHover:this.props.showRowColumnHover,ariaLabel:qn(null===(o=this.props.featureToggles)||void 0===o?void 0:o.accessibilityScreenReaderSupport,C)}));break;case v.ColDimHeader:case v.RowDimHeader:case v.AttributeColDimHeader:case v.AttributeRowDimHeader:l.push(_.createElement(Go,{key:C.id,cell:C,showGrid:p,firstInRow:b,width:D,height:E,left:u,firstInCol:this.props.firstRow,fontOverride:this.props.fontOverride,mobile:this.props.mobile,handler:this.props.handler,onIconClicked:this.props.handler.onCellIconClicked,onCellDropped:this.props.handler.onCellDropped,extraClass:y,lineHeight:h,featureToggles:this.props.featureToggles,showRowColumnHover:this.props.showRowColumnHover}));break;case v.EmptyAxisRowHeader:case v.EmptyAxisColumnHeader:l.push(_.createElement(Yo,{key:C.id,cell:C,showGrid:p,firstInRow:b,width:D,height:E,left:u,firstInCol:this.props.firstRow,fontOverride:this.props.fontOverride,mobile:this.props.mobile,handler:this.props.handler,onCellDropped:this.props.handler.onCellDropped,extraClass:y,lineHeight:h,featureToggles:this.props.featureToggles,showRowColumnHover:this.props.showRowColumnHover,ariaLabel:no(null===(r=this.props.featureToggles)||void 0===r?void 0:r.accessibilityScreenReaderSupport)}));break;default:l.push(_.createElement(Zn,{key:C.id,cell:C,showGrid:p,firstInRow:b,width:D,height:E,left:u,firstInCol:this.props.firstRow,fontOverride:this.props.fontOverride,mobile:this.props.mobile,handler:this.props.handler,extraClass:y,lineHeight:h,featureToggles:this.props.featureToggles,mergeCellRowHeights:A,mergeCellColumnWidths:I,showRowColumnHover:this.props.showRowColumnHover,ariaLabel:qn(null===(i=this.props.featureToggles)||void 0===i?void 0:i.accessibilityScreenReaderSupport,C)}))}u=R||m?oe.COORDINATE_CELL_SIZE:u+O}else u+=this.props.columnSettings[C.column].width}return l}},{key:"shouldComponentUpdate",value:function(e){return!(this.props.row===e.row&&this.props.height===e.height&&this.props.fixed===e.fixed&&this.props.showRowNumberCoordinateHeader===e.showRowNumberCoordinateHeader&&this.props.firstRow===e.firstRow&&this.props.reversedHierarchy===e.reversedHierarchy&&this.props.selectedHeader===e.selectedHeader&&this.props.designMode===e.designMode&&this.props.showGrid===e.showGrid&&this.props.mobile===e.mobile&&this.props.numberOfCells===e.numberOfCells&&this.props.startCol===e.startCol&&this.props.endCol===e.endCol&&this.props.activeNewLineMemberCell===e.activeNewLineMemberCell&&this.props.notRenderedWidthOnTheLeft===e.notRenderedWidthOnTheLeft&&this.props.showRowColumnHover===e.showRowColumnHover&&tn(e.cells,this.props.cells)&&tn(e.columnSettings,this.props.columnSettings)&&tn(e.fontOverride,this.props.fontOverride)&&tn(e.formulaCellStyleMap,this.props.formulaCellStyleMap)&&tn(e.cellChartData,this.props.cellChartData)&&tn(e.featureToggles,this.props.featureToggles))}},{key:"render",value:function(){var e,t={height:this.props.height};return _.createElement("div",{style:t,className:$.ROW,role:null!==(e=this.props.featureToggles)&&void 0!==e&&e.accessibilityScreenReaderSupport?"row":void 0},this.getCellsToRender())}}]),r}(_.Component);var sr=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(e){return(0,P.Z)(this,r),o.call(this,e)}return(0,k.Z)(r,[{key:"shouldComponentUpdate",value:function(e){return!(this.props.row===e.row&&this.props.height===e.height&&this.props.fixed===e.fixed&&this.props.showRowNumberCoordinateHeader===e.showRowNumberCoordinateHeader&&this.props.showGrid===e.showGrid&&this.props.firstRow===e.firstRow&&this.props.reversedHierarchy===e.reversedHierarchy&&this.props.lastColIndex===e.lastColIndex&&this.props.designMode===e.designMode&&this.props.startCol===e.startCol&&this.props.endCol===e.endCol&&this.props.showCorner===e.showCorner&&this.props.showRowColumnHover===e.showRowColumnHover&&this.props.notRenderedWidthOnTheLeft===e.notRenderedWidthOnTheLeft&&tn(e.selection,this.props.selection)&&tn(e.cells,this.props.cells)&&tn(e.columnSettings,this.props.columnSettings)&&tn(e.fontOverride,this.props.fontOverride)&&tn(e.formulaCellStyleMap,this.props.formulaCellStyleMap)&&tn(e.featureToggles,this.props.featureToggles))}},{key:"getCells",value:function(){var e=[],t=this.props.startCol||0,n=void 0!==this.props.endCol?this.props.endCol:this.props.lastColIndex;for(this.props.showCorner&&e.push({id:"cell--1-".concat(-1),row:-1,column:-1,context:{dimensions:[],originalDimension:""},cellType:v.CoordinateCorner,formatted:"",plain:"",editable:!1,isInHierarchy:!1,styleUpdatedByUser:!0});t<=n;t++){var o=this.props.selection&&this.props.selection.some((function(e){return At(e,t,-1)}))?this.props.designMode?v.ColumnCoordinateSelectedDesignMode:v.ColumnCoordinateSelectedViewMode:v.ColumnCoordinate;e.push({id:"cell--1-".concat(t),row:-1,column:t,context:{dimensions:[],originalDimension:""},cellType:o,formatted:this.getColumnName(t),plain:this.getColumnName(t),editable:!1,isInHierarchy:!1,styleUpdatedByUser:!0})}return e}},{key:"getColumnName",value:function(e){var t=e>=26?this.getColumnName(Math.floor(e/26)-1):"",n="ABCDEFGHIJKLMNOPQRSTUVWXYZ"[e%26];return"".concat(t).concat(n)}},{key:"render",value:function(){return _.createElement(ar,(0,ln.Z)({},this.props,{row:-1,cells:this.getCells(),firstRow:!1,endCol:void 0,startCol:0}))}}]),r}(_.Component);var cr=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(e){var t;return(0,P.Z)(this,r),(t=o.call(this,e)).boundGetMergedRowHeight=t.getMergedRowHeight.bind((0,M.Z)(t)),t.boundGetHeightsOfMergedCell=t.getHeightsOfMergedCell.bind((0,M.Z)(t)),t}return(0,k.Z)(r,[{key:"getMergedRowHeight",value:function(e,t){var n=this.props.data.showGrid?oe.GRID_BORDER_SIZE:0;return st(this.props.data.rows,n,e,t)}},{key:"getHeightsOfMergedCell",value:function(e,t){var n=this.props.data.showGrid?oe.GRID_BORDER_SIZE:0;return function(e,t,n,o){return e.slice(n,o).map((function(e){return e?e.height+t:0}))}(this.props.data.rows,n,e,t)}},{key:"getRowsToRender",value:function(){var e=this,t=[];this.props.showCoordinateHeaderRow&&t.push(_.createElement(sr,{key:oe.COORDINATE_ROW_NAME,row:-1,cells:[],lastColIndex:this.props.data.columnSettings.length-1,firstRow:!0,height:oe.COORDINATE_CELL_SIZE,fixed:!0,formulaCellStyleMap:this.props.data.formulaCellStyleMap,columnSettings:this.props.data.columnSettings,handler:this.props.rowHandler,showRowNumberCoordinateHeader:!1,reversedHierarchy:this.props.data.reversedHierarchy,designMode:this.props.data.designMode,selection:this.props.selection,startCol:this.props.startCol,endCol:this.props.endCol,showCorner:this.props.showCoordinateHeaderCorner,featureToggles:this.props.data.featureToggles,getMergedRowHeight:this.boundGetMergedRowHeight,getHeightsOfMergedCell:this.boundGetHeightsOfMergedCell,notRenderedWidthOnTheLeft:this.props.notRenderedWidthOnTheLeft,showRowColumnHover:!1}));for(var n=void 0!==this.props.endRow?this.props.endRow:this.props.data.rows.length-1,o=this.props.startRow||0,r=function(){var n=e.props.data.rows[o];if(!n)return"continue";var r=e.props.selection&&e.props.selection.some((function(e){return At(e,-1,n.row)}));t.push(_.createElement(ar,{key:n.id,row:n.row,cells:n.cells,firstRow:0===o,fontOverride:e.props.data.fontOverride,height:e.props.data.showGrid?n.height+oe.GRID_BORDER_SIZE:n.height,fixed:n.fixed,showGrid:e.props.data.showGrid,mobile:e.props.data.mobile,formulaCellStyleMap:e.props.data.formulaCellStyleMap,columnSettings:e.props.data.columnSettings,handler:e.props.rowHandler,showRowNumberCoordinateHeader:e.props.showCoordinateHeaderColumn,reversedHierarchy:e.props.data.reversedHierarchy,selectedHeader:r,designMode:e.props.data.designMode,cellChartData:e.props.data.cellChartData,numberOfCells:e.props.data.columnSettings.length,startCol:e.props.startCol,endCol:e.props.endCol,activeNewLineMemberCell:e.props.data.activeNewLineMemberCell,featureToggles:e.props.data.featureToggles,getMergedRowHeight:e.boundGetMergedRowHeight,getHeightsOfMergedCell:e.boundGetHeightsOfMergedCell,notRenderedWidthOnTheLeft:e.props.notRenderedWidthOnTheLeft,showRowColumnHover:e.props.showRowColumnHover}))};o<=n;o++)r();return t}},{key:"shouldComponentUpdate",value:function(e){return!(this.props.copyInProcess===e.copyInProcess&&this.props.tableWidth===e.tableWidth&&this.props.notRenderedHeightTop===e.notRenderedHeightTop&&this.props.notRenderedHeightBottom===e.notRenderedHeightBottom&&this.props.notRenderedWidthOnTheLeft===e.notRenderedWidthOnTheLeft&&this.props.data.rows.length===e.data.rows.length&&this.props.startRow===e.startRow&&this.props.endRow===e.endRow&&this.props.startCol===e.startCol&&this.props.endCol===e.endCol&&this.props.titleVisible===e.titleVisible&&this.props.showRowColumnHover===e.showRowColumnHover&&this.props.showCoordinateHeaderColumn===e.showCoordinateHeaderColumn&&this.props.showCoordinateHeaderRow===e.showCoordinateHeaderRow&&this.props.showCoordinateHeaderCorner===e.showCoordinateHeaderCorner&&tn(e.selection,this.props.selection)&&tn(e.data,this.props.data))}},{key:"getClassList",value:function(){return"reactTable ".concat(this.props.copyInProcess?"copySelect":""," ").concat(this.props.data.showGrid?"showGrid":""," ").concat(this.props.titleVisible?"titleVisible":""," ").concat(this.getRowColSelectionClass())}},{key:"getRowColSelectionClass",value:function(){var e="";return this.props.selection&&this.props.selection[0]&&(this.props.selection[0].selectionType===C.Columns&&(e="columnsSelected"),this.props.selection[0].selectionType===C.Rows&&(e="rowsSelected")),e}},{key:"getStyle",value:function(){return{paddingTop:ae(this.props.notRenderedHeightTop),paddingBottom:ae(this.props.notRenderedHeightBottom),width:ae(this.props.tableWidth)}}},{key:"render",value:function(){return _.createElement("div",{className:"tableDivTable ".concat(this.getClassList()),style:this.getStyle()},this.getRowsToRender())}}]),r}(_.Component);var dr=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"render",value:function(){return _.createElement("div",{style:{position:"absolute",top:0,left:0,width:"1px",height:"".concat(this.props.height,"px"),pointerEvents:"none"}})}}]),r}(_.PureComponent);function hr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function pr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hr(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ur,fr=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"render",value:function(){return void 0!==this.props.commonStyle.height&&this.props.commonStyle.height<=0||void 0!==this.props.commonStyle.width&&this.props.commonStyle.width<=0?null:_.createElement("div",{className:"overlayBorder",style:pr({},this.props.commonStyle)},this.props.children)}}]),r}(_.PureComponent);!function(e){e.CellHover="Cell",e.DataRegionHover="DataRegion",e.HeaderRegionHover="HeaderRegion",e.HeaderRegionCornerHover="HeaderRegionCorner",e.DimensionHover="Dimension",e.InCellChartHover="InCellChart",e.SolidBackground="SolidBackground",e.CornerSolidBackground="CornerSolidBackground",e.NonCornerSolidBackground="NonCornerSolidBackground",e.ExcludingFocusSmall="ExcludingFocusSmall",e.ExcludingFocusBig="ExcludingFocusBig",e.ReferenceSourceCellHover="ReferenceSourceCell",e.ReferencedCellHover="ReferencedCell",e.RowHighlighting="RowHighlighting",e.ColHighlighting="ColHighlighting",e.CellHighlighting="CellHighlighting"}(ur||(ur={}));var gr=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"render",value:function(){return _.createElement("div",{className:"overlay",style:{backgroundColor:this.props.backgroundColor,position:"absolute",top:this.props.top,left:this.props.left,height:this.props.height,width:this.props.width}})}}]),r}(_.PureComponent);function Cr(e,t){return void 0!==t?Math.min(e,t):e}function vr(e,t){var n,o=!0,r=!0,i=void 0!==e.mergedStartRow?e.mergedStartRow:e.startRow,l=e.endRow,a=void 0!==e.mergedStartCol?e.mergedStartCol:e.startCol,s=e.endCol;i>l?(l=i,i=e.endRow,o=!1):e.isReverseDraggingVertical&&(o=!1),a>s?(s=a,a=e.endCol,r=!1):e.isReverseDraggingHorizontal&&(r=!1),(n=e.selectionType)===C.Columns||n===C.All?(l=t.data.lastRowIndex,e.endRow=t.data.lastRowIndex):function(e,t){return[c.DatacellRegion,c.HeaderRegion].includes(e)||function(e,t){return[c.Dimension,c.MultiRegion].includes(e)&&t.startCol===t.endCol}(e,t)}(t.selection.selectionContextType,e)&&(l=t.data.dataRegionEndRow,e.endRow=t.data.dataRegionEndRow);var d=i===l&&a===s;if(d){var h=t.data.rows[i]&&t.data.rows[i].cells[a];h&&h.merged&&(l=i+(h.merged.rows||0),s=a+(h.merged.columns||0))}var p={startRow:i,endRow:l,startCol:a,endCol:s,isOneCellSelected:d,isFocusedCellOnTop:o,isFocusedCellOnTheLeft:r,showFocusedCell:e.selectionType!==C.Region&&void 0===e.mergedStartRow&&void 0===e.mergedStartCol&&!e.hideFirstSelectedCellBackground,showDragger:!0};return function(e,t,n){var o=void 0!==t.freezeSectionEndCol&&e.startCol<=t.freezeSectionEndCol,r=void 0!==t.freezeSectionEndRow&&e.startRow<=t.freezeSectionEndRow,i=void 0!==t.freezeSectionStartCol&&e.startCol>=t.freezeSectionStartCol,l=void 0!==t.freezeSectionStartRow&&e.startRow>=t.freezeSectionStartRow,a=r&&o,s=void 0===t.freezeSectionEndRow&&o&&l,c=void 0===t.freezeSectionEndCol&&r&&i,d=void 0===t.freezeSectionEndCol&&void 0===t.freezeSectionEndRow&&l&&i;return a||s||c||d||(n.showFocusedCell=!1),void 0!==t.freezeSectionStartCol&&n.startCol<t.freezeSectionStartCol&&(n.startCol=t.freezeSectionStartCol),void 0!==t.freezeSectionStartRow&&n.startRow<t.freezeSectionStartRow&&(n.startRow=t.freezeSectionStartRow),void 0!==t.freezeSectionEndCol&&n.endCol>t.freezeSectionEndCol&&(n.endCol=t.freezeSectionEndCol,n.showDragger=!1),void 0!==t.freezeSectionEndRow&&n.endRow>t.freezeSectionEndRow&&(n.endRow=t.freezeSectionEndRow,n.showDragger=!1),n}(e,t,p)}function br(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function yr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?br(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):br(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var mr,Rr=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(){return(0,P.Z)(this,r),o.apply(this,arguments)}return(0,k.Z)(r,[{key:"render",value:function(){return this.props.showDragger?_.createElement("div",{className:"selectionDragger",style:yr({},this.props.draggerStyle),onMouseDown:this.props.onCopyDraggerClick}):null}}]),r}(_.PureComponent);function wr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function Sr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}!function(e){e[e.Top=0]="Top",e[e.Left=1]="Left",e[e.TopLeft=2]="TopLeft"}(mr||(mr={}));var Tr=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(e){return(0,P.Z)(this,r),o.call(this,e)}return(0,k.Z)(r,[{key:"shouldComponentUpdate",value:function(e){return!(this.props.fixedTableWidth===e.fixedTableWidth&&this.props.fixedTableHeight===e.fixedTableHeight&&this.props.offsetOverlayTop===e.offsetOverlayTop&&this.props.offsetOverlayLeft===e.offsetOverlayLeft&&this.props.notRenderedHeightTop===e.notRenderedHeightTop&&this.props.designMode===e.designMode&&this.props.copyInProcess===e.copyInProcess&&this.props.tableId===e.tableId&&this.props.showCopyDragger===e.showCopyDragger&&this.props.freezeLines===e.freezeLines&&this.props.hasLADatapointSelection===e.hasLADatapointSelection&&this.props.freezeSectionStartCol===e.freezeSectionStartCol&&this.props.freezeSectionStartRow===e.freezeSectionStartRow&&this.props.freezeSectionEndCol===e.freezeSectionEndCol&&this.props.freezeSectionEndRow===e.freezeSectionEndRow&&tn(e.highlightedCells,this.props.highlightedCells)&&tn(e.hover,this.props.hover)&&tn(e.selection,this.props.selection)&&tn(e.data,this.props.data))}},{key:"getColor",value:function(){return this.props.designMode?"rgba(249, 187, 149, 0.2)":"rgba(169, 198, 222, 0.2)"}},{key:"getBorderColor",value:function(){return this.props.designMode?oe.SELECTION_BORDER_COLOR_DESIGN:oe.SELECTION_BORDER_COLOR}},{key:"getTopHoverPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.hover&&this.props.hover.row;if(!this.props.hover||void 0===e)return 0;var t=this.props.data.showGrid?oe.GRID_BORDER_SIZE:0;return this.props.data.rows.slice(this.props.freezeSectionStartRow,e).reduce((function(e,n){return n?e+n.height+t:e}),0)}},{key:"getLeftHoverPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.hover&&this.props.hover.column;return this.props.hover&&void 0!==e?this.props.data.columnSettings.slice(this.props.freezeSectionStartCol,e).reduce((function(e,t){return e+t.width}),0):0}},{key:"renderHeaderRegionHover",value:function(){var e=this.getTopHoverPosition(this.props.data.dataRegionStartRow),t=this.getLeftHoverPosition(this.props.data.dataRegionStartCol),n=this.getTopHoverPosition(Cr(this.props.data.dataRegionCornerRow,this.props.freezeSectionEndRow)+1),o=this.getLeftHoverPosition(Cr(this.props.data.dataRegionCornerCol,this.props.freezeSectionEndCol)+1),r=this.getTopHoverPosition(Cr(this.props.data.dataRegionEndRow,this.props.freezeSectionEndRow)+1),i=this.getLeftHoverPosition(Cr(this.props.data.dataRegionEndCol,this.props.freezeSectionEndCol)+1);return _.createElement("div",null,this.renderOverlay(ur.HeaderRegionHover,e,t,n-e,i-t),this.renderOverlay(ur.HeaderRegionCornerHover,n,t,r-n,o-t))}},{key:"renderDataRegionHover",value:function(){if(void 0!==this.props.freezeSectionEndRow&&this.props.data.dataRegionCornerRow+1>this.props.freezeSectionEndRow||void 0!==this.props.freezeSectionEndCol&&this.props.data.dataRegionCornerCol+1>this.props.freezeSectionEndCol)return null;var e=this.getTopHoverPosition(this.props.data.dataRegionCornerRow+1),t=this.getTopHoverPosition(Cr(this.props.data.dataRegionEndRow,this.props.freezeSectionEndRow)+1),n=this.getLeftHoverPosition(this.props.data.dataRegionCornerCol+1),o=this.getLeftHoverPosition(Cr(this.props.data.dataRegionEndCol,this.props.freezeSectionEndCol)+1);return this.renderOverlay(ur.DataRegionHover,e,n,t-e,o-n)}},{key:"renderDimensionHover",value:function(){if(!this.props.hover||!this.props.hover.dimensionId)return null;var e=this.props.data.dimensionCellCoordinatesInHeader[this.props.hover.dimensionId];if(void 0!==this.props.freezeSectionEndRow&&e.startRow>this.props.freezeSectionEndRow||void 0!==this.props.freezeSectionEndCol&&e.startCol>this.props.freezeSectionEndCol)return null;var t=this.getTopHoverPosition(e.startRow),n=this.getTopHoverPosition(Cr(e.endRow,this.props.freezeSectionEndRow)+1),o=this.getLeftHoverPosition(e.startCol),r=this.getLeftHoverPosition(Cr(e.endCol,this.props.freezeSectionEndCol)+1);return this.renderOverlay(ur.DimensionHover,t,o,n-t,r-o)}},{key:"renderInCellChartHover",value:function(){if(this.props.hover&&this.props.hover.dimensionId&&this.props.data.cellChartData){var e=this.props.data.cellChartData[this.props.hover.dimensionId],t=this.getTopHoverPosition(e.startRow),n=this.getTopHoverPosition(e.endRow+1),o=this.getLeftHoverPosition(e.startCol),r=this.getLeftHoverPosition(e.endCol+1);return this.renderOverlay(ur.InCellChartHover,t,o,n-t,r-o)}}},{key:"renderHighlightedCell",value:function(e,t){var n=e.x,o=e.y,r=this.props.data.showGrid?oe.GRID_BORDER_SIZE:0,i=this.getTopHoverPosition(o)-r,l=this.getTopHoverPosition(o+1)-r,a=this.getLeftHoverPosition(n),s=this.getLeftHoverPosition(n+1);return this.renderOverlay(ur.CellHighlighting,i,a,l-i,s-a,t,e.backgroundColor)}},{key:"renderSelectedRegion",value:function(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sr(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);if(!function(e,t){if(void 0!==t.startRow&&void 0!==t.startCol){var n=e.startCol>=t.startCol,o=e.endCol>=t.startCol,r=e.startRow>=t.startRow,i=e.endRow>=t.startRow,l=void 0!==t.endCol&&n&&e.startCol<=t.endCol,a=void 0!==t.endCol&&e.endCol<=t.endCol&&o,s=void 0!==t.endRow&&r&&e.startRow<=t.endRow,c=void 0!==t.endRow&&e.endRow<=t.endRow&&i,d=l||a,h=void 0===t.endCol&&(o||n),p=s||c,u=void 0===t.endRow&&(i||r);return p&&d||p&&h||d&&u||u&&h}return!0}(n,{startRow:this.props.freezeSectionStartRow,endRow:this.props.freezeSectionEndRow,startCol:this.props.freezeSectionStartCol,endCol:this.props.freezeSectionEndCol}))return null;var o,r,i,l,a=t+1===this.props.selection.selectedRegions.length,s=vr(n,this.props),c=s.startRow,d=s.endRow,h=s.startCol,p=s.endCol,u=s.isOneCellSelected,f=s.isFocusedCellOnTop,g=s.isFocusedCellOnTheLeft,v=s.showFocusedCell,b=s.showDragger,y=this.getTopHoverPosition(c),m=this.getTopHoverPosition(d+1),R=this.getLeftHoverPosition(h),w=this.getLeftHoverPosition(p+1);if(!a||!v)if(void 0!==n.cornerCol&&void 0!==n.cornerRow){var S=this.getLeftHoverPosition(Cr(this.props.data.dataRegionCornerCol,this.props.freezeSectionEndCol)+1),T=this.getTopHoverPosition(Cr(this.props.data.dataRegionCornerRow,this.props.freezeSectionEndRow)+1);o=_.createElement("div",{key:"solidBackground-".concat(t)},this.renderOverlay(ur.SolidBackground,y,R,T-y,w-R),this.renderOverlay(ur.CornerSolidBackground,T,R,m-T,S-R))}else o=this.renderOverlay(ur.NonCornerSolidBackground,y,R,m-y,w-R,t);if(a){var O,D,E,I,A,H,L=n.selectionType===C.Box;if(L=L&&this.props.showCopyDragger&&b,O=function(e,t){return e===t.startRow&&t.endRow>=t.startRow||e===t.endRow&&t.endRow<=t.startRow}(c,n),D=function(e,t){return e===t.startCol&&t.endCol>=t.startCol||e===t.endCol&&t.endCol<=t.startCol}(h,n),E=function(e,t){return e===t.endRow&&t.endRow>=t.startRow||e===t.startRow&&t.endRow<=t.startRow}(d,n),I=function(e,t,n){return void 0!==e&&void 0!==n.cornerRow&&e<=n.cornerRow&&(!t||n.cornerRow<=t)}(this.props.freezeSectionStartRow,this.props.freezeSectionEndRow,n),A=function(e,t){return e===t.endCol&&t.endCol>=t.startCol||e===t.startCol&&t.endCol<=t.startCol}(p,n),H=function(e,t,n){return void 0!==e&&void 0!==n.cornerCol&&e<=n.cornerCol&&(!t||n.cornerCol<=t)}(this.props.freezeSectionStartCol,this.props.freezeSectionEndCol,n),void 0!==n.cornerCol&&void 0!==n.cornerRow){var P=this.getLeftHoverPosition(this.props.data.dataRegionCornerCol+1),k=this.getTopHoverPosition(this.props.data.dataRegionCornerRow+1);r=_.createElement("div",{key:"border-".concat(t)},this.renderBorder(y,R,k-y,P-R,O,D,!1,!1,mr.TopLeft),this.renderBorder(y,P,k-y,w-P,O,!1,I,A,mr.Top),this.renderBorder(k,R,m-k,P-R,!1,D,E,H,mr.Left))}else r=this.renderBorder(y,R,m-y,w-R,O,D,E,A,t,L);if(v){var z,M,N,Z,B,j;if(f)N=y,B=Z=this.getTopHoverPosition(c+1),j=m;else{var W=n.isReverseDraggingVertical?n.endRow:n.startRow;B=y,N=j=this.getTopHoverPosition(W),Z=m}if(g)z=this.getLeftHoverPosition(h+1),M=w;else{var F=n.isReverseDraggingHorizontal?n.endCol:n.startCol;z=R,M=this.getLeftHoverPosition(F)}i=this.renderOverlay(ur.ExcludingFocusSmall,N,z,Z-N,M-z),l=this.renderOverlay(ur.ExcludingFocusBig,B,R,j-B,w-R)}}return a?u&&n.selectionType!==C.Region||n.isCellChartSelection?r:n.selectionType!==C.Region&&v?_.createElement("div",{key:"all-".concat(t)},h!==p&&i,c!==d&&l,r):_.createElement("div",{key:"solidBackgroundAndBorder-".concat(t)},o,r):o}},{key:"renderCellHover",value:function(){if(this.props.hover&&void 0!==this.props.hover.column&&void 0!==this.props.hover.row){var e=this.props.data.rows[this.props.hover.row],t=e&&e.cells[this.props.hover.column]&&e.cells[this.props.hover.column].merged,n=this.props.hover.column+(t&&t.columns||0),o=this.props.hover.row+(t&&t.rows||0);if(void 0!==this.props.freezeSectionEndRow&&o>this.props.freezeSectionEndRow||void 0!==this.props.freezeSectionEndCol&&n>this.props.freezeSectionEndCol)return null;var r=this.getTopHoverPosition(),i=this.getLeftHoverPosition(),l=this.getTopHoverPosition(o+1),a=this.getLeftHoverPosition(n+1);return this.renderOverlay(ur.CellHover,r,i,l-r,a-i)}}},{key:"renderOverlay",value:function(e,t,n,o,r,i,l){var a=l||this.getColor();return _.createElement(gr,{overlayBoxType:e,key:void 0!==i?"overlay-box-".concat(i,"-").concat(e):"overlay-box-".concat(e),backgroundColor:a,top:t,left:n,height:o,width:r})}},{key:"renderBorder",value:function(e,t,n,o,r,i,l,a,s,c){var d=!(!c||this.props.data.mobile),h=this.props.copyInProcess?"dashed":"solid",p=r?h:"none",u=i?h:"none",f=l?h:"none",g=a?h:"none",C={borderColor:this.getBorderColor(),borderWidth:1,boxSizing:"border-box",position:"absolute",top:e,left:t,width:o,height:n,borderTopStyle:p,borderLeftStyle:u,borderBottomStyle:f,borderRightStyle:g},v={backgroundColor:this.getBorderColor()};return _.createElement("div",{key:"borderBox-".concat(s)},_.createElement(fr,{commonStyle:C},_.createElement(Rr,{showDragger:d,draggerStyle:v,onCopyDraggerClick:this.props.onCopyDraggerClick})))}},{key:"renderReferenceHighlighting",value:function(){var e,t,n=null===(e=ft(this.props.selection.selectedRegions))||void 0===e?void 0:e.startRow,o=null===(t=ft(this.props.selection.selectedRegions))||void 0===t?void 0:t.startCol,r=void 0!==n&&void 0!==o&&this.props.data.rows[n]&&this.props.data.rows[n].cells[o]&&this.props.data.rows[n].cells[o].reference;if(r&&void 0!==n&&void 0!==o){var i=this.getTopHoverPosition(n),l=this.getLeftHoverPosition(o),a=this.getTopHoverPosition(n+1),s=this.getLeftHoverPosition(o+1),c=this.renderOverlay(ur.ReferenceSourceCellHover,i,l,a-i,s-l,void 0,oe.SELECTION_REFERENCE_COLOR),d=this.getTopHoverPosition(r.row),h=this.getLeftHoverPosition(r.col),p=this.getTopHoverPosition(r.row+1),u=this.getLeftHoverPosition(r.col+1),f=this.renderOverlay(ur.ReferencedCellHover,d,h,p-d,u-h,void 0,oe.SELECTION_REFERENCE_COLOR);return _.createElement("div",null,c,f)}}},{key:"shouldHideSelection",value:function(e){if(e.startRow!==e.endRow||e.startCol!==e.endCol)return!1;var t=!1;if(!(this.props.hasLADatapointSelection&&this.props.highlightedCells&&this.props.highlightedCells.length))return!1;var n,o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return wr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(a)throw i}}}}(this.props.highlightedCells);try{for(o.s();!(n=o.n()).done;){var r=n.value;if(r.x===e.startCol&&r.y===e.startRow){t=!0;break}}}catch(e){o.e(e)}finally{o.f()}return!t}},{key:"renderRowHighlighting",value:function(){var e=this.props,t=e.hover,n=e.data,o=e.freezeSectionStartRow,r=e.freezeSectionEndRow,i=e.copyInProcess,l=n.showGrid?oe.GRID_BORDER_SIZE:0;if(!i&&t){var a=t.hoverContextType===c.Row,s=void 0===o,d=void 0!==t.row&&void 0!==r&&r>=t.row,h=void 0!==t.row&&void 0===r&&void 0!==o&&o<=t.row;if(a&&void 0!==t.row&&(s||d||h)){var p=this.getTopHoverPosition()-l,u=this.getLeftHoverPosition(Cr(this.props.data.columnSettings.length,this.props.freezeSectionEndCol)+1);return this.renderOverlay(ur.RowHighlighting,p,0,n.rows[t.row].height+l,u)}}return null}},{key:"renderColHighlighting",value:function(){var e=this.props,t=e.hover,n=e.data,o=e.freezeSectionEndCol,r=e.freezeSectionStartCol;if(!e.copyInProcess&&t){var i=t.hoverContextType===c.Column,l=void 0===r,a=void 0!==t.column&&void 0!==o&&o>=t.column,s=void 0!==t.column&&void 0===o&&void 0!==r&&r<=t.column;if(i&&void 0!==t.column&&(l||a||s)){var d=this.getLeftHoverPosition(),h=this.getTopHoverPosition(Cr(this.props.data.rows.length,this.props.freezeSectionEndRow)+1);return this.renderOverlay(ur.ColHighlighting,0,d,h,n.columnSettings[t.column].width)}}return null}},{key:"render",value:function(){var e=this,t=ft(this.props.selection.selectedRegions),n=t&&t.startRow===t.endRow&&t.startCol===t.endCol,o=t&&this.props.data.rows[t.startRow],r=o&&t&&o.cells[t.startCol],i=t&&this.shouldHideSelection(t);return _.createElement("div",{className:"reactTableOverlay",style:{pointerEvents:"none",position:"absolute",top:this.props.offsetOverlayTop+this.props.notRenderedHeightTop,left:this.props.offsetOverlayLeft}},this.props.hover&&(this.props.hover.hoverContextType===c.DataCell||this.props.hover.hoverContextType===c.DimensionMember)&&this.renderCellHover(),this.renderRowHighlighting(),this.renderColHighlighting(),this.props.hover&&this.props.hover.hoverContextType===c.DatacellRegion&&this.renderDataRegionHover(),this.props.hover&&this.props.hover.hoverContextType===c.HeaderRegion&&this.renderHeaderRegionHover(),this.props.hover&&this.props.hover.hoverContextType===c.Dimension&&void 0!==this.props.hover.dimensionId&&this.renderDimensionHover(),this.props.hover&&this.props.hover.hoverContextType===c.CellChart&&void 0!==this.props.hover.dimensionId&&this.renderInCellChartHover(),n&&r&&r.reference&&this.renderReferenceHighlighting(),!i&&this.props.selection.selectedRegions.map((function(t,n){return e.renderSelectedRegion(t,n)})),this.props.highlightedCells&&this.props.highlightedCells.map((function(t,n){return e.renderHighlightedCell(t,n)})))}}]),r}(_.Component);var Or=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(e){return(0,P.Z)(this,r),o.call(this,e)}return(0,k.Z)(r,[{key:"shouldComponentUpdate",value:function(e){return!(this.props.sectionId===e.sectionId&&this.props.top===e.top&&this.props.left===e.left&&this.props.width===e.width&&this.props.height===e.height&&this.props.maxHeight===e.maxHeight&&tn(e.htmlTable,this.props.htmlTable)&&tn(e.overlay,this.props.overlay))}},{key:"render",value:function(){return _.createElement("div",{ref:this.props.innerRef,className:"freezeSection".concat(this.props.sectionId),style:{position:"absolute",top:this.props.top,left:this.props.left,width:this.props.width,height:this.props.height,boxSizing:"border-box",overflow:"hidden"}},_.createElement(cr,this.props.htmlTable),_.createElement(Tr,this.props.overlay),this.props.maxHeight>0&&_.createElement(dr,{height:this.props.maxHeight}))}}]),r}(_.Component),Dr=n(200);ce()(Dr.Z,{insert:"head",singleton:!1}),Dr.Z.locals;var Er,Ir,Ar=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(e){var t;return(0,P.Z)(this,r),(t=o.call(this,e)).boundHandleResizeStart=t.handleResizeStart.bind((0,M.Z)(t)),t.boundHandleResizeTitle=t.handleResizeTitle.bind((0,M.Z)(t)),t.boundHandleResizeEnd=t.handleResizeEnd.bind((0,M.Z)(t)),t}return(0,k.Z)(r,[{key:"handleResizeStart",value:function(e,t,n){n.textContent=ae(this.props.resizingInfo.height),t.style.top=ae(this.props.resizingInfo.height),t.setAttribute(be,"".concat(e.clientY)),this.initialTitleHeight=this.props.titleHeight,this.props.onTitleResizeStart()}},{key:"handleResizeTitle",value:function(e,t,n){var o=t.getAttribute(be);if(o){var r=this.props.titleHeight,i=r+(e.clientY-parseInt(o,10));i<this.props.minimumTitleHeight||i>this.props.tableContainerHeight+r||(this.props.resizingInfo.height=i,this.props.resizingInfo.newHeight=i,t.style.top=ae(i),n.textContent=ae(i))}}},{key:"handleResizeEnd",value:function(){this.props.resizingInfo.newHeight!==this.initialTitleHeight&&this.props.onNewTitleHeight(this.props.resizingInfo.newHeight),this.props.onTitleResizeEnd()}},{key:"render",value:function(){return this.props.resizingInfo.height=this.props.titleHeight,this.props.resizingInfo.newHeight=this.props.titleHeight,_.createElement(ye,{resizerCssClassName:"titleResizer",resizeIndicatorCssClassName:"titleResizeIndicator",resizingInfo:this.props.resizingInfo,refResizer:this.props.refTitleResizer,onResizerDoubeClick:ie,onResizeStart:this.boundHandleResizeStart,onResizing:this.boundHandleResizeTitle,onResizeEnd:this.boundHandleResizeEnd})}}]),r}(_.Component);function Hr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Lr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hr(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.Wrapper="titleWrapper",e.Title="sapReportEngineTitle",e.Subtitle="sapReportEngineSubtitle",e.TokenContainer="sapReportEngineTokenContainer"}(Er||(Er={})),function(e){e.DatasetIcon="sapReportEngineDatasetIcon",e.Subtitle="sapReportEngineSubtitle",e.Notifictaion="sapReportEngineNotificationIcon"}(Ir||(Ir={}));var xr,Pr=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(e){var t;return(0,P.Z)(this,r),t=o.call(this,e),(0,x.Z)((0,M.Z)(t),"keyCounter",0),t.resizingInfo={left:0,top:0,height:0,width:0,col:0,row:0,newHeight:0,newWidth:0,offsetLeft:0,offsetTop:0,scrollOffsetLeft:0,scrollOffsetTop:0},t.boundHandleTitleResizeStart=t.handleTitleResizeStart.bind((0,M.Z)(t)),t.boundHandleTitleResizeEnd=t.handleTitleResizeEnd.bind((0,M.Z)(t)),t.boundHandleNewTitleHeight=t.handleNewTitleHeight.bind((0,M.Z)(t)),t.boundHandleDoubleClickEvent=t.handleDoubleClick.bind((0,M.Z)(t)),t.boundHandleMouseDownEvent=t.handleMouseDown.bind((0,M.Z)(t)),t.boundHandleMouseDownTokenEvent=t.handleMouseDownToken.bind((0,M.Z)(t)),t.boundHandleMouseOverEvent=t.handleMouseOver.bind((0,M.Z)(t)),t.boundHandleContextMenu=t.handleContextMenu.bind((0,M.Z)(t)),t.refTitleContainer=_.createRef(),t}return(0,k.Z)(r,[{key:"componentDidMount",value:function(){this.refTitleContainer.current&&this.refTitleContainer.current.addEventListener("wheel",this.handleOnWheelEvent.bind(this))}},{key:"shouldComponentUpdate",value:function(e){return!(this.props.selected===e.selected&&this.props.designMode===e.designMode&&tn(e.fontOverride,this.props.fontOverride)&&tn(e.title,this.props.title)&&this.props.tableContainerHeight===e.tableContainerHeight&&this.props.titleHeight===e.titleHeight)}},{key:"handleTitleResizeStart",value:function(){this.props.resizingTitleStart()}},{key:"handleTitleResizeEnd",value:function(){this.props.resizingTitleEnd()}},{key:"handleNewTitleHeight",value:function(e){this.props.setNewTitleHeight(e)}},{key:"render",value:function(){var e=this,t=this.props.title.subtitleVisible||this.props.title.detailsVisible,n=this.getStyle(),o=this.props.title.titleChunks,r=this.props.accessibilityKeyboardSupport?-1:void 0;return _.createElement("div",{style:Lr(Lr({},n),{},{minHeight:this.props.title.titleStyle.height?"".concat(this.props.title.titleStyle.height,"px"):void 0,width:"100%",borderColor:this.getBorderColor()}),className:this.getClassList(),onMouseDown:this.boundHandleMouseDownEvent,onDoubleClick:this.boundHandleDoubleClickEvent,onContextMenu:this.boundHandleContextMenu,ref:this.refTitleContainer,tabIndex:r},this.renderLines(),this.props.title.titleVisible&&_.createElement("div",{className:"sapReportEngineTitle",onDoubleClick:this.boundHandleDoubleClickEvent,tabIndex:0,ref:this.props.refTitleValue,editable:"".concat(this.props.title.editable),style:Lr(Lr({},this.getFontStyle(d.Title)),{},{minHeight:""===this.props.title.titleText.trim()?ae(ne.FONT_SIZE_TITLE):void 0})},o&&o.map((function(t){return e.renderTitleHTML(t,!0)}))),this.props.title.tokenData&&t&&this.renderTitleHTML(this.props.title.tokenData,!1),_.createElement("div",{className:"titleEditor"}),this.props.designMode&&!this.props.devicePreview&&_.createElement("div",{className:"titleOverlay"}),this.props.resizeableTitle&&_.createElement(Ar,{refTitleResizer:this.props.refTitleResizer,onTitleResizeStart:this.boundHandleTitleResizeStart,onNewTitleHeight:this.boundHandleNewTitleHeight,onTitleResizeEnd:this.boundHandleTitleResizeEnd,resizingInfo:this.resizingInfo,tableContainerHeight:this.props.tableContainerHeight,titleHeight:this.props.titleHeight,minimumTitleHeight:this.props.title.titleStyle.minimumHeight}))}},{key:"renderTitleHTML",value:function(e,t){var n=this;if("string"==typeof e)return e;var o=e.classes.includes(Er.Subtitle),r=Lr(Lr(Lr({},this.convertToCamelCase(e.styles)),o?this.getFontStyle(d.Subtitle):{}),{},{justifyContent:e.classes.includes(Er.TokenContainer)?this.getStyle().alignItems:void 0}),i="".concat(this.props.title.tableId,"_title_").concat(e.tag,"_").concat(this.keyCounter++),l=e.tag,a=!1;this.props.title.editable&&(a=t||o);var s=[Ir.DatasetIcon,Ir.Notifictaion,Ir.Subtitle].some((function(t){return e.classes.includes(t)})),c=e.children;return _.createElement(l,(0,ln.Z)({key:i,style:r,className:e.classes.join(" "),onMouseDown:t?this.boundHandleMouseDownEvent:this.boundHandleMouseDownTokenEvent,onMouseMove:s?this.boundHandleMouseOverEvent:null,onMouseLeave:this.props.handler.onCellMouseLeave,onDoubleClick:a?this.boundHandleDoubleClickEvent:null},this.getAdditionalAttributes(e.attributes)),c&&c.map((function(e){return n.renderTitleHTML(e,t)})))}},{key:"getAdditionalAttributes",value:function(e){if(Object.keys(e).length>0){var t=["class","style"],n={};for(var o in e)t.includes(o)||(n[o]=e[o]);return n}return null}},{key:"convertToCamelCase",value:function(e){for(var t={},n=0,o=Object.keys(e);n<o.length;n++){var r=o[n];t[r.replace(/-([a-z])/g,(function(e,t){return t.toUpperCase()}))]=e[r]}return t}},{key:"getClassList",value:function(){var e="".concat(Q," dataRegionTitle");return this.props.selected&&(e+=" selected"),e}},{key:"getBorderColor",value:function(){return this.props.selected?this.props.designMode?oe.SELECTION_BORDER_COLOR_DESIGN:oe.SELECTION_BORDER_COLOR:oe.TITLE_BORDER_COLOR}},{key:"getFontStyle",value:function(e){var t=e===d.Title?this.props.title.titleStyle:this.props.title.subtitleStyle;return t?Lr({},t.font&&yn(t.font,this.props.fontOverride,e)):{}}},{key:"getStyle",value:function(){var e=this.props.title.titleStyle;return e?{backgroundColor:e.fillColor?e.fillColor:void 0,justifyContent:this.getVerticalAlignment(),alignItems:this.getHorizontalAlignment()}:{}}},{key:"getVerticalAlignment",value:function(){var e=this.props.title.titleStyle,t=e.alignment&&e.alignment.vertical;if(void 0!==t)switch(t){case a.Top:return"flex-start";case a.Middle:return"center";case a.Bottom:return"flex-end";default:return}}},{key:"getHorizontalAlignment",value:function(){var e=this.props.title.titleStyle,t=e.alignment&&e.alignment.horizontal;if(void 0!==t)switch(t){case s.Left:return"flex-start";case s.Center:return"center";case s.Right:return"flex-end";default:return}}},{key:"renderLines",value:function(){var e;return null!==(e=this.props.title.titleStyle)&&void 0!==e&&e.lines?_.createElement(dn,{lines:this.props.title.titleStyle.lines}):null}},{key:"handleDoubleClick",value:function(){if(this.props.title.editable&&!this.props.devicePreview&&this.props.title.titleVisible){var e=this.props.refTitleValue.current;if(e&&this.props.handler.onCellEdit){var t={target:e,isReworkTitle:!0};this.props.handler.onCellEdit(t)}}}},{key:"handleMouseDownToken",value:function(e){if((e.currentTarget.classList.contains(Er.Subtitle)||e.currentTarget.classList.contains(Er.TokenContainer))&&this.props.handler.onTitleSelected(e),this.props.handler.onCellMouseDown){var t={regionkey:e.currentTarget.dataset?e.currentTarget.dataset.regionkey:null,tokenId:e.currentTarget.id,target:e.currentTarget,event:e.nativeEvent,col:this.props.title.column,row:this.props.title.row};this.props.handler.onCellMouseDown(t),e.stopPropagation()}}},{key:"handleMouseDown",value:function(e){if(this.props.handler.onTitleSelected(e),this.props.handler.onCellMouseDown){var t={regionkey:e.currentTarget.dataset?e.currentTarget.dataset.regionkey:null,tokenId:e.currentTarget.id,target:e.currentTarget,event:e.nativeEvent};this.props.handler.onCellMouseDown(t),e.stopPropagation()}}},{key:"handleContextMenu",value:function(e){this.props.handler.onContextMenu({isTitle:!0,event:e.nativeEvent,col:-1,row:-1,targetDescription:J})}},{key:"handleMouseOver",value:function(e){if(this.props.handler.onCellMouseOver){var t=e.currentTarget.closest("div"),n={boundingClientRect:t?t.getBoundingClientRect():null,target:e.currentTarget,event:e.nativeEvent,getParameters:function(){return this},id:e.currentTarget.id,tokenId:e.currentTarget.id,regionkey:e.currentTarget.dataset?e.currentTarget.dataset.regionkey:null};this.props.handler.onCellMouseOver(n)}}},{key:"handleOnWheelEvent",value:function(e){e.preventDefault()}}]),r}(_.Component);function kr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function _r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function zr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_r(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e[e.AddElement=0]="AddElement",e[e.RemoveElement=1]="RemoveElement"}(xr||(xr={}));var Mr=function(e){(0,N.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,B.Z)(t);if(n){var r=(0,B.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,Z.Z)(this,e)});function r(e,t,n){var i;(0,P.Z)(this,r),i=o.call(this,e),(0,x.Z)((0,M.Z)(i),"tableFocusedFromInside",!1),i.refTitleResizer=_.createRef(),i.refRowResizer=_.createRef(),i.refColumnResizer=_.createRef(),i.refTableContainer=_.createRef(),i.refHtmlTableWrapper=_.createRef(),i.refTitleValue=_.createRef(),i.refTableRoot=_.createRef(),i.pasteInProgress=!1,i.state=zr({hover:{hoverContextType:c.DataCell,doubleOverlay:!1},selection:{selectedRegions:[],selectionContextType:c.Widget},copyInProcess:!1},t),i.resizingInfo={left:0,top:0,height:0,width:0,col:0,row:0,newHeight:0,newWidth:0,offsetLeft:0,offsetTop:0,scrollOffsetLeft:0,scrollOffsetTop:0},i.boundHandleKeyDown=i.handleKeyDown.bind((0,M.Z)(i)),i.boundHandleKeyUp=i.handleKeyUp.bind((0,M.Z)(i)),i.boundHandleMouseDownOutside=i.handleMouseDownOutside.bind((0,M.Z)(i)),i.boundHandleMouseUpOutside=i.handleMouseUpOutside.bind((0,M.Z)(i)),i.boundHandleScroll=i.handleScroll.bind((0,M.Z)(i)),i.boundHandleCellDoubleClick=i.handleCellDoubleClick.bind((0,M.Z)(i)),i.boundHandleCellMouseDown=i.handleCellMouseDown.bind((0,M.Z)(i)),i.boundHandleCellMouseEnter=i.handleCellMouseEnter.bind((0,M.Z)(i)),i.boundHandleCellMouseUp=i.handleCellMouseUp.bind((0,M.Z)(i)),i.boundHandleCellMouseOver=i.handleCellMouseOver.bind((0,M.Z)(i)),i.boundHandleContextMenu=i.handleContextMenu.bind((0,M.Z)(i)),i.boundHandleOverlayClick=i.handleOverlayClick.bind((0,M.Z)(i)),i.boundHandleShowOverlay=i.handleShowOverlay.bind((0,M.Z)(i)),i.boundHandleHideOverlay=i.handleHideOverlay.bind((0,M.Z)(i)),i.boundHandleTitleClick=i.handleTitleClick.bind((0,M.Z)(i)),i.boundHandleTableMouseUp=i.handleTableMouseUp.bind((0,M.Z)(i)),i.boundHandleTableOnFocus=i.handleTableOnFocus.bind((0,M.Z)(i)),i.boundHandleClick=i.handleClick.bind((0,M.Z)(i)),i.boundHandleCopyDraggerClick=i.handleCopyDraggerClick.bind((0,M.Z)(i)),i.boundHandleResizerDoubleClick=i.handleResizerDoubleClick.bind((0,M.Z)(i)),i.boundHandleRowResizeStart=i.handleRowResizeStart.bind((0,M.Z)(i)),i.boundHandleRowResizeEnd=i.handleRowResizeEnd.bind((0,M.Z)(i)),i.boundHandleNewRowHeight=i.handleNewRowHeight.bind((0,M.Z)(i)),i.boundHandleColumnResizeStart=i.handleColumnResizeStart.bind((0,M.Z)(i)),i.boundHandleColumnResizeEnd=i.handleColumnResizeEnd.bind((0,M.Z)(i)),i.boundHandleNewColumnWidth=i.handleNewColumnWidth.bind((0,M.Z)(i)),i.boundHandleNewTitleHeight=i.handleNewTitleHeight.bind((0,M.Z)(i)),i.boundHandleResizingTitleStart=i.handleTitleResizeStart.bind((0,M.Z)(i)),i.boundHandleResizingTitleEnd=i.handleTitleResizeEnd.bind((0,M.Z)(i)),i.boundHandleDrillIconClicked=i.handleDrillIconClicked.bind((0,M.Z)(i)),i.boundHandleCellIconClicked=i.handleCellIconClicked.bind((0,M.Z)(i)),i.boundHandleCellDropped=i.handleCellDropped.bind((0,M.Z)(i)),i.updateScrollPosition.bind((0,M.Z)(i)),i.setSelectionArea.bind((0,M.Z)(i)),i.boundHandleTableRootContextMenuEvent=i.handleTableRootContextMenuEvent.bind((0,M.Z)(i)),i.scrollDragDirection=u.unset,i.resizing=h.None,i.active=!1,i.setFirstClickWithMultiSelect(!1),i.cancelKeyboardPressToOpenHyperlink=!1;var l=i.props.handler,a=l.onInternalReloadLimitReachedVertically,s=l.onInternalReloadLimitReachedHorizontally;return i.scrollReloadDispatcher=new qe(i.props.data.scrollPosition,{onInternalReloadLimitReachedVertically:a,onInternalReloadLimitReachedHorizontally:s},i.props.handler.storeScrollPosition),i.horizontalScrollDetector=new Ge,i.scrollSynchronizer=i.props.data.mobile?new $e:new Qe,i.autoScroll=(null==n?void 0:n.autoScroll)||new Ze(i.setScrollTop.bind((0,M.Z)(i)),i.setScrollLeft.bind((0,M.Z)(i))),i}return(0,k.Z)(r,[{key:"componentDidMount",value:function(){this.refTableContainer.current&&(this.refTableContainer.current.addEventListener("wheel",this.handleDefaultWheelScroll.bind(this)),this.applyInitialScrollPosition()),this.props.handler.onRenderComplete&&this.props.handler.onRenderComplete(this.refTableContainer),this.updateResizer(0,this.props.data.lastRowIndex)}},{key:"applyInitialScrollPosition",value:function(){0!==this.props.data.scrollPosition.scrollTop&&this.setScrollTop(this.props.data.scrollPosition.scrollTop),0!==this.props.data.scrollPosition.scrollLeft&&this.setScrollLeft(this.props.data.scrollPosition.scrollLeft)}},{key:"addEventListeners",value:function(){this.removeEventListeners(),document.addEventListener("keydown",this.boundHandleKeyDown,!0),document.addEventListener("keyup",this.boundHandleKeyUp,!0),document.addEventListener("mousedown",this.boundHandleMouseDownOutside),document.addEventListener("mouseup",this.boundHandleMouseUpOutside)}},{key:"removeEventListeners",value:function(){document.removeEventListener("keydown",this.boundHandleKeyDown,!0),document.removeEventListener("keyup",this.boundHandleKeyUp,!0),document.removeEventListener("mousedown",this.boundHandleMouseDownOutside),document.removeEventListener("mouseup",this.boundHandleMouseUpOutside)}},{key:"handleDefaultWheelScroll",value:function(e){if(this.horizontalScrollDetector.isHorizontalScroll(e.deltaX))e.preventDefault();else{var t=this.scrollSynchronizer.isScrolledToTop()&&e.deltaY<0,n=this.props.tableSizes.maxScrollTop<=Math.ceil(this.scrollSynchronizer.getScrollTop())&&e.deltaY>0;t||n&&this.props.tableSizes.allRowsProcessed||e.preventDefault()}}},{key:"getScrollTop",value:function(){return this.scrollSynchronizer.getScrollTop()}},{key:"getScrollLeft",value:function(){return this.scrollSynchronizer.getScrollLeft()}},{key:"setScrollTop",value:function(e){this.scrollSynchronizer.setScrollTop(e)}},{key:"setScrollLeft",value:function(e){this.scrollSynchronizer.setScrollLeft(e)}},{key:"getLastScrollUpdateVertical",value:function(){return this.scrollReloadDispatcher.getLastScrollUpdateVertical()}},{key:"getLastScrollUpdateHorizontal",value:function(){return this.scrollReloadDispatcher.getLastScrollUpdateHorizontal()}},{key:"handleMouseDownOutside",value:function(e){var t,n=e.target;n&&null===(null===(t=n.closest(".".concat(Er.TokenContainer)))||void 0===t?void 0:t.parentNode)||$t(n,this.props.data,this.props.handler.isTableOverlappedByOutsideElement)&&this.setActive(!1)}},{key:"handleMouseUpOutside",value:function(e){var t=e.target;this.props.selectionStrategy.getSelectionInProcess()&&$t(t,this.props.data,this.props.handler.isTableOverlappedByOutsideElement)&&(this.handleCellMouseUp({event:e}),this.props.selectionStrategy.setSelectionInProcess(!1))}},{key:"handleTableOnFocus",value:function(){var e;this.isActive()||null===(e=this.props.data.featureToggles)||void 0===e||!e.accessibilityKeyboardSupport||this.tableFocusedFromInside||(this.setActive(!0),this.setSelectionArea({selectionArea:Bt(),singleSelection:!0,isKeyEvent:!1})),this.tableFocusedFromInside=!1}},{key:"setSelected",value:function(e){var t=this;this.active&&this.firstClickWithMultiSelect||e||this.props.data.hasLADatapointSelection||this.props.data.addingDynamicTextToTitle||this.setState((function(e){var n={selectedRegions:[],selectionContextType:c.Widget};return zt(n,t.props.handler),zr(zr({},e),{},{selection:n})}))}},{key:"setActive",value:function(e){this.active!==e&&(this.active=e,e?this.addEventListeners():(this.removeEventListeners(),this.firstClickWithMultiSelect&&(this.setFirstClickWithMultiSelect(!1),this.setSelected(!1))))}},{key:"isActive",value:function(){return this.active}},{key:"setFirstClickWithMultiSelect",value:function(e){this.firstClickWithMultiSelect=e}},{key:"handleKeyDown",value:function(e){var t,n=[et.TAB,et.ENTER].includes(e.keyCode),o=St(this.state.selection.selectionContextType),r=this.props.handler.getNewLineDataEntryInProgress&&this.props.handler.getNewLineDataEntryInProgress(),i=this.props.handler.getDataEntryInProgress&&this.props.handler.getDataEntryInProgress();if(!r&&(!i||n&&!o)&&Yt(this.active,this.props.data.id)&&!this.props.preventDefaultSelection){var l=ut(e),a=[et.CONTROL,et.CMD_LEFT,et.CMD_RIGHT].includes(e.keyCode),s=e.shiftKey,d=e.altKey,h=Wt(this.state.selection),u=zr(zr({},h),{},{isCellChartSelection:!1});if(a&&Tt(this.state.selection.selectionContextType,this.state.hover.hoverContextType))this.setState(zr(zr({},this.state),{},{hover:{hoverContextType:c.DataCell,doubleOverlay:!1}}));else{this.setState(zr(zr({},this.state),{},{copyInProcess:!1}));var f,g=e.keyCode,C=null===(t=this.props.data.rows[h.startRow])||void 0===t?void 0:t.cells[h.startCol];switch(g){case et.A:if(l){e.stopPropagation(),e.preventDefault();var b=this.props.selectionStrategy.handleKeyDown(et.A,this.props.data,u,this.state.selection.selectionContextType,e);this.setSelectionArea(b)}break;case et.ARROW_DOWN:if(e.stopPropagation(),e.preventDefault(),d)this.handleAltArrowKeyTriggerDrill(C,h,!(null!=C&&C.expanded),C.cellType===v.RowDimMember);else{var y=this.props.selectionStrategy.handleKeyDown(et.ARROW_DOWN,this.props.data,u,this.state.selection.selectionContextType,e);l||s||!this.props.data.responsive&&this.props.data.editMode&&this.addOrRemoveTableElement(p.Row,xr.AddElement),this.triggerKeyboardShortcutCallback(h,e),this.setSelectionArea(y)}break;case et.ARROW_LEFT:if(e.stopPropagation(),e.preventDefault(),d)this.handleAltArrowKeyTriggerDrill(C,h,null==C?void 0:C.expanded,C.cellType===v.ColDimMember);else{var m=this.props.selectionStrategy.handleKeyDown(et.ARROW_LEFT,this.props.data,u,this.state.selection.selectionContextType,e);l||s||!this.props.data.responsive&&this.props.data.editMode&&this.addOrRemoveTableElement(p.Column,xr.RemoveElement),this.triggerKeyboardShortcutCallback(h,e),this.setSelectionArea(m)}break;case et.ARROW_RIGHT:if(e.stopPropagation(),e.preventDefault(),d)this.handleAltArrowKeyTriggerDrill(C,h,!(null!=C&&C.expanded),C.cellType===v.ColDimMember);else{var R=this.props.selectionStrategy.handleKeyDown(et.ARROW_RIGHT,this.props.data,u,this.state.selection.selectionContextType,e);l||s||!this.props.data.responsive&&this.props.data.editMode&&this.addOrRemoveTableElement(p.Column,xr.AddElement),this.triggerKeyboardShortcutCallback(h,e),this.setSelectionArea(R)}this.triggerKeyboardShortcutCallback(h,e);break;case et.ARROW_UP:if(e.stopPropagation(),e.preventDefault(),d)this.handleAltArrowKeyTriggerDrill(C,h,null==C?void 0:C.expanded,C.cellType===v.RowDimMember);else{var w=this.props.selectionStrategy.handleKeyDown(et.ARROW_UP,this.props.data,u,this.state.selection.selectionContextType,e);l||s||!this.props.data.responsive&&this.props.data.editMode&&this.addOrRemoveTableElement(p.Row,xr.RemoveElement),this.triggerKeyboardShortcutCallback(h,e),this.setSelectionArea(w)}break;case et.PAGE_DOWN:e.preventDefault(),this.handlePageDown(u,d);break;case et.PAGE_UP:e.preventDefault(),this.handlePageUp(u,d);break;case et.HOME:e.preventDefault();var S=this.props.selectionStrategy.handleKeyDown(et.HOME,this.props.data,u,this.state.selection.selectionContextType,e);this.setSelectionArea(S);break;case et.END:e.preventDefault();var T=this.props.selectionStrategy.handleKeyDown(et.END,this.props.data,u,this.state.selection.selectionContextType,e);this.setSelectionArea(T);break;case et.ENTER:if(e.preventDefault(),!l){var O=this.props.selectionStrategy.handleKeyDown(et.ENTER,this.props.data,u,this.state.selection.selectionContextType,e);this.setSelectionArea(O)}this.triggerKeyboardShortcutCallback(h,e);break;case et.TAB:e.preventDefault();var D=this.props.selectionStrategy.handleKeyDown(et.TAB,this.props.data,u,this.state.selection.selectionContextType,e);this.setSelectionArea(D);break;case et.SPACE:e.preventDefault(),this.startKeyboardPressToOpenHyperlink=!0,(l&&!s||s&&!l)&&(this.startKeyboardPressToOpenHyperlink=!1);var E=this.props.selectionStrategy.handleKeyDown(et.SPACE,this.props.data,u,this.state.selection.selectionContextType,e);this.setSelectionArea(E);break;case et.ESCAPE:e.preventDefault(),this.startKeyboardPressToOpenHyperlink?(this.cancelKeyboardPressToOpenHyperlink=!0,this.startKeyboardPressToOpenHyperlink=!1):this.setSelectionArea({clearSelection:!0,isKeyEvent:!0});break;case et.DELETE:case et.BACKSPACE:case et.B:case et.C:case et.I:case et.U:case et.V:case et.X:case et.D:case et.M:if(!this.props.data.designMode&&(f=g,l&&pt.includes(f))){e.stopPropagation(),e.preventDefault();break}(l||et.DELETE===g||et.BACKSPACE===g)&&(e.stopPropagation(),this.triggerKeyboardShortcutCallback(h,e)),l&&(g!==et.C&&g!==et.X||this.setState(zr(zr({},this.state),{},{copyInProcess:!0})),g===et.V&&(this.pasteInProgress=!0));break;case et.F2:var I=function(e,t,n){var o=dt(e,t);return o?{row:n.row,col:n.column,target:o}:void 0}(this.props.data,h,C);s&&this.triggerKeyboardShortcutCallback(h,e),!I||s||l||this.handleCellDoubleClick(I,o);break;case et.F4:this.handleAltArrowKeyTriggerDrill(C,h,!0,!0);break;case et.NUMPAD_PLUS:this.handleAltArrowKeyTriggerDrill(C,h,!(null!=C&&C.expanded),!0);break;case et.NUMPAD_MINUS:this.handleAltArrowKeyTriggerDrill(C,h,null==C?void 0:C.expanded,!0);break;case et.PLUS:this.handleAltArrowKeyTriggerDrill(C,h,!(null!=C&&C.expanded),!0);break;case et.SLASH:this.handleAltArrowKeyTriggerDrill(C,h,null==C?void 0:C.expanded,!0);break;case et.SHIFT:this.startKeyboardPressToOpenHyperlink&&(this.cancelKeyboardPressToOpenHyperlink=!0,this.startKeyboardPressToOpenHyperlink=!1);break;case et.F6:this.isActive()&&(this.setSelectionArea({clearSelection:!0,isKeyEvent:!0}),this.setActive(!1));break;case et.F10:if(s){var A={col:o?-1:C.column,row:o?-1:C.row,event:e,targetDescription:o?J:Xt(C.row,C.column),isTitle:o};this.handleContextMenu(A)}}var H=this.state.selection.selectedRegions.length>0||o;if(!l&&(g>=et.DIGIT_0&&g<=et.Z||g>=et.NUMPAD_0&&g<=et.NUMPAD_SLASH||g>=et.OPEN_BRACKET&&g<=et.SINGLE_QUOTE)&&H){var L={target:e.target,row:h.startRow,col:h.startCol,keyEvent:e};this.handleCellDoubleClick(L,o)}}}}},{key:"triggerKeyboardShortcutCallback",value:function(e,t){this.props.handler.onKeyboardShortcut&&this.props.handler.onKeyboardShortcut({selectionArea:e,event:t})}},{key:"focusTableFromInside",value:function(){var e;this.tableFocusedFromInside=!0,null===(e=this.refTableRoot.current)||void 0===e||e.focus()}},{key:"focusTable",value:function(){var e;null===(e=this.refTableRoot.current)||void 0===e||e.focus({preventScroll:!0})}},{key:"handleAltArrowKeyTriggerDrill",value:function(e,t,n,o){if(this.props.handler.onDrillIconClicked&&null!=e&&e.showDrillIcon&&n&&o){var r=function(e,t,n){var o=dt(e,t);return o?{row:null==n?void 0:n.row,col:null==n?void 0:n.column,td:o}:{}}(this.props.data,t,e);this.props.handler.onDrillIconClicked(r)}}},{key:"handlePageDown",value:function(e,t){var n=this;t?this.props.handler.onAltPageUpDownKey(!0,e,(function(e){n.setSelectionArea({selectionArea:e,singleSelection:!0,isKeyEvent:!0})})):this.props.handler.onPageUpDownKey(!0,e,(function(e){n.setSelectionArea({selectionArea:e,singleSelection:!0,isKeyEvent:!0,scrollDirection:Fe.PageDown})}))}},{key:"handlePageUp",value:function(e,t){var n=this;t?this.props.handler.onAltPageUpDownKey(!1,e,(function(e){n.setSelectionArea({selectionArea:e,singleSelection:!0,isKeyEvent:!0})})):this.props.handler.onPageUpDownKey(!1,e,(function(e){n.setSelectionArea({selectionArea:e,singleSelection:!0,isKeyEvent:!0,scrollDirection:Fe.PageUp})}))}},{key:"handleKeyUp",value:function(e){var t=e.keyCode;t===et.DELETE&&e.stopPropagation();var n,o=ut(e);if(Yt(this.active,this.props.data.id)&&this.props.handler.onKeyboardShortcut&&(t===et.V&&o||t===et.WINDOWS||this.pasteInProgress)){if(t===et.V&&(this.pasteInProgress=!1),St(this.state.selection.selectionContextType))return;this.props.handler.onKeyboardShortcut({selectionArea:Wt(this.state.selection),event:e,keyUp:!0})}if(t===et.SPACE){if(this.startKeyboardPressToOpenHyperlink&&!this.cancelKeyboardPressToOpenHyperlink){var r,i=Wt(this.state.selection),l=null===(r=this.props.data.rows[i.startRow])||void 0===r?void 0:r.cells[i.startCol];if(this.props.handler.onCellLinkPressed&&null!=l&&l.showHyperlink){var a={row:(n=l).row,col:n.column,cellHyperlinkId:n.id};this.props.handler.onCellLinkPressed(a)}this.startKeyboardPressToOpenHyperlink=!1}this.cancelKeyboardPressToOpenHyperlink=!1}}},{key:"addOrRemoveTableElement",value:function(e,t){var n=Wt(this.state.selection);if(e===p.Row){var o=this.props.data.rows.length-1;n.endRow===o&&t===xr.AddElement?this.props.handler.onAddRowOrColOnTheFly(p.Row):n.endRow===o&&t===xr.RemoveElement&&this.props.handler.onRemoveRowOrColOnTheFly(p.Row,o)}else{var r=this.props.data.columnSettings.length-1;n.endCol===r&&t===xr.AddElement?this.props.handler.onAddRowOrColOnTheFly(p.Column):n.endCol===r&&t===xr.RemoveElement&&this.props.handler.onRemoveRowOrColOnTheFly(p.Column,r)}}},{key:"setSelectionArea",value:function(e){var t,n=this;if(e.selectionArea){var o=zr({},e.selectionArea);if(o=lt(o=function(e,t,n){var o=bt({},e),r=t.length-1;o.startRow>r&&(o.startRow=r),o.endRow>r&&(o.endRow=r);var i=n-1;return o.startCol>i&&(o.startCol=i),o.endCol>i&&(o.endCol=i),o.startRow<0&&(o.startRow=0),o.startCol<0&&(o.startCol=0),o.endRow<0&&(o.endRow=0),o.endCol<0&&(o.endCol=0),o}(o,this.props.data.rows,this.props.data.columnSettings.length),this.props.data.rows),this.props.isPaginating&&e.scrollDirection&&(o=function(e,t,n,o){var r=bt({},e),i=t.filter((function(e){return void 0!==e&&!e.fixed})),l=i[0].row,a=i[i.length-1].row,s=t[r.startRow],c=t[r.endRow],d=n===Fe.PageDown||n===Fe.PageUp;if(void 0===s||d)switch(n){case Fe.Down:r.startRow=r.startRow>a?a:r.startRow<0?0:l;break;case Fe.Up:r.startRow=r.startRow<0?0:r.startRow<l&&void 0!==o&&o>-1?o:r.startRow>a?a:l;break;case Fe.PageDown:r.startRow=a;break;case Fe.PageUp:r.startRow=void 0!==o&&o>-1?0:l}if(void 0===c||d)switch(n){case Fe.Down:r.endRow=r.endRow>a?a:r.endRow<0?0:l;break;case Fe.Up:r.endRow=r.endRow<0?0:r.endRow<l&&void 0!==o&&o>-1?o:r.endRow>a?a:l;break;case Fe.PageDown:r.endRow=a;break;case Fe.PageUp:r.endRow=void 0!==o&&o>-1?0:l}return r}(o,this.props.data.rows,e.scrollDirection,this.props.data.freezeEndRow)),e.singleSelection){var i;this.setState((function(t){var i=[o],l=e.context||r.getSelectionAreaContext(i,n.props.data.rows),a=zr(zr({},t.selection),{},{selectedRegions:i,selectionContextType:l});return zt(a,n.props.handler,e.isKeyEvent),e.event&&n.props.handler.onTableMouseUp&&n.props.handler.onTableMouseUp(e.event),e.fireSelectionUpdate&&n.props.handler.onCellSelected(),zr(zr({},t),{},{selection:a,hover:{hoverContextType:c.DataCell,doubleOverlay:!1},copyInProcess:!1})}));var l=this.props.handler.getNewLineDataEntryInProgress&&this.props.handler.getNewLineDataEntryInProgress();null!==(i=this.props.data.featureToggles)&&void 0!==i&&i.accessibilityKeyboardSupport&&!l&&ct(this.props.data,o)}}e.clearSelection&&(this.setState((function(t){var o={selectedRegions:[],selectionContextType:c.Widget};return zt(o,n.props.handler,e.isKeyEvent),e.event&&n.props.handler.onTableMouseUp&&n.props.handler.onTableMouseUp(e.event),zr(zr({},t),{},{selection:o,hover:{hoverContextType:c.DataCell,doubleOverlay:!1},copyInProcess:!1})})),null!==(t=this.props.data.featureToggles)&&void 0!==t&&t.accessibilityKeyboardSupport&&this.focusTableFromInside());var a=[Fe.PageDown,Fe.PageUp];void 0!==e.scrollDirection&&-1===a.indexOf(e.scrollDirection)&&this.updateScrollPosition(e.scrollDirection)}},{key:"setNewRowHeight",value:function(e){var t,n,o,r=function(e){var t=[];if(!e||0===e.length)return t;var n,o=gt(e);try{for(o.s();!(n=o.n()).done;){var r=n.value;t=Array.from(new Set([].concat((0,L.Z)(t),(0,L.Z)(Nt(r)))))}}catch(e){o.e(e)}finally{o.f()}return t}(this.state.selection.selectedRegions);if(t=this.resizingInfo,n=this.props.data.rows,o=this.props.tableSizes.borderSize,t.newHeight>=re.MIN_HEIGHT&&function(e,t,n){var o=t.newHeight;return 0!==o&&o!==n[t.row].height+e}(o,t,n)){var i=Se(this.resizingInfo.row,e,r);this.props.handler.onRowHeightChanged(i)}}},{key:"setNewColumnWidth",value:function(e){var t,n,o=this.resizingInfo.col,r=function(e){var t=[];if(!e||0===e.length)return t;var n,o=gt(e);try{for(o.s();!(n=o.n()).done;){var r=n.value;t=Array.from(new Set([].concat((0,L.Z)(t),(0,L.Z)(Mt(r)))))}}catch(e){o.e(e)}finally{o.f()}return t}(this.state.selection.selectedRegions);if(t=this.resizingInfo,n=this.props.data.columnSettings,t.newWidth>=oe.MINIMUM_COLUMN_SIZE&&function(e,t){var n=e.newWidth;return 0!==n&&n!==t[e.col].width}(t,n)){var i=Se(o,e,r);this.props.handler.onColumnWidthChanged(i)}}},{key:"setNewTitleHeight",value:function(e){this.props.handler.onTitleHeightChanged(e)}},{key:"getHorizontalOffsetForColumnIndexExcludingFrozen",value:function(e){return this.props.data.columnSettings.slice(0,e).reduce((function(e,t){return e+t.width}),0)-this.props.tableSizes.freezeWidth+this.props.tableSizes.coordinateOffset}},{key:"getVerticalOffsetForRowIndexExcludingFrozen",value:function(e){var t=this;return this.props.data.rows.slice(0,e).reduce((function(e,n){return!n||n.fixed?e:e+n.height+t.props.tableSizes.borderSize}),this.props.tableSizes.notRenderedHeightTop)}},{key:"updateScrollPosition",value:function(e){var t;if(this.refTableContainer.current){var n=Wt(this.state.selection),o=n.endCol,r=n.endRow,i=void 0!==this.props.data.freezeEndCol&&this.props.data.freezeEndCol>=o,l=void 0!==this.props.data.freezeEndRow&&this.props.data.freezeEndRow>=r,a=this.getHorizontalOffsetForColumnIndexExcludingFrozen(o),s=this.getVerticalOffsetForRowIndexExcludingFrozen(r),c=this.getScrollLeft(),d=this.getScrollTop(),h=this.props.data.totalHeight+this.props.tableSizes.coordinateOffset,p=this.props.data.totalWidth+this.props.tableSizes.coordinateOffset,u=(null===(t=this.props.data.rows[r])||void 0===t?void 0:t.height)+this.props.tableSizes.borderSize,f=o-1===this.props.data.freezeEndCol,g=r-1===this.props.data.freezeEndRow;switch(e){case Fe.Right:this.scrollDirectionRight(a,c,o,f,i);break;case Fe.Down:this.scrollDirectionDown(s,d,u,g,l);break;case Fe.Left:this.scrollDirectionLeft(a,c,o,i);break;case Fe.Up:this.scrollDirectionUp(s,d,u,l);break;case Fe.FirstRow:this.setScrollTop(0);break;case Fe.FirstCol:this.setScrollLeft(0);break;case Fe.LastRow:this.setScrollTop(h-this.props.tableSizes.tableContainerHeight);break;case Fe.LastCol:this.setScrollLeft(p-this.props.tableSizes.tableContainerWidth);break;case Fe.FirstCell:this.setScrollTop(0),this.setScrollLeft(0);break;case Fe.LastCell:this.setScrollTop(h-this.props.tableSizes.tableContainerHeight),this.setScrollLeft(p-this.props.tableSizes.tableContainerWidth);break;case Fe.DownAndFirstCol:this.scrollDirectionDown(s,d,u,g,l),this.setScrollLeft(0);break;case Fe.UpAndLastCol:this.scrollDirectionUp(s,d,u,l),this.setScrollLeft(p-this.props.tableSizes.tableContainerWidth)}}}},{key:"scrollDirectionLeft",value:function(e,t,n,o){if(!o){var r=Ke(e,this.props.data.columnSettings[n].width,t,this.props.tableSizes.tableContainerWidth-this.props.tableSizes.freezeWidth);void 0!==r&&this.setScrollLeft(r)}}},{key:"scrollDirectionDown",value:function(e,t,n,o,r){if(!r)if(o)this.setScrollTop(0);else{var i=Ke(e,n,t,this.props.tableSizes.tableContainerHeight-this.props.tableSizes.freezeHeight);void 0!==i&&this.setScrollTop(i)}}},{key:"scrollDirectionUp",value:function(e,t,n,o){if(!o){var r=Ke(e,n,t,this.props.tableSizes.tableContainerHeight-this.props.tableSizes.freezeHeight);void 0!==r&&this.setScrollTop(r)}}},{key:"scrollDirectionRight",value:function(e,t,n,o,r){if(!r)if(o)this.setScrollLeft(0);else{var i=Ke(e,this.props.data.columnSettings[n].width,t,this.props.tableSizes.tableContainerWidth-this.props.tableSizes.freezeWidth);void 0!==i&&this.setScrollLeft(i)}}},{key:"handleTableMouseUp",value:function(e){this.props.selectionStrategy.getSelectionInProcess()&&this.handleCellMouseUp({event:e.nativeEvent}),this.props.handler.onTableMouseUp&&this.resizing===h.None&&this.active&&this.props.handler.onTableMouseUp(e.nativeEvent)}},{key:"handleCellMouseDown",value:function(e){var t,n,o,r,i,l,a;(null!==(t=this.props.data.featureToggles)&&void 0!==t&&t.accessibilityKeyboardSupport&&this.props.handler.getNewLineDataEntryInProgress&&!this.props.handler.getNewLineDataEntryInProgress()&&e.event.preventDefault(),this.props.data.devicePreview)||(ht(e)&&0===e.event.button&&(null===(n=(o=this.props.handler).onCellLinkPressed)||void 0===n||n.call(o,e)),function(e){return e.target.classList.contains("comment")}(e)&&(null===(r=(i=this.props.handler).onCommentIconClicked)||void 0===r||r.call(i,e)),this.props.handler.getFormulaEntryInProgress&&this.props.handler.getFormulaEntryInProgress()?null===(l=(a=this.props.handler).onCellMouseDown)||void 0===l||l.call(a,e):this.props.selectionStrategy.handleSelectionForMouseDown(this.setState.bind(this),this.isActive.bind(this),this.setActive.bind(this),this.setFirstClickWithMultiSelect.bind(this),this.setSelectionArea.bind(this),this.state,this.props.preventDefaultSelection,this.props.data,this.props.handler,e,this.focusTableFromInside.bind(this)))}},{key:"handleCellMouseUp",value:function(e){this.props.handler.getDataEntryInProgress&&this.props.handler.getDataEntryInProgress()&&this.props.handler.getFormulaEntryInProgress&&this.props.handler.getFormulaEntryInProgress()||this.isActive()&&this.props.selectionStrategy.handleSelectionForMouseUp(this.setState.bind(this),this.props.handler,this.state,e,this.resizing)}},{key:"handleCellMouseOver",value:function(e){var t,n=this,o=null===(t=this.props.data.rows[e.row])||void 0===t?void 0:t.cells[e.col],r=this.resizing!==h.None;if(!r&&o&&o.merged){var i=Te(e,this.props.data,this.props.tableSizes.borderSize);this.updateResizer(i.col,i.row)}var l,a,s,d,p,f,g=!(null==o||!o.cellChart),b=(null==o?void 0:o.cellType)===v.Threshold;if(g||b||this.active&&!r&&!this.props.data.mobile&&!this.props.data.devicePreview){var y=Wt(this.state.selection);if(this.props.selectionStrategy.getSelectionInProcess()){if(this.autoScroll.autoScrollTable(e,this.getScrollTop(),this.getScrollLeft(),this.props.tableSizes.tableContainerWidth+oe.SCROLLBAR_SIZE,this.props.tableSizes.tableContainerHeight+this.props.tableSizes.horizontalScrollbarHeight),y.isCellChartSelection&&e.row>=y.startRow&&e.row<=y.endRow&&e.col>=y.startCol&&e.col<=y.endCol)return;s=Ot(l=y,(a=e).row,a.col),d=Dt(l,a.row,a.col),p=-1===a.row||-1===a.col,f=function(e){return e.selectionType===C.Box}(l)&&!p&&!Et(l)&&!It(l),(s||d||f)&&this.setState((function(t){var o,r,i=zr({},y);if(t.copyInProcess){var l=(o={scrollDragDirection:n.scrollDragDirection,originalSelectionArea:n.props.selectionStrategy.getDraggerSelectionArea(),currentSelectionArea:i,newCol:e.col,newRow:e.row},r={dragDirection:o.scrollDragDirection,selectionArea:bt({},o.currentSelectionArea)},o.originalSelectionArea?(r.dragDirection===u.unset&&(r.dragDirection=function(e){return kt(e,u.horizontal)?u.vertical:u.horizontal}(o),r.selectionArea=bt({},o.originalSelectionArea)),r.dragDirection===u.horizontal?kt(o,u.horizontal)?r.dragDirection=u.unset:r=Lt(r,o,u.horizontal):r.dragDirection===u.vertical&&(kt(o,u.vertical)?r.dragDirection=u.unset:r=Lt(r,o,u.vertical)),r):r);n.scrollDragDirection=l.dragDirection,i=l.selectionArea}else i.endRow=e.row>=0?e.row:i.endRow,i.endCol=e.col>=0?e.col:i.endCol;(i=lt(i,n.props.data.rows)).isCellChartSelection=!1;var a=(0,L.Z)(t.selection.selectedRegions);a[t.selection.selectedRegions.length-1]=i;var s=t.selection.selectionContextType;return s===c.Column||s===c.Row||i.startRow===i.endRow&&i.startCol===i.endCol||(s=c.MultiCell),zr(zr({},t),{},{selection:zr(zr({},t.selection),{},{selectedRegions:a,selectionContextType:s})})}))}this.props.handler.onCellMouseOver&&this.props.handler.onCellMouseOver(e)}}},{key:"handleContextMenu",value:function(e){this.props.handler.onContextMenu&&this.props.handler.onContextMenu({row:e.row,col:e.col,event:e.event,targetDescription:e.targetDescription,currentSelectionAreas:this.state.selection.selectedRegions,isTitle:e.isTitle})}},{key:"handleCopyDraggerClick",value:function(e){this.props.selectionStrategy.setSelectionInProcess(!0),this.props.selectionStrategy.setCopying(!0),this.props.selectionStrategy.setDraggerSelectionArea(zr({},Wt(this.state.selection))),this.setState(zr(zr({},this.state),{},{copyInProcess:!0})),e.stopPropagation()}},{key:"handleClick",value:function(e){this.props.handler.getDataEntryInProgress&&this.props.handler.getDataEntryInProgress()||this.props.data.devicePreview||this.props.preventDefaultSelection||this.props.selectionStrategy.handleClick(e,this.props.data,this.isActive.bind(this),this.setActive.bind(this),this.setSelectionArea.bind(this))}},{key:"updateResizer",value:function(e,t){var n,o,r,i;this.resizingInfo=function(e,t,n,o,r,i,l){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);if(t>=0&&!o.rows[t]||e>=0&&!o.columnSettings[e])return a;var s=!(t>=0)||o.rows[t].fixed,c=!(e>=0)||o.columnSettings[e].fixed,d=o.rows[t]?o.rows[t].height+r.borderSize:oe.COORDINATE_CELL_SIZE,h=o.columnSettings[e]?o.columnSettings[e].width:oe.COORDINATE_CELL_SIZE;return a.top=r.coordinateOffset+o.rows.slice(0,t).reduce((function(e,t){return t?e+t.height+r.borderSize:e}),0),a.left=r.coordinateOffset+o.columnSettings.slice(0,e).reduce((function(e,t){return e+t.width}),0),a.height=d,a.width=h,a.row=t,a.col=e,a.newWidth=h,a.newHeight=d,a.offsetLeft=l,a.offsetTop=i,a.scrollOffsetLeft=c?0:l,a.scrollOffsetTop=s?0:i,a}(e,t,this.resizingInfo,this.props.data,this.props.tableSizes,this.getScrollTop(),this.getScrollLeft()),this.refRowResizer.current&&(n=this.refRowResizer.current,o=this.resizingInfo,r=t===this.props.data.rows.length-1?5:3,i=this.props.tableSizes.notRenderedHeightTop,n.style.top="".concat(o.top+o.height+i-r-o.scrollOffsetTop,"px")),this.refColumnResizer.current&&function(e,t,n){e.style.left="".concat(t.left+t.width-n-t.scrollOffsetLeft,"px")}(this.refColumnResizer.current,this.resizingInfo,e===this.props.data.columnSettings.length-1?5:3)}},{key:"handleResizeStart",value:function(){var e,t,n;null===(e=this.refTitleResizer.current)||void 0===e||e.classList.add("resizing"),null===(t=this.refRowResizer.current)||void 0===t||t.classList.add("resizing"),null===(n=this.refColumnResizer.current)||void 0===n||n.classList.add("resizing")}},{key:"handleResizeEnd",value:function(){var e,t,n;null===(e=this.refTitleResizer.current)||void 0===e||e.classList.remove("resizing"),null===(t=this.refRowResizer.current)||void 0===t||t.classList.remove("resizing"),null===(n=this.refColumnResizer.current)||void 0===n||n.classList.remove("resizing")}},{key:"handleRowResizeStart",value:function(){this.resizing=h.Row,this.handleResizeStart()}},{key:"handleTitleResizeStart",value:function(){this.resizing=h.Title,this.handleResizeStart()}},{key:"handleTitleResizeEnd",value:function(){this.resizing=h.None,this.handleResizeEnd()}},{key:"handleRowResizeEnd",value:function(){this.resizing=h.None,this.handleResizeEnd()}},{key:"handleNewRowHeight",value:function(e){this.setNewRowHeight(e)}},{key:"handleColumnResizeStart",value:function(){this.resizing=h.Column,this.handleResizeStart()}},{key:"handleColumnResizeEnd",value:function(){this.resizing=h.None,this.handleResizeEnd()}},{key:"handleNewColumnWidth",value:function(e){this.setNewColumnWidth(e)}},{key:"handleNewTitleHeight",value:function(e){this.setNewTitleHeight(e)}},{key:"handleCellMouseEnter",value:function(e){if(!this.props.data.mobile&&!this.props.data.devicePreview){if(this.resizing===h.None){var t=Te(e,this.props.data,this.props.tableSizes.borderSize);this.updateResizer(t.col,t.row)}var n=ut(e.event);if((!n||!yt(this.state.selection.selectionContextType))&&!this.props.selectionStrategy.getSelectionInProcess()&&this.resizing===h.None&&this.props.data.designMode){if(W(e.cellType)){var o,r=mt(this.state.selection.selectionContextType)||this.state.selection.selectionContextType===c.MultiRegion,i=e.context.originalDimension;o=r||n?this.props.selectionStrategy.getSelectedDimensions().includes(i)||"DummyDimension"===e.context.dimensions[0].id||(this.state.selection.selectionContextType===c.DataCell||this.state.selection.selectionContextType===c.DimensionMember)&&n||this.state.selection.selectionContextType===c.MultiCell?{hoverContextType:c.DimensionMember,doubleOverlay:!0,row:e.row,column:e.col}:{hoverContextType:c.Dimension,doubleOverlay:!0,dimensionId:i}:{hoverContextType:c.HeaderRegion,doubleOverlay:!1},this.setState((function(e){return zr(zr({},e),{},{hover:o})}))}V(e.cellType)&&this.setState((function(t){return Kt(e,t)})),K(e.cellType)&&this.setState((function(t){return Kt(e,t)})),F(e.cellType)&&this.handleCellMouseEnterDataCell(e,n),e.cellType!==v.Custom&&e.cellType!==v.Empty||this.setState((function(t){return zr(zr({},t),{},{hover:{hoverContextType:c.DataCell,doubleOverlay:!1,row:e.row,column:e.col}})}))}}}},{key:"handleCellMouseEnterDataCell",value:function(e,t){var n,o=this.state.selection.selectionContextType,r=!1,i=ft(this.state.selection.selectedRegions);if(i&&e.cellType===v.Chart&&this.props.data.cellChartData&&(o===c.DataCell||o===c.CellChart)&&e.chartDimension){var l=this.props.data.cellChartData[e.chartDimension];r=l.startCol<=i.startCol&&l.endCol>=i.startCol&&l.startRow<=i.startRow&&l.endRow>=i.startRow}n=e.cellType===v.Chart&&Rt(o)&&o!==c.MultiCell&&!r?{hoverContextType:c.CellChart,doubleOverlay:this.state.hover.hoverContextType===c.DatacellRegion,dimensionId:e.chartDimension}:Rt(o)||t?{hoverContextType:c.DataCell,doubleOverlay:!0,row:e.row,column:e.col}:{hoverContextType:c.DatacellRegion,doubleOverlay:!1},this.setState((function(e){return zr(zr({},e),{},{hover:n})}))}},{key:"handleShowOverlay",value:function(e){this.props.selectionStrategy.getSelectionInProcess()||this.resizing!==h.None||this.props.data.devicePreview||ut(e.event)&&(yt(this.state.selection.selectionContextType)||wt(this.state.selection.selectionContextType))||this.setState((function(t){return Kt(e,t)}))}},{key:"handleHideOverlay",value:function(){this.resizing===h.None&&this.setState((function(e){return zr(zr({},e),{},{hover:{hoverContextType:c.DataCell,doubleOverlay:!1}})}))}},{key:"handleTitleClick",value:function(e){var t,n=this;if(e.preventDefault(),!this.props.data.devicePreview&&(this.setActive(!0),this.setState((function(e){var t={selectedRegions:[],selectionContextType:c.TitleRegion};return zt(t,n.props.handler),zr(zr({},e),{},{selection:t})})),null!==(t=this.props.data.featureToggles)&&void 0!==t&&t.accessibilityKeyboardSupport)){var o=e.currentTarget.closest(".".concat(Q));o&&o.focus({preventScroll:!0})}}},{key:"handleOverlayClick",value:function(e){this.resizing===h.None&&(this.setActive(!0),this.props.selectionStrategy.handleOverlayClick(this.state.selection,e,this.props.data,this.setSelectionArea.bind(this),this.setState.bind(this),this.props.handler))}},{key:"handleScroll",value:function(e){var t=e.currentTarget.scrollTop||this.getScrollTop(),n=e.currentTarget.scrollLeft||this.getScrollLeft();this.scrollReloadDispatcher.dispatchInternalReloadLimitReached({scrollTop:t,scrollLeft:n,scrollLimitVertical:this.props.data.scrollLimitVertical,scrollLimitHorizontal:this.props.data.scrollLimitHorizontal,tableSizes:this.props.tableSizes})}},{key:"handleCellDoubleClick",value:function(e,t){this.props.handler.getDataEntryInProgress&&this.props.handler.getDataEntryInProgress()||this.props.data.devicePreview||(t?this.refTitleValue.current&&this.props.handler.onCellEdit&&this.props.handler.onCellEdit({keyEvent:e.keyEvent,target:this.refTitleValue.current,isReworkTitle:t}):this.props.handler.onCellEdit&&this.props.handler.onCellEdit({target:e.target,row:e.row,col:e.col,keyEvent:e.keyEvent}))}},{key:"handleResizerDoubleClick",value:function(){this.props.handler.onResizerDoubleClick(this.resizingInfo.col)}},{key:"handleDrillIconClicked",value:function(e){if((this.props.handler.getDataEntryInProgress&&this.props.handler.getDataEntryInProgress()||this.props.preventDefaultSelection)&&function(e){return void 0!==e.event}(e))return this.props.handler.onCellMouseDown&&this.props.handler.onCellMouseDown(e),void(this.props.handler.onTableMouseUp&&this.props.handler.onTableMouseUp(e.event));this.props.handler.onDrillIconClicked&&this.props.handler.onDrillIconClicked(e)}},{key:"handleCellIconClicked",value:function(e){this.props.handler.onCellIconClicked&&this.props.handler.onCellIconClicked(e)}},{key:"handleCellDropped",value:function(e){this.props.handler.onCellDropped&&this.props.handler.onCellDropped(e)}},{key:"handleTableRootContextMenuEvent",value:function(e){this.props.handler.onContextMenu&&e.nativeEvent.preventDefault()}},{key:"renderLoadingArea",value:function(){return _.createElement(_.Fragment,null,_.createElement(fe,{pathToLoadingGif:this.props.data.pathToLoadingGif||"",preContent:!0,coordinateOffset:this.props.tableSizes.coordinateOffset,innerRef:this.props.loadingIndicatorRefs.loadingAreaTop,name:"top"}),_.createElement(ve,{pathToLoadingGif:this.props.data.pathToLoadingGif||"",preContent:!0,coordinateOffset:this.props.tableSizes.coordinateOffset,innerRef:this.props.loadingIndicatorRefs.loadingAreaLeft,name:"left"}),_.createElement(fe,{pathToLoadingGif:this.props.data.pathToLoadingGif||"",preContent:!1,coordinateOffset:this.props.tableSizes.coordinateOffset,innerRef:this.props.loadingIndicatorRefs.loadingAreaBottom,name:"bottom"}),_.createElement(ve,{pathToLoadingGif:this.props.data.pathToLoadingGif||"",preContent:!1,coordinateOffset:this.props.tableSizes.coordinateOffset,innerRef:this.props.loadingIndicatorRefs.loadingAreaRight,name:"right"}))}},{key:"renderFreezeLines",value:function(){if(!this.props.generalSettings.showFreezeLines)return null;var e=this.props.data.rows.length-1,t=(void 0===this.props.data.freezeEndRow||this.props.data.freezeEndRow<=e)&&this.props.tableSizes.freezeHeight-this.props.tableSizes.coordinateOffset>0,n=this.props.data.columnSettings.length-1,o=(void 0===this.props.data.freezeEndCol||this.props.data.freezeEndCol<=n)&&this.props.tableSizes.freezeWidth-this.props.tableSizes.coordinateOffset>0;return _.createElement(he,{vertical:o,horizontal:t,left:this.props.tableSizes.freezeWidth,top:this.props.tableSizes.freezeHeight,containerWidth:this.props.tableSizes.tableContainerWidth,containerHeight:Math.min(this.props.tableSizes.tableContentHeight,this.props.tableSizes.tableContainerHeight)})}},{key:"isBottomSectionNeeded",value:function(e,t){return e<t.length-1}},{key:"isRightSectionNeeded",value:function(e,t){return e<t.length-1}},{key:"render",value:function(){var e,t,n,o,r,i=null!==(e=this.props.data.featureToggles)&&void 0!==e&&e.accessibilityKeyboardSupport?0:-1,l=this.props.data.showGrid?oe.SHOW_GRID_CLASS:"",a=this.props.generalSettings.showCoordinateHeader?this.state.selection.selectedRegions:void 0,s=this.props.data.freezeEndCol,c=this.props.data.freezeEndRow,d=this.getLastScrollUpdateHorizontal(),h=this.getLastScrollUpdateVertical(),p={registerImageLoading:this.props.handler.registerImageLoading,onDrillIconClicked:this.boundHandleDrillIconClicked,onCellIconClicked:this.boundHandleCellIconClicked,onCellDropped:this.boundHandleCellDropped,onCellEdit:this.boundHandleCellDoubleClick,onCellMouseLeave:this.props.handler.onCellMouseLeave,onCellMouseDown:this.boundHandleCellMouseDown,onCellMouseEnter:this.boundHandleCellMouseEnter,onCellMouseUp:this.boundHandleCellMouseUp,onCellMouseOver:this.boundHandleCellMouseOver,onContextMenu:this.boundHandleContextMenu,onOverlayClick:this.boundHandleOverlayClick,onShowRowColOverlay:this.boundHandleShowOverlay,onHideOverlay:this.boundHandleHideOverlay,getTranslatedText:this.props.handler.getTranslatedText},u={onCellMouseDown:this.props.handler.onCellMouseDown,onCellMouseOver:this.props.handler.onCellMouseOver,onCellMouseLeave:this.props.handler.onCellMouseLeave,onCellEdit:this.props.handler.onCellEdit,onTitleSelected:this.boundHandleTitleClick,onContextMenu:this.boundHandleContextMenu},f={tableId:this.props.data.id,offsetOverlayTop:0,offsetOverlayLeft:this.props.tableSizes.coordinateOffset,notRenderedHeightTop:this.props.tableSizes.notRenderedHeightTop,fixedTableWidth:this.props.tableSizes.freezeWidth-this.props.tableSizes.coordinateOffset,fixedTableHeight:this.props.tableSizes.freezeHeight-this.props.tableSizes.coordinateOffset,selection:this.state.selection,copyInProcess:this.state.copyInProcess,data:this.props.data,hover:this.state.hover,highlightedCells:this.props.data.highlightedCells,designMode:this.props.data.designMode,freezeLines:this.props.generalSettings.showFreezeLines,onCopyDraggerClick:this.boundHandleCopyDraggerClick,hasLADatapointSelection:this.props.data.hasLADatapointSelection,showCopyDragger:this.props.generalSettings.showCopyDragger},g={data:zr(zr({},this.props.data),{},{highlightedCells:void 0}),rowHandler:p,copyInProcess:this.state.copyInProcess,tableWidth:this.props.tableSizes.tableContentWidth,notRenderedHeightTop:this.props.tableSizes.notRenderedHeightTop,notRenderedWidthOnTheLeft:this.props.tableSizes.notRenderedWidthOnTheLeft,notRenderedHeightBottom:this.props.tableSizes.notRenderedHeightBelow,titleVisible:this.props.tableSizes.titleHeight>0,selection:a,scrollLeft:this.getScrollLeft()||(d<this.props.tableSizes.tableContentWidth?d:0),scrollTop:this.getScrollTop()||(h<this.props.tableSizes.tableContentHeight?h:0),showCoordinateHeaderColumn:!1,showCoordinateHeaderRow:!1,showCoordinateHeaderCorner:!1,showRowColumnHover:this.props.generalSettings.showRowColumnHover},C=void 0!==this.props.data.freezeEndRow?0:g.notRenderedHeightTop,v=void 0!==this.props.data.freezeEndRow?0:g.notRenderedHeightBottom,b=void 0!==this.props.data.freezeEndCol?0:g.notRenderedWidthOnTheLeft,y=void 0!==s?0:this.props.tableSizes.columnIndices.startColumnIndex,m=this.props.tableSizes.columnIndices.endColumnIndex,R=this.props.tableSizes.columnIndices.endColumnIndex;return void 0!==s&&s<=this.props.data.columnSettings.length-1&&(m=s,R=s),_.createElement("div",{id:oe.TABLE_ROOT_ID_PREFIX+this.props.data.id,ref:this.refTableRoot,tabIndex:i,style:{width:"100%",height:"100%",position:"absolute",top:0,left:0},onMouseUp:this.boundHandleTableMouseUp,role:null!==(t=this.props.data.featureToggles)&&void 0!==t&&t.accessibilityScreenReaderSupport?"treegrid":void 0,onContextMenu:this.boundHandleTableRootContextMenuEvent,onFocus:this.boundHandleTableOnFocus},this.props.data.title&&this.props.tableSizes.titleHeight>0&&_.createElement(Pr,{refTitleValue:this.refTitleValue,refTitleResizer:this.refTitleResizer,title:this.props.data.title,selected:St(this.state.selection.selectionContextType),handler:u,designMode:this.props.data.designMode,devicePreview:this.props.data.devicePreview,fontOverride:this.props.data.fontOverride,resizeableTitle:(null===(n=this.props.data.featureToggles)||void 0===n?void 0:n.resizeableTitle)&&!this.props.data.mobile,setNewTitleHeight:this.boundHandleNewTitleHeight,resizingTitleStart:this.boundHandleResizingTitleStart,resizingTitleEnd:this.boundHandleResizingTitleEnd,tableContainerHeight:this.props.tableSizes.tableContainerHeight,titleHeight:this.props.tableSizes.titleHeight,accessibilityKeyboardSupport:null===(o=this.props.data.featureToggles)||void 0===o?void 0:o.accessibilityKeyboardSupport}),_.createElement("div",{className:"tableContainer table".concat(this.props.data.id," "),ref:this.refTableContainer,onClick:this.boundHandleClick,onScroll:this.boundHandleScroll,style:(r=this.props.data,{height:ae(Ae(r)),width:ae(r.widgetWidth),overflow:"hidden"}),onWheel:this.scrollSynchronizer.boundContainerWheel},_.createElement("div",{style:{width:"".concat(this.props.tableSizes.htmlTableWrapperWidth,"px"),height:"".concat(this.props.tableSizes.htmlTableWrapperHeight,"px"),boxSizing:"border-box"}},!this.props.data.responsive&&!this.props.data.mobile&&_.createElement(me,{refColumnResizer:this.refColumnResizer,onColumnResizerDoubeClick:this.boundHandleResizerDoubleClick,onNewColumnWidth:this.boundHandleNewColumnWidth,onColumnResizeStart:this.boundHandleColumnResizeStart,onColumnResizeEnd:this.boundHandleColumnResizeEnd,columnSettings:this.props.data.columnSettings,resizingInfo:this.resizingInfo}),!this.props.data.mobile&&_.createElement(Oe,{refRowResizer:this.refRowResizer,onNewRowHeight:this.boundHandleNewRowHeight,onRowResizeStart:this.boundHandleRowResizeStart,onRowResizeEnd:this.boundHandleRowResizeEnd,borderSize:this.props.tableSizes.borderSize,notRenderedHeightTop:this.props.tableSizes.notRenderedHeightTop,rows:this.props.data.rows,resizingInfo:this.resizingInfo,tableContainerHeight:this.props.tableSizes.tableContainerHeight}),this.renderFreezeLines(),_.createElement("div",{ref:this.refHtmlTableWrapper,className:"htmlTableWrapper ".concat(l),style:{width:"".concat(this.props.tableSizes.htmlTableWrapperWidth,"px"),height:"".concat(this.props.tableSizes.htmlTableWrapperHeight,"px"),boxSizing:"border-box"}},_.createElement(Or,{innerRef:this.scrollSynchronizer.freezeSectionTopLeftRef,maxHeight:void 0!==c?0:this.props.tableSizes.htmlTableWrapperHeight,overlay:zr(zr({},f),{},{offsetOverlayTop:this.props.tableSizes.coordinateOffset,freezeSectionStartRow:0,freezeSectionStartCol:0,freezeSectionEndCol:s,freezeSectionEndRow:c,notRenderedHeightTop:C}),htmlTable:zr(zr({},g),{},{startRow:0,startCol:y,endCol:m,endRow:c,tableWidth:this.props.tableSizes.topLeftSection.htmlTableWidth,notRenderedHeightTop:C,notRenderedWidthOnTheLeft:b,notRenderedHeightBottom:v,showCoordinateHeaderColumn:this.props.generalSettings.showCoordinateHeader,showCoordinateHeaderRow:this.props.generalSettings.showCoordinateHeader,showCoordinateHeaderCorner:this.props.generalSettings.showCoordinateHeader}),sectionId:"topLeft",top:0,left:0,width:this.props.tableSizes.topLeftSection.width,height:this.props.tableSizes.topLeftSection.height}),void 0!==c&&this.isBottomSectionNeeded(c,this.props.data.rows)&&_.createElement(Or,{innerRef:this.scrollSynchronizer.freezeSectionBotLeftRef,maxHeight:this.props.tableSizes.htmlTableWrapperHeight-parseInt(this.props.tableSizes.topLeftSection.height,10),overlay:zr(zr({},f),{},{freezeSectionStartCol:0,freezeSectionStartRow:c+1,freezeSectionEndCol:s}),htmlTable:zr(zr({},g),{},{startCol:y,startRow:c+1,endCol:R,tableWidth:this.props.tableSizes.bottomLeftSection.htmlTableWidth,showCoordinateHeaderColumn:this.props.generalSettings.showCoordinateHeader,notRenderedWidthOnTheLeft:b}),sectionId:"bottomLeft",top:this.props.tableSizes.freezeHeight,left:0,width:this.props.tableSizes.bottomLeftSection.width,height:this.props.tableSizes.bottomLeftSection.height}),void 0!==s&&this.isRightSectionNeeded(s,this.props.data.columnSettings)&&_.createElement(Or,{innerRef:this.scrollSynchronizer.freezeSectionTopRightRef,maxHeight:void 0!==c?0:this.props.tableSizes.htmlTableWrapperHeight,overlay:zr(zr({},f),{},{offsetOverlayTop:this.props.tableSizes.coordinateOffset,offsetOverlayLeft:0,freezeSectionStartRow:0,freezeSectionStartCol:s+1,freezeSectionEndRow:c,notRenderedHeightTop:C}),htmlTable:zr(zr({},g),{},{startRow:0,startCol:Math.max(s+1,this.props.tableSizes.columnIndices.startColumnIndex),endRow:c,endCol:this.props.tableSizes.columnIndices.endColumnIndex,tableWidth:this.props.tableSizes.topRightSection.htmlTableWidth,notRenderedHeightTop:C,notRenderedHeightBottom:v,showCoordinateHeaderRow:this.props.generalSettings.showCoordinateHeader}),sectionId:"topRight",top:0,left:this.props.tableSizes.freezeWidth,width:this.props.tableSizes.topRightSection.width,height:this.props.tableSizes.topRightSection.height}),void 0!==c&&this.isBottomSectionNeeded(c,this.props.data.rows)&&void 0!==s&&this.isRightSectionNeeded(s,this.props.data.columnSettings)&&_.createElement(Or,{innerRef:this.scrollSynchronizer.freezeSectionBotRightRef,maxHeight:this.props.tableSizes.htmlTableWrapperHeight-parseInt(this.props.tableSizes.topRightSection.height,10),overlay:zr(zr({},f),{},{offsetOverlayLeft:0,freezeSectionStartRow:c+1,freezeSectionStartCol:s+1}),htmlTable:zr(zr({},g),{},{startCol:Math.max(s+1,this.props.tableSizes.columnIndices.startColumnIndex),startRow:c+1,endCol:this.props.tableSizes.columnIndices.endColumnIndex,tableWidth:this.props.tableSizes.bottomRightSection.htmlTableWidth}),sectionId:"bottomRight",top:this.props.tableSizes.freezeHeight,left:this.props.tableSizes.freezeWidth,width:this.props.tableSizes.bottomRightSection.width,height:this.props.tableSizes.bottomRightSection.height}))),!this.props.data.mobile&&_.createElement(_.Fragment,null,_.createElement(Ue,{containerWidth:this.props.tableSizes.tableContainerWidth,totalScrollableColumnWidth:this.props.tableSizes.htmlTableWrapperWidth,scrollContainerRef:this.scrollSynchronizer.horizontalScrollbarContainerRef,onScrollLeftChanged:this.scrollSynchronizer.boundSyncHorizontalScrollPosition}),_.createElement(tt,{containerHeight:this.props.tableSizes.tableContainerHeight,totalScrollableRowHeight:this.props.tableSizes.htmlTableWrapperHeight,scrollContainerRef:this.scrollSynchronizer.verticalScrollbarContainerRef,onScrollTopChanged:this.scrollSynchronizer.boundSyncVerticalScrollPosition})),this.renderLoadingArea()))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n,o=!1,i=e.data.rows.length,l=e.data.columnSettings.length,a=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return kr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(a)throw i}}}}(t.selection.selectedRegions);try{for(a.s();!(n=a.n()).done;){var s=n.value;if(i<=s.startRow||i<=s.endRow||l<=s.startCol||l<=s.endCol){o=!0;break}}}catch(e){a.e(e)}finally{a.f()}if(o){var d={selectedRegions:[],selectionContextType:c.Widget};return zt(d,e.handler),zr(zr({},t),{},{selection:d})}if(!e.data.designMode){var h=ft(t.selection.selectedRegions);if(h&&h.selectionType===C.Region){var p=t,u={startRow:h.startRow,startCol:h.startCol,endRow:h.startRow,endCol:h.startCol,selectionType:C.Box},f=r.getSelectionAreaContext([u],e.data.rows);return t.selection.selectionContextType===c.CellChart&&(u.endRow=h.endRow,u.endCol=h.endCol,u.inCellChartContext=h.inCellChartContext,u.isCellChartSelection=!0,f=c.CellChart),p.selection={selectedRegions:[u],selectionContextType:f},e.handler.onSelectedCellChanged&&e.handler.onSelectedCellChanged(h.startRow,h.startCol),e.handler.onSelectedRegionChanged&&e.handler.onSelectedRegionChanged([u],f),p}}if(e.data.focusedCell&&(!t.focusedCellFromOutside||t.focusedCellFromOutside.x!==e.data.focusedCell.x&&t.focusedCellFromOutside.y!==e.data.focusedCell.y)){var g={startRow:e.data.focusedCell.y,startCol:e.data.focusedCell.x,endRow:e.data.focusedCell.y,endCol:e.data.focusedCell.x,selectionType:C.Box},v=e.data.rows[e.data.focusedCell.y]&&e.data.rows[e.data.focusedCell.y].cells[e.data.focusedCell.x],b={selectedRegions:[g],selectionContextType:v&&v.cellType?Ht(v.cellType):c.DataCell};return zr(zr({},t),{},{selection:b,focusedCellFromOutside:e.data.focusedCell})}return e.data.focusedCell?null:zr(zr({},t),{},{focusedCellFromOutside:void 0})}},{key:"getSelectionAreaContext",value:function(e,t){var n=ft(e);if(n&&n.startRow===n.endRow&&n.startCol===n.endCol){var o=t[n.startRow];if(!o)return c.DataCell;var r=o.cells[n.startCol];return Zt({cellType:r?r.cellType:void 0,selectedRegions:e.length})}return c.MultiCell}}]),r}(_.Component),Nr=function(){function e(){(0,P.Z)(this,e),(0,x.Z)(this,"loadingAreaState",{top:!1,left:!1,bottom:!1,right:!1})}return(0,k.Z)(e,[{key:"createRefs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_.createRef(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_.createRef(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_.createRef(),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:_.createRef();return this.loadingAreaLeft=e,this.loadingAreaTop=t,this.loadingAreaRight=n,this.loadingAreaBottom=o,this}},{key:"getLoadingAreaRefs",value:function(){return{loadingAreaLeft:this.loadingAreaLeft,loadingAreaTop:this.loadingAreaTop,loadingAreaRight:this.loadingAreaRight,loadingAreaBottom:this.loadingAreaBottom}}},{key:"getLoadingAreaState",value:function(){return this.loadingAreaState}},{key:"isCurrentlyLoading",value:function(){return this.loadingAreaState.right||this.loadingAreaState.bottom||this.loadingAreaState.left||this.loadingAreaState.top}},{key:"hideLoadingAreas",value:function(){this.isCurrentlyLoading()&&(this.toggleLoadingAreaOnTheRight(!1),this.toggleLoadingAreaOnTheLeft(!1),this.toggleLoadingAreaOnTheBottom(!1),this.toggleLoadingAreaOnTheTop(!1))}},{key:"showHorizontalLoading",value:function(e){e?this.toggleLoadingAreaOnTheRight(!0):this.toggleLoadingAreaOnTheLeft(!0)}},{key:"showVerticalLoading",value:function(e){e?this.toggleLoadingAreaOnTheBottom(!0):this.toggleLoadingAreaOnTheTop(!0)}},{key:"toggleLoadingAreaOnTheRight",value:function(e){this.loadingAreaState.right!==e&&(this.loadingAreaState.right=e,this.toggleLoadingArea(this.loadingAreaRight,e))}},{key:"toggleLoadingAreaOnTheLeft",value:function(e){this.loadingAreaState.left!==e&&(this.loadingAreaState.left=e,this.toggleLoadingArea(this.loadingAreaLeft,e))}},{key:"toggleLoadingAreaOnTheTop",value:function(e){this.loadingAreaState.top!==e&&(this.loadingAreaState.top=e,this.toggleLoadingArea(this.loadingAreaTop,e))}},{key:"toggleLoadingAreaOnTheBottom",value:function(e){this.loadingAreaState.bottom!==e&&(this.loadingAreaState.bottom=e,this.toggleLoadingArea(this.loadingAreaBottom,e))}},{key:"toggleLoadingArea",value:function(e,t){e.current&&(e.current.style.opacity=t?"1":"0")}}]),e}();function Zr(e,t,n,o){for(var r=0,i=e.length-1,l=-1,a=0,s=t,c=0,d=0;d<e.length;d++){var h=e[d],p=jr(h,o);if(h&&h.fixed){if(l=Wr(h),a>=n){i=d-1;break}a+=p}else if(s<=0){if(a>=n){i=d-1;break}a+=p}else h&&!h.fixed&&(r=Wr(h),(s-=p)>=0&&(c+=p,r+=1))}var u=Math.max(c,0);return{startIndex:r=Math.max(r,l+1),endIndex:i,freezeIndex:l,notRenderedSpace:u}}function Br(e){return void 0!==e.row}function jr(e,t){if(!e)return 0;var n=t?oe.GRID_BORDER_SIZE:0;return Br(e)?e.height+n:e.width}function Wr(e){return e?Br(e)?e.row:e.column:-1}function Fr(e){return e.map((function(e){return e.width})).reduce((function(e,t){return e+t}),0)}function Ur(e,t,n,o,r){var i=n?oe.COORDINATE_CELL_SIZE:0,l=Math.ceil(e*o),a=Math.ceil(e*r)-i,s=t-l,c=Math.min(s,0);return{skippedSize:Math.max(s,0),contentSizeLimit:Math.min(a,a+c)}}var Gr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe.BUFFER_LIMIT_HORIZONTAL,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oe.CONTENT_LIMIT_HORIZONTAL;(0,P.Z)(this,e),(0,x.Z)(this,"notRenderedWidthOnTheLeft",0),(0,x.Z)(this,"startIndexColumns",0),this.bufferLimit=t,this.contentLimit=n}return(0,k.Z)(e,[{key:"getStartIndexColumns",value:function(){return this.startIndexColumns}},{key:"getEndIndexColumns",value:function(){return this.endIndexColumns}},{key:"getFreezeEndColumn",value:function(){return this.freezeEndColumn}},{key:"getNotRenderedWidthOnTheLeft",value:function(){return this.notRenderedWidthOnTheLeft}},{key:"updateColumnIndicesForWindowing",value:function(e,t,n){var o=this.getUpdatedColumnIndices(e,t,n),r=o.startIndex,i=o.endIndex,l=o.notRenderedSpace,a=o.freezeIndex;this.startIndexColumns=r,this.endIndexColumns=i,this.freezeEndColumn=a,this.notRenderedWidthOnTheLeft=l}},{key:"getUpdatedColumnIndices",value:function(e,t,n){var o=e.columnSettings,r=Ur(e.widgetWidth,t,n.showCoordinateHeader,this.bufferLimit,this.contentLimit),i=r.contentSizeLimit;return Zr(o,r.skippedSize,i,!1)}}]),e}(),Vr=function(){function e(){(0,P.Z)(this,e),(0,x.Z)(this,"startIndexRows",0),(0,x.Z)(this,"lastFrozenRowIndex",-1),(0,x.Z)(this,"notRenderedHeightTop",0)}return(0,k.Z)(e,[{key:"getNotRenderedHeightTop",value:function(){return this.notRenderedHeightTop}},{key:"getStartIndexRows",value:function(){return this.startIndexRows}},{key:"getEndIndexRows",value:function(){return this.endIndexRows}},{key:"getLastFrozenRowIndex",value:function(){return this.lastFrozenRowIndex}},{key:"updateRowIndicesForWindowing",value:function(e,t,n){var o=e.widgetHeight,r=e.rows,i=e.showGrid,l=Ur(o,t,n.showCoordinateHeader,oe.BUFFER_LIMIT_VERTICAL,n.rowContentLimitFactor),a=l.contentSizeLimit,s=l.skippedSize,c=this.getUpdatedColumnIndices(r,i,a,s),d=c.startIndex,h=c.endIndex,p=c.notRenderedSpace,u=c.freezeIndex;this.startIndexRows=d,this.endIndexRows=h,this.lastFrozenRowIndex=u,this.notRenderedHeightTop=p}},{key:"getUpdatedColumnIndices",value:function(e,t,n,o){return Zr(e,o,n,t)}}]),e}(),Kr=function(){function e(t,n){(0,P.Z)(this,e),(0,x.Z)(this,"frozenRows",[]),(0,x.Z)(this,"preFillArray",[]),(0,x.Z)(this,"contentRows",[]),(0,x.Z)(this,"afterFillArray",[]),this.rowsWindowing=t||new Vr,this.columnsWindowing=n||new Gr}return(0,k.Z)(e,[{key:"getFrozenRows",value:function(){return this.frozenRows}},{key:"getPreFillArray",value:function(){return this.preFillArray}},{key:"getContentRows",value:function(){return this.contentRows}},{key:"getAfterFillArray",value:function(){return this.afterFillArray}},{key:"getNotRenderedHeightTop",value:function(){return this.rowsWindowing.getNotRenderedHeightTop()}},{key:"getNotRenderedWidthToTheLeft",value:function(){return this.columnsWindowing.getNotRenderedWidthOnTheLeft()}},{key:"updateIndicesForWindowing",value:function(e,t,n,o){this.rowsWindowing.updateRowIndicesForWindowing(e,t,o),this.columnsWindowing.updateColumnIndicesForWindowing(e,n,o)}},{key:"getRowIndices",value:function(){return{startRowIndex:this.rowsWindowing.getStartIndexRows(),endRowIndex:this.rowsWindowing.getEndIndexRows()}}},{key:"getColumnIndices",value:function(){return{startColumnIndex:this.columnsWindowing.getStartIndexColumns(),endColumnIndex:this.columnsWindowing.getEndIndexColumns()}}},{key:"doWindowing",value:function(e){return this.doRowWindowing(e)}},{key:"doRowWindowing",value:function(e){var t=(0,L.Z)(e.rows),n=this.rowsWindowing.getLastFrozenRowIndex(),o=this.rowsWindowing.getStartIndexRows(),r=this.rowsWindowing.getEndIndexRows(),i=void 0===r?t.length:r+1;return this.frozenRows=e.hasFixedRowsCols?t.slice(0,n+1):[],this.preFillArray=new Array(Math.max(0,o-this.frozenRows.length)),this.afterFillArray=new Array(Math.max(0,t.length-i)),this.contentRows=t.slice(o,i),e.rows=[].concat((0,L.Z)(this.frozenRows),(0,L.Z)(this.preFillArray),(0,L.Z)(this.contentRows),(0,L.Z)(this.afterFillArray)),e}}]),e}();var Xr=n(973);function Yr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Jr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yr(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qr(e,t,n,o,r){var i={startRow:999999,startCol:999999,endRow:0,endCol:0,selectionType:C.Region},l=c.Widget;return t===c.AllCells&&(l=c.AllCells,i=$r(e,i)),t===c.DatacellRegion&&(l=c.DatacellRegion,i=function(e){return{startCol:e.dataRegionCornerCol+1,endCol:e.dataRegionEndCol,startRow:e.dataRegionCornerRow+1,endRow:e.dataRegionEndRow,selectionType:C.Region}}(e)),t===c.HeaderRegion&&(l=c.HeaderRegion,i=function(e){return{startCol:e.dataRegionStartCol,endCol:e.dataRegionEndCol,cornerCol:e.dataRegionCornerCol,startRow:e.dataRegionStartRow,endRow:e.dataRegionEndRow,cornerRow:e.dataRegionCornerRow,selectionType:C.Region}}(e)),t===c.Dimension&&(l=c.Dimension,i=function(e,t){var n=e.dimensionCellCoordinatesInHeader[t||""];return{startRow:n?n.startRow:0,endRow:n?n.endRow:0,startCol:n?n.startCol:0,endCol:n?n.endCol:0,selectionType:C.Region}}(e,r)),t===c.Row&&(l=c.Row,i=function(e,t){return{selectionType:C.Rows,startCol:0,endCol:e.columnSettings.length-1,startRow:t,endRow:t}}(e,n)),t===c.Column&&(l=c.Column,i=function(e,t){return{selectionType:C.Columns,startCol:t,endCol:t,startRow:0,endRow:e.rows.length-1}}(e,o)),{selectionArea:i,context:l}}function $r(e,t){var n=e.rows.length-1<0?0:e.rows.length-1,o=e.columnSettings.length-1<0?0:e.columnSettings.length-1;return Jr(Jr({},t),{},{startRow:0,startCol:0,endRow:n,endCol:o,selectionType:C.All})}function qr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ei(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qr(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ti(e){var t=e.ctrlOrMetaKeyPressed,n=e.shiftPressed,o=e.currentSelection,r=ei({},o);return t||n||(r.endCol=0,r.startCol=0),n&&(r.endCol=0),t&&(r.endCol=0,r.startCol=n?o.startCol:0,r.endRow=0,r.startRow=n?o.startRow:0),r}function ni(e){var t=e.ctrlOrMetaKeyPressed,n=e.shiftPressed,o=e.currentSelection,r=e.tableData,i=ei({},o);return t||n||(i.endCol=r.columnSettings.length-1,i.startCol=n?o.startCol:r.columnSettings.length-1),n&&(i.endCol=r.columnSettings.length-1),t&&(i.endRow=r.rows.length-1,i.startRow=n?o.startRow:r.rows.length-1,i.endCol=r.columnSettings.length-1,i.startCol=n?o.startCol:r.columnSettings.length-1),i}function oi(e){var t=e.ctrlOrMetaKeyPressed,n=e.shiftPressed,o=e.currentSelection,r=e.tableData,i=ei({},o);return t&&!n?(i.endRow=r.rows.length-1,i.startRow=0,i.selectionType=C.Columns,o.selectionType===C.Rows?$r(r,i):i):n&&!t?(i.endCol=r.columnSettings.length-1,i.startCol=0,i.selectionType=C.Rows,o.selectionType===C.Columns?$r(r,i):i):t&&n?$r(r,i):i}function ri(e,t){(function(e,t){var n=Et(e)||It(e);return!(t&&n)})(e,t)&&(e.selectionType=C.Box,delete e.cornerCol,delete e.cornerRow)}function ii(e){var t=ei({},e.currentSelection);return ri(t,e.shiftPressed),e.ctrlOrMetaKeyPressed||e.shiftPressed?(e.shiftPressed&&(t.endRow=e.mergedCellIndices.endRow+1,t.endCol=e.mergedCellIndices.endCol),e.ctrlOrMetaKeyPressed&&(t.endRow=e.lastRowIndex,t.startRow=e.shiftPressed?t.startRow:e.lastRowIndex)):(t.startRow=e.mergedCellIndices.endRow+1,t.endRow=e.mergedCellIndices.endRow+1,t.endCol=t.startCol),t}function li(e){var t=ei({},e.currentSelection);return ri(t,e.shiftPressed),e.ctrlOrMetaKeyPressed||e.shiftPressed?(e.shiftPressed&&(t.endCol=e.mergedCellIndices.startCol-1,t.endRow=e.mergedCellIndices.endRow),e.ctrlOrMetaKeyPressed&&(t.endCol=0,t.startCol=e.shiftPressed?t.startCol:0)):(t.endRow=t.startRow,t.startCol=e.mergedCellIndices.startCol-1,t.endCol=e.mergedCellIndices.startCol-1),t}function ai(e){var t=ei({},e.currentSelection);return ri(t,e.shiftPressed),e.ctrlOrMetaKeyPressed||e.shiftPressed?(e.shiftPressed&&(t.endCol=e.mergedCellIndices.endCol+1,t.endRow=e.mergedCellIndices.endRow),e.ctrlOrMetaKeyPressed&&(t.endCol=e.lastColIndex,t.startCol=e.shiftPressed?t.startCol:e.lastColIndex)):(t.endRow=t.startRow,t.startCol=e.mergedCellIndices.endCol+1,t.endCol=e.mergedCellIndices.endCol+1),t}function si(e){var t=ei({},e.currentSelection);return ri(t,e.shiftPressed),e.ctrlOrMetaKeyPressed||e.shiftPressed?(e.shiftPressed&&(t.endRow=e.mergedCellIndices.startRow-1,t.endCol=e.mergedCellIndices.endCol),e.ctrlOrMetaKeyPressed&&(t.endRow=e.firstRow,t.startRow=e.shiftPressed?t.startRow:e.firstRow)):(t.startRow=e.mergedCellIndices.startRow-1,t.endRow=e.mergedCellIndices.startRow-1,t.endCol=t.startCol),t}function ci(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function di(e,t){var n=e.ctrlOrMetaKeyPressed,o=e.selectionArea,r=e.shiftPressed;return{selectionArea:t({currentSelection:o,tableData:e.tableData,ctrlOrMetaKeyPressed:n,shiftPressed:r}),singleSelection:!0,isKeyEvent:!0}}function hi(e){var t=gi(e,ii);return t.scrollDirection=e.ctrlOrMetaKeyPressed?Fe.LastRow:Fe.Down,t}function pi(e){var t=gi(e,li);return t.scrollDirection=e.ctrlOrMetaKeyPressed?Fe.FirstCol:Fe.Left,t}function ui(e){var t=gi(e,ai);return t.scrollDirection=e.ctrlOrMetaKeyPressed?Fe.LastCol:Fe.Right,t}function fi(e){var t=gi(e,si);return t.scrollDirection=e.ctrlOrMetaKeyPressed?Fe.FirstRow:Fe.Up,t}function gi(e,t){var n=e.ctrlOrMetaKeyPressed,o=e.selectionArea,r=e.shiftPressed,i=e.tableData;return{selectionArea:t({currentSelection:o,ctrlOrMetaKeyPressed:n,shiftPressed:r,mergedCellIndices:rt(o.endRow,o.endCol,i.rows),firstRow:0,lastRowIndex:i.rows.length-1,lastColIndex:i.columnSettings.length-1}),singleSelection:!0,isKeyEvent:!0}}function Ci(e){var t=di(e,ti);return t.scrollDirection=e.ctrlOrMetaKeyPressed?Fe.FirstCell:Fe.FirstCol,t}function vi(e){var t=di(e,ni);return t.scrollDirection=e.ctrlOrMetaKeyPressed?Fe.LastCell:Fe.LastCol,t}function bi(e){return di(e,oi)}function yi(e){return{selectionArea:$r(e.tableData,e.selectionArea),singleSelection:!0,isKeyEvent:!0,context:c.AllCells}}function mi(e){var t=e.selectionArea,n=e.selectionContextType,o=e.shiftPressed,r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ci(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ci(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t),i=Fe.Up;if(n===c.Widget)r.startRow=0,r.startCol=0,r.endRow=0,r.endCol=0;else if(o)r.startRow=t.startRow-1,r.endRow=t.startRow-1,r.endCol=t.startCol;else{var l=St(n)?0:1;r.startRow=t.startRow+l,r.endRow=t.startRow+l,r.endCol=t.startCol,i=Fe.Down}return{selectionArea:r,scrollDirection:i,singleSelection:!0,isKeyEvent:!0}}function Ri(e){var t=e.selectionArea,n=e.tableData,o=e.selectionContextType,r=e.shiftPressed,i=ft(n.rows),l=i?i.row:0,a=n.rows.length-1+l,s=n.columnSettings.length-1,c=St(o),d=r?function(e,t,n){var o=bt({},e);return 0===o.startCol&&0===o.startRow?(o.startRow=t,o.endRow=t,o.startCol=n,o.endCol=n,{newSelectionArea:o,scrollDirection:Fe.LastCell}):0===o.startCol?(o.startRow=e.endRow-1,o.endRow=e.endRow-1,o.startCol=n,o.endCol=n,{newSelectionArea:o,scrollDirection:Fe.UpAndLastCol}):(o.endRow=e.startRow,o.startCol=e.startCol-1,o.endCol=e.startCol-1,{newSelectionArea:o,scrollDirection:Fe.Left})}(t,a,s):function(e,t,n,o){var r=bt({},e);if(r.startCol===n&&r.startRow===t)return r.startRow=0,r.endRow=0,r.startCol=0,r.endCol=0,{newSelectionArea:r,scrollDirection:Fe.FirstCell};if(r.startCol===n)return r.endRow=e.startRow+1,r.startRow=e.startRow+1,r.startCol=0,r.endCol=0,{newSelectionArea:r,scrollDirection:Fe.DownAndFirstCol};var i=o?1:0;return r.endRow=e.startRow,r.startCol=e.startCol+1-i,r.endCol=e.startCol+1-i,{newSelectionArea:r,scrollDirection:Fe.Right}}(t,a,s,c);return{selectionArea:d.newSelectionArea,singleSelection:!0,scrollDirection:d.scrollDirection,isKeyEvent:!0}}ce()(Xr.Z,{insert:"head",singleton:!1}),Xr.Z.locals,c.Widget;var wi,Si=function(){function e(){(0,P.Z)(this,e)}return(0,k.Z)(e,[{key:"handleSelectionForMouseDown",value:function(e,t,n,o,r,i,l,a,s,c){}},{key:"handleSelectionForMouseUp",value:function(e,t,n,o,r){}},{key:"handleClick",value:function(e,t,n,o,r){}},{key:"handleOverlayClick",value:function(e,t,n,o,r,i){}},{key:"handleKeyDown",value:function(e,t,n,o,r){return Ft}},{key:"getSelectionInProcess",value:function(){return!1}},{key:"setSelectionInProcess",value:function(e){}},{key:"getKeepSelectionAlive",value:function(){return!1}},{key:"setKeepSelectionAlive",value:function(e){}},{key:"getCopying",value:function(){return!1}},{key:"setCopying",value:function(e){}},{key:"getDraggerSelectionArea",value:function(){return null}},{key:"setDraggerSelectionArea",value:function(e){}},{key:"getSelectedDimensions",value:function(){return[]}},{key:"supportsRowColumnHover",value:function(){return!1}},{key:"supportsCopyDragger",value:function(){return!1}}]),e}();function Ti(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Oi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ti(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ti(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Di=!1,Ei=(wi={},(0,x.Z)(wi,et.ARROW_DOWN,(function(e){return hi(Oi(Oi({},e),{},{shiftPressed:Di}))})),(0,x.Z)(wi,et.ARROW_LEFT,(function(e){return pi(Oi(Oi({},e),{},{shiftPressed:Di}))})),(0,x.Z)(wi,et.ARROW_RIGHT,(function(e){return ui(Oi(Oi({},e),{},{shiftPressed:Di}))})),(0,x.Z)(wi,et.ARROW_UP,(function(e){return fi(Oi(Oi({},e),{},{shiftPressed:Di}))})),(0,x.Z)(wi,et.HOME,(function(e){return Ci(Oi(Oi({},e),{},{shiftPressed:Di}))})),(0,x.Z)(wi,et.END,(function(e){return vi(Oi(Oi({},e),{},{shiftPressed:Di}))})),(0,x.Z)(wi,et.SPACE,(function(e){return bi(Oi(Oi({},e),{},{ctrlOrMetaKeyPressed:!1,shiftPressed:Di}))})),(0,x.Z)(wi,et.ENTER,(function(e){return mi(e)})),(0,x.Z)(wi,et.TAB,(function(e){return Ri(e)})),wi),Ii=function(){function e(t){(0,P.Z)(this,e),(0,x.Z)(this,"keepSelectionAlive",!1),this.mapKeyDownToSelection=t||Ei}return(0,k.Z)(e,[{key:"handleSelectionForMouseDown",value:function(e,t,n,o,r,i,l,a,s,c){var d;null===(d=s.onCellMouseDown)||void 0===d||d.call(s,c),c.event.stopPropagation(),l||Ai(r,a,c)}},{key:"handleSelectionForMouseUp",value:function(e,t,n,o,r){this.keepSelectionAlive=!0,o.event.preventDefault(),t.onCellSelected(),t.onCellMouseUp&&t.onCellMouseUp(o)}},{key:"getSelectionInProcess",value:function(){return!1}},{key:"setSelectionInProcess",value:function(e){}},{key:"getKeepSelectionAlive",value:function(){return this.keepSelectionAlive}},{key:"setKeepSelectionAlive",value:function(e){this.keepSelectionAlive=e}},{key:"getCopying",value:function(){return!1}},{key:"setCopying",value:function(e){}},{key:"getDraggerSelectionArea",value:function(){return null}},{key:"setDraggerSelectionArea",value:function(e){}},{key:"getSelectedDimensions",value:function(){return[]}},{key:"supportsRowColumnHover",value:function(){return!1}},{key:"supportsCopyDragger",value:function(){return!1}},{key:"handleKeyDown",value:function(e,t,n,o,r){var i,l;return(null===(i=(l=this.mapKeyDownToSelection)[e])||void 0===i?void 0:i.call(l,{tableData:t,selectionArea:n,selectionContextType:o,shiftPressed:r.shiftKey,ctrlOrMetaKeyPressed:ut(r)}))||Ft}},{key:"handleClick",value:function(e,t,n,o,r){this.keepSelectionAlive?this.keepSelectionAlive=!1:Hi(e,t,n,o,r)}},{key:"handleOverlayClick",value:function(e,t,n,o,r,i){}}]),e}();function Ai(e,t,n){var o,r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.editMode&&n.cellType===v.Chart&&!i&&t.cellChartData&&n.chartDimension&&n.chartContext){var l=t.cellChartData[n.chartDimension];o={startCol:l.startCol,endCol:l.endCol,startRow:l.startRow,endRow:l.endRow,selectionType:C.Box,isCellChartSelection:!0,inCellChartContext:n.chartContext},r=c.CellChart}else o={startRow:n.row,startCol:n.col,endRow:n.row,endCol:n.col,selectionType:C.Box},r=Zt({cellType:n.cellType,selectedRegions:1});e({selectionArea:o,singleSelection:!0,context:r,isKeyEvent:!1})}function Hi(e,t,n,o,r){var i=e.target;(function(e){return e.classList&&(e.classList.contains("tableContainer")||e.classList.contains("freezeSectiontopLeft")||e.classList.contains("freezeSectionbottomLeft")||e.classList.contains("freezeSectiontopRight")||e.classList.contains("freezeSectionbottomRight"))})(i)&&r({clearSelection:!0,isKeyEvent:!1});var l=i.closest&&i.closest(".tableCell"),a=l&&l.getAttribute("data-tablecol"),s=l&&l.getAttribute("data-tablerow"),c=void 0!==a&&void 0!==s,d=null!==a&&null!==s;if(n()){if(t.mobile&&d&&c){var h=document.createEvent("MouseEvents");h.initEvent("mousedown",!0,!0),e.target.dispatchEvent(h)}}else e&&(e.ctrlKey||e.shiftKey)||(o(!0),d&&c&&l&&"string"==typeof a&&"string"==typeof s&&!l.classList.contains("coordinateHeader")&&function(e,t,n,o,r){var i=o.rows[n],l=i&&i.cells[t];l&&o.editMode&&l.cellType===v.Chart&&o.cellChartData&&l.cellChart?r(Ut(o,n,t)):(e.persist(),r({selectionArea:{startRow:n,startCol:t,endRow:n,endCol:t,selectionType:C.Box},singleSelection:!0,fireSelectionUpdate:!0,event:e.nativeEvent,isKeyEvent:!1}))}(e,parseInt(a,10),parseInt(s,10),t,r))}function Li(e){switch(e){case I.None:return new Si;case I.Default:return new ki;case I.SingleCell:return new Ii;default:return new ki}}function xi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Pi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xi(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ki=function(){function e(t){var n;(0,P.Z)(this,e),(0,x.Z)(this,"selectionInProcess",!1),(0,x.Z)(this,"keepSelectionAlive",!1),(0,x.Z)(this,"copying",!1),(0,x.Z)(this,"draggerSelectionArea",null),(0,x.Z)(this,"selectedDimensions",[]),this.mapKeyDownToSelection=t||(n={},(0,x.Z)(n,et.A,yi),(0,x.Z)(n,et.ARROW_DOWN,hi),(0,x.Z)(n,et.ARROW_LEFT,pi),(0,x.Z)(n,et.ARROW_RIGHT,ui),(0,x.Z)(n,et.ARROW_UP,fi),(0,x.Z)(n,et.HOME,Ci),(0,x.Z)(n,et.END,vi),(0,x.Z)(n,et.SPACE,bi),(0,x.Z)(n,et.ENTER,mi),(0,x.Z)(n,et.TAB,Ri),n)}return(0,k.Z)(e,[{key:"handleSelectionForMouseDown",value:function(e,t,n,o,r,i,l,a,s,d,h){var p,u=ut(d.event),f=d.event.shiftKey,g=u||f;if(!t()){if(a.editMode&&g)return void o(!1);o(g),l||n(!0)}null===(p=s.onCellMouseDown)||void 0===p||p.call(s,d);var C=function(e,t){return e.selectedRegions.some((function(e){var n=e.startCol<=t.col&&e.endCol>=t.col||e.startCol>=t.col&&e.endCol<=t.col,o=e.startRow<=t.row&&e.endRow>=t.row||e.startRow>=t.row&&e.endRow<=t.row;return n&&o}))}(i.selection,d);if(!(C&&2===d.event.button&&i.selection.selectionContextType===c.MultiCell||u&&Tt(i.selection.selectionContextType,i.hover.hoverContextType))){if(function(e,t,n,o){var r,i=c.HeaderRegion===t.hover.hoverContextType,l=c.DatacellRegion===t.hover.hoverContextType,a=c.Dimension===t.hover.hoverContextType,s=c.CellChart===t.hover.hoverContextType,d=U(e.cellType),h=mt(t.selection.selectionContextType),p=!Rt(t.selection.selectionContextType),u=!h,f=h||wt(t.selection.selectionContextType)&&!o.includes(null===(r=e.context)||void 0===r?void 0:r.originalDimension);return!!(n&&(i&&u||l&&p||a&&f)||d||s)}(d,i,a.designMode,this.selectedDimensions))return this.selectionInProcess=U(d.cellType),void this.handleRegionSelection(e,r,i,a,s,d);d.event.stopPropagation(),l||(this.startSelectionInProcess(d,s),u?this.handleCtrlMouseDown(e,s,a,C,d,h):u||f?f&&this.handleShiftMouseDown(e,s,a,i.selection,d):Ai(r,a,d,C))}}},{key:"handleSelectionForMouseUp",value:function(e,t,n,o,r){if(this.keepSelectionAlive=!0,o.event.preventDefault(),r===h.None&&this.selectionInProcess){var i=ut(o.event),l=o.event.shiftKey;i||l||!n.copyInProcess||e((function(e){return Pi(Pi({},e),{},{copyInProcess:!1})})),0===o.event.button&&zt(n.selection,t),this.copying&&t.onDragCopyFinish&&t.onDragCopyFinish({originalRegion:this.draggerSelectionArea}),this.setSelectionInProcess(!1),this.copying=!1,t.onCellSelected()}t.onCellMouseUp&&t.onCellMouseUp(o)}},{key:"handleCoordinateSelection",value:function(e,t,n,o,r,i){var l=i.event,a=i.row,s=i.col,c=ut(i.event),d=l&&l.shiftKey,h=Wt(n);if(!c&&!d||Ot(h,a,s)||Dt(h,a,s)){var p=Ht(i.cellType),u=Qr(o,p,a,s),f=u.selectionArea,g=u.context;if(c)e((function(e){return jt(e,r,f,!1)}));else{if(d){var C=Pi({},h);return C.endRow=a>=0?a:C.endRow,C.endCol=s>=0?s:C.endCol,void t({selectionArea:C,singleSelection:!0,context:g,isKeyEvent:!1})}t({selectionArea:f,singleSelection:!0,context:p,isKeyEvent:!1})}}}},{key:"handleRegionSelection",value:function(e,t,n,o,r,i){if(i&&U(i.cellType))this.handleCoordinateSelection(e,t,n.selection,o,r,i);else{var l=i?i.row:-1,a=i?i.col:-1,s=i&&i.context&&i.context.originalDimension||n.hover.dimensionId,d=n.hover.hoverContextType,h=i&&ut(i.event);if(!h||!Tt(n.selection.selectionContextType,n.hover.hoverContextType)){var p=n.hover.hoverContextType===c.Dimension;h&&p?this.selectedDimensions.push(s):this.selectedDimensions=p?[s]:[];var u=Qr(o,d,l,a,s),f=u.selectionArea,g=u.context;d===c.CellChart&&o.cellChartData?t(Ut(o,l,a)):(d=g,h?e((function(e){return jt(e,r,f,!0)})):t({selectionArea:f,singleSelection:!0,context:d,isKeyEvent:!1}))}}}},{key:"getSelectionInProcess",value:function(){return this.selectionInProcess}},{key:"setSelectionInProcess",value:function(e){this.selectionInProcess=e}},{key:"getKeepSelectionAlive",value:function(){return this.keepSelectionAlive}},{key:"setKeepSelectionAlive",value:function(e){this.keepSelectionAlive=e}},{key:"getCopying",value:function(){return this.copying}},{key:"setCopying",value:function(e){this.copying=e}},{key:"getDraggerSelectionArea",value:function(){return this.draggerSelectionArea}},{key:"setDraggerSelectionArea",value:function(e){this.draggerSelectionArea=e}},{key:"getSelectedDimensions",value:function(){return this.selectedDimensions}},{key:"supportsRowColumnHover",value:function(){return!0}},{key:"supportsCopyDragger",value:function(){return!0}},{key:"handleKeyDown",value:function(e,t,n,o,r){var i,l,a=ut(r),s=r.shiftKey;return(null===(i=(l=this.mapKeyDownToSelection)[e])||void 0===i?void 0:i.call(l,{tableData:t,selectionArea:n,selectionContextType:o,ctrlOrMetaKeyPressed:a,shiftPressed:s}))||Ft}},{key:"handleCtrlMouseDown",value:function(e,t,n,o,r,i){if(o)this.setSelectionInProcess(!1),e((function(e){var o,l,a=e.selection.selectedRegions.filter((function(e){return!(e.startCol===r.col&&e.endCol===r.col&&e.startRow===r.row&&e.endRow===r.row)})),s=Pi(Pi({},e.selection),{},{selectedRegions:a,selectionContextType:Zt({cellType:r.cellType,selectedRegions:a.length})});if(zt(s,t),null!==(o=n.featureToggles)&&void 0!==o&&o.accessibilityKeyboardSupport&&a.length>0){var c=Wt(s);ct(n,c)}else null!==(l=n.featureToggles)&&void 0!==l&&l.accessibilityKeyboardSupport&&i();return Pi(Pi({},e),{},{selection:s})}));else{this.preventDragSelectionForMacOS();var l={startRow:r.row,startCol:r.col,endRow:r.row,endCol:r.col,selectionType:C.Box};e((function(e){var o,i=[].concat((0,L.Z)(e.selection.selectedRegions),[l]),a=Pi(Pi({},e.selection),{},{selectedRegions:i,selectionContextType:Zt({cellType:r.cellType,selectedRegions:i.length})});if(zt(a,t),null!==(o=n.featureToggles)&&void 0!==o&&o.accessibilityKeyboardSupport){var s=Wt(a);ct(n,s)}return Pi(Pi({},e),{},{selection:a})}))}}},{key:"preventDragSelectionForMacOS",value:function(){var e;(0===(e=navigator.platform).toLowerCase().indexOf("mac")||"iPhone"===e||"iPad"===e||"iPod"===e)&&this.setSelectionInProcess(!1)}},{key:"handleShiftMouseDown",value:function(e,t,n,o,r){e((function(e){var i=Pi(Pi({},Wt(o)),{},{endRow:r.row,endCol:r.col});i=lt(i,n.rows);var l=(0,L.Z)(e.selection.selectedRegions);0===l.length&&(i.startRow=r.row,i.startCol=r.col),l[Math.max(0,l.length-1)]=i;var a=Pi(Pi({},e.selection),{},{selectedRegions:l,selectionContextType:Zt({selectedRegions:l.length})});return zt(a,t),Pi(Pi({},e),{},{selection:a})}))}},{key:"handleClick",value:function(e,t,n,o,r){this.keepSelectionAlive?this.keepSelectionAlive=!1:Hi(e,t,n,o,r)}},{key:"handleOverlayClick",value:function(e,t,n,o,r,i){var l=Pi({},Wt(e)),a=ut(t.event),s=wt(e.selectionContextType);if(!a||!yt(e.selectionContextType)&&!s){var d=t.event.shiftKey,h=void 0!==t.col?t.col:-1,p=void 0!==t.row?t.row:-1;h>=0&&(l.endRow=n.rows.length-1,l.startRow=0,l.startCol=d?l.startCol:h,l.endCol=h,l.selectionType=C.Columns),p>=0&&(l.endCol=n.columnSettings.length-1,l.startCol=0,l.startRow=d?l.startRow:p,l.endRow=p,l.selectionType=C.Rows),d||!d&&!a?o({selectionArea:l,singleSelection:!0,isKeyEvent:!1}):r((function(e){var t=(0,L.Z)(e.selection.selectedRegions);t.push(l);var n=l.selectionType===C.Columns?c.Column:c.Row,o=Pi(Pi({},e.selection),{},{selectedRegions:t,selectionContextType:n});return zt(o,i),Pi(Pi({},e),{},{selection:o})}))}}},{key:"startSelectionInProcess",value:function(e,t){var n=this.cellEditIsInProgress(t),o=ht(e),r=0===e.event.button&&!o&&!n;this.setSelectionInProcess(r)}},{key:"cellEditIsInProgress",value:function(e){return!!(e.getDataEntryInProgress&&e.getDataEntryInProgress()||e.getNewLineDataEntryInProgress&&e.getNewLineDataEntryInProgress())}}]),e}();function _i(e,t){return void 0===t?e?-1:void 0:t}function zi(e,t){return e.reduce((function(e,n){return e+n.height+t}),0)}function Mi(e,t,n,o){return!(e+o<=t||e-t>=n)}function Ni(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Zi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zi(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(a)throw i}}}}function Zi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function Bi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ji(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bi(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Wi=function(){function e(t,n,o,r){var i;(0,P.Z)(this,e),this.table=null,this.cachedData=t,this.parentContainer=n,this.externalHandler=o,this.heightOfOnTheFlyRows=0,this.widthOfOnTheFlyCols=0,this.scrollPosition={scrollTop:0,scrollLeft:0},this.isPaginating=!1,this.paginationRowIndexes={fromRowIndex:-1,toRowIndex:-1},this.tableSizes=ke(t),this.tableDataWindowing=new Kr,this.showHideLoadingAreas=(new Nr).createRefs(),this.preventDefaultSelection=!1,this.pendingImages=[],this.selectionStrategy=new ki,void 0!==t.selectionMode&&null!==(i=t.featureToggles)&&void 0!==i&&i.selectionMode&&(this.selectionStrategy=Li(t.selectionMode)),this.boundHandleColumnWidthChanged=this.handleColumnWidthChanged.bind(this),this.boundHandleRowHeightChanged=this.handleRowHeightChanged.bind(this),this.boundHandleTitleHeightChanged=this.handleTitleHeightChanged.bind(this),this.boundHandleAddRowOrColOnTheFly=this.handleAddCustomColOrRow.bind(this),this.boundHandleRemoveRowOrColOnTheFly=this.handleRemoveCustomColOrRow.bind(this),this.boundHandleStoreScrollPosition=this.handleStoreScrollPosition.bind(this),this.boundUpdateNewLineMemberCell=this.updateNewLineMemberCell.bind(this),this.boundOnPageUpDownKey=this.handlePageUpDownKey.bind(this),this.boundAltOnPageUpDownKey=this.handleAltPageUpDownKey.bind(this),this.boundInternalElementDropped=this.handleInternalElementDropped.bind(this),this.boundRefCreatedOrRemovedCallback=this.refCreatedOrRemovedCallback.bind(this),this.boundAfterDomRenderUpdateCallback=this.afterDomRenderUpdateCallback.bind(this),this.boundRegisterImageLoading=this.registerImageLoading.bind(this),this.boundOnInternalReloadLimitReachedVertically=this.internalReloadLimitReachedVertically.bind(this),this.boundOnInternalReloadLimitReachedHorizontally=this.internalReloadLimitReachedHorizontally.bind(this),this.refCreatedRemovedCallback=r,this.tableHandler=ji(ji({onResizerDoubleClick:ie,onCellSelected:ie},this.externalHandler),{},{onColumnWidthChanged:this.boundHandleColumnWidthChanged,onRowHeightChanged:this.boundHandleRowHeightChanged,onTitleHeightChanged:this.boundHandleTitleHeightChanged,onInternalReloadLimitReachedVertically:this.boundOnInternalReloadLimitReachedVertically,onInternalReloadLimitReachedHorizontally:this.boundOnInternalReloadLimitReachedHorizontally,onPageUpDownKey:this.boundOnPageUpDownKey,onAltPageUpDownKey:this.boundAltOnPageUpDownKey,onCellDropped:this.boundInternalElementDropped,onAddRowOrColOnTheFly:this.boundHandleAddRowOrColOnTheFly,onRemoveRowOrColOnTheFly:this.boundHandleRemoveRowOrColOnTheFly,storeScrollPosition:this.boundHandleStoreScrollPosition,onUpdateNewLineMemberCell:this.boundUpdateNewLineMemberCell,registerImageLoading:this.boundRegisterImageLoading})}return(0,k.Z)(e,[{key:"getWidthOfOnTheFlyCols",value:function(){return this.widthOfOnTheFlyCols}},{key:"getHeightOfOnTheFlyRows",value:function(){return this.heightOfOnTheFlyRows}},{key:"getTableData",value:function(){return this.cachedData}},{key:"getContentWidth",value:function(){return this.tableSizes.htmlTableWrapperWidth+oe.SCROLLBAR_SIZE-this.widthOfOnTheFlyCols}},{key:"getContentHeight",value:function(){return this.tableSizes.htmlTableWrapperHeight+this.tableSizes.titleHeight+oe.SCROLLBAR_SIZE-this.heightOfOnTheFlyRows}},{key:"setParentContainer",value:function(e){this.parentContainer=e}},{key:"refCreatedOrRemovedCallback",value:function(e){this.table=e,this.refCreatedRemovedCallback&&this.refCreatedRemovedCallback(this.table)}},{key:"afterDomRenderUpdateCallback",value:function(){var e=this;this.showHideLoadingAreas.hideLoadingAreas(),Promise.allSettled(this.pendingImages).then((function(){e.pendingImages=[],e.afterRenderingCallback&&e.table&&e.afterRenderingCallback(e.table)}))}},{key:"registerImageLoading",value:function(e){this.pendingImages.push(e)}},{key:"hasImagesPending",value:function(){return!!this.pendingImages.length}},{key:"allRowsProcessed",value:function(){return this.cachedData.rows.length===this.cachedData.totalNumberOfRows}},{key:"internalReloadLimitReachedVertically",value:function(e,t){var n=this,o=this.getWidthOfOnTheFlyCols(),r=this.getHeightOfOnTheFlyRows();(function(e,t,n){var o=void 0===n.totalNumberOfRows?n.rows.length-1:n.totalNumberOfRows-1,r=!t&&0!==e.startRowIndex,i=t&&o!==e.endRowIndex;return r||i})(this.tableDataWindowing.getRowIndices(),t,this.cachedData)&&this.showHideLoadingAreas.showVerticalLoading(t),!this.externalHandler.onReloadLimitReachedVertically&&!this.externalHandler.onReloadLimitReached||this.allRowsProcessed()?Je((function(){return n.updateTableAndPreserveOnTheFlyColsAndRows(o,r)})):(this.externalHandler.onReloadLimitReachedVertically?this.externalHandler.onReloadLimitReachedVertically(e,t):this.externalHandler.onReloadLimitReached&&this.externalHandler.onReloadLimitReached(e,t),this.setOnTheFlyColsAndRowsValues(o,r))}},{key:"internalReloadLimitReachedHorizontally",value:function(e,t){var n=this;if(!this.isPaginating){var o=this.getWidthOfOnTheFlyCols(),r=this.getHeightOfOnTheFlyRows();(function(e,t,n){var o=void 0===n.totalNumberOfColumns?n.columnSettings.length-1:n.totalNumberOfColumns-1,r=!t&&0!==e.startColumnIndex,i=t&&o!==e.endColumnIndex;return r||i})(this.tableDataWindowing.getColumnIndices(),t,this.cachedData)&&this.showHideLoadingAreas.showHorizontalLoading(t),Je((function(){return n.updateTableAndPreserveOnTheFlyColsAndRows(o,r)})),this.externalHandler.onReloadLimitReachedHorizontally&&this.externalHandler.onReloadLimitReachedHorizontally(e,t)}}},{key:"updateTableAndPreserveOnTheFlyColsAndRows",value:function(e,t){this.updateTableData(this.cachedData),this.setOnTheFlyColsAndRowsValues(e,t)}},{key:"setOnTheFlyColsAndRowsValues",value:function(e,t){this.widthOfOnTheFlyCols=e,this.heightOfOnTheFlyRows=t}},{key:"handlePageUpDownKey",value:function(e,t,n){var o=this,r=this.getScrollTop(),i=function(e,t,n,o){var r,i=0,l=e,a=0,s=De(n);try{for(s.s();!(r=s.n()).done;){var c=r.value.height+o;(l-=c)<0&&a<t&&(i++,a+=c)}}catch(e){s.e(e)}finally{s.f()}return{numberOfVisibleRows:i,sizeOfVisibleRows:a}}(r,this.tableSizes.tableContainerHeight-this.tableSizes.freezeHeight,this.cachedData.rows,this.tableSizes.borderSize),l=i.numberOfVisibleRows,a=i.sizeOfVisibleRows;this.scrollTopAfterPageKey=r+(e?a:-a);var s=e?function(e,t){return bt(bt({},e),{},{startRow:e.startRow+t,endRow:e.startRow+t})}(t,l):function(e,t){return bt(bt({},e),{},{startRow:e.startRow-t,endRow:e.startRow-t})}(t,l);this.callAppendRowsOrUpdateAfterPageUpDown(e,l,(function(){o.setScrollTop(o.scrollTopAfterPageKey),o.scrollTopAfterPageKey=0,n(s)}))}},{key:"handleAltPageUpDownKey",value:function(e,t,n){var o=this,r=this.getScrollLeft(),i=function(e,t,n){var o,r=0,i=e,l=0,a=De(n);try{for(a.s();!(o=a.n()).done;){var s=o.value.width;(i-=s)<0&&l<t&&(r++,l+=s)}}catch(e){a.e(e)}finally{a.f()}return{numberOfVisibleColumns:r,sizeOfVisibleColumns:l}}(r,this.tableSizes.tableContainerWidth-this.tableSizes.freezeWidth,this.cachedData.columnSettings),l=i.numberOfVisibleColumns,a=i.sizeOfVisibleColumns;this.scrollLeftAfterPageKey=r+(e?a:-a);var s=e?function(e,t){return bt(bt({},e),{},{startCol:e.startCol+t,endCol:e.startCol+t})}(t,l):function(e,t){return bt(bt({},e),{},{startCol:e.startCol-t,endCol:e.startCol-t})}(t,l);this.updateTableData(this.cachedData,(function(){o.setScrollLeft(o.scrollLeftAfterPageKey),o.scrollLeftAfterPageKey=0,n(s)}))}},{key:"handleInternalElementDropped",value:function(e){this.externalHandler.onExternalElementDropped&&this.externalDragData?this.externalHandler.onExternalElementDropped({targetRow:e.targetRow,targetCol:e.targetCol,placedBeforeCell:e.placedBeforeCell,externalData:this.externalDragData}):this.externalHandler.onCellDropped&&this.externalHandler.onCellDropped(e)}},{key:"callAppendRowsOrUpdateAfterPageUpDown",value:function(e,t,n){if(this.externalHandler.onAppendRowsForPageDown&&e){var o=this.getCurrentGeneralSettings().rowContentLimitFactor,r=Math.max(this.cachedData.rows.length+t,o*t);this.externalHandler.onAppendRowsForPageDown(r,n)}else this.updateTableData(this.cachedData,n)}},{key:"renderReact",value:function(e,t){z.render(_.createElement(Mr,{data:e,handler:this.tableHandler,ref:this.boundRefCreatedOrRemovedCallback,tableSizes:this.tableSizes,isPaginating:this.isPaginating,preventDefaultSelection:this.preventDefaultSelection,loadingIndicatorRefs:this.showHideLoadingAreas.getLoadingAreaRefs(),generalSettings:t,selectionStrategy:this.selectionStrategy}),this.parentContainer,this.boundAfterDomRenderUpdateCallback)}},{key:"handleTitleHeightChanged",value:function(e){var t=ji({},this.cachedData),n=t.title;t.title=ji(ji({},n),{},{titleStyle:ji(ji({},n.titleStyle),{},{height:e})}),this.updateTableData(t),this.externalHandler.onTitleHeightChanged&&this.externalHandler.onTitleHeightChanged(e)}},{key:"prepareDataAndRenderTable",value:function(){var e=ji({},this.cachedData),t=this.getCurrentGeneralSettings();e.activeNewLineMemberCell=this.activeNewLineMemberCell,e.scrollPosition=this.scrollPosition,e.freezeEndRow=_i(t.showCoordinateHeader,e.freezeEndRow),e.freezeEndCol=_i(t.showCoordinateHeader,e.freezeEndCol),e.totalWidth=Fr(e.columnSettings),e.lastRowIndex=e.lastRowIndex||this.cachedData.rows.length-1,this.isPaginating?(e=this.updateRowsForPagination(e),this.tableSizes=ke(e)):(e=this.tableDataWindowing.doWindowing(e),this.tableSizes=function(e,t,n,o){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l={columnIndices:t.getColumnIndices(),notRenderedHeightOnTop:t.getNotRenderedHeightTop(),notRenderedWidthToTheLeft:t.getNotRenderedWidthToTheLeft(),scrollTop:n,scrollLeft:o,isPaginatedTable:!1,allRowsProcessed:r,allColumnsProcessed:i};return _e(e,l)}(e,this.tableDataWindowing,this.getScrollTop(),this.getScrollLeft(),this.allRowsProcessed(),!0)),this.renderReact(e,t)}},{key:"reapplyScrollPosition",value:function(){if(this.table){var e=this.getScrollLeft()||this.table.getLastScrollUpdateHorizontal(),t=this.getScrollTop()||this.table.getLastScrollUpdateVertical();this.scrollToPosition(t,e)}}},{key:"removeTable",value:function(){var e;null===(e=this.table)||void 0===e||e.removeEventListeners(),z.unmountComponentAtNode(this.parentContainer)}},{key:"updateOnTheFlyValuesAndUpdateTableData",value:function(e){if(e.preserveOnTheFlyValues||this.setOnTheFlyColsAndRowsValues(0,0),this.cachedData=e.tableData,this.afterRenderingCallback=e.callback,this.adjustScrollPosition(e.resetScroll),!this.isPaginating){var t=this.scrollTopAfterPageKey||this.getScrollTop();this.tableDataWindowing.updateIndicesForWindowing(this.cachedData,t,this.getScrollLeft(),this.getCurrentGeneralSettings())}this.prepareDataAndRenderTable()}},{key:"getCurrentGeneralSettings",value:function(){return{showRowColumnHover:this.selectionStrategy.supportsRowColumnHover()&&Jt(this.cachedData.showRowColumnHover),showCopyDragger:this.selectionStrategy.supportsCopyDragger()&&Jt(this.cachedData.showCopyDragger),showCoordinateHeader:!!this.cachedData.showCoordinateHeader,showFreezeLines:Jt(this.cachedData.showFreezeLines),rowContentLimitFactor:this.cachedData.rowContentLimitFactor||oe.CONTENT_LIMIT_VERTICAL,selectionMode:void 0!==this.cachedData.selectionMode?this.cachedData.selectionMode:I.Default}}},{key:"updateTableData",value:function(e,t,n){var o,r,i;void 0!==e.selectionMode&&this.cachedData.selectionMode!==e.selectionMode&&null!==(o=e.featureToggles)&&void 0!==o&&o.selectionMode&&(this.selectionStrategy=Li(e.selectionMode)),e.widgetHeight>0&&e.widgetWidth>0&&this.updateOnTheFlyValuesAndUpdateTableData({tableData:e,callback:t,preserveOnTheFlyValues:!1,resetScroll:n}),this.externalHandler.tableContentSizeChanged&&null!==(r=this.table)&&void 0!==r&&null!==(i=r.refTableContainer)&&void 0!==i&&i.current&&this.externalHandler.tableContentSizeChanged(this.table.refTableContainer.current)}},{key:"resetNewLineMemberCell",value:function(){this.updateNewLineMemberCell(void 0)}},{key:"updateNewLineMemberCell",value:function(e){this.activeNewLineMemberCell=e,this.prepareDataAndRenderTable()}},{key:"setIsPaginating",value:function(e){this.isPaginating=e}},{key:"getIsPaginating",value:function(){return this.isPaginating}},{key:"setPreventDefaultSelectionAndRerender",value:function(e){this.preventDefaultSelection!==e&&(this.preventDefaultSelection=e,this.prepareDataAndRenderTable())}},{key:"updateRowIndexesForPagination",value:function(e){this.paginationRowIndexes=e}},{key:"getRowIndexesForPagination",value:function(){return this.paginationRowIndexes}},{key:"updateColumnWidths",value:function(e){if(0!==e.length&&!this.cachedData.responsive){var t,n=Ni(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;this.cachedData.columnSettings.length>o.index&&(this.cachedData=ji({},this.cachedData),this.cachedData.columnSettings=(0,L.Z)(this.cachedData.columnSettings),this.cachedData.columnSettings[o.index]=ji(ji({},this.cachedData.columnSettings[o.index]),{},{width:o.size}))}}catch(e){n.e(e)}finally{n.f()}this.prepareDataAndRenderTable()}}},{key:"updateRowHeights",value:function(e){if(0!==e.length){var t,n=Ni(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;this.cachedData.rows.length>o.index&&(this.cachedData=ji({},this.cachedData),this.cachedData.rows=(0,L.Z)(this.cachedData.rows),this.cachedData.rows[o.index]=ji(ji({},this.cachedData.rows[o.index]),{},{height:o.size}),at(this.cachedData.rows,this.tableSizes.borderSize,o.index))}}catch(e){n.e(e)}finally{n.f()}this.cachedData.totalHeight=zi(this.cachedData.rows,this.tableSizes.borderSize);var r=this.tableDataWindowing.getRowIndices().endRowIndex||this.cachedData.rows.length-1,i=function(e,t,n,o){var r=t+1;if(n.length>r){var i=function(e){var t=e.map((function(e){return e.index}));return Math.max.apply(Math,(0,L.Z)(t))}(n)+1;return zi(e.slice(0,i),o)}var l=t+1;return zi(e.slice(0,l),o)}(this.cachedData.rows,r,e,this.tableSizes.borderSize);this.cachedData.widgetHeight>i?this.internalReloadLimitReachedVertically(this.getScrollTop(),!0):this.prepareDataAndRenderTable()}}},{key:"handleColumnWidthChanged",value:function(e){this.updateColumnWidths(e),this.externalHandler.onColumnWidthChanged&&this.externalHandler.onColumnWidthChanged(e)}},{key:"handleRowHeightChanged",value:function(e){this.updateRowHeights(e),this.externalHandler.onRowHeightChanged&&this.externalHandler.onRowHeightChanged(e)}},{key:"getRowHeight",value:function(){if(this.cachedData.rowHeightSetting===D.Custom&&this.cachedData.rowHeightCustomPixels)return this.cachedData.rowHeightCustomPixels;var e=this.cachedData.style&&this.cachedData.style.size?this.cachedData.style.size:ne.FONT_SIZE;return function(e,t,n){var o=2*function(e){switch(e){case D.Cozy:return Y.PADDING_COZY;case D.Condensed:return Y.PADDING_CONDENSED;case D.SuperCondensed:return Y.PADDING_SUPER_CONDENSED;default:return Y.PADDING_COMPACT}}(e)+(t>-1?t:q.FONT_SIZE);return n?o+X.TEXT_HEIGHT_CALC_ERROR_MARGIN:o}(this.cachedData.rowHeightSetting,e,!0)}},{key:"handleAddCustomColOrRow",value:function(e){var t=ji({},this.cachedData);if(e===p.Row){for(var n=this.cachedData.rows.length,o=this.getRowHeight(),r={id:Fn(n,this.cachedData.id),row:n,fixed:!1,cells:[],height:o,changedOnTheFlyUnresponsive:!0},i=0;i<t.columnSettings.length;i++)r.cells.push(Kn(n,i,this.cachedData.id));t.rows.push(r),t.lastRowIndex=t.rows.length-1,t.totalHeight+=o+this.tableSizes.borderSize,this.heightOfOnTheFlyRows+=o+this.tableSizes.borderSize}else{for(var l=t.columnSettings.length,a=0;a<t.rows.length;a++)t.rows[a].cells.push(Kn(a,l,this.cachedData.id));t.columnSettings.push({id:Un(l,this.cachedData.id),column:l,width:w.Value,minWidth:0,fixed:!1,hasWrapCell:!1,emptyColumn:!0,addedOnTheFlyUnresponsive:!0}),this.widthOfOnTheFlyCols+=w.Value}this.updateOnTheFlyValuesAndUpdateTableData({tableData:t,preserveOnTheFlyValues:!0})}},{key:"handleStoreScrollPosition",value:function(e){this.scrollPosition=e}},{key:"handleRemoveCustomColOrRow",value:function(e,t){var n=ji({},this.cachedData);if(e===p.Row){var o=n.rows[t];(function(e){return e.changedOnTheFlyUnresponsive&&e.cells.every((function(e){return e.cellType===v.Empty||""===e.formatted.trim()}))})(o)&&(n.rows.pop(),n.lastRowIndex=n.rows.length-1,n.totalHeight-=o.height+this.tableSizes.borderSize,this.heightOfOnTheFlyRows-=o.height+this.tableSizes.borderSize)}else{var r=n.columnSettings[t];if(function(e){return e.addedOnTheFlyUnresponsive&&e.emptyColumn}(r)){var i,l=Ni(n.rows);try{for(l.s();!(i=l.n()).done;)i.value.cells.pop()}catch(e){l.e(e)}finally{l.f()}n.columnSettings.pop(),this.widthOfOnTheFlyCols-=r.width}}this.updateOnTheFlyValuesAndUpdateTableData({tableData:n,preserveOnTheFlyValues:!0})}},{key:"scrollToPosition",value:function(e,t){this.table&&!this.cachedData.mobile&&(this.table.setScrollTop(e),this.table.setScrollLeft(t))}},{key:"setScrollTop",value:function(e){var t;null===(t=this.table)||void 0===t||t.setScrollTop(e)}},{key:"setScrollLeft",value:function(e){var t;null===(t=this.table)||void 0===t||t.setScrollLeft(e)}},{key:"getScrollTop",value:function(){var e;return(null===(e=this.table)||void 0===e?void 0:e.getScrollTop())||0}},{key:"getScrollLeft",value:function(){var e;return(null===(e=this.table)||void 0===e?void 0:e.getScrollLeft())||0}},{key:"isCellInVisibleArea",value:function(e,t){return!!(this.isPaginating?this.isRowInPaginationArea(t):this.isRowInVisibleArea(t))&&this.isColumnInVisibleArea(e)}},{key:"isRowInPaginationArea",value:function(e){var t=void 0!==this.cachedData.freezeEndRow&&e<=this.cachedData.freezeEndRow,n=e<=this.paginationRowIndexes.toRowIndex&&e>=this.paginationRowIndexes.fromRowIndex;return t||n}},{key:"isRowInVisibleArea",value:function(e){for(var t=this.getScrollTop(),n=this.cachedData.showCoordinateHeader?oe.COORDINATE_CELL_SIZE:0,o=t,r=this.cachedData.showGrid?oe.GRID_BORDER_SIZE:0,i=0;i<this.cachedData.rows.length;i++){if(e===i){var l=this.tableSizes.tableContainerHeight;return void 0!==this.cachedData.freezeEndRow&&(e<=this.cachedData.freezeEndRow?(o=0,l=this.tableSizes.freezeHeight):(n-=this.tableSizes.freezeHeight,l-=this.tableSizes.freezeHeight)),Mi(n,o,l,this.cachedData.rows[i].height)}n+=this.cachedData.rows[i].height+r}return!1}},{key:"isColumnInVisibleArea",value:function(e){for(var t=this.getScrollLeft(),n=this.cachedData.showCoordinateHeader?oe.COORDINATE_CELL_SIZE:0,o=t,r=0;r<this.cachedData.columnSettings.length;r++){if(e===r){var i=this.tableSizes.tableContainerWidth;return void 0!==this.cachedData.freezeEndCol&&(e<=this.cachedData.freezeEndCol?(o=0,i=this.tableSizes.freezeWidth):(n-=this.tableSizes.freezeWidth,i-=this.tableSizes.freezeWidth)),Mi(n,o,i,this.cachedData.columnSettings[r].width)}n+=this.cachedData.columnSettings[r].width}return!1}},{key:"adjustScrollPosition",value:function(e){if(e)return this.scrollToPosition(0,0),void this.handleStoreScrollPosition({scrollTop:0,scrollLeft:0});if(this.isPaginating)this.setScrollTop(0);else{var t=Fr(this.cachedData.columnSettings),n=this.getScrollTop(),o=this.getScrollLeft(),r=n,i=o;this.cachedData.totalHeight<n&&(r=this.cachedData.totalHeight-this.tableSizes.tableContainerHeight),t<o&&(i=t-this.tableSizes.tableContainerWidth),i===o&&r===n||this.scrollToPosition(r,i)}}},{key:"updateRowsForPagination",value:function(e){var t=e.hasFixedRowsCols&&void 0!==e.freezeEndRow?e.freezeEndRow:-1,n=(0,L.Z)(e.rows),o=-1!==this.paginationRowIndexes.fromRowIndex?this.paginationRowIndexes.fromRowIndex:0;o=Math.max(o,t+1);var r=-1!==this.paginationRowIndexes.toRowIndex?this.paginationRowIndexes.toRowIndex:n.length-1;r=Math.min(r,n.length-1);var i=e.hasFixedRowsCols?n.slice(0,t+1):[],l=new Array(Math.max(0,o-i.length)),a=new Array(Math.max(0,n.length-r)),s=n.slice(o,r+1);return e.rows=[].concat((0,L.Z)(i),l,(0,L.Z)(s),a),e}},{key:"enableDragDrop",value:function(e){this.externalDragData=e,ko(this.table&&this.table.refTableContainer.current)}},{key:"disableDragDrop",value:function(){this.externalDragData=null,_o(this.table&&this.table.refTableContainer.current)}}]),e}()},973:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(645),r=n.n(o)()((function(e){return e[1]}));r.push([e.id,'.reactTableComponent .icon {\n  font-family: "fpa-icons";\n  -webkit-font-smoothing: antialiased;\n}\n.reactTableComponent .icon.hierarchyIcon,\n.reactTableComponent .icon.hierarchyIconMobile {\n  color: #346187;\n  cursor: pointer;\n  display: inline-block;\n  font-style: normal;\n  text-decoration: none;\n  font-weight: normal;\n}\n.reactTableComponent .icon.hierarchyIcon.expandedBelowIcon:before,\n.reactTableComponent .icon.hierarchyIconMobile.expandedBelowIcon:before {\n  content: "\\e625";\n}\n.reactTableComponent .icon.hierarchyIcon.expandedAboveIcon:before,\n.reactTableComponent .icon.hierarchyIconMobile.expandedAboveIcon:before {\n  content: "\\e624";\n}\n.reactTableComponent .icon.hierarchyIcon.collapsedIcon:before,\n.reactTableComponent .icon.hierarchyIconMobile.collapsedIcon:before {\n  content: "\\e627";\n}\n.reactTableComponent .icon.comment,\n.reactTableComponent .icon.childComment {\n  font-size: 1rem;\n  line-height: 1rem;\n  top: -3px;\n  right: 0px;\n  position: absolute;\n  font-style: normal;\n  text-decoration: none;\n  font-weight: normal;\n}\n.reactTableComponent .icon.comment {\n  cursor: pointer;\n  color: #21c4c4;\n}\n.reactTableComponent .icon.comment:before {\n  content: "\\e7f0";\n}\n.reactTableComponent .icon.childComment {\n  color: #808184;\n}\n.reactTableComponent .icon.childComment:before {\n  content: "\\e7ef";\n}\n.reactTableComponent .icon.thresholdIcon {\n  display: inline-block;\n}\n.reactTableComponent .icon.thresholdIcon.good:before {\n  content: "\\e787";\n}\n.reactTableComponent .icon.thresholdIcon.warning:before {\n  content: "\\e788";\n}\n.reactTableComponent .icon.thresholdIcon.alert:before {\n  content: "\\e789";\n}\n.reactTableComponent .icon.thresholdIcon.diamond:before {\n  content: "\\e834";\n}\n.reactTableComponent .icon.dataLocking {\n  display: inline-block;\n}\n.reactTableComponent .icon.dataLocking.locked:before {\n  content: "\\e621";\n}\n.reactTableComponent .icon.dataLocking.loading:before {\n  content: "\\e6e9";\n}\n.reactTableComponent .icon.dataLocking.unknown:before {\n  content: "\\e63a";\n}\n.reactTableComponent .icon.dataLocking.mixed:before {\n  content: "\\e7ab";\n}\n.reactTableComponent .icon.validationWarning.INVALID:before {\n  display: inline-block;\n  content: "\\e637";\n}\n.reactTableComponent .icon.selectAllCellsIcon:after {\n  display: inline-block;\n  content: "\\E661";\n  font-size: 1.625rem;\n  position: absolute;\n  top: 6px;\n  font-family: "fpa-icons";\n  right: 4px;\n  color: rgba(47, 60, 72, 0.2);\n}\n.reactTableComponent .icon.emptyAxisRowSwapIcon:after {\n  content: "\\E762";\n  font-family: "fpa-icons";\n}\n.reactTableComponent .icon.emptyAxisColumnSwapIcon:after {\n  content: "\\E646";\n  font-family: "fpa-icons";\n}\n',""]);const i=r},200:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(645),r=n.n(o)()((function(e){return e[1]}));r.push([e.id,'/*\n    this file covers the styling of the react table and should be independent of SAC/FIORI\n */\n.reactTableComponent {\n  width: 100%;\n  height: 100%;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  cursor: default;\n}\n.reactTableComponent .tableContainer {\n  position: relative;\n  width: 100%;\n  height: 100%;\n}\n.reactTableComponent .tableContainer .selectionDragger {\n  z-index: 98;\n  width: 8px;\n  height: 8px;\n  border-radius: 50%;\n  box-sizing: border-box;\n  position: absolute;\n  border: 1px solid #fff;\n  cursor: crosshair;\n  pointer-events: auto;\n  bottom: -2px;\n  right: -2px;\n}\n.reactTableComponent .tableContainer .reactTable {\n  table-layout: fixed;\n  border-collapse: separate;\n  border-spacing: 0px;\n  box-sizing: border-box;\n}\n.reactTableComponent .tableContainer .reactTable .tableCell {\n  font-size: 13px;\n  line-height: 16px;\n  font-weight: normal;\n  font-family: "72", Arial, Helvetica, sans-serif;\n  font-style: normal;\n  color: #333;\n  fill: #333;\n  padding-top: 2px;\n}\n.reactTableComponent .tableContainer .reactTable .tableCell .centerImageHorizontal {\n  position: absolute;\n  top: 4px;\n  left: 50%;\n  transform: translate(-50%);\n}\n.reactTableComponent .tableContainer .reactTable .tableCell .border {\n  z-index: 95;\n}\n.reactTableComponent .tableContainer .reactTable .tableCell .defaultBorderStyle.border {\n  border-bottom-width: 1px;\n  border-bottom-style: solid;\n  left: 4px;\n  position: absolute;\n  box-sizing: border-box;\n}\n.reactTableComponent .tableContainer .reactTable .tableCell .defaultBorderStyle.bottomBorder {\n  border-bottom-color: #cccccc;\n  bottom: 0px;\n}\n.reactTableComponent .tableContainer .reactTable .tableCell.headerCell.rowDimHeader .defaultBorderStyle.topBorder,\n.reactTableComponent .tableContainer .reactTable .tableCell.headerCell.attributeRowDimHeader .defaultBorderStyle.topBorder {\n  border-bottom-color: #3f5161;\n  top: 0px;\n}\n.reactTableComponent .tableContainer .reactTable .tableCell.headerCell.colDimHeader .defaultBorderStyle.bottomBorder,\n.reactTableComponent .tableContainer .reactTable .tableCell.headerCell.colDimMember .defaultBorderStyle.bottomBorder,\n.reactTableComponent .tableContainer .reactTable .tableCell.headerCell.attributeColDimMember .bottomBorder {\n  border-bottom-color: #3f5161;\n}\n.reactTableComponent .tableContainer .reactTable .tableCell.headerCell.colDimMember.dimensionMember.CategoryAC .defaultBorderStyle.bottomBorder {\n  height: 5px;\n  background-color: #3f5161;\n  bottom: 0px;\n}\n.reactTableComponent .tableContainer .reactTable .tableCell.headerCell.colDimMember.dimensionMember.CategoryFC .defaultBorderStyle.bottomBorder,\n.reactTableComponent .tableContainer .reactTable .tableCell.headerCell.colDimMember.dimensionMember.CategoryRF .defaultBorderStyle.bottomBorder {\n  bottom: 0px;\n  height: 5px;\n  border: 1px solid #3f5161;\n  background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXR0ZXJuIGlkPSJoYXRjaGluZzEtc3ZnLXBhdHRlcm4tIiBoZWlnaHQ9IjYiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHdpZHRoPSI2Ij48cmVjdCB3aWR0aD0iNiIgaGVpZ2h0PSI2IiBmaWxsPSIjRkZGRkZGIj48L3JlY3Q+PHBhdGggZD0iTS0xLDEgbDIsLTIgTTAsNiBsNiwtNiBNNSw3IGwyLC0yIiBzdHJva2U9InJnYig2Myw4MSw5NykiIHN0cm9rZS13aWR0aD0iMSI+PC9wYXRoPjwvcGF0dGVybj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2hhdGNoaW5nMS1zdmctcGF0dGVybi0pIj48L3JlY3Q+PC9zdmc+);\n}\n.reactTableComponent .tableContainer .reactTable .tableCell.headerCell.colDimMember.dimensionMember.CategoryPL .defaultBorderStyle.bottomBorder {\n  bottom: 0px;\n  height: 5px;\n  border: 1px solid #3f5161;\n  background-color: transparent;\n}\n.reactTableComponent .tableContainer .reactTable .tableCell .tableCellHyperlink {\n  color: #0070b1;\n  text-decoration: none;\n  cursor: pointer;\n}\n.reactTableComponent .tableContainer .reactTable .tableCell .tableCellHyperlink:hover {\n  text-decoration: underline;\n}\n.reactTableComponent .tableContainer .reactTable .tableCell.readOnly {\n  color: #999999;\n  fill: #999999;\n}\n.reactTableComponent .tableContainer .reactTable .chartCell > svg {\n  /* Horizontally align in-cell charts to be able to adjust their horizontal padding */\n  display: block;\n}\n.reactTableComponent .tableContainer .reactTable .totals {\n  font-weight: bold;\n}\n.reactTableComponent .tableContainer .reactTable .headerCell.colDimHeader,\n.reactTableComponent .tableContainer .reactTable .headerCell.rowDimHeader {\n  font-weight: bold;\n}\n.reactTableComponent .tableContainer .reactTable .headerCell.attributeColDimMember,\n.reactTableComponent .tableContainer .reactTable .headerCell.attributeRowDimMember {\n  font-style: italic;\n}\n.reactTableComponent .tableContainer .reactTable .headerCell.attributeColDimHeader,\n.reactTableComponent .tableContainer .reactTable .headerCell.attributeRowDimHeader {\n  font-weight: normal;\n  font-style: italic;\n}\n.reactTableComponent .tableContainer .reactTable .headerCell.colDimHeader,\n.reactTableComponent .tableContainer .reactTable .headerCell.colDimMember,\n.reactTableComponent .tableContainer .reactTable .headerCell.newLine {\n  text-align: right;\n  justify-content: flex-end;\n}\n.reactTableComponent .tableContainer .reactTable .headerCell.cellWithIcons {\n  font-weight: normal;\n  font-style: normal;\n  justify-content: flex-start;\n}\n.reactTableComponent .tableContainer .reactTable .headerCell.cellWithIcons .cellValue {\n  align-items: center;\n  display: flex;\n  box-sizing: border-box;\n}\n.reactTableComponent .tableContainer .reactTable .headerCell.cellWithIcons.rowDimHeader .cellValue {\n  font-weight: bold;\n  justify-content: flex-start;\n}\n.reactTableComponent .tableContainer .reactTable .headerCell.cellWithIcons.colDimHeader .cellValue {\n  font-weight: bold;\n  justify-content: flex-end;\n}\n.reactTableComponent .tableContainer .reactTable .headerCell.cellWithIcons.colDimMember .cellValue {\n  justify-content: flex-end;\n}\n.reactTableComponent .tableContainer .reactTable .headerCell.cellWithIcons.attributeColDimHeader .cellValue,\n.reactTableComponent .tableContainer .reactTable .headerCell.cellWithIcons.attributeRowDimHeader .cellValue {\n  font-weight: normal;\n  font-style: italic;\n}\n.reactTableComponent .tableContainer .reactTable .headerCell.cellWithIcons.attributeColDimMember .cellValue,\n.reactTableComponent .tableContainer .reactTable .headerCell.cellWithIcons.attributeRowDimMember .cellValue {\n  font-style: italic;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 2px 8px;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n  position: absolute;\n  display: flex;\n  align-items: center;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell:before {\n  display: none;\n  content: none;\n  width: calc(100% - 1px);\n  height: calc(100% - 1px);\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell a:link {\n  color: #0070b1;\n  text-decoration: none;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell a:link:visited {\n  color: #0070b1;\n  text-decoration: none;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell a:link:hover {\n  color: #0070b1;\n  text-decoration: underline;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.dataCell {\n  text-align: right;\n  justify-content: flex-end;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.cellInHierarchy {\n  padding-top: 0px;\n  padding-left: 0px;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.locked,\n.reactTableComponent .tableContainer .reactTable .tableDivCell.referenceToLockedCell {\n  background-color: #f0f0f0;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.referencedCell {\n  background-color: rgba(255, 170, 73, 0.3);\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.noHorizontalPadding {\n  padding-left: 0px;\n  padding-right: 0px;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell .icon.nextToCellValue {\n  padding-right: 4px;\n  float: left;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell .icon.thresholdIcon {\n  line-height: 1rem;\n  font-size: 1rem;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell .icon.hierarchyIcon {\n  width: 16px;\n  display: inline-block;\n  font-size: 0.75rem;\n  text-align: left;\n  vertical-align: bottom;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell .icon.hierarchyIcon.floatingIcon {\n  float: left;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell .icon.hierarchyIconMobile {\n  width: 20px;\n  display: inline-block;\n  font-size: 1rem;\n  text-align: left;\n  vertical-align: bottom;\n  font-weight: 400;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell .icon.hierarchyIconMobile.floatingIcon {\n  float: left;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell .icon.dataLocking {\n  font-size: 0.75rem;\n  color: #acacad;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell .icon.validationWarning {\n  font-size: 0.75rem;\n  color: #f9a429;\n  line-height: 16px;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell .cellEditor {\n  overflow: visible;\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.unbooked svg {\n  position: absolute;\n  top: 0;\n  left: 5px;\n  width: calc(100% - 10px);\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.unbooked svg line {\n  stroke: #e6e7e8;\n  stroke-width: 1px;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.editing {\n  overflow: visible;\n  padding: 0 !important;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.commentCell {\n  text-align: left;\n  justify-content: flex-start;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.rowDimHeader,\n.reactTableComponent .tableContainer .reactTable .tableDivCell.attributeRowDimHeader {\n  text-align: left;\n  justify-content: flex-start;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.colDimHeader {\n  text-align: right;\n  justify-content: flex-end;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.coordinateHeader {\n  width: 55px;\n  vertical-align: middle;\n  justify-content: center;\n  font-size: 12px;\n  background-color: #f7f7f7;\n  color: #58595b;\n  text-align: center;\n  padding: 2px 0;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.coordinateHeader.coordinateHeaderColumn,\n.reactTableComponent .tableContainer .reactTable .tableDivCell.coordinateHeader.coordinateCorner {\n  border-bottom: 1px solid #cccccc;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.coordinateHeader.coordinateHeaderRow,\n.reactTableComponent .tableContainer .reactTable .tableDivCell.coordinateHeader.coordinateCorner {\n  border-right: 1px solid #cccccc;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.coordinateHeader.coordinateHeaderSelectedDesign {\n  color: white;\n  background-color: #f26d1a;\n  border-color: #d85a0c;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.coordinateHeader.coordinateHeaderSelectedView {\n  color: white;\n  background-color: #427cac;\n  border-color: #37678f;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.rowDimMember {\n  text-align: left;\n  justify-content: flex-start;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.colDimMember.cellInHierarchy {\n  vertical-align: top !important;\n  align-items: flex-start !important;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.colDimMember.cellInHierarchy .textOverflow {\n  vertical-align: top !important;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell .showEllipsis,\n.reactTableComponent .tableContainer .reactTable .tableDivCell .showEllipsis a {\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell .textOverflow {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  vertical-align: middle;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell .colSelection {\n  position: absolute;\n  width: 100%;\n  height: 10px;\n  background: transparent;\n  top: 0;\n  left: 0;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell .rowSelection {\n  position: absolute;\n  width: 10px;\n  height: 100%;\n  background: transparent;\n  top: 0;\n  left: 0;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.modified {\n  background-color: #fdf1cc !important;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.modifiedMDE {\n  background-color: #ebf2f7 !important;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell .cutOffContent {\n  width: 100%;\n  justify-content: inherit;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.chartCell {\n  align-items: center;\n  justify-content: center;\n}\n.reactTableComponent .tableContainer .reactTable .tableDivCell.cellWithIcons {\n  justify-content: flex-start;\n}\n.reactTableComponent .tableContainer .reactTable .cellValue {\n  flex: 1;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  cursor: inherit;\n}\n.reactTableComponent .tableContainer .reactTable.columnsSelected .coordinateHeaderRow.coordinateHeader.coordinateHeaderSelectedView,\n.reactTableComponent .tableContainer .reactTable.columnsSelected .coordinateHeaderRow.coordinateHeader.coordinateHeaderSelectedDesign {\n  background-color: #89919A;\n  border-color: #5E696E;\n}\n.reactTableComponent .tableContainer .reactTable.rowsSelected .coordinateHeaderColumn.coordinateHeader.coordinateHeaderSelectedView,\n.reactTableComponent .tableContainer .reactTable.rowsSelected .coordinateHeaderColumn.coordinateHeader.coordinateHeaderSelectedDesign {\n  background-color: #89919A;\n  border-color: #5E696E;\n}\n.reactTableComponent .tableContainer .columnResizer {\n  position: absolute;\n  width: 5px;\n  height: 100%;\n  top: 0;\n  z-index: 98;\n  cursor: col-resize;\n}\n.reactTableComponent .tableContainer .columnResizeIndicator {\n  display: none;\n  border-left: 1px dashed #000;\n  width: 5px;\n  height: 100%;\n  top: 0;\n  position: absolute;\n  box-sizing: border-box;\n  z-index: 99;\n}\n.reactTableComponent .tableContainer .rowColOverlay {\n  position: absolute;\n  display: none;\n  background-color: rgba(169, 198, 222, 0.2);\n  pointer-events: none;\n}\n.reactTableComponent .tableContainer .overlayBorder {\n  z-index: 98;\n}\n.reactTableComponent .tableContainer .overlay {\n  z-index: 96;\n}\n.reactTableComponent .tableContainer .htmlTableWrapper.showGrid .tableDivCell {\n  border: 1px solid #e6e7e8;\n  border-width: 0 1px 1px 0;\n}\n.reactTableComponent .tableContainer .htmlTableWrapper.showGrid .freezeSectiontopLeft .tableDivCell:first-child,\n.reactTableComponent .tableContainer .htmlTableWrapper.showGrid .freezeSectionbottomLeft .tableDivCell:first-child {\n  border-left-width: 1px;\n}\n.reactTableComponent .tableContainer .htmlTableWrapper.showGrid .freezeSectiontopLeft .reactTable:not(.titleVisible) .tableDivRow:first-child .tableDivCell,\n.reactTableComponent .tableContainer .htmlTableWrapper.showGrid .freezeSectiontopRight .reactTable:not(.titleVisible) .tableDivRow:first-child .tableDivCell {\n  border-top-width: 1px;\n}\n.reactTableComponent .titleWrapper {\n  position: relative;\n  box-sizing: border-box;\n  display: flex;\n  align-items: flex-start;\n  flex-direction: column;\n  justify-content: center;\n  padding: 4px 1px;\n  /* contributes to CONSTANTS.TITLE_PADDING_HORIZONTAL and CONSTANTS.TITLE_PADDING_VERTICAL */\n  cursor: default;\n}\n.reactTableComponent .titleWrapper.selected {\n  border: 1px solid #3b6f9a;\n  padding: 3px 0px;\n}\n.reactTableComponent .titleWrapper.editing .sapReportEngineTokenContainer,\n.reactTableComponent .titleWrapper.editing .sapReportEngineTitle {\n  display: none;\n}\n.reactTableComponent .titleWrapper:hover .titleOverlay {\n  background-color: rgba(249, 187, 149, 0.2);\n  pointer-events: none;\n}\n.reactTableComponent .titleWrapper .titleOverlay {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n}\n.reactTableComponent .titleWrapper .sapReportEngineTitle {\n  font-size: 16px;\n  /* Defaults.FONT_SIZE_TITLE */\n  color: #333;\n  padding: 0 4px;\n  /* contributes to CONSTANTS.TITLE_PADDING_HORIZONTAL */\n}\n.reactTableComponent .titleWrapper .sapReportEngineTokenContainer {\n  margin-top: -4px;\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  box-sizing: border-box;\n  padding: 0 4px;\n  height: 100%;\n  width: 100%;\n  color: #0070b1;\n}\n.reactTableComponent .titleWrapper .sapReportEngineTokenContainer .titleToken {\n  white-space: nowrap;\n}\n.reactTableComponent .titleWrapper .sapReportEngineTokenContainer .sapReportEngineToken {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  min-height: 20px;\n  margin-top: 4px;\n}\n.reactTableComponent .titleWrapper .sapReportEngineTokenContainer .sapReportEngineToken .sapReportEngineDatasetIcon {\n  width: 15px;\n}\n.reactTableComponent .titleWrapper .sapReportEngineTokenContainer .sapReportEngineTokenSeparator {\n  display: inline;\n  width: 1px;\n  height: 20px;\n  margin-left: 5px;\n  margin-right: 5px;\n  border-left: 1px solid rgba(63, 81, 97, 0.2);\n  padding-left: 1px;\n  padding-right: 1px;\n}\n.reactTableComponent .titleWrapper .titleEditor {\n  overflow: visible;\n}\n.reactTableComponent .titleWrapper .titleEditor .CodeMirror {\n  box-shadow: none;\n  font-weight: 400;\n  border: none;\n}\n.reactTableComponent .titleWrapper .titleEditor .CodeMirror .CodeMirror-sizer {\n  box-shadow: 1px 1px 4px 0px rgba(0, 10, 26, 0.1);\n}\n.reactTableComponent .resizeInfo {\n  font-size: 12px;\n  line-height: 20px;\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 20px;\n  width: 50px;\n  vertical-align: middle;\n  text-align: center;\n  border: 1px solid #000000;\n  background-color: #ffffff;\n  border-radius: 4px;\n  margin-left: 1px;\n}\n.reactTableComponent .rowResizeIndicator,\n.reactTableComponent .titleResizeIndicator {\n  display: none;\n  border-top: 1px dashed #000;\n  width: 100%;\n  height: 5px;\n  left: 0;\n  position: absolute;\n  box-sizing: border-box;\n  z-index: 99;\n}\n.reactTableComponent .selected .titleResizeIndicator {\n  margin-top: -1px;\n}\n.reactTableComponent .rowResizer {\n  position: absolute;\n  height: 5px;\n  width: 100%;\n  left: 0px;\n  z-index: 98;\n  cursor: row-resize;\n}\n.reactTableComponent .titleResizer {\n  position: absolute;\n  height: 5px;\n  width: 100%;\n  left: 0px;\n  z-index: 98;\n  cursor: row-resize;\n  bottom: 0;\n}\n.reactTableComponent .resizing.titleResizer,\n.reactTableComponent .resizing.rowResizer,\n.reactTableComponent .resizing.columnResizer {\n  cursor: default;\n}\n.reactTableComponent .freezeLine {\n  background: #a5a7a9;\n  z-index: 97;\n}\n.reactTableComponent .sacGridCellIcon {\n  padding: 0 2px;\n  width: 16px;\n  height: 16px;\n  box-sizing: border-box;\n  cursor: pointer;\n}\n.reactTableComponent .sacGridCellIcon.sacGridCellIconRightFirst {\n  margin-left: auto;\n}\n.reactTableComponent .tableDivCell:hover .sacGridCellDragHandle {\n  background-color: #8080804d;\n  display: block;\n  color: #2d2d2d;\n}\n.reactTableComponent .sacGridCellDragHandle {\n  z-index: 103;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 10px;\n  text-align: center;\n  line-height: 10px;\n  border-radius: 3px;\n  font-size: 10px;\n  color: transparent;\n  cursor: grab;\n  display: none;\n}\n.reactTableComponent .sacGridCellDragHandle:active {\n  cursor: grabbing;\n}\n.reactTableComponent .sacGridCellDropArea {\n  display: none;\n  position: absolute;\n  z-index: 102;\n  box-sizing: border-box;\n}\n.reactTableComponent .sacGridCellDropArea.dropAreaFocused {\n  background-color: rgba(0, 112, 177, 0.05);\n  border: 1px solid #427cac;\n}\n.reactTableComponent .sacGridCellDropArea.sacGridRowsDropAreas {\n  width: 50%;\n  height: 100%;\n  top: 0;\n}\n.reactTableComponent .sacGridCellDropArea.sacGridRowsDropAreas.sacGridCellDropAreaLeft {\n  left: 0;\n}\n.reactTableComponent .sacGridCellDropArea.sacGridRowsDropAreas.sacGridCellDropAreaRight {\n  right: 0;\n}\n.reactTableComponent .sacGridCellDropArea.sacGridColumnsDropAreas {\n  width: 100%;\n  height: 50%;\n  left: 0;\n}\n.reactTableComponent .sacGridCellDropArea.sacGridColumnsDropAreas.sacGridCellDropAreaLeft {\n  top: 0;\n}\n.reactTableComponent .sacGridCellDropArea.sacGridColumnsDropAreas.sacGridCellDropAreaRight {\n  bottom: 0;\n}\n.reactTableComponent .emptyAxisDropArea {\n  display: none;\n  position: absolute;\n  z-index: 102;\n  box-sizing: border-box;\n  top: 0;\n  left: 0;\n  height: 100%;\n  width: 100%;\n}\n.reactTableComponent .emptyAxisDropArea .emptyAxisRowSwapIcon,\n.reactTableComponent .emptyAxisDropArea .emptyAxisColumnSwapIcon {\n  padding-left: 4px;\n  display: none;\n  font-size: 1rem;\n  pointer-events: none;\n  color: #427cac;\n}\n.reactTableComponent .emptyAxisDropArea.dropAreaFocused {\n  background-color: rgba(0, 112, 177, 0.05);\n  border: 1px solid #427cac;\n}\n.reactTableComponent .emptyAxisDropArea.dropAreaFocused .emptyAxisRowSwapIcon,\n.reactTableComponent .emptyAxisDropArea.dropAreaFocused .emptyAxisColumnSwapIcon {\n  display: block;\n}\n.tableContainer.draggingInProcess .sacGridCellDropArea {\n  display: block;\n}\n.tableContainer.draggingInProcess .emptyAxisDropArea {\n  display: flex;\n  align-items: center;\n}\n.loadingArea {\n  pointer-events: none;\n  opacity: 0;\n  position: absolute;\n  background: rgba(255, 255, 255, 0.2);\n}\n.loadingArea .loadingIndicatorGif {\n  width: 40px;\n  height: 20px;\n  position: absolute;\n}\n',""]);const i=r},16:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(645),r=n.n(o)()((function(e){return e[1]}));r.push([e.id,".freezeLine {\n  pointer-events: none;\n  position: absolute;\n}\n.freezeLine.verticalFreezeLine {\n  width: 2px;\n}\n.freezeLine.horizontalFreezeLine {\n  height: 2px;\n}\n",""]);const i=r},24:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(645),r=n.n(o)()((function(e){return e[1]}));r.push([e.id,".scrollbarContainer {\n  background: transparent;\n  position: absolute;\n  overflow: scroll;\n  z-index: 100;\n}\n.scrollbarContainer.vertical {\n  height: calc(100% -  12px);\n  width: 12px;\n  right: 0;\n  top: 0;\n  overflow-x: hidden;\n}\n.scrollbarContainer.horizontal {\n  width: calc(100% -  12px);\n  height: 12px;\n  bottom: 0;\n  left: 0;\n  overflow-y: hidden;\n}\n.scrollableSize {\n  position: relative;\n  border-radius: 2px;\n  min-height: 12px;\n  min-width: 12px;\n}\n",""]);const i=r}},n={};function o(e){var r=n[e];if(void 0!==r)return r.exports;var i=n[e]={id:e,exports:{}};return t[e](i,i.exports,o),i.exports}o.m=t,e=[],o.O=(t,n,r,i)=>{if(!n){var l=1/0;for(c=0;c<e.length;c++){for(var[n,r,i]=e[c],a=!0,s=0;s<n.length;s++)(!1&i||l>=i)&&Object.keys(o.O).every((e=>o.O[e](n[s])))?n.splice(s--,1):(a=!1,i<l&&(l=i));a&&(e.splice(c--,1),t=r())}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[n,r,i]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={179:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var r,i,[l,a,s]=n,c=0;for(r in a)o.o(a,r)&&(o.m[r]=a[r]);if(s)var d=s(o);for(t&&t(n);c<l.length;c++)i=l[c],o.o(e,i)&&e[i]&&e[i][0](),e[l[c]]=0;return o.O(d)},n=self.webpackChunkSACGridRendering=self.webpackChunkSACGridRendering||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var r=o.O(void 0,[736],(()=>o(497)));r=o.O(r),window.SACGridRendering=r})();