// Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/Core","sap/ui/core/Manifest","sap/base/Log"],function(e,t,a){"use strict";var r={_getDataSourcePromise:null};var n="sap.ushell_abap.integration.fileshares.AppRuntimeFileShareSupport";var i="FileShare";var o="manage";var s="/sap/bc/ui2/start_up?so="+i+"&action="+o+"&systemAliasesFormat=object&formFactor=desktop&shellType=FLP&depth=0";r.getDataSource=function(){var i=r._getClient();var o=s+"&sap-client="+i;if(!i){a.error("Could not determine sap-client parameter.",null,n);return Promise.reject(new Error("Could not determine sap-client parameter."))}if(!r._getDataSourcePromise){r._getDataSourcePromise=fetch(o,{method:"GET",headers:{"Content-Type":"application/json; utf-8",Accept:"application/json","Accept-Language":e.getConfiguration().getLanguageTag()}}).then(function(e){if(e.ok===false){a.error("Could not fetch data, request failed","error: "+e.status+", "+e.statusText+",\nurl: "+o,n);return Promise.reject(e.statusText)}return e.json()}).then(function(e){if(e&&e.targetMappings&&Object.keys(e.targetMappings).length>0){var r=e.targetMappings[Object.keys(e.targetMappings)[0]].applicationDependencies;if(r){var i;try{i=JSON.parse(r).manifest}catch(t){a.error("Could not parse JSON data of applicationDependencies for targetMapping '"+Object.keys(e.targetMappings)[0]+"': "+t.message,null,n)}if(i){return t.load({manifestUrl:i,async:true})}}}var o=["No manifest URL defined:",JSON.stringify(e)].join(" ");a.error(o,null,n);throw new Error(o)}).then(function(e){return e.getEntry("/sap.app/dataSources/mainService")})}return r._getDataSourcePromise};r._getClient=function(){var e=document.getElementsByTagName("meta")["sap-client"];return e&&e.content};return r});
//# sourceMappingURL=AppRuntimeFileShareSupport.js.map