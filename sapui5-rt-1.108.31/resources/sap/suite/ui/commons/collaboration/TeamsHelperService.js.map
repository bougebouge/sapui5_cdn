{"version":3,"file":"TeamsHelperService.js","names":["sap","ui","define","Log","Core","URLListValidator","CollaborationHelper","BaseHelperService","Element","Device","TeamsHelperService","extend","COLLABORATION_MSTEAMS_APPID","oLogger","getLogger","oResourceBundle","getLibraryResourceBundle","prototype","getOptions","oParams","oDefaultParams","isShareAsLinkEnabled","isShareAsTabEnabled","oTeamsParams","aOptions","aFinalOptions","system","desktop","this","_providerConfig","push","text","getText","key","icon","fesrStepName","info","_isShareAsTabEnabled","length","type","subOptions","share","oOption","url","error","validate","_shareAsChat","_shareAsTab","newWindow","window","open","sMessage","appTitle","subTitle","opener","minifyUrlForChat","compactHash","then","sShortURL","sModifiedUrl","_modifyUrlForNavigationContext","location","encodeURIComponent","bind","oUshellContainer","ushell","Container","oURLParsing","getService","sAppUri","iIndexOfHash","indexOf","sUriForHeaderLess","substring","iIndexOfQuestionMark","sParam","oHashPartOfUri","parseShellHash","params","sHashOfUri","constructShellHash","oData","subEntityId","mode","_getApplicationID","teamsAppId","sURL","JSON","stringify","m","URLHelper","redirect","iParamsCount","Object","keys","oUrl","URL","searchParams","has","set","delete","toString","_getCurrentUrl","sCurrentUrl","sBeforeHashURL","split","oParsedUrl","parseParameters","Promise","resolve","renderers","fiori2","componentData","config","sapHorizonEnabled"],"sources":["TeamsHelperService-dbg.js"],"mappings":"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"}