/*
 * ! SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.define(["sap/apf/ui/utils/printView","sap/apf/ui/utils/formatter","sap/viz/ui5/types/legend/Common","sap/base/util/isEmptyObject","sap/ui/thirdparty/jquery"],function(t,e,i,n,jQuery){"use strict";sap.apf.ui.utils.Print=function(t){"use strict";var e=t.oCoreApi;var i=t.uiApi;var a=null;var r=new sap.apf.ui.utils.PrintModel(t);var o=new sap.apf.ui.utils.PrintView(t,r);this.oPrintLayout={};function s(t){if(!n(t.oPrintLayout)){t.oPrintLayout.removeContent()}jQuery("#apfPrintArea").remove();jQuery("body").append('<div id="apfPrintArea"></div>');i.createApplicationLayout(false).then(function(t){t.setBusy(true)})}this.doPrint=function(t){t=t||0;e.getApplicationConfigProperties().done(function(i){r.setApplicationConfig(i);var n,u,p;var d=2e3,f=this;r.nStepRenderCount=0;a=e.getSteps();r.nNoOfSteps=a.length;this.oPrintLayout=new sap.ui.layout.VerticalLayout({id:"idAPFPrintLayout"});s(this);p=new sap.ui.layout.VerticalLayout({id:"idAPFPrintFirstPageLayout",content:[o.getHeaderForFirstPage(),o.getPrintLayoutForFacetFiltersAndFooters()]}).addStyleClass("filterLayout");this.oPrintLayout.addContent(p);for(n=0;n<a.length;n++){u=parseInt(n,10)+1;this.oPrintLayout.addContent(o.getPrintLayoutForEachStep(a[n],u,a.length))}this.oPrintLayout.placeAt("apfPrintArea");l(f.oPrintLayout,d,t)}.bind(this))};function l(t,e,n){new Promise(function(t){setTimeout(function(){t()},e)}).then(function(){d(t);if(n==1){p(n)}else{p()}u(t);return i.createApplicationLayout(false)}).then(function(t){t.setBusy(false)})}function u(t){var e,i;var n,r;for(var o=0;o<jQuery("#apfPrintArea").siblings().length;o++){jQuery("#apfPrintArea").siblings()[o].hidden=false}for(var s=0;s<a.length;s++){e=a[s].getSelectedRepresentation();e=e.bIsAlternateView?e.toggleInstance:e;if(e&&e.titleControl&&e.titleControl.oParent){n=e.titleControl.oParent.getItems();if(n&&n.length>1){for(var l=0;l<n.length;l++){if(n[l].getMetadata()._sClassName==="sap.m.HBox"){r=n[l];r.setVisible(true)}}}}if(e.type!==sap.apf.ui.utils.CONSTANTS.representationTypes.TREE_TABLE_REPRESENTATION&&e.type!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){i=t.getContent()[s+1].getContent()[1].getContent()[0];i.destroy();i=null}}t.destroy();t=null;jQuery("div[id^=idAPFStepLayout]").remove();jQuery("#apfPrintArea").remove()}function p(t){t=t||0;var e=sap.ui.Device.system.tablet;var i=sap.ui.Device.os.ios;if(e===true&&i===true){var n=jQuery("html").clone();var a=jQuery(n).find("body");jQuery(a).children("div").each(function(t,e){if(jQuery(e).attr("id")==="apfPrintArea"){jQuery(e).show()}else{jQuery(e).remove()}});jQuery(jQuery(n).find("body")).html(jQuery(a.html()));var r="<html>"+jQuery(n).html()+"</html>";var o=window.open("","_blank","width=300,height=300");o.opener=null;o.document.write(r);o.print()}else{if(t==0){var s=window.open("","_blank","height=600,width=700");var l=document.getElementById("apfPrintArea").innerHTML;s.opener=null;s.document.write("<html><head><title>Analysis Path Framework</title>");s.document.write("</head><body >");s.document.write(l);s.document.write("</body></html>");s.document.close();s.print();s.close()}else{window.print()}}}function d(t){var e=t.getDomRef();jQuery("#apfPrintArea").empty();jQuery("#apfPrintArea").append(jQuery(e).html());for(var i=0;i<jQuery("#apfPrintArea").siblings().length;i++){jQuery("#apfPrintArea").siblings()[i].hidden=true}}}});
//# sourceMappingURL=print.js.map