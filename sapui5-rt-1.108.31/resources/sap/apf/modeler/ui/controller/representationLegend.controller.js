/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2018 SAP SE. All rights reserved
 */
sap.ui.define(["sap/apf/modeler/ui/controller/representationDimension.controller","sap/apf/modeler/ui/utils/textManipulator"],function(e,t){"use strict";return e.extend("sap.apf.modeler.ui.controller.representationLegend",{getAllPropertiesAsPromise:function(){var e=this,r,a,o,n,i=[];var s=e.oStepPropertyMetadataHandler.oStep;var d=sap.apf.modeler.ui.utils.CONSTANTS;var p=jQuery.Deferred();e.oStepPropertyMetadataHandler.getEntityTypeMetadataAsPromise().done(function(l){s.getConsumablePropertiesForRepresentation(e.oRepresentation.getId()).done(function(s){r=s.consumable;r.forEach(function(t){if(e.oStepPropertyMetadataHandler.getPropertyMetadata(l,t)){n=e.oStepPropertyMetadataHandler.getPropertyMetadata(l,t)["aggregation-role"];if(n===d.aggregationRoles.DIMENSION){i.push(t)}}});a=e.getSelectedProperty();if(a!==e.oTextReader("none")&&a!==undefined){o=i.indexOf(a)!==-1?i:i.concat(a);i=s.available.indexOf(a)!==-1?o:i.concat(t.addPrefixText([a],e.oTextReader));a=s.available.indexOf(a)!==-1?a:t.addPrefixText([a],e.oTextReader)[0]}i.splice(0,0,e.oTextReader("none"));p.resolve({aAllProperties:i,sSelectedKey:a})})});return p.promise()},removeProperties:function(){var e=this;e.getView().getViewData().oRepresentationHandler.getActualLegends().forEach(function(t){e.oRepresentation.removeDimension(t.sProperty)})},enableDisableLabelDisplayOptionTypeAsPromise:function(){var e=jQuery.Deferred();var r,a=this;var o=a.byId("idLabelDisplayOptionType");var n=t.removePrefixText(a.byId("idPropertyType").getSelectedKey(),a.oTextReader(sap.apf.modeler.ui.utils.CONSTANTS.texts.NOTAVAILABLE));a.oStepPropertyMetadataHandler.getEntityTypeMetadataAsPromise().done(function(t){var i=a.oStepPropertyMetadataHandler.hasTextPropertyOfDimension(t,n);if(n===a.oTextReader("none")){o.setEnabled(false);e.resolve();return}o.setEnabled(true);for(r=0;r<o.getItems().length;r++){o.getItems()[r].setEnabled(true);if(r>0&&!i){o.getItems()[r].setEnabled(false)}}e.resolve()});return e.promise()},addPropertyAsPromise:function(){var e=jQuery.Deferred();var t=this,r,a=[];var o=t.oStepPropertyMetadataHandler.oStep;var n=sap.apf.modeler.ui.utils.CONSTANTS;t.oStepPropertyMetadataHandler.getEntityTypeMetadataAsPromise().done(function(i){o.getConsumablePropertiesForRepresentation(t.oRepresentation.getId()).done(function(o){o.consumable.forEach(function(e){if(t.oStepPropertyMetadataHandler.getPropertyMetadata(i,e)){r=t.oStepPropertyMetadataHandler.getPropertyMetadata(i,e)["aggregation-role"];if(r===n.aggregationRoles.DIMENSION){a.push(e)}}});t.getView().fireEvent(n.events.ADDPROPERTY,{sProperty:a[0],sContext:t.getView().getViewData().oPropertyTypeData.sContext});t.oConfigurationEditor.setIsUnsaved();e.resolve()})});return e.promise()}})});
//# sourceMappingURL=representationLegend.controller.js.map