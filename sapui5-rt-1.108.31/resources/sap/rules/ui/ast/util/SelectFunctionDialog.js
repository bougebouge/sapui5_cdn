sap.ui.define(["sap/ui/core/Control","sap/m/List","sap/ui/model/json/JSONModel","sap/rules/ui/ast/constants/Constants","sap/rules/ui/parser/infrastructure/util/utilsBase"],function(e,t,a,s,n){"use strict";var i;var o=function(){this.oBundle=sap.ui.getCore().getLibraryResourceBundle("sap.rules.ui.i18n");this.functionLabelDisplay="";this.functionLabel="";this._selectFunctionSelected="";this._whereExpressionId="";this.dataObjectId="";this._count=0;this.dataObjectLabel="";this.dataObjectIdSelected="";this.enableCountField=true;this.sortOrder=[{name:s.NOSORT,label:this.oBundle.getText("no_sorting")},{name:s.SORTASC,label:this.oBundle.getText("sort_ascending")},{name:s.SORTDESC,label:this.oBundle.getText("sort_descending")}];this.selectedData=[{attributeSelected:"",sortOrder:s.NOSORT,cancelButton:false,addButton:true}];this.enabledData={enabled:false};this.dataObjectIdData={dataObjectId:""}};o.prototype._filterSelectFunction=function(e){var t=[];if(e&&e.selection){for(var a=0;a<e.selection.length;a++){if(e.selection[a].name!==s.SORTASC&&e.selection[a].name!==s.SORTDESC&&e.selection[a].name!==s.BOTTOM){t.push(e.selection[a])}}return{selection:t}}};o.prototype._createFunctionSelectionDropDown=function(e,t){var a=this;e=this._filterSelectFunction(e);var n=new sap.ui.model.json.JSONModel(e);this.functionSelect=new sap.m.Select({width:"200px",selectedKey:this._selectFunctionSelected,forceSelection:false,showSecondaryValues:true,layoutData:new sap.ui.layout.GridData({span:"L3 M3 S12"}),ariaLabelledBy:t,change:function(e){a._selectFunctionSelected=e.getSource().getSelectedItem().getText();if(a._selectFunctionSelected===s.SELECT||a._selectFunctionSelected===s.FIRST){a._countField.setEnabled(false);a._countField.setValue("");a._count=""}else{a._countField.setEnabled(true)}if(a.dataObjectId&&a._selectFunctionSelected&&(a._count||a._selectFunctionSelected===s.SELECT||a._selectFunctionSelected===s.FIRST)){a.functionLabelDisplay=a._count?a._selectFunctionSelected+"("+a.dataObjectLabel+","+a._count+")":a._selectFunctionSelected+"("+a.dataObjectLabel+")";a.functionLabel=a._count?a._selectFunctionSelected+"("+a.dataObjectId+","+a._count+")":a._selectFunctionSelected+"("+a.dataObjectId+")";a.functionLabelField.setValue(a.functionLabelDisplay);if(a._selectFunctionSelected!==s.SELECT&&a._count>0||this.oModel.getData().selectionData[0].attributeSelected!==""&&a._selectFunctionSelected===s.SELECT||a._selectFunctionSelected===s.FIRST&&a.dataObjectId){this.applyButton.setEnabled(true)}else{this.applyButton.setEnabled(false)}this.astExpressionBasicForWhere.setEditable(true)}else{this.applyButton.setEnabled(false);this.astExpressionBasicForWhere.setEditable(false);this.astExpressionBasicForWhere.setValue("");this.functionLabelField.setValue("")}}.bind(this)}).addStyleClass("sapAstExpressionDialogField");this.functionSelect.setModel(n);this.functionSelect.bindItems({path:"/selection",template:new sap.ui.core.ListItem({text:"{name}",key:"{name}",additionalText:"{label}"})});return this.functionSelect};o.prototype._getAttributeAstExpressionBasic=function(e){var t=this;this.astExpressionBasicForAttribute=new sap.rules.ui.AstExpressionBasic({astExpressionLanguage:this._oAstExpressionLanguage,enableAggregateFunctionWhereClause:true,value:"{attributeSelected}",dataObjectInfo:"{/dataObjectIdData/dataObjectId}",isAttributeContext:true,editable:"{/enabledData/enabled}",ariaLabelledBy:e,change:function(e){var a=parseInt(e.getSource().getBindingContext().sPath.split("/")[2]);t._AttributeExpressionId=e.getParameter("newValue");var n=t.oModel.getData().selectionData;if(this._attributeAlreadySelected(n)){e.oSource.setValueState("Error");e.oSource.setValueStateText(this.oBundle.getText("duplicateAttribute"))}else{e.oSource.setValueState("None")}if(t._AttributeExpressionId){n[a].attributeSelected=t._AttributeExpressionId.trim()}var i=t._setDataObjectInfoForWhereConditionAutoSuggestion();t.astExpressionBasicForWhere.setDataObjectInfo(i);if(t._selectFunctionSelected!==s.SELECT&&t._count>0||this.oModel.getData().selectionData[0].attributeSelected!==""&&t._selectFunctionSelected===s.SELECT||t._selectFunctionSelected===s.FIRST&&t.dataObjectId){this.applyButton.setEnabled(true)}else{this.applyButton.setEnabled(false)}this.astExpressionBasicForWhere.setValue("");this._whereExpressionId=""}.bind(this)});this.astExpressionBasicForAttribute.addStyleClass("sapAstExpressionDialog");return this.astExpressionBasicForAttribute};o.prototype._attributeAlreadySelected=function(e){var t=0;for(var a in e){if(e[a].attributeSelected.trim()===this._AttributeExpressionId.trim()){t++}}if(t>1){return true}return false};o.prototype._tableColumnsFactory=function(e,t){var a=this;var s=new sap.m.ColumnListItem({cells:[a._getAttributeAstExpressionBasic("selectAttributeLabelId"+a.selectLabelUUID),new sap.m.Select({enabled:"{/enabledData/enabled}",items:{path:"/sortOrder",template:new sap.ui.core.ListItem({key:"{name}",text:"{label}"})},change:function(e){var t=parseInt(e.getSource().getBindingContext().sPath.split("/")[2]);a._sortOrder=e.getSource().getSelectedItem().getKey();a.oModel.getData().selectionData[t].sortOrder=a._sortOrder}.bind(this),selectedKey:"{sortOrder}",width:"200px",tooltip:a.oBundle.getText("sort_attributes_tooltip")}).addStyleClass("sapAstExpressionDialogField sapAstExpressionSortSelect"),new sap.ui.layout.HorizontalLayout({content:[new sap.m.Button({type:sap.m.ButtonType.Transparent,icon:sap.ui.core.IconPool.getIconURI("sys-cancel"),visible:"{cancelButton}",enabled:"{/enabledData/enabled}",press:function(e){var t=e.getSource().getParent().getParent().getBindingContextPath().split("/")[2];this._removeColumnFromJsonModel(parseInt(t))}.bind(this)}),new sap.m.Button({type:sap.m.ButtonType.Transparent,icon:sap.ui.core.IconPool.getIconURI("add"),visible:"{addButton}",enabled:"{/enabledData/enabled}",press:function(e){var t=e.getSource().getParent().getParent().getBindingContextPath().split("/")[2];this._addColumnToJsonModel(parseInt(t))}.bind(this)})]})]});return s};o.prototype._addColumnToJsonModel=function(e){var t={attributeSelected:"",sortOrder:s.NOSORT,cancelButton:true,addButton:true};this.selectedData.splice(e+1,0,t);if(this.selectedData.length>1){this.selectedData[0].cancelButton=true}this.oModel.setData({sortOrder:this.sortOrder,selectionData:this.selectedData,enabledData:this.enabledData,dataObjectIdData:this.dataObjectIdData})};o.prototype._removeColumnFromJsonModel=function(e){this.selectedData.splice(e,1);if(this.selectedData.length===1){this.selectedData[0].cancelButton=false}this.oModel.setData({sortOrder:this.sortOrder,selectionData:this.selectedData,enabledData:this.enabledData,dataObjectIdData:this.dataObjectIdData});var t=this._setDataObjectInfoForWhereConditionAutoSuggestion();this.astExpressionBasicForWhere.setDataObjectInfo(t);this.astExpressionBasicForWhere.setValue("");this._whereExpressionId=""};o.prototype._getSuggestionsForTheGivenInput=function(e){var t=this._oAstExpressionLanguage.getTokensForGivenStringInput(e);var a=this._oAstExpressionLanguage.convertTokensToUiModelForAutoSuggestion(t);var s={};s.AttributeContext=true;s.OperationsContext=false;var n=this._oAstExpressionLanguage.getSuggesstions(a,s);return n};o.prototype._createDataObjectDropDown=function(e){var t=this;var a=this._getSuggestionsForTheGivenInput("");var n=a.autoComplete.categories;var i=new sap.ui.model.json.JSONModel(n);this.vocabularySelect=new sap.m.Select({width:"200px",selectedKey:this.dataObjectIdSelected,forceSelection:false,ariaLabelledBy:e,layoutData:new sap.ui.layout.GridData({span:"L3 M3 S12"}),change:function(e){t.dataObjectIdSelected=e.getSource().getSelectedItem().getKey();t.dataObjectId="/"+e.getSource().getSelectedItem().getKey();t.dataObjectLabel=e.getSource().getSelectedItem().getText();if(t.dataObjectId){t.oModel.getData().dataObjectIdData.dataObjectId=t.dataObjectId;t.oModel.getData().enabledData.enabled=true}this.selectedData=[{attributeSelected:"",sortOrder:s.NOSORT,cancelButton:false,addButton:true}];var a=t._setDataObjectInfoForWhereConditionAutoSuggestion();t.astExpressionBasicForWhere.setDataObjectInfo(a);if(t.dataObjectId&&t._selectFunctionSelected&&(t._count||t._selectFunctionSelected===s.SELECT||t._selectFunctionSelected===s.FIRST)){t.functionLabelDisplay=t._count?t._selectFunctionSelected+"("+t.dataObjectLabel+","+t._count+")":t._selectFunctionSelected+"("+t.dataObjectLabel+")";t.functionLabel=t._count?t._selectFunctionSelected+"("+t.dataObjectId+","+t._count+")":t._selectFunctionSelected+"("+t.dataObjectId+")";t.functionLabelField.setValue(t.functionLabelDisplay);if(t._selectFunctionSelected!==s.SELECT&&t._count>0||this.oModel.getData().selectionData[0].attributeSelected!==""&&t._selectFunctionSelected===s.SELECT||t._selectFunctionSelected===s.FIRST&&t.dataObjectId){this.applyButton.setEnabled(true)}else{this.applyButton.setEnabled(false)}this.astExpressionBasicForWhere.setValue("");this._whereExpressionId="";this.astExpressionBasicForWhere.setEditable(true)}else{this.applyButton.setEnabled(false);this.astExpressionBasicForWhere.setEditable(false);this.astExpressionBasicForWhere.setValue("");this.functionLabelField.setValue("")}t._bindAttributes()}.bind(this)}).addStyleClass("sapAstExpressionDialogField");this.vocabularySelect.setModel(i);this.vocabularySelect.bindItems({path:"/terms",template:new sap.ui.core.ListItem({text:"{label}",key:"{id}"})});var o=a.autoComplete.categories.vocabularyRules;for(var r in o){var l=new sap.ui.core.ListItem({text:o[r].label,key:o[r].id});this.vocabularySelect.addItem(l)}return this.vocabularySelect};o.prototype._bindAttributes=function(){this.oModel=new sap.ui.model.json.JSONModel;this.oModel.setData({sortOrder:this.sortOrder,selectionData:this.selectedData,enabledData:this.enabledData,dataObjectIdData:this.dataObjectIdData});this.conditionsTable.setModel(this.oModel)};o.prototype._createWhereAstExpressionBasic=function(e){var t=this;this.astExpressionBasicForWhere=new sap.rules.ui.AstExpressionBasic({astExpressionLanguage:this._oAstExpressionLanguage,enableAggregateFunctionWhereClause:true,value:this._whereExpressionId,editable:"{/value}",dataObjectInfo:this._setDataObjectInfoForWhereConditionAutoSuggestion(),ariaLabelledBy:e,change:function(e){t._whereExpressionId=e.getParameter("newValue")}.bind(this)});this.astExpressionBasicForWhere.addStyleClass("sapAstExpressionDialog");return this.astExpressionBasicForWhere};o.prototype._setDataObjectInfoForWhereConditionAutoSuggestion=function(){if(this.dataObjectId){var e=this._returnDataObjectBasedOnCommonAssociationReferenceAndType(this.dataObjectId,this._getSelectedAttributeJsons());return this._selectFunctionSelected+"("+s.FILTER+"("+e+","}};o.prototype._createFunctionLabel=function(){this.functionLabelField=new sap.m.TextArea({value:this.functionLabelDisplay,enabled:false,width:"100%"}).addStyleClass("sapAstExpressionDialogTextField");return this.functionLabelField};o.prototype._clearData=function(){this.functionLabelDisplay="";this.functionLabel="";this._selectFunctionSelected="";this._whereExpressionId="";this.dataObjectId="";this._count="";this.dataObjectLabel="";this.dataObjectIdSelected="";this.enableCountField=false;this.attributeJson={};this.sortOrder=[{name:s.NOSORT,label:this.oBundle.getText("no_sorting")},{name:s.SORTASC,label:this.oBundle.getText("sort_ascending")},{name:s.SORTDESC,label:this.oBundle.getText("sort_descending")}];this.selectedData=[{attributeSelected:"",sortOrder:s.NOSORT,cancelButton:false,addButton:true}];this.enabledData={enabled:false};this.dataObjectIdData={dataObjectId:""}};o.prototype._createTable=function(){var e=this;this.conditionsTable=new sap.m.Table({backgroundDesign:sap.m.BackgroundDesign.Solid,showSeparators:sap.m.ListSeparators.None,layoutData:new sap.ui.layout.form.GridContainerData({halfGrid:false}),columns:[new sap.m.Column({width:"50%"}).setStyleClass("sapAstAttributeColumn"),new sap.m.Column({width:"25%"}).setStyleClass("sapAstSortColumn"),new sap.m.Column({width:"20%"})]}).addStyleClass("sapAstAttributeTable");this._bindAttributes();var t=e._tableColumnsFactory();this.conditionsTable.bindItems("/selectionData",t);return this.conditionsTable};o.prototype._createCountField=function(e){var t=this;this._countField=new sap.m.TextArea({value:t._count,enabled:this.enableCountField,ariaLabelledBy:e,layoutData:new sap.ui.layout.GridData({span:"L1 M1 S12"}),change:function(e){t._count=e.getSource().getValue();if(t.dataObjectId&&t._selectFunctionSelected&&(t._count||t._selectFunctionSelected===s.SELECT||t._selectFunctionSelected===s.FIRST)){t.functionLabelDisplay=t._count?t._selectFunctionSelected+"("+t.dataObjectLabel+","+t._count+")":t._selectFunctionSelected+"("+t.dataObjectLabel+")";t.functionLabel=t._count?t._selectFunctionSelected+"("+t.dataObjectId+","+t._count+")":t._selectFunctionSelected+"("+t.dataObjectId+")";t.functionLabelField.setValue(t.functionLabelDisplay);if(t._selectFunctionSelected!==s.SELECT&&t._count>0||this.oModel.getData().selectionData[0].attributeSelected!==""&&t._selectFunctionSelected===s.SELECT||t._selectFunctionSelected===s.FIRST&&t.dataObjectId){this.applyButton.setEnabled(true)}else{this.applyButton.setEnabled(false)}this.astExpressionBasicForWhere.setEditable(true)}else{this.applyButton.setEnabled(false);this.astExpressionBasicForWhere.setEditable(false);this.astExpressionBasicForWhere.setValue("");this.functionLabelField.setValue("")}}.bind(this)}).addStyleClass("sapAstSelectCountField sapAstExpressionDialogTextField");return this._countField};o.prototype._convertFunctionLabelToText=function(e,t){this.termsProvider=this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider;var a=this.termsProvider.getTermNameFromASTNodeReference(e);t=t.replace(e,a);return t};o.prototype._createSelectFunctionDialog=function(e,t,a,n,i){var o=this;var r=0;this._clearData();this.selectLabelUUID=this._createUUId();this.oBundle=sap.ui.getCore().getLibraryResourceBundle("sap.rules.ui.i18n");this._oAstExpressionLanguage=a;if(i){this._selectFunctionSelected=i.function;this._whereExpressionId=i.filter;this.dataObjectId=i.dataObject;this.functionLabel=i.functionLabel;this.dataObjectIdSelected=i.dataObject.replace("/","");this.attributeJson=i.attributes;if(i.count){this._count=i.count;this.enableCountField=true}o.functionLabelDisplay=this._convertFunctionLabelToText(i.dataObject,i.functionLabel);if(this.dataObjectId){var l=this._returnDataObjectBasedOnCommonAssociationoReferenceSelection(i.doVocabId,i.attributes);this.attributeJson=this._addTableIdFromAttribute(i.attributes,l,this.dataObjectId);this.dataObjectIdData.dataObjectId=this.dataObjectId;this.enabledData.enabled=true;this.termsProvider=this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider;this.dataObjectLabel=this.termsProvider.getTermNameFromASTNodeReference(this.dataObjectId)}if(!jQuery.isEmptyObject(this.attributeJson)){this.selectedData=[];for(var c in this.attributeJson){var d={attributeSelected:"",sortOrder:s.NOSORT,cancelButton:true,addButton:true};d.attributeSelected=c;d.sortOrder=this.attributeJson[c];this.selectedData.push(d);r++}if(r===1){this.selectedData[0].cancelButton=false}}if(this._selectFunctionSelected===s.SELECT){this.enableCountField=false}}var u=o._createFunctionSelectionDropDown(e,"selectFunctionSelectionLabelId",+o.selectLabelUUID);var b=new sap.m.Text({text:"Count",tooltip:"Count",textAlign:"End",layoutData:new sap.ui.layout.GridData({span:"L1 M1 S12"})});var p=new sap.m.Text({text:o.oBundle.getText("vocabulary"),tooltip:o.oBundle.getText("vocabulary"),textAlign:"End",layoutData:new sap.ui.layout.GridData({span:"L2 M2 S12"})});var h=o._createTable();var f=o._createWhereAstExpressionBasic("selectWhereLabelId"+o.selectLabelUUID);var g=o._createFunctionLabel();var _=new sap.ui.layout.form.SimpleForm({layout:sap.ui.layout.form.SimpleFormLayout.ResponsiveGridLayout,editable:true,content:[new sap.m.Label("selectFunctionSelectionLabelId"+o.selectLabelUUID,{text:o.oBundle.getText("function"),tooltip:o.oBundle.getText("function"),labelFor:u.getId()}),u,b,o._createCountField(b.getId()),p,o._createDataObjectDropDown(p.getId()),new sap.m.Label("selectAttributeLabelId"+o.selectLabelUUID,{text:o.oBundle.getText("attributes"),tooltip:o.oBundle.getText("attributes"),labelFor:h.getId()}).addStyleClass("sapAstAttributeLabel"),h,new sap.m.Label("selectWhereLabelId"+o.selectLabelUUID,{text:o.oBundle.getText("where"),tooltip:o.oBundle.getText("where"),labelFor:f.getId()}),f,new sap.m.Label({text:o.oBundle.getText("function_label"),tooltip:o.oBundle.getText("function_label"),labelFor:g.getId()}),g]});var S=new sap.m.Dialog({title:this.oBundle.getText("selectFunctionTitle"),contentWidth:"800px",showHeader:true,draggable:true,beforeClose:function(){n(false)},content:[_],buttons:[this.applyButton=new sap.m.Button({text:this.oBundle.getText("apply"),tooltip:this.oBundle.getText("applyChangesBtnTooltip"),press:function(e){var a=o._createJson();e.getSource().mProperties={value:o.functionLabel,jsonData:a};t(e);o._setModal(false);S.close();S.destroy()}}),new sap.m.Button({text:this.oBundle.getText("cancel"),tooltip:this.oBundle.getText("cancelBtnTooltip"),press:function(e){o._setModal(false);S.close();S.destroy()}})]}).addStyleClass("sapUiSizeCompact");o._setModal(true);S.open()};o.prototype._setModal=function(e){var t=sap.ui.getCore().byId("popover");if(t){t.setModal(e)}};o.prototype._getSelectedAttributeJsons=function(){var e="";var t="";var a={};for(var s=0;s<this.oModel.getData().selectionData.length;s++){if(this.oModel.getData().selectionData[s].attributeSelected!==""){e=this.oModel.getData().selectionData[s].attributeSelected;t=this.oModel.getData().selectionData[s].sortOrder;a[e]=t}}return a};o.prototype._returnDataObjectBasedOnCommonAssociationoReferenceSelection=function(e,t){var a="";var s="";if(e&&Object.keys(t).length!==0&&t.constructor===Object){var n=Object.keys(t)[0];a=e+n.replace(".","");if(Object.keys(t).length>1){for(var i in t){s=e+i.replace(".","");var o=a.split("/");var r=s.split("/");if(o.length>2&&r.length>2){a="";for(var l=1;l<(o<r?o.length:r.length);l++){if(o[l]===r[l]){a+="/"+o[l]}}}}}else{var o=a.split("/");a="";for(var l=1;l<o.length-1;l++){a+="/"+o[l]}}if(this._hasAssociationId(a)||this._hasReferenceId(a)){return a}}if(!this.includes(e,"/")){e="/"+e}return e};o.prototype._returnDataObjectBasedOnCommonAssociationReferenceAndType=function(e,t){var a="";var s="";if(e&&Object.keys(t).length!==0&&t.constructor===Object){var n=Object.keys(t)[0];a=e+n.replace(".","");if(Object.keys(t).length>1){for(var i in t){s=e+i.replace(".","");var o=a.split("/");var r=s.split("/");if(o.length>2&&r.length>2){a="";for(var l=1;l<(o<r?o.length:r.length);l++){if(o[l]===r[l]){a+="/"+o[l]}}}}}else{var o=a.split("/");a="";for(var l=1;l<o.length-1;l++){a+="/"+o[l]}}if(this._hasAssociationId(a)||this._hasReferenceId(a)){return this._returnDataObjectBasedOnType(a)}}return e};o.prototype._returnDataObjectBasedOnType=function(e){var t=e;if(t){var a=t.split("/");var s=a[1];var n=0;var i;var o="";if(a.length>2){for(var r=2;r<a.length;r++){s+="."+a[r];i=this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider.getTermByTermId(s);if(i&&i._dataObjectType==="AO"&&i._cardinality==="1..n"){n=r}else if(i&&i._dataObjectType==="R"&&i._isDataObjectTable){n=r}}if(n>0){for(var r=1;r<=n;r++){o+="/"+a[r]}}}if(o){return o}else{return"/"+a[1]}}};o.prototype._hasAssociationId=function(e){var t=e;if(t){var a=t.split("/");var s=a[1];if(a.length>2){for(var n=2;n<a.length;n++){s+="."+a[n]}}if(this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider.getTermByTermId(s)&&this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider.getTermByTermId(s)._dataObjectType==="AO"){return true}}return false};o.prototype._hasReferenceId=function(e){var t=e;if(t){var a=t.split("/");var s=a[1];if(a.length>2){for(var n=2;n<a.length;n++){s+="."+a[n]}}if(this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider.getTermByTermId(s)&&this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider.getTermByTermId(s)._dataObjectType==="R"){return true}}return false};o.prototype._returnTableIdForAttributesBasedOnType=function(e){if(e){var t=e.split("/");var a=t[1];var s=0;var n;var i="";if(t.length>2){for(var o=2;o<t.length;o++){a+="."+t[o];n=this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider.getTermByTermId(a);if(n&&n._dataObjectType==="AO"&&n._cardinality==="1..n"){s=o}else if(n&&n._dataObjectType==="R"&&n._isDataObjectTable){s=o}}if(s>0){for(var o=2;o<=s;o++){i+="/"+t[o]}}}return i}};o.prototype._addAssociationIdToWhere=function(e,t){var a="";var s;if(e){s=e.split(" ");for(var n=0;n<s.length;n++){if(s[n].indexOf("./")!==-1){s[n]="."+s[n].replace(/\./,t)}a+=s[n]+" "}return a.trim()}return e};o.prototype._removetableIdFromAttribute=function(e,t,a){var s="";var n;var i={};var o=this._returnTableIdForAttributesBasedOnType(t);if(a&&Object.keys(e).length!==0&&e.constructor===Object&&o){var r=Object.keys(e);for(var l=0;l<r.length;l++){var c=r[l];var d=e[c];c=c.replace(o,"");i[c]=d}return i}return e};o.prototype._removeAssociationIdToWhere=function(e){var t="";var a;if(e){a=e.split(" ");for(var s=0;s<a.length;s++){if(a[s].indexOf("./")!==-1){var n=a[s].split("/");a[s]="./"+n[n.length-1]}t+=a[s]+" "}return t.trim()}return e};o.prototype._addTableIdFromAttribute=function(e,t,a){var s="";var n;var i={};var o=this._returnTableIdForAttributesBasedOnType(t);if(a&&Object.keys(e).length!==0&&e.constructor===Object&&o){var r=Object.keys(e);for(var l=0;l<r.length;l++){var c=r[l];var d=e[c];c="."+c.replace(/\./,o);i[c]=d}return i}return e};o.prototype._createJson=function(){var e=this._getSelectedAttributeJsons();var t=this._whereExpressionId;var a=this._returnDataObjectBasedOnCommonAssociationoReferenceSelection(this.dataObjectId,e);var s=this._returnDataObjectBasedOnCommonAssociationReferenceAndType(this.dataObjectId,e);e=this._removetableIdFromAttribute(e,a,this.dataObjectId);var n={function:this._selectFunctionSelected,filter:t,functionLabel:this.functionLabel,dataObject:this.dataObjectId,attributes:e,doVocabId:s};if(this._count){n["count"]=this._count}return n};o.prototype.includes=function(e,t){var a=false;if(e.indexOf(t)!==-1){a=true}return a};o.prototype._createUUId=function(){this.infraUtils=new sap.rules.ui.parser.infrastructure.util.utilsBase.utilsBaseLib;return this.infraUtils.createUUID()};return{getInstance:function(){i=new o;return i}}},true);
//# sourceMappingURL=SelectFunctionDialog.js.map