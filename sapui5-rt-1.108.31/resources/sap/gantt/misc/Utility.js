/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/base/assert","sap/base/util/array/uniqueSort","sap/base/util/uid","sap/gantt/misc/Format","sap/gantt/library","sap/gantt/config/TimeHorizon","sap/base/Log","sap/ui/core/Core","sap/ui/core/format/TimezoneUtil"],function(e,t,a,i,n,r,o,u,s){"use strict";var d={};d.assign=function(e,t){if(typeof e!==typeof t){return t}else if(typeof e==="undefined"||e===null){return t}else{return e}};d.assignDeep=function(e,t){if(!e&&!t){return null}else if(e&&!t){return e}else if(!e&&t){return t}else if(typeof e==="object"&&typeof t==="object"){var a=e;for(var i in t){if(typeof a[i]!=="boolean"&&!a[i]){a[i]=t[i]}else if(typeof t[i]==="object"&&typeof a[i]==="object"){a[i]=this.assignDeep(a[i],t[i])}}return a}else{return e}};d.generateRowUid=function(e,t,i,n,r){jQuery.each(e,function(e,t){t.uid=t.id;if(n){t.uid=n+"|"+t.uid}else if(t.bindingObj&&t.bindingObj.findNode){var o=t.bindingObj.findNode(t.rowIndex);while(o.parent&&o.level>0){o=o.parent;t.uid=o.context.getObject()[r]+"|"+t.uid}}var u=t.index===undefined?-1:t.index;var s=t.chartScheme===undefined?"":t.chartScheme;t.uid="PATH:"+t.uid+"|SCHEME:"+s+"["+u+"]";t.data.uid=t.uid;for(var d=0;d<i.length;d++){var f,c;if(typeof i[d]==="string"){f=i[d];c="id"}else{f=i[d].name;c=i[d].idName?i[d].idName:"id"}if(f in t.data){for(var p=0;p<t.data[f].length;p++){var l=t.data[f][p];if(l[c]===undefined){l[c]=a()}l.uid=t.uid+"|DATA:"+f+"["+l[c]+"]";l.__id__=l[c]}}}})};d.getChartSchemeByShapeUid=function(e){return d.parseUid(e).chartScheme||""};d.generateUidForRelationship=function(e,t){var i="relationship";var n="PATH:DUMMY|SCHEME:DUMMY[0]";for(var r=0;r<e.length;r++){if(e[r][t]===undefined){e[r][t]=a()}e[r].uid=n+"|DATA:"+i+"["+e[r][t]+"]";e[r].__id__=e[r][t]}};d.generateObjectPathToObjectMap=function(e,t,a){var i;for(var n in e){var r=e[n],o,u;if(r.objectInfoRef){o=r.objectInfoRef.id;r=r.objectInfoRef}else{o=r.id}if(a&&a!=""){o=a.concat(".").concat(o)}u=o.concat("-").concat(d.parseUid(r.uid).rowIndex);t[u]=r;if(r.children&&r.children.length>0){i=this.generateObjectPathToObjectMap(r.children,t,o)}}return i};d.getShapeDataNameByUid=function(e){return d.parseUid(e).shapeDataName};d.getIdByUid=function(e,t){return t?d.parseUid(e).rowId:d.parseUid(e).shapeId};d.parseUid=function(e){var t=/(PATH:(.+)\|SCHEME:(.*?\[-?\d+\]))(?:\|DATA:(.+)\[(.*)\])?$/g;var a=t.exec(e);var i={};if(a){var n=a[3];if(n){var r=n.match(/\[-?\d+\]/)[0].slice(1,-1);n=n.replace(/\[-?\d+\]/,"")}var u=a[1],s=a[2],d=s.split("|"),f=d[d.length-1];i={rowId:f,rowPath:s,rowUid:u,chartScheme:n,shapeDataName:a[4],shapeId:a[5],rowIndex:r}}else{o.warning("UID "+e+" does not match regular expression.")}return i};d.scaleBySapUiSize=function(e,t){switch(e){case"sapUiSizeCozy":return t*1.5;case"sapUiSizeCondensed":return t*.78;default:return t}};d.findSapUiSizeClass=function(){if(document.body.classList.contains("sapUiSizeCondensed")){return"sapUiSizeCondensed"}else if(document.body.classList.contains("sapUiSizeCompact")){return"sapUiSizeCompact"}else if(document.body.classList.contains("sapUiSizeCozy")){return"sapUiSizeCozy"}else{return"sapUiSizeCozy"}};d.floatEqual=function(e,t){return Math.abs(e-t)<1e-4};d.calculateStringLength=function(e){var t=0;if(e.match("[一-鿿]")===null){t=e.length}else{t=e.length+e.match(/[\u4E00-\u9FFF]/g).length}return t};d.judgeTimeHorizonValidity=function(e,t){if(!e||!e.getStartTime()||!e.getEndTime()){return false}var a=i.abapTimestampToDate(e.getStartTime()).getTime(),n=i.abapTimestampToDate(e.getEndTime()).getTime(),r=i.abapTimestampToDate(t.getStartTime()).getTime(),o=i.abapTimestampToDate(t.getEndTime()).getTime();return a-r>=0&&o-n>=0};d.getShapeDatumById=function(e,t){return d.getDatumById(e,"sap-gantt-shape-id",t)};d.getRowDatumById=function(e,t){return d.getDatumById(e,"sap-gantt-row-id",t)||[]};d.getRowDatumRefById=function(e,t){return d.getRowDatumById(e,t).map(function(e){return e.objectInfoRef})};d.getRowDatumByShapeUid=function(e,t){var a=this.parseUid(e),i=a.rowUid,n=a.rowId;var r=null;var o=this.getRowDatumById(n,t);var u=o.filter(function(e){return e.objectInfoRef.uid.indexOf(i)>=0});if(u.length>0){r=u[0].objectInfoRef}return r};d.getShapeDatumByShapeUid=function(e,t){var a=this.parseUid(e),i=a.shapeId,n=a.rowUid;var r=this.getShapeDatumById(i,t);var o=r.filter(function(e){return e.uid.indexOf(n)>=0});return o[0]};d.getRowDatumByEventTarget=function(e){var t=null;var a=jQuery(e).closest("g[data-sap-gantt-row-id]");if(a.length){t=d3.select(a.get(0)).datum()}return t};d.getDatumById=function(a,i,n){e(typeof a==="string"||a instanceof Array,"vId must be string or array");e(n,"sContainer must specify");var r=a?a:"";var o=r;if(typeof r==="string"){o=[r]}var u=[];o.forEach(function(e){var t=["[id='",n,"']"," [data-",i,"='",e,"']"].join("");jQuery(t).each(function(e,t){var a=d3.select(t),i=a.datum();var n=u.some(function(e){var t=e.uid||e.objectInfoRef.uid,a=i.uid||i.objectInfoRef.uid;if(t!==a){return false}else{var n=e.shapeData?e.shapeData.length:0;var r=i.shapeData?i.shapeData.length:0;return n===r}});if(!n){u.push(i)}})});return t(u)};d.attributeEqualSelector=function(e,t){return"["+e+"="+"'"+t+"'"+"]"};d.calculateHorizonByWidth=function(e,t,a,n){var o=i.abapTimestampToDate(e.getStartTime());var u=i.abapTimestampToDate(e.getEndTime());var s=Math.abs(o.getTime()-u.getTime())/t;var d;if(n){d=n}else{d=o}var f=new Date;if(isFinite(s)&&typeof s==="number"&&isFinite(a)&&typeof a==="number"){f.setTime(d.getTime()+a*s)}else{f=u}return new r({startTime:d,endTime:f})};d.safeCall=function(e,t,a,i){var n=e;for(var r=0;r<t.length;r++){var o=t[r];if(!n||typeof n[o]!=="function"){return a}else if(r<t.length-1){n=n[o]()}else{n=n[o].apply(n,i)}}return n};d.getShapeBias=function(e){var t=u.getConfiguration().getRTL(),a=t?-e.getXBias():e.getXBias(),i=e.getYBias();return{x:a,y:i}};d.getLowerCaseLabel=function(e){if(n.config.TIME_PATTERN_LOWERCASE){var t=e.replaceAll("AM","am");return t.replaceAll("PM","pm")}else{return e}};d.getFormattedDate=function(e,t){var a=s.getLocalTimezone();return e.format(t,a)};return d},true);
//# sourceMappingURL=Utility.js.map